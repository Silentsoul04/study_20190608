ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6713320 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6esp-des ipsecv6-esp 5 7.5 7.7 9 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6esp-des.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IPSECV6-ESP/IPSECV6ESPpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IPSec ESP Anti Replay Window Size        32                  # (0x00000020)
IPSec ESP DUT Supports Configurable Lifetime True
IPSec ESP SA Lifetime Seconds            120                 # (0x00000078)
IPSec ESP SA Lifetime Bytes              1065                # (0x00000429)
IPSec ESP DUT Supports Transport Mode    True
IPSec DUT Supports Configurable Outbound SPD True
IPSec DUT Supports Anti Replay           True
IPSec Wait Time                          10                  # (0x0000000A)
IPSec DUT Supports Configurable Inbound SPD True
IPSec DUT Supports Explicit Congestion Notification True
IPSec DUT Supports Traffic Flow Confidentiality True
IPSecV6 ESP Suite Setup Command          "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Reset IP Security Command    "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Reset SA with Anti Replay Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Set SA Lifetime Bytes Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Set SA Lifetime Seconds Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP DUT Mode Configure Command   "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Inbound SPD for Protocol and Port Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Inbound SPD for Protocol Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Inbound SPD Policy for Subnet Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Inbound SPD Policy for Host Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 DUT Send Ping Command            "./DocScriptQ35/IPSECV6-ESP/ipsecv6-dut-send-ping-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Host Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Protocol and Port Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Protocol Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Outbound SPD Policy for Subnet Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-outbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Remove ANVL from SA Command      "./DocScriptQ35/IPSECV6-ESP/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
IPSec DUT ECN Configure Command          "./DocScriptQ35/IPSECV6-ESP/ipsecv6-ecn-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for ICMP Type And Code Command "./DocScriptQ35/IPSECV6-ESP/ipsec-set-outbound-spd-icmp-type-code-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Outbound SPD Policy for Host Command ""
IPSec DUT Verify Audit Log for Bad SPI Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP DUT TFC Configure Command      "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-TFC-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP Set SA Lifetime Seconds Command ""
IPSec Set Inbound SPD for Protocol and Port Command ""
IPSec Set Inbound SPD for Host Command   ""
IPSecV6 DUT Uses Wildcard Identification True
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6esp-des.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:1111::5555
  IPV6 ANVL Address                        3ffe:1111::1111
  IPV6 Gateway                             3ffe:1111::5555
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:2222::5555
  IPV6 ANVL Address                        3ffe:2222::1111
  IPV6 Gateway                             3ffe:2222::5555
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Encapsulation                   v6Ov6
  IPSec Configuration                      Manual
  IPSec IPv6 Remote Host Address           3ffe:1111::1111
  IPSec IPv6 Local Host Address            3ffe:2222::1111
  IPSec ANVL SPI                           768               # (0x00000300)
  IPSec DUT SPI                            770               # (0x00000302)
  IPSec Authentication Algorithm           HMAC_MD5_96
  IPSec Authentication Key                 66306630663066306630663066302222
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          SHA
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                AH_MD5
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Authentication Algorithm    HMAC_MD5
  IPSec Encryption Algorithm               DES_CBC
  IPSec Encryption Key                     8000000000000000
  IPSec Encryption IV                      0202020202020202
  IKE Pre-Shared Key                       abcdefghijklmnopqrstuvwx

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL NOT_CONFIGURED NOT_CONFIGURED HMAC_MD5_96 NOT_CONFIGURED DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 NOT_CONFIGURED NOT_CONFIGURED NOT_CONFIGURED NOT_CONFIGURED

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "1"
sysvar: ipnet.inet.AcceptSourceRoute=1 ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 3ffe:1111::5555/64 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 3ffe:2222::5555/64 up
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5555 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 3ffe:1111::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5555 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 3ffe:1111::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5555 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 3ffe:1111::1111 < 3ffe:1111::5555 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:1111::5555 as 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:5555 < 3ffe:2222::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 3ffe:2222::1111 < 3ffe:2222::5555 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:2222::5555 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite IPSec Encapsulating Security Payload
RFC 4301: 'Security Architecture for the Internet Protocol'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)
RFC 2403: 'The Use of HMAC-MD5-96 within ESP and AH'
(C. Madson Cisco Systems Inc., R. Glenn NIST, November 1998)
RFC 2404: 'The Use of HMAC-SHA-1-96 within ESP and AH'
(C. Madson Cisco Systems Inc., R. Glenn NIST, November 1998)
RFC 2405: 'The ESP DES-CBC Cipher Algorithm With Explicit IV
(C. Madson Cisco Systems Inc., N. Doraswamy Bay Networks, Inc.,
November 1998)
RFC 4306: 'IP Encapsulating Security Payload'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)


ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the machine ANVL is running on is connected
to 2 interfaces that are connected to the device under test.

The ANVL config file must contain 2 IPv6 interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IPSECV6-ESP-5.1
TEST_DESCRIPTION
IPSec MUST discard an incoming IPv6-datagram containing 8 bytes of
Payload Data in ESP Header .
TEST_REFERENCE
NEGATIVE: RFC 2405 s3 p2 ESP Payload
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
        containing 8 bytes of Payload Data in ESP Header
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2662  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2663  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2664  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2665  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2666  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1953] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1952] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1954] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1955] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted IPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  02 02 02 02 02 02 02 02                           ........
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  EB FA 4D FE 7C 35 62 D7 46 B6 5B 02               ..M.|5b.F.[.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for  IP Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-5.1: Passed

>> IPSECV6-ESP-5.2
TEST_DESCRIPTION
IPSec MUST discard an incoming IPv6-datagram containing Next Header
field NOT right aligned within a 8-byte word.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.4 p14 Padding (for Encryption)
          RFC 2405 s3.1 p3 Block Size and Padding
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host with
        Payload Data, Padding, Pad Length and Next Header field NOT
        right aligned within a 8-byte word in ESP Trailer.
        The padding field
        will be such that the Payload Data, Padding, Pad Length and
        Next Header field will be out of (8-byte) alignment by
        <shift> bytes
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
- CASE: <shift> = 1
- CASE: <shift> = 2
- CASE: <shift> = 3
- CASE: <shift> = 5
- CASE: <shift> = 6
- CASE: <shift> = 7
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2667  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2668  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2669  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2670  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2671  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1957] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1956] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1958] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1959] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Pad Length to 1 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 89 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: --- Bad Encrypted Payload Data [69 bytes] ---
ESP:  71 06 C1 50 82 A4 15 57 E0 91 D5 FF 0C 6D 3F 50   q..P...W.....m?P
ESP:  FA D8 F0 4A 6C 23 23 8A D4 26 15 EC A2 83 61 BB   ...Jl##..&....a.
ESP:  3B 5C 22 CC 84 21 E8 38 61 FA 99 78 5D 47 FC 41   ;\"..!.8a..x]G.A
ESP:  2A 8A E4 7A D2 B7 4F DE 16 5B 2D CC 98 73 AB BF   *..z..O..[-..s..
ESP:  00 00 00 00 00                                    .....
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 4B 37 B2 08 DC 70 F6 F1 42 EE 84               .K7...p..B..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Pad Length to 2 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 90 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: --- Bad Encrypted Payload Data [70 bytes] ---
ESP:  73 AB BF 00 00 00 00 00 F4 68 1D 9E 4C B2 B9 23   s........h..L..#
ESP:  90 71 96 23 E5 3F 86 36 64 1D 29 F0 D6 C4 00 99   .q.#.?.6d.).....
ESP:  9C AB F7 63 AC BA D4 57 44 38 0B FB FD E5 8A B8   ...c...WD8......
ESP:  1C 3B D6 D9 18 DB 52 45 2F 3E D5 F9 7B 68 B5 E0   .;....RE/>..{h..
ESP:  00 00 00 00 00 00                                 ......
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6C 3F 97 30 79 DF ED 39 5A AA A0 B0               l?.0y..9Z...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Pad Length to 3 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 91 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: --- Bad Encrypted Payload Data [71 bytes] ---
ESP:  B5 E0 00 00 00 00 00 00 3B BB C6 CE 7F 29 DA 82   ........;....)..
ESP:  8B F2 62 1C 9D 7A A3 25 A0 EB FE 9D A4 F9 EB 49   ..b..z.%.......I
ESP:  98 17 9E 3B AB 5B C7 E8 6C F3 40 29 9C DB 2B 91   ...;.[..l.@)..+.
ESP:  49 52 F4 28 42 1D 7B 3D 06 A9 B2 A6 98 4E 54 6D   IR.(B.{=.....NTm
ESP:  00 00 00 00 00 00 00                              .......
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AB DD 12 4F FF B4 01 6B 59 9E E3 96               ...O...kY...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Pad Length to 5 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 93 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: --- Bad Encrypted Payload Data [73 bytes] ---
ESP:  6D 00 00 00 00 00 00 00 04 04 7C 7D 9C EF BB D6   m.........|}....
ESP:  57 78 4A F3 08 E4 D3 88 5C 24 9E 57 47 04 F0 91   WxJ.....\$.WG...
ESP:  10 3C 69 3A B3 34 CB 5A D6 9E B0 07 AC 0C C9 D2   .<i:.4.Z........
ESP:  CE A4 2F C4 27 9A E7 E5 0C 89 55 91 B4 10 0B 11   ../.'.....U.....
ESP:  95 A5 44 4A 49 38 0F A5 00                        ..DJI8...
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8D 58 20 18 93 C5 3F B5 B1 1F 98 46               .X ...?....F
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Pad Length to 6 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 94 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: --- Bad Encrypted Payload Data [74 bytes] ---
ESP:  A5 44 4A 49 38 0F A5 00 36 80 4E 5A 3F CD 66 FC   .DJI8...6.NZ?.f.
ESP:  85 1E 2A 07 43 37 75 EB D4 88 BB EF D2 A2 08 C8   ..*.C7u.........
ESP:  24 08 46 28 24 3F F6 7C CB 29 48 5B D5 10 4C 48   $.F($?.|.)H[..LH
ESP:  B1 63 6E D0 4F E4 12 20 00 4F FD 09 38 63 CA 68   .cn.O.. .O..8c.h
ESP:  3C C7 D0 37 D9 0D C0 05 00 00                     <..7......
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2D 3B CD 4B BE 6F 78 DE 5B BC 8E C7               -;.K.ox.[...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Pad Length to 7 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 95 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: --- Bad Encrypted Payload Data [75 bytes] ---
ESP:  D0 37 D9 0D C0 05 00 00 F5 C4 BA 22 DB 5C AE 9C   .7.........".\..
ESP:  D9 C2 43 97 28 C3 D6 4B D6 72 18 11 19 CF F8 A8   ..C.(..K.r......
ESP:  D6 ED EF 7A D1 BE E4 60 7F B2 69 2B D3 1D D0 2F   ...z...`..i+.../
ESP:  71 61 B9 72 CB 0B 0E 55 4C 7B 11 26 FB E1 A3 AD   qa.r...UL{.&....
ESP:  F1 AB FC FA 5B DF C2 5B 00 00 00                  ....[..[...
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  08 45 D7 E7 D5 E3 79 40 CE B9 2A FE               .E....y@..*.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-5.2: Passed

>> IPSECV6-ESP-7.5
TEST_DESCRIPTION
IPSec MUST set the Pad Length and Next Header in ESP Trailer such that
they are right aligned within 8-byte word, while using non-NULL
Encryption Algo.
TEST_REFERENCE
RFC 4303 s2.4 p15 Padding
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host with
        <n> bytes of ULP Information
-  DUT: Forward the ESP-secured ICMPv6 Echo Request to Remote Host
        with Padding field in ESP Trailer set such that Pad-Length
        and Next-Header fields are right-aligned within a 8-byte word
- CASE: <n> = 10 (needs (8n+4) bytes Padding, n>=0)
- CASE: <n> =  9 (needs (8n+5) bytes Padding, n>=0)
- CASE: <n> =  8 (needs (8n+6) bytes Padding, n>=0)
- CASE: <n> =  7 (needs (8n+7) bytes Padding, n>=0)
- CASE: <n> =  6 (needs (8n+0) bytes Padding, n>=0)
- CASE: <n> =  5 (needs (8n+1) bytes Padding, n>=0)
- CASE: <n> =  4 (needs (8n+2) bytes Padding, n>=0)
- CASE: <n> =  3 (needs (8n+3) bytes Padding, n>=0)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2672  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2673  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2674  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2675  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2676  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1961] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1960] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1962] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1963] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send ICMPv6 Echo Request with 10 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 18 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x58FF (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [10 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  03 F9 93 DE 5D 49 F7 20                           ....]I. 
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 18 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x58FF (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [10 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [4 bytes] ---
ESP:  01 02 03 04                                       ....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 4 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  48 73 F5 B3 64 B0 BE F8 EA A7 0B 74               Hs..d......t
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
4 (8x0 + 4) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 9 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 17 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5920 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [9 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  2B E9 9B D3 BE 58 99 C8                           +....X..
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 17 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5920 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [9 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [5 bytes] ---
ESP:  01 02 03 04 05                                    .....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 5 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2D 74 A7 98 B3 52 1B 83 19 8C 06 61               -t...R.....a
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
5 (8x0 + 5) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 8 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 16 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD21 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  5A 98 95 E8 2B 18 6E EC                           Z...+.n.
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 16 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD21 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B4 10 9D 3F C7 EF 76 DF C6 54 D9 C5               ...?..v..T..
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
6 (8x0 + 6) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 7 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 15 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD75 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [7 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45                              ANVL TE
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  2E 5A 76 2A 7A 41 43 42                           .Zv*zACB
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 15 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD75 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [7 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45                              ANVL TE
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [7 bytes] ---
ESP:  01 02 03 04 05 06 07                              .......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 7 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0C 7A E0 33 5F D1 46 72 80 FE 9A 2F               .z.3_.Fr.../
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
7 (8x0 + 7) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 6 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  E5 EA 0B BA A1 17 11 1C                           ........
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C7 46 E6 8C ED 6D 0D 66 25 CA 3B B3               .F...m.f%.;.
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
0 (8x0 + 0) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 5 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BC F6 DC EF 11 67 23 97                           .....g#.
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [1 bytes] ---
ESP:  01                                                .
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 1 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  69 EA 61 30 A0 6A 5A C8 76 A5 D2 9C               i.a0.jZ.v...
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
1 (8x0 + 1) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 4 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  74 E2 05 AC 33 86 99 95                           t...3...
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  84 B9 59 26 A9 2A D3 80 87 D9 20 97               ..Y&.*.... .
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
2 (8x0 + 2) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 3 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  39 A8 5B E9 81 A7 A5 16                           9.[.....
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DA 56 BF 69 C4 B4 41 61 68 49 4A 48               .V.i..AahIJH
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
3 (8x0 + 3) in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.5: Passed

>> IPSECV6-ESP-7.7
TEST_DESCRIPTION
The first padding byte appended to the plaintext is numbered 1,
with subsequent padding bytes making up a monotonically increasing
sequence: 1, 2, 3, ...  using NULL Encryption.
TEST_REFERENCE
RFC 2406 s2.4 p6 Padding; RFC 2405 s3.1 p3 ESP Payload
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host with <n> bytes of
        ULP Information
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Request
        to Remote Host with Padding field in ESP trailer set such
        that the Padding field contains a sequence of monotonically
        increasing integers starting from 1
- CASE: <n> = 10 (needs 8n bytes Padding, n>=0)
- CASE: <n> =  9 (needs (8n+1) bytes Padding, n>=0)
- CASE: <n> =  8 (needs (8n+2) bytes Padding, n>=0)
- CASE: <n> =  7 (needs (8n+3) bytes Padding, n>=0)
- CASE: <n> =  6 (needs (8n+4) bytes Padding, n>=0)
- CASE: <n> =  5 (needs (8n+5) bytes Padding, n>=0)
- CASE: <n> =  4 (needs (8n+6) bytes Padding, n>=0)
- CASE: <n> =  3 (needs (8n+7) bytes Padding, n>=0)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2677  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2678  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2679  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2680  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2681  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1965] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1964] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1966] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1967] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send ICMPv6 Echo Request with 10 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 18 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x58FF (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [10 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B0 67 31 20 96 34 B1 03                           .g1 .4..
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 18 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x58FF (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [10 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [4 bytes] ---
ESP:  01 02 03 04                                       ....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 4 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7F B3 1D 4F 42 03 83 4C 7E 7F 12 21               ...OB..L~..!
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04                                       ....
is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 9 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 17 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5920 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [9 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BB 03 3F B4 7E 66 07 51                           ..?.~f.Q
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 17 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5920 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [9 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [5 bytes] ---
ESP:  01 02 03 04 05                                    .....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 5 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  57 C9 B3 D1 DA 1E 95 F9 49 E3 5C 0A               W.......I.\.
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04 05                                    .....
is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 8 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 16 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD21 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D4 09 D1 6C A5 57 B3 A1                           ...l.W..
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 16 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD21 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  96 7A E3 A2 51 BA AF 2F 1C 36 4D 3A               .z..Q../.6M:
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04 05 06                                 ......
is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 7 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 15 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD75 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [7 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45                              ANVL TE
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F3 5E 5F 7D 77 7E EC 46                           .^_}w~.F
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 15 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD75 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [7 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45                              ANVL TE
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [7 bytes] ---
ESP:  01 02 03 04 05 06 07                              .......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 7 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C4 66 61 B3 3A 2D E2 83 53 DC D1 4B               .fa.:-..S..K
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04 05 06 07                              .......
is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 6 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  5F DE 37 AF 73 31 E9 99                           _.7.s1..
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8A BD 88 9F 7C EA 98 69 D8 42 CD C1               ....|..i.B..
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:

is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 5 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  17 26 98 57 D2 5D 15 40                           .&.W.].@
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [1 bytes] ---
ESP:  01                                                .
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 1 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  55 2B 3F 2B EB F3 6F 73 41 F3 5E AE               U+?+..osA.^.
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01                                                .
is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 4 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F3 08 7E 8B 14 E6 64 50                           ..~...dP
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  13 E8 B4 3B 23 D0 35 6F 3D 4B 46 A9               ...;#.5o=KF.
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02                                             ..
is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Case: send ICMPv6 Echo Request with 3 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  7C F8 6F 05 2D 29 2B C1                           |.o.-)+.
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  73 9E 4B F7 4A 74 34 40 C8 40 7C 21               s.K.Jt4@.@|!
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03                                          ...
is correct in the ESP packet received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.7: Passed

>> IPSECV6-ESP-9.1
TEST_DESCRIPTION
DES-CBC requires an explicit Initialization Vector (IV) of
8 octets (64 bits).
TEST_REFERENCE
RFC 2405 s3 p2 ESP Payload
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host with <n>
        bytes of ULP Information
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Request
        to Remote Host with Payload-Data field in ESP Header having
        length <n+8+40+8> (8 bytes for ICMPv6 header +
                           40 bytes for IPv6 Header +
                           8 bytes for Initialization Vector)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2682  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2683  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2684  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2685  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2686  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1969] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1968] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1970] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1971] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  AF 1E 9B 9A DE 13 0C 3F                           .......?
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C2 0A ED 4A 86 77 D6 01 64 8A 25 26               ...J.w..d.%&
ESP: --- Authentication Data End ---
ESP:

Correctly received payload data len in ESP Packet:72
on interface eth3 (3ffe:1111::1111)
(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-9.1: Passed

>> IPSECV6-ESP-9.2
TEST_DESCRIPTION
This IV immediately precedes the protected (encrypted)
payload. The IV MUST be a random value.
TEST_REFERENCE
RFC 2405 s3 p2 ESP PAYLOAD
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host
-  DUT: Forward the corresponding ICMPv6 Echo Request to
        Remote Host
- ANVL: Note the value of IV (iv1) in ESP-secured ICMPv6 Echo Request
        to Remote Host and send next ICMPv6 Echo Request
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Request
        to Remote Host with a random IV different from iv1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2687  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2688  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2689  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2690  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2691  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1973] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1972] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1974] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1975] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  9A 26 C5 08 43 29 9B 83                           .&..C)..
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B0 90 BE 5D 6B 04 9A 06 81 B7 48 2D               ...]k.....H-
ESP: --- Authentication Data End ---
ESP:

Received expected ESP Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  57 E1 22 32 8E 3A 21 88                           W."2.:!.
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  88 B5 BE BC 24 D7 8D 8B 40 2A 57 63               ....$...@*Wc
ESP: --- Authentication Data End ---
ESP:

Correctly received initialization vector in ESP Packet:
57 E1 22 32 8E 3A 21 88                           W."2.:!.
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-9.2: Passed

>> IPSECV6-ESP-9.3
TEST_DESCRIPTION
To avoid ECB encryption of very similar plaintext blocks in
different packets, implementations MUST NOT use a counter or
other low-Hamming distance source for IVs.
TEST_REFERENCE
RFC 2405 s3 p2 ESP Payload
TEST_METHOD
- ANVL: Send 10 ICMPv6 Echo Requests from Local Host
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Requests
        to Remote Host, such that the I-th (1 <= I <= 10)
        forwarded Request contains <ivI> in the IV field of the
        ESP Payload
- ANVL: Check that (iv1, iv2, ... iv10) do not form an arithmetic
        sequence
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command-des.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2692  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2693  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2694  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2695  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2696  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1977] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1976] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1978] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1979] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BF DA 63 7C 07 E8 67 A5                           ..c|..g.
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B8 F4 BC 28 54 23 54 46 50 20 C6 EC               ...(T#TFP ..
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  66 A0 7B E0 EF B1 00 06                           f.{.....
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  20 30 84 B9 9A E6 1C 00 81 C9 F5 05                0..........
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  4D EE 83 C5 6B E8 D7 A8                           M...k...
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BD C8 0D 75 EF 9A 90 87 B6 1B AC 99               ...u........
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DC 7A FF 56 82 C9 3F 2D                           .z.V..?-
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B1 41 54 65 0E E4 E6 4D 10 DD 44 CB               .ATe...M..D.
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  4A C9 AA E4 A3 75 1B 5F                           J....u._
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5E C4 26 8B 3C 63 30 34 8F AA 4D FB               ^.&.<c04..M.
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DF DD 93 FC DE 4C 52 1C                           .....LR.
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  53 45 1A 5C AF 92 FB B6 54 C0 FF A9               SE.\....T...
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C4 C2 58 00 28 89 C0 25                           ..X.(..%
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  26 E5 CE 74 73 D8 B7 5B 5F 4B 0C 18               &..ts..[_K..
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  9C 4A 1E 4B B4 9B AB 82                           .J.K....
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B3 3F 3B 57 3E 54 95 63 47 9E EE 23               .?;W>T.cG..#
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  CA C2 C5 DA C6 C5 33 8C                           ......3.
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2E D4 C5 17 74 E7 F0 D7 2C 56 0E 17               ....t...,V..
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DF CC D8 1E 03 32 86 3D                           .....2.=
ESP: --- Initialization Vector End ---
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A2 BE 01 68 50 5C 71 7D 90 F1 22 EB               ...hP\q}..".
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Correctly received initialization vectors in ESP Packets
They did not form an arithmetic sequence.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-9.3: Passed
Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/IPSECV6ESPpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "0"
sysvar: ipnet.inet.AcceptSourceRoute=0 ok
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2697  pid=0x5de180
------------------------------------------
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          7
Number of tests passed:       7
Number of tests failed:       0
Number of tests inconclusive: 0
