ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6744072 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvligmpv3 igmpv3 1-5.10 5.12-6.9 6.11-7 9-10 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvligmpv3.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IGMPV3/IGMPV3postsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IGMPv3 Suite Setup Command               "./DocScriptQ35/IGMPV3/igmpv3-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IGMPv3 Interface Init Command            "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IGMPv3 Interface Reset Command           "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IGMPv3 Configure Static Route Command    "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IGMPv3 Same Application uses same socket to join a Group True
IGMPv3 Run Older Version Tests           True
IGMPv3 Configure Group Command           "./DocScriptQ35/IGMPV3/igmpv3-configure-group-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IGMPv3 Enter Older Version Command       "./DocScriptQ35/IGMPV3/igmpv3-enter-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IGMPv3 Leave Older Version Command       "./DocScriptQ35/IGMPV3/igmpv3-leave-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IGMPv3 DUT is Configured as              ROUTER
IGMPv3 User Defined Tolerance Time       1                   # (0x00000001)
IGMPv3 User Defined Process Time         1                   # (0x00000001)
IGMPv3 Robustness Variable               2                   # (0x00000002)
IGMPv3 Query Response Interval           100                 # (0x00000064)
IGMPv3 Startup Query Interval            31                  # (0x0000001F)
IGMPv3 Last Member Query Interval        10                  # (0x0000000A)
IGMPv3 Last Member Query Count           2                   # (0x00000002)
IGMPv3 Unsolicited Report Interval       1                   # (0x00000001)
IGMPv3 Older Version Router Present Timeout 260              # (0x00000104)
IGMPv3 Send Seed Packet To Prime DUT     True
IGMPv3 Number Seed Packets To Send       1                   # (0x00000001)
IGMPv3 Delay After Sending Seed Packet   1                   # (0x00000001)
IGMPv3 Query Interval                    125                 # (0x0000007D)
IGMPv3 IP Invalid Protocol               255                 # (0x000000FF)
IGMPv3 IP Invalid TTL                    255                 # (0x000000FF)
IGMPv3 IP Invalid Type Of Service        255                 # (0x000000FF)
IGMPv3 Invalid Checksum                  65535               # (0x0000FFFF)
IGMPv3 Run Source Specific Multicast Routing Tests True
IGMPv3 First Unused Multicast Group Address "239.255.255.2"

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvligmpv3.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255
  IP First Unused Address                  30.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255
  IP First Unused Address                  40.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

# Configuration File End.

The DUT is not configured to act as host, therefore
 the following tests will not be run: 1.2 2.1 2.2 2.3 2.4 3.1 3.2 3.3 4.2 4.3 4.6 4.7 4.10 4.11 4.14 
4.15 4.20 5.1 5.2 5.3 5.5 5.10 5.24 5.25 5.31 5.32 6.1 6.3 
6.5 6.6 6.7 6.8 6.9 6.11 6.14 6.15 6.16 6.17 6.18 6.19 6.20 
6.21 6.22 6.23 6.25 6.27 6.28 10.4 10.5 10.6 10.7 
10.8 10.9 10.10 10.11 10.12 10.13 10.14 10.15 10.16 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill iprip
ipd: kill iprip ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask  255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask  255.255.255.0 up
-> cmd sysvar set -o -c ipmcp.UpstreamIf "gei2"
sysvar: ipmcp.UpstreamIf=gei2 ok
-> cmd sysvar set -o -c ipmcp.DownstreamIfs "gei0,gei1"
sysvar: ipmcp.DownstreamIfs=gei0,gei1 ok
-> cmd sysvar set -o -c ipmcp.igmp.CompatibilityMode "3"
sysvar: ipmcp.igmp.CompatibilityMode=3 ok
-> exit
Au revoir!
Connection closed by foreign host.

Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp failed: not started
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Checking if DUT sends IGMPv3 General Queries on both the interfaces
<DIface-0> (30.1.1.5) and <DIface-1> (40.1.1.5)

Ignoring IGMPv2 Membership Report message
01:00:5E:00:00:01 < 00:15:17:C8:90:28 IP 224.0.0.1 < 30.1.1.5 IGMPv3 Membership Query (0x11)


Ignoring IGMPv2 Membership Report message
01:00:5E:00:00:01 < 00:15:17:C8:90:29 IP 224.0.0.1 < 40.1.1.5 IGMPv3 Membership Query (0x11)

DUT correctly sent IGMPv3 General Queries on both the interfaces
<DIface-0> (30.1.1.5) and <DIface-1> (40.1.1.5)
Active Validation Successful

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

00:1B:21:7D:57:BA < 00:15:17:C8:90:28 ARP Rsp 30.1.1.150

Device Under Test found at 30.1.1.5 as 00:15:17:C8:90:28
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite IGMPv3 (igmpv3)
RFC 3376: 'Internet Group Management Protocol, Version 3'
(Fenner, October 2002)

ANVL Test Suite Required Setup:
This suite expects to be running against an IGMP v3 host or an
IGMP v3 router. If the DUT is a router, it has to be configured
to accept IGMPv3 packets on 1 interface for some tests and 2 for
some other tests. Some tests require that the router be restarted.
If the DUT is an IGMP v3 host, some tests require that it be
configured to join or leave a specified group.

Many tests expect that the DUT's timers be configured to the
default values specified in the RFC.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IGMPV3-1.1
TEST_DESCRIPTION
Quick test to verify that DUT acts as an IGMPv3 Router
TEST_REFERENCE
RFC 3376, IGMP Version 3
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv2 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x606E (24686)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xC49E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-1.1: Passed

>> IGMPV3-4.1
TEST_DESCRIPTION
IGMP messages are encapsulated in IPv4 datagrams, with an
IP protocol number of 2
(Tests that IGMPv3 Membership Query Message conforms to
above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4 p7 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - IP protocol number field set to 2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv2 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x3FC6 (16326)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE546 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

IP protocol number field of received IGMPv3 General Query
is correctly set to 2

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.1: Passed

>> IGMPV3-4.4
TEST_DESCRIPTION
IGMP messages are encapsulated in IPv4 datagrams, with an
IP protocol number of 2
(Tests that IGMPv3 Membership Report Message conforms to
above statement)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4 p7 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing one IGMP Group Record containing:
        - Record Type field set to MODE_IS_EXCLUDE
        - Multicast Address field set to <MCAST_GRP_1>
        - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - IP protocol number field set to <InvalidProtoNum>
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Discard the malformed IGMPv3 Report Message
-  DUT: Do not multicast IGMPv3 Group Specific Query Message
        for <MCAST_GRP_1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv2 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x61B6 (25014)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xC356 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5)
containing one IGMP Group Record containing:
- Record Type field set to 2 (IS_EX)
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
- No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2462 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP protocol number field set to <InvalidProtoNum> (255)
- one IGMP Group Record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0002 (2)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = *UNKNOWN* (255)
IP: Header Checksum        = 0x2364 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IP: --- Trailing Data [16 bytes] ---
IP:  22 00 EB FB 00 00 00 01 03 00 00 00 EF FF FF 02   "...............
IP: --- Trailing Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for no IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

Correctly did not receive IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.4: Passed

>> IGMPV3-4.5
TEST_DESCRIPTION
Every IGMP message described in this document is sent
with an IP Time-to-Live of 1
(Tests that IGMPv3 Membership Query Message conforms to
above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4 p7 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - IP Time-to-Live field set to 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv2 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x4B0F (19215)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xD9FD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

IP Time-to-Live field of received IGMPv3 General Query
is correctly set to 1

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.5: Passed

>> IGMPV3-4.8
TEST_DESCRIPTION
Every IGMP message described in this document is sent
with an IP Time-to-Live of 1
(Tests that IGMPv3 Membership Report Message conforms to
above statement)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4 p7 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing one IGMP Group Record containing:
        - Record Type field set to MODE_IS_EXCLUDE
        - Multicast Address field set to <MCAST_GRP_1>
        - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - IP Time-to-Live field set to <InvalidIGMPTTL>
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Discard the malformed IGMPv3 Report Message
-  DUT: Do not multicast IGMPv3 Group Specific Query Message
        for <MCAST_GRP_1>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv2 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x1613 (5651)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x0EFA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5)
containing one IGMP Group Record containing:
- Record Type field set to 2 (IS_EX)
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
- No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2460 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Time-to-Live field set to <InvalidIGMPTTL> (255)
- one IGMP Group Record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 255
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x265E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for no IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

Correctly did not receive IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.8: Passed

>> IGMPV3-4.9
TEST_DESCRIPTION
Every IGMP message described in this document is sent with
IP Precedence of Internetwork Control (e.g., Type of Service
0xc0)
(Tests that IGMPv3 Membership Query Message conforms to
above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4 p7 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - IP Type of Service field set to 0xc0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xBF96 (49046)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x6576 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

IP Type of Service field of received IGMPv3 General Query
is correctly set to 0xC0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.9: Passed

>> IGMPV3-4.13
TEST_DESCRIPTION
Every IGMP message described in this document carries an IP
Router Alert option [RFC-2113] in its IP header
(Tests that IGMPv3 Membership Query Message conforms to
above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4 p7 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - IP Router Alert option
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x5D95 (23957)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xC777 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Received IP header correctly contains IPv4 options

IP options type field of received IGMPv3 General Query
is correctly set to 0x94 (Router Alert)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.13: Passed

>> IGMPV3-4.16
TEST_DESCRIPTION
Every IGMP message described in this document carries an IP
Router Alert option [RFC-2113] in its IP header
(Tests that IGMPv3 Membership Report Message conforms to
above statement)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4 p7 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing one IGMP Group Record containing:
        - Record Type field set to MODE_IS_EXCLUDE
        - Multicast Address field set to <MCAST_GRP_1>
        - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - No IP Router Alert option
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Discard the malformed IGMPv3 Report Message
-  DUT: Do not multicast IGMPv3 Group Specific Query Message
        for <MCAST_GRP_1>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x09C6 (2502)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1B47 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5)
containing one IGMP Group Record containing:
- Record Type field set to 2 (IS_EX)
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
- No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x245E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- No IP Router Alert option
- one IGMP Group Record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xB965 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for no IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Correctly did not receive IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.16: Passed

>> IGMPV3-4.17
TEST_DESCRIPTION
An implementation of IGMPv3 MUST also support the following
message type, for interoperation with previous versions
of IGMP:
0x12          Version 1 Membership Report    [RFC-1112]
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4 p8 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv1 Report Message to <DIface-0>
        containing:
        - Multicast Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       556   lo0    0    
128.224.166.0/23                vxTarget                      UC       1102  gei2   0    
vxTarget                        vxTarget                      UH       3419  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       104352lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x1F1A (7962)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x05F3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv1 Membership Report to <DIface-0> (30.1.1.5) containing:
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1578 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = IGMPv1 Membership Report (0x12)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFEFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv1 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B13 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B12 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0900 (2304)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x331B (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       564   lo0    0    
128.224.166.0/23                vxTarget                      UC       1113  gei2   0    
vxTarget                        vxTarget                      UH       3451  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       106472lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.17: Passed

>> IGMPV3-4.18
TEST_DESCRIPTION
An implementation of IGMPv3 MUST also support the following
message type, for interoperation with previous versions
of IGMP:
0x16          Version 2 Membership Report    [RFC-2236]
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4 p8 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv2 Report Message to <DIface-0>
        containing:
        - Multicast Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       580   lo0    0    
128.224.166.0/23                vxTarget                      UC       1116  gei2   0    
vxTarget                        vxTarget                      UH       3487  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       108568lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x53D5 (21461)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xD137 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv2 Membership Report to <DIface-0> (30.1.1.5) containing:
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1575 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = IGMPv2 Membership Report (0x16)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFAFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv2 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B10 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0F (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0C00 (3072)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x301B (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       588   lo0    0    
128.224.166.0/23                vxTarget                      UC       1124  gei2   0    
vxTarget                        vxTarget                      UH       3519  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       110674lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.18: Passed

>> IGMPV3-4.19
TEST_DESCRIPTION
An implementation of IGMPv3 MUST also support the following
message type, for interoperation with previous versions
of IGMP:
0x17          Version 2 Leave Group          [RFC-2236]
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4 p8 Message Formats
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv2 Report Message to <DIface-0>
        containing:
        - Multicast Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Send an IGMPv2 Leave Message to <DIface-0>
        containing:
        - IP Destination Address field set to ALL_ROUTERS
        - Multicast Address field set to <MCAST_GRP_1>
- ANVL: Wait for <AddressRecordDeleteTime> seconds for DUT
        to delete <MCAST_GRP_1> from its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       604   lo0    0    
128.224.166.0/23                vxTarget                      UC       1126  gei2   0    
vxTarget                        vxTarget                      UH       3553  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       112772lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xC93F (51519)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x5BCD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv2 Membership Report to <DIface-0> (30.1.1.5) containing:
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1572 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = IGMPv2 Membership Report (0x16)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFAFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv2 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0D (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0C (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0F00 (3840)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2D1B (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv2 Leave to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to ALL_ROUTERS (224.0.0.2)
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x246F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = Leave Group (0x17)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xF9FC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv2 Leave to <DIface-0> (30.1.1.5)

Waiting for 3 seconds for DUT to delete group 239.255.255.2
from its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B09 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       612   lo0    0    
128.224.166.0/23                vxTarget                      UC       1136  gei2   0    
vxTarget                        vxTarget                      UH       3585  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       114950lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-4.19: Passed

>> IGMPV3-5.4
TEST_DESCRIPTION
The Checksum is the 16-bit one's complement of the one's
complement sum of the whole IGMP message (the entire IP
payload).
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.2 p10 Checksum
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - Checksum fields set to the 16-bit one's
          complement of the one's complement sum of the
          whole IGMP message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xED62 (60770)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x37AA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Checksum field of received IGMPv3 General Query
is correctly set to 0xEC1E

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.4: Passed

>> IGMPV3-5.6
TEST_DESCRIPTION
The Group Address field is set to zero when sending a
General Query
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.3 p10 Group Address
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - Group Address field set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x5695 (22165)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xCE77 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 General Query
is correctly set to 0.0.0.0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.6: Passed

>> IGMPV3-5.7
TEST_DESCRIPTION
The Group Address field is set to the IP multicast address
being queried when sending a Group-Specific Query
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.3 p10 Group Address
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
        for <MCAST_GRP_1>
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x2A8D (10893)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xFA7F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2450 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x244F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x426E (17006)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xD39D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group Specific Query
is correctly set to 0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.7: Passed

>> IGMPV3-5.8
TEST_DESCRIPTION
The Group Address field is set to the IP multicast address
being queried when sending a Group-and-Source-Specific
Query
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.3 p10 Group Address
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Addresses <S1>,<S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message for <MCAST_GRP_1> and source <S2>
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 1
        - Source Address <S2>
        - No other Source Addresses
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x8BC8 (35784)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x9944 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Addresses <S1> (64.64.64.1),<S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2446 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2449 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0x68B8 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 1
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x606F (24687)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xB598 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0x7D32 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 1
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group And Source Specific Query
is correctly set to 1

The first Source Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 64.64.64.2

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.8: Passed

>> IGMPV3-5.9
TEST_DESCRIPTION
The Resv field is set to zero on transmission
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.4 p10 Resv (Reserved)
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - Resv field set to 0.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xAA2E (43566)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x7ADE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Resv field of received IGMPv3 General Query
is correctly set to 0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.9: Passed

>> IGMPV3-5.12
TEST_DESCRIPTION
When set to one, the S Flag indicates to any receiving
multicast routers that they are to suppress the normal
timer updates they perform upon hearing a Query
While received Q(G) Group Timer is lowered to LMQT if
S-Flag is not set
(Tests for S Flag set to 0)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.1.5 p10 S Flag
(Suppress Router-Side Processing)
NEGATIVE: RFC 3376, IGMP Version 3, s6.6.1. p33 Timer
Updates
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 General Query Message to <DIface-0>
        containing:
        - IP Source Address field set to <LowerSrcAddress>
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Send an IGMPv3 Group-Specific Query Message to
        <DIface-0> containing:
        - IP Source Address field set to <LowerSrcAddress>
        - S Flag field set to 0
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
- ANVL: Wait for <AddressRecordDeleteTime> seconds for DUT
        to delete <MCAST_GRP_1> from its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       748   lo0    0    
128.224.166.0/23                vxTarget                      UC       1166  gei2   0    
vxTarget                        vxTarget                      UH       3773  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       118644lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x3A6C (14956)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xEAA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 General Query to <DIface-0> (30.1.1.5) containing:
- IP Source Address field set to <LowerSrcAddress> (30.1.1.1)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x0017 (23)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x24FA (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Successfully sent IGMPv3 General Query to <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5)
containing one IGMP Group Record containing:
- Record Type field set to 2 (IS_EX)
- Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
- No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x24E0 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x24DF (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)
Sending an IGMPv3 IGMPv3 Group Specific Query to <DIface-0> (30.1.1.5) containing:
- IP Source Address field set to <LowerSrcAddress> (30.1.1.1)
- S Flag field set to 0
- Group Address field set to <MCAST_GRP_1> (239.255.255.2)
- Number of Sources (N) field set to 0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x15F6 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Successfully sent IGMPv3 Group Specific Query to <DIface-0> (30.1.1.5)

Waiting for 3 seconds for DUT to delete group 239.255.255.2
from its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B00 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       756   lo0    0    
128.224.166.0/23                vxTarget                      UC       1174  gei2   0    
vxTarget                        vxTarget                      UH       3805  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       120748lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       5     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.12: Passed

>> IGMPV3-5.13
TEST_DESCRIPTION
When the S Flag is set to one, it does not, however,
suppress the querier election
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.5 p10 S Flag (Suppress
Router-Side Processing)
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 General Query Message to <DIface-0>
        containing:
        - IP Source Address field set to <LowerSrcAddress>
        - S Flag field set to 1
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Do not multicast an IGMPv3 General Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x91ED (37357)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x931F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 General Query to <DIface-0> (30.1.1.5) containing:
- IP Source Address field set to <LowerSrcAddress> (30.1.1.1)
- S Flag field set to 1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x24F4 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xE41E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 1 (Suppress Router-Side Processing)
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Waiting (up to 126.000 seconds) for no IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Correctly did not receive IGMPv3 General Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.13: Passed

>> IGMPV3-5.14
TEST_DESCRIPTION
The Querier's Query Interval Code field specifies the
[Query Interval] used by the querier.  The actual interval,
called the Querier's Query Interval (QQI), is represented
in units of seconds
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.7 p10 QQIC (Querier's
Query Interval Code)
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Note down the Querier Query Interval Code (QQIC) in the
        received IGMPv3 General Query Message
- ANVL: Listen (for upto <QQIC> seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xEFBF (61375)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x354D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x46B7 (18103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xDE55 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.14: Passed

>> IGMPV3-5.15
TEST_DESCRIPTION
The Number of Sources (N) field specifies how many source
addresses are present in the Query. This number is zero
in a General Query
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.8 p11 Number of Sources (N)
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - Number of Sources (N) field set to 0.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x4026 (16422)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4E6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

IGMP Number of Sources (N) of received IGMPv3 General Query
is correctly set to 0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.15: Passed

>> IGMPV3-5.16
TEST_DESCRIPTION
The Number of Sources (N) field specifies how many source
addresses are present in the Query. This number is zero in
a Group Specific Query
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.8 p11 Number of Sources (N)
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
        for <MCAST_GRP_1>
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xD748 (55112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x4DC4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2445 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2444 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x7D96 (32150)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x9875 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group Specific Query
is correctly set to 0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.16: Passed

>> IGMPV3-5.17
TEST_DESCRIPTION
The Number of Sources (N) field specifies how many source
addresses are present in the Query. This number is
non-zero in a Group-and-Source-Specific Query
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.8 p11 Number of Sources (N)
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Addresses <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0> containing:
        - one group record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message for <MCAST_GRP_1> and source <S2>
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 1
        - Source Address <S2>
        - No other Source Addresses
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x3369 (13161)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xF1A3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Addresses <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x243B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x243E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0x68B8 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 1
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x9D4A (40266)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x78BD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0x7D32 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 1
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group And Source Specific Query
is correctly set to 1

The first Source Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 64.64.64.2

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.17: Passed

>> IGMPV3-5.18
TEST_DESCRIPTION
The Source Address [i] fields are a vector of n IP
unicast addresses, where n is the value in the Number
of Sources (N) field
(Tests that IGMPv3 General Query Message conforms to
the above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.9 p11 Source Address [i]
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - Number of Sources (N) field set to 0
        - Source Address [i] field containing:
          - Zero (0) IP unicast address
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x9229 (37417)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x92E3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Number of Sources (N) of received IGMPv3 General Query
is correctly set to 0

Source Address [i] field of received IGMPv3 General Query
correctly does not contain any source address

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.18: Passed

>> IGMPV3-5.19
TEST_DESCRIPTION
The Source Address [i] fields are a vector of n IP
unicast addresses, where n is the value in the Number
of Sources (N) field
(Tests that IGMPv3 Group-Specific Query Message conforms
to the above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.9 p11 Source Address [i]
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
        for <MCAST_GRP_1>
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
        - Source Address [i] field containing:
          - Zero (0) IP unicast address
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xE11A (57626)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x43F2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2441 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2440 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x4B2B (19243)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xCAE0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group Specific Query
is correctly set to 0

Source Address [i] field of received IGMPv3 Group Specific Query
correctly does not contain any source address

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.19: Passed

>> IGMPV3-5.20
TEST_DESCRIPTION
The Source Address [i] fields are a vector of n IP
unicast addresses, where n is the value in the Number
of Sources (N) field
(Tests that IGMPv3 Group-and-Source-Specific Query
Message conforms to the above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.9 p11 Source Address [i]
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Addresses <S1>,<S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message for <MCAST_GRP_1> and source <S2>
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 1
        - Source Address [i] field containing:
          - 1 IP unicast address <S2>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x8132 (33074)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA3DA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Addresses <S1> (64.64.64.1),<S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2437 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x243A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0x68B8 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 1
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x2621 (9761)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xEFE6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0x7D32 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 1
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group And Source Specific Query
is correctly set to 1

Source Address [i] field of received IGMPv3 Group And Source Specific Query
correctly contains 64.64.64.2

The received IGMPv3 Group And Source Specific Query correctly contains only
1 source address

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.20: Passed

>> IGMPV3-5.21
TEST_DESCRIPTION
When sending a Query, an IGMPv3 implementation MUST NOT
include additional octets beyond the fields described here
(Tests that IGMPv3 General Query Message conforms to
the above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.10 p11 Additional Data
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - No additional octet beyond the Number of Sources
          (N) field
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x59D3 (22995)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xCB39 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

The received IGMPv3 General Query correctly does not contain any additional
octet beyond the Number of Sources (N) field

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.21: Passed

>> IGMPV3-5.22
TEST_DESCRIPTION
When sending a Query, an IGMPv3 implementation MUST NOT
include additional octets beyond the fields described here
(Tests that IGMPv3 Group-Specific Query Message conforms to
the above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.10 p11 Additional Data
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
        for <MCAST_GRP_1>
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
        - No additional octet beyond the Number of Sources
          (N) field
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x2760 (10080)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xFDAC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x243D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x243C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xF20D (61965)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23FE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group Specific Query
is correctly set to 0

The received IGMPv3 Group Specific Query correctly does not contain any additional
octet beyond the Number of Sources (N) field

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.22: Passed

>> IGMPV3-5.23
TEST_DESCRIPTION
When sending a Query, an IGMPv3 implementation MUST NOT
include additional octets beyond the fields described here
(Tests that IGMPv3 Group-and-Source-Specific Query Message
conforms to the above statement)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.10 p11 Additional Data
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Addresses <S1>,<S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message for <MCAST_GRP_1> and source <S2>
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 1
        - Source Address <S2>
        - No other Source Addresses
        - No additional octet beyond the Source
          Address <S2>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x836C (33644)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA1A0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Addresses <S1> (64.64.64.1),<S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2433 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2436 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0x68B8 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 1
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x497A (18810)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xCC8D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0x7D32 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 1
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group And Source Specific Query
is correctly set to 1

The first Source Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 64.64.64.2

The received IGMPv3 Group Specific Query correctly does not contain any additional
octet beyond the source address <64.64.64.2>

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.23: Passed

>> IGMPV3-5.26
TEST_DESCRIPTION
In a Group-Specific Query, the Group Address field contains
the multicast address of interest, and the Number of
Sources (N) field contains zero
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.10 p12 Query Variants
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
        for <MCAST_GRP_1>
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x0899 (2201)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1C74 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2439 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2438 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x11DA (4570)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x0432 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group Specific Query
is correctly set to 0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.26: Passed

>> IGMPV3-5.27
TEST_DESCRIPTION
In a Group-and-Source-Specific Query, Source Address [i]
fields contain the source address(es) of interest
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.10 p12 Query Variants
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Addresses <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message for <MCAST_GRP_1> and source <S2>
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 1
        - Source Address field containing:
          - Source Address <S2>
          - No other Source Addresses
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x9575 (38261)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x8F97 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Addresses <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x242F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2432 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0x68B8 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 1
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x2D7F (11647)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE888 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0x7D32 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 1
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group And Source Specific Query
is correctly set to 1

The first Source Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 64.64.64.2

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.27: Passed

>> IGMPV3-5.28
TEST_DESCRIPTION
In IGMPv3, General Queries are sent with an IP destination
address of 224.0.0.1, the all-systems multicast address
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.12 p12 IP Destination
Addresses for Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message contains:
        - IP destination address field set to 224.0.0.1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x1EEC (7916)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x0621 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

IP destination address field of received IGMPv3 General Query
is correctly set to 224.0.0.1

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.28: Passed

>> IGMPV3-5.29
TEST_DESCRIPTION
Group-Specific Queries are sent with an IP destination
address equal to the  multicast address of interest
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.12 p12 IP Destination
Addresses for Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
        for <MCAST_GRP_1>
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - IP destination address field set to <MCAST_GRP_1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x7BAC (31660)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA960 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2435 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2434 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x3584 (13700)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE087 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

IP destination address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.29: Passed

>> IGMPV3-5.30
TEST_DESCRIPTION
Group-and-Source Specific Queries are sent with an IP
destination address equal to the  multicast address of
interest
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.1.12 p12 IP Destination
Addresses for Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Addresses <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one group record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message for <MCAST_GRP_1> and source <S2>
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - IP destination address field set to <MCAST_GRP_1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x3DE3 (15843)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE729 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Addresses <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x242B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one group record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x242E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0x68B8 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 1
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0xBDB2 (48562)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x5855 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0x7D32 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 1
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

IP destination address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-5.30: Passed

>> IGMPV3-6.2
TEST_DESCRIPTION
In Version 3 Membership Report Message, the Reserved fields
are ignored on reception
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.1 p14 Reserved
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - First IGMP Reserved fields set to
          <InvalidResvField>
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
-  DUT: Ignore the Reserved fields of IGMPv3 Report Message
        and accept the packet
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1156  lo0    0    
128.224.166.0/23                vxTarget                      UC       1300  gei2   0    
vxTarget                        vxTarget                      UH       4335  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       127802lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xA18B (41355)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x8381 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- First IGMP Reserved field set to <InvalidResvField> (255)
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2431 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 255
IGMPv3: Checksum                    = 0xEBFC (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE8 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE7 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x3400 (13312)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x081B (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1164  lo0    0    
128.224.166.0/23                vxTarget                      UC       1307  gei2   0    
vxTarget                        vxTarget                      UH       4367  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       130020lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.2: Passed

>> IGMPV3-6.4
TEST_DESCRIPTION
When receiving Version 3 Membership Report packets, the
checksum MUST be verified before processing a message
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.2 p14 Checksum
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - Checksum fields set to
          <InvalidChecksumFieldValue>
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
-  DUT: Discard the malformed IGMPv3 Report Message
- ANVL: Wait for <ProcessTime> seconds
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1180  lo0    0    
128.224.166.0/23                vxTarget                      UC       1309  gei2   0    
vxTarget                        vxTarget                      UH       4402  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       132088lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x824A (33354)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA2C2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- Checksum fields set to <InvalidChecksumFieldValue> (65535)
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x242E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFFFF *Should be 0xECFB*
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE5 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE4 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1188  lo0    0    
128.224.166.0/23                vxTarget                      UC       1316  gei2   0    
vxTarget                        vxTarget                      UH       4434  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       134236lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.4: Passed

>> IGMPV3-6.12
TEST_DESCRIPTION
If the Packet Length field in the IP header of a received
Report indicates that there are additional octets of data
present, beyond the last Group Record, IGMPv3
implementations MUST include those octets in the computation
to verify the received IGMP Checksum
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.11 p15 Additional
Data
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
        - Additional Data of length <AdditionalDataLen>
          added after the IGMP Group Record
        - Checksum field set to the value of checksum
          computed over the IP payload minus the
          Additional Data added after the IGMP Group Record
-  DUT: Detect the incorrect IGMP checksum and discard the
        packet
- ANVL: Wait for <ProcessTime> seconds
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1204  lo0    0    
128.224.166.0/23                vxTarget                      UC       1319  gei2   0    
vxTarget                        vxTarget                      UH       4469  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       136186lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xA206 (41478)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x8306 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address
- Additional Data of length <AdditionalDataLen> (8 bytes)
  added after the IGMP Group Record
- Checksum field set to the value of checksum
  computed over the IP payload minus the
  Additional Data added after the IGMP Group Record

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2423 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB *Should be 0xA0DC*
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
IGMPv3: ---- Additional Data [8 bytes]  ----
49 47 4D 50 56 33 5F 54                           IGMPV3_T
IGMPv3: ---- Additional Data End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE2 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE1 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1212  lo0    0    
128.224.166.0/23                vxTarget                      UC       1326  gei2   0    
vxTarget                        vxTarget                      UH       4501  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       138358lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.12: Passed

>> IGMPV3-6.13
TEST_DESCRIPTION
If the Packet Length field in the IP header ... additional
octets of data present, beyond the last Group Record, ...
the received IGMP Checksum but MUST otherwise ignore those
additional octets
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.11 p15 Additional
Data
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
        - Additional Data of length <AdditionalDataLen>
          added after the IGMP Group Record
        - Checksum field set to the value of checksum
          computed over the entire IP payload including the
          Additional Data added after the IGMP Group Record
-  DUT: Ignore the Additional Data in the IGMPv3 Report
        Message and accept the packet
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1228  lo0    0    
128.224.166.0/23                vxTarget                      UC       1327  gei2   0    
vxTarget                        vxTarget                      UH       4537  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       140472lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x7B60 (31584)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA9AC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address
- Additional Data of length <AdditionalDataLen> (8 bytes)
  added after the IGMP Group Record
- Checksum field set to the value of checksum
  computed over the entire IP payload including the
  Additional Data added after the IGMP Group Record

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2420 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xA0DC (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
IGMPv3: ---- Additional Data [8 bytes]  ----
49 47 4D 50 56 33 5F 54                           IGMPV3_T
IGMPv3: ---- Additional Data End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADF (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADE (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x3D00 (15616)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xFF1A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1236  lo0    0    
128.224.166.0/23                vxTarget                      UC       1334  gei2   0    
vxTarget                        vxTarget                      UH       4569  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       142538lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.13: Passed

>> IGMPV3-6.24
TEST_DESCRIPTION
Routers MUST accept a report with a source address of
0.0.0.0
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.13 p17 IP Source
Addresses for Reports
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - IP Source Address field set to 0.0.0.0
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1252  lo0    0    
128.224.166.0/23                vxTarget                      UC       1337  gei2   0    
vxTarget                        vxTarget                      UH       4605  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       144614lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x98FA (39162)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x8C12 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Source Address field set to 0.0.0.0
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x43BC (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADC (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADB (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x4000 (16384)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xFC1A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1260  lo0    0    
128.224.166.0/23                vxTarget                      UC       1348  gei2   0    
vxTarget                        vxTarget                      UH       4637  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       146816lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.24: Passed

>> IGMPV3-6.26
TEST_DESCRIPTION
Version 3 Reports are sent with an IP destination address of
224.0.0.22, to which all IGMPv3-capable multicast routers
listen
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.2.14 p18 IP
Destination Addresses for Reports
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to 224.0.0.22
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1276  lo0    0    
128.224.166.0/23                vxTarget                      UC       1349  gei2   0    
vxTarget                        vxTarget                      UH       4671  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       148802lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x27A9 (10153)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xFD63 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to (224.0.0.22)
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2422 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD9 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD8 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x4300 (17152)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF91A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1284  lo0    0    
128.224.166.0/23                vxTarget                      UC       1359  gei2   0    
vxTarget                        vxTarget                      UH       4703  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       151064lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.26: Passed

>> IGMPV3-6.29
TEST_DESCRIPTION
In addition, a system MUST accept and process any version 1
or version 2 Report whose IP Destination Address field
contains *any* of the addresses (unicast or multicast)
assigned to the interface on which the Report arrives
(Tests for IGMPv1 compatibility mode and multicast address)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.14 p18 IP
Destination Addresses for Reports
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv1 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to <MCAST_GRP_1>
        - IGMPv1 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1300  lo0    0    
128.224.166.0/23                vxTarget                      UC       1361  gei2   0    
vxTarget                        vxTarget                      UH       4738  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       153172lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x2EE2 (12002)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xF62A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv1 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to <MCAST_GRP_1> (239.255.255.2)
- IGMPv1 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x153B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = IGMPv1 Membership Report (0x12)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFEFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv1 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD6 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD5 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x4600 (17920)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF61A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1308  lo0    0    
128.224.166.0/23                vxTarget                      UC       1368  gei2   0    
vxTarget                        vxTarget                      UH       4770  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       155300lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.29: Passed

>> IGMPV3-6.30
TEST_DESCRIPTION
In addition, a system MUST accept and process any version 1
or version 2 Report whose IP Destination Address field
contains *any* of the addresses (unicast or multicast)
assigned to the interface on which the Report arrives
(Tests for IGMPv1 compatibility mode and unicast address)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.14 p18 IP
Destination Addresses for Reports
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv1 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to the unicast
          address of <DIface-0>
        - IGMPv1 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       0     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1324  lo0    0    
128.224.166.0/23                vxTarget                      UC       1370  gei2   0    
vxTarget                        vxTarget                      UH       4806  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       157412lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x8228 (33320)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA2E4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv1 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to the unicast
  address of <DIface-0> (30.1.1.5)
- IGMPv1 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

Sending IGMPv1 Report message with IP destination
address field set to 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE534 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = IGMPv1 Membership Report (0x12)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFEFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv1 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD3 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD2 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x4900 (18688)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF31A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       1     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1332  lo0    0    
128.224.166.0/23                vxTarget                      UC       1377  gei2   0    
vxTarget                        vxTarget                      UH       4838  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       159516lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.30: Passed

>> IGMPV3-6.31
TEST_DESCRIPTION
In addition, a system MUST accept and process any version 1
or version 2 Report whose IP Destination Address field
contains *any* of the addresses (unicast or multicast)
assigned to the interface on which the Report arrives
(Tests for IGMPv2 compatibility mode and multicast address)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.14 p18 IP
Destination Addresses for Reports
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv2 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to <MCAST_GRP_1>
        - IGMPv2 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       1     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1348  lo0    0    
128.224.166.0/23                vxTarget                      UC       1379  gei2   0    
vxTarget                        vxTarget                      UH       4871  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       161612lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xC52B (50475)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x5FE1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv2 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to <MCAST_GRP_1> (239.255.255.2)
- IGMPv2 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1535 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = IGMPv2 Membership Report (0x16)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFAFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv2 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD0 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACF (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x4C00 (19456)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF01A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       1     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1356  lo0    0    
128.224.166.0/23                vxTarget                      UC       1386  gei2   0    
vxTarget                        vxTarget                      UH       4903  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       163750lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.31: Passed

>> IGMPV3-6.32
TEST_DESCRIPTION
In addition, a system MUST accept and process any version 1
or version 2 Report whose IP Destination Address field
contains *any* of the addresses (unicast or multicast)
assigned to the interface on which the Report arrives
(Tests for IGMPv2 compatibility mode and unicast address)
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s4.2.14 p18 IP
Destination Addresses for Reports
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv2 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to the unicast
          address of <DIface-0>
        - IGMPv1 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       1     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1372  lo0    0    
128.224.166.0/23                vxTarget                      UC       1388  gei2   0    
vxTarget                        vxTarget                      UH       4937  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       165844lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x0582 (1410)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1F8B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv2 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to the unicast
  address of <DIface-0> (30.1.1.5)
- IGMPv1 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE52E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = IGMPv2 Membership Report (0x16)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFAFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv2 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACD (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACC (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x4F00 (20224)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xED1A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1380  lo0    0    
128.224.166.0/23                vxTarget                      UC       1396  gei2   0    
vxTarget                        vxTarget                      UH       4969  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       167936lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-6.32: Passed

>> IGMPV3-7.1
TEST_DESCRIPTION
IS_IN ( x )  -  Type MODE_IS_INCLUDE, source addresses x.
It is sent by a system in response to a Query. It indicates
that the interface has a filter mode of INCLUDE for the
specified multicast addresses
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.2.15 p18 Notation for Group Records
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1396  lo0    0    
128.224.166.0/23                vxTarget                      UC       1397  gei2   0    
vxTarget                        vxTarget                      UH       5002  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       169906lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xF6D7 (63191)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2E35 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x240B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B2D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B2C (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x5200 (20992)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xEA7D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B29 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B28 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1404  lo0    0    
128.224.166.0/23                vxTarget                      UC       1407  gei2   0    
vxTarget                        vxTarget                      UH       5034  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       172180lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-7.1: Passed

>> IGMPV3-7.2
TEST_DESCRIPTION
IS_EX ( x )  -  Type MODE_IS_EXCLUDE, source addresses x
It is sent by a system in response to a Query. It indicates
that the interface has a filter mode of EXCLUDE for the
specified multicast addresses
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.2.15 p18 Notation for Group Records
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1420  lo0    0    
128.224.166.0/23                vxTarget                      UC       1408  gei2   0    
vxTarget                        vxTarget                      UH       5069  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       174300lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x3B73 (15219)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE999 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2406 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEC75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B26 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B25 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x5700 (22272)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xE57B (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B26 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B25 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1428  lo0    0    
128.224.166.0/23                vxTarget                      UC       1424  gei2   0    
vxTarget                        vxTarget                      UH       5101  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       176426lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-7.2: Passed

>> IGMPV3-7.3
TEST_DESCRIPTION
TO_IN ( x )  -  Type CHANGE_TO_INCLUDE_MODE, source addresses x
It is sent by a system whenever a local invocation of
IPMulticastListen causes a change of filter mode. It indicates
that the interface has changed to INCLUDE filter mode for the
specified multicast address
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.2.15 p18 Notation for Group Records
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        sources <S1> and <S2> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1444  lo0    0    
128.224.166.0/23                vxTarget                      UC       1426  gei2   0    
vxTarget                        vxTarget                      UH       5136  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       178472lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x5FD8 (24536)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xC534 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x2401 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEC75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B23 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B22 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23FE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEB75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add sources 64.64.64.1
and 64.64.64.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B20 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1F (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x5F00 (24320)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDD7D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1452  lo0    0    
128.224.166.0/23                vxTarget                      UC       1437  gei2   0    
vxTarget                        vxTarget                      UH       5168  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       180504lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-7.3: Passed

>> IGMPV3-7.4
TEST_DESCRIPTION
TO_EX ( x )  -  Type CHANGE_TO_EXCLUDE_MODE, source addresses x
It is sent by a system whenever a local invocation of
IPMulticastListen causes a change of filter mode. It indicates
that the interface has changed to EXCLUDE filter mode for the
specified multicast address
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.2.15 p18 Notation for Group Records
TEST_METHOD
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_EXCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1468  lo0    0    
128.224.166.0/23                vxTarget                      UC       1438  gei2   0    
vxTarget                        vxTarget                      UH       5202  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       182468lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 4 (TO_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23FB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEA75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 4 (TO_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1B (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1A (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x6200 (25088)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDA7B (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1B (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1A (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1476  lo0    0    
128.224.166.0/23                vxTarget                      UC       1446  gei2   0    
vxTarget                        vxTarget                      UH       5234  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       184508lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-7.4: Passed

>> IGMPV3-7.5
TEST_DESCRIPTION
ALLOW ( x )  -  Type ALLOW_NEW_SOURCES, source addresses x
It is sent by a system whenever a local invocation of
IPMulticastListen causes a change of source list. It indicates
that the Source Address [i] fields in this Group Record contain
a list of the additional sources that the system wishes to
hear from
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.2.15 p18 Notation for Group Records
TEST_METHOD
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to ALLOW_NEW_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1492  lo0    0    
128.224.166.0/23                vxTarget                      UC       1447  gei2   0    
vxTarget                        vxTarget                      UH       5269  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       186520lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 5 (ALLOW)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23F6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xE975 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 5 (ALLOW)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B18 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B17 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x6700 (26368)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD57D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B14 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B13 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1500  lo0    0    
128.224.166.0/23                vxTarget                      UC       1454  gei2   0    
vxTarget                        vxTarget                      UH       5301  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       188514lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-7.5: Passed

>> IGMPV3-7.6
TEST_DESCRIPTION
BLOCK ( x )  -  Type BLOCK_OLD_SOURCES, source addresses x
It is sent by a system whenever a local invocation of
IPMulticastListen causes a change of source list. It indicates
that the Source Address [i] fields in this Group Record contain
a list of the sources the system no longer wishes to hear from
TEST_REFERENCE
RFC 3376, IGMP Version 3, s4.2.15 p18 Notation for Group Records
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S3>, <S4>
- ANVL: Wait for <AddressRecordDeleteTime> seconds for DUT
        to delete sources <S3> and <S4> from its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1516  lo0    0    
128.224.166.0/23                vxTarget                      UC       1456  gei2   0    
vxTarget                        vxTarget                      UH       5336  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       190548lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xCF35 (53045)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x55D7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23F1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEC75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B11 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B10 (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x6C00 (27648)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD07B (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23EE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xE871 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.3
IGMPv3: Source Address [2]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for 3 seconds for DUT to add sources 64.64.64.3
and 64.64.64.4 from its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0E (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0D (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1524  lo0    0    
128.224.166.0/23                vxTarget                      UC       1465  gei2   0    
vxTarget                        vxTarget                      UH       5368  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       192562lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-7.6: Passed

>> IGMPV3-9.1
TEST_DESCRIPTION
On each interface over which this protocol is being run,
the router MUST enable reception of multicast address
224.0.0.22, from all sources
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6 p25 Description of the
Protocol for Multicast Routers
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to 224.0.0.22
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1540  lo0    0    
128.224.166.0/23                vxTarget                      UC       1467  gei2   0    
vxTarget                        vxTarget                      UH       5403  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       194618lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xE262 (57954)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x42AA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to (224.0.0.22)
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23F3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AAA (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA9 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x7200 (29184)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xCA1A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1548  lo0    0    
128.224.166.0/23                vxTarget                      UC       1476  gei2   0    
vxTarget                        vxTarget                      UH       5435  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       196644lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       7     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.1: Passed

>> IGMPV3-9.2
TEST_DESCRIPTION
Multicast routers send General Queries periodically to
request group membership information from an attached
network
The Query Interval is the interval between General Queries
sent by the Querier
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.1 p25 Conditions for IGMP
Queries
RFC 3376, IGMP Version 3, s8.2 p40 Query Interval
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Note down the Querier Query Interval Code (QQIC) in the
        received IGMPv3 General Query Message
- ANVL: Listen (for upto <2 * GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast two IGMPv3 General Query Message
- ANVL: Verify that the second IGMPv3 General Query Message
        was received just at QUERY_INTERVAL time after
        receiving the first IGMPv3 General Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x4EAE (20142)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xD65E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Waiting (up to 251.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x07F9 (2041)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1D14 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x22D2 (8914)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x023B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected 2 IGMPv3 General Query from <DIface-0> (30.1.1.5)

Correctly the second IGMPv3 General Query was received at 125 sec interval
after receiving the first IGMPv3 General Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.2: Passed

>> IGMPV3-9.3
TEST_DESCRIPTION
When a group membership is terminated at a system or traffic
from a particular source is no longer desired, a multicast
router must query for other members ... before deleting the
group (or source) and pruning its traffic
(Tests for group deletion by IGMPv3 router)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.1 p25 Conditions for IGMP
Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
- ANVL: Wait for <AddressRecordDeleteTime> seconds for DUT
        to delete <MCAST_GRP_1> from its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1588  lo0    0    
128.224.166.0/23                vxTarget                      UC       1505  gei2   0    
vxTarget                        vxTarget                      UH       5498  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       199000lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x5AAC (23212)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xCA60 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23F0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA7 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA6 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x7500 (29952)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xC71A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23ED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x6ECE (28366)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA73D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group Specific Query
is correctly set to 0

Waiting for 3 seconds for DUT to delete group 239.255.255.2
from its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA4 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA3 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1596  lo0    0    
128.224.166.0/23                vxTarget                      UC       1514  gei2   0    
vxTarget                        vxTarget                      UH       5530  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       201160lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.3: Passed

>> IGMPV3-9.4
TEST_DESCRIPTION
When a group membership is terminated at a system or traffic
from a particular source is no longer desired, a multicast
router must query for other members ... before deleting the
group (or source) and pruning its traffic
(Tests for source deletion by IGMPv3 router)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.1 p25 Conditions for IGMP
Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>, <S3>, <S4>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 2
        - Source Address <S1>, <S2>
        - No other Source Addresses
- ANVL: Wait for <AddressRecordDeleteTime> seconds for DUT
        to delete sources <S1>, <S2> from the source list
        for <MCAST_GRP_1>
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1612  lo0    0    
128.224.166.0/23                vxTarget                      UC       1517  gei2   0    
vxTarget                        vxTarget                      UH       5564  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       203404lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x2ACD (10957)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xFA3F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2),
    <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23DA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECEB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 4
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3: Source Address [3]          = 64.64.64.3
IGMPv3: Source Address [4]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B04 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B03 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x7B00 (31488)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xC17D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23DF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xE875 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x9843 (38979)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x7DC0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFCEF (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 2
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.1
IGMPv3: Source Address [2]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group And Source Specific Query
is correctly set to 2

All of the Source Addresses are present in
the received IGMPv3 Group And Source Specific Query

Correctly no other Source Addresses are present in
the received IGMPv3 Group And Source Specific Query

Waiting for 3 seconds for DUT to delete sources 64.64.64.1
and 64.64.64.2 from its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B01 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B00 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFD (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0080 (128)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFC (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x8000 (32768)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xBC7B (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1620  lo0    0    
128.224.166.0/23                vxTarget                      UC       1533  gei2   0    
vxTarget                        vxTarget                      UH       5596  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       205496lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.4: Passed

>> IGMPV3-9.5
TEST_DESCRIPTION
Group-Specific Queries are sent when a router receives a
State-Change record indicating a system is leaving a group
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.1 p25 Conditions for IGMP
Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to CHANGE_TO_INCLUDE_MODE
          - Multicast Address field set to <MCAST_GRP_1>
          - No Source Address
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-Specific Query Message
- ANVL: Verify that the received IGMPv3 Group-Specific
        Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1636  lo0    0    
128.224.166.0/23                vxTarget                      UC       1535  gei2   0    
vxTarget                        vxTarget                      UH       5630  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       207584lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x8B0B (35595)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x9A01 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0081 (129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23E2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A99 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0083 (131)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A98 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x8300 (33536)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB91A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 3 (TO_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - No Source Address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0084 (132)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23DF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEBFB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 3 (TO_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xBBD7 (48087)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x5A34 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group Specific Query
is correctly set to 0

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1644  lo0    0    
128.224.166.0/23                vxTarget                      UC       1543  gei2   0    
vxTarget                        vxTarget                      UH       5662  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       209882lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.5: Passed

>> IGMPV3-9.6
TEST_DESCRIPTION
Group-and-Source Specific Queries list sources for a
particular group which have been requested to no longer
be forwarded ...  Group-and-Source Specific Queries are
only sent in response to State-Change Records
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.1 p26 Conditions for IGMP
Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>, <S3>, <S4>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 Group-and-Source-Specific Query
        Message
- ANVL: Verify that the received IGMPv3 Group-and-Source-
        Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 2
        - Source Address <S1>, <S2>
        - No other Source Addresses
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1660  lo0    0    
128.224.166.0/23                vxTarget                      UC       1544  gei2   0    
vxTarget                        vxTarget                      UH       5696  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       212140lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x7168 (29032)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xB3A4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2),
    <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0085 (133)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23CE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECEB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 4
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3: Source Address [3]          = 64.64.64.3
IGMPv3: Source Address [4]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0086 (134)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF8 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0087 (135)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF7 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x8700 (34560)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB57D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0088 (136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23D3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xE875 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Waiting (up to 2.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x8218 (33304)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x93EB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFCEF (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 2
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.1
IGMPv3: Source Address [2]    = 64.64.64.2
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Received expected IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received IGMPv3 Group And Source Specific Query
is correctly set to 2

All of the Source Addresses are present in
the received IGMPv3 Group And Source Specific Query

Correctly no other Source Addresses are present in
the received IGMPv3 Group And Source Specific Query

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1668  lo0    0    
128.224.166.0/23                vxTarget                      UC       1551  gei2   0    
vxTarget                        vxTarget                      UH       5728  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       214442lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.6: Passed

>> IGMPV3-9.7
TEST_DESCRIPTION
Group-and-Source Specific Queries list sources for a
particular group which have been requested to no longer
be forwarded ...  Group-and-Source Specific Queries are
never sent in response to Current-State Records
TEST_REFERENCE
NEGATIVE: RFC 3376, IGMP Version 3, s6.1 p26 Conditions
for IGMP Queries
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>, <S3>, <S4>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not multicast any IGMPv3 Group-and-Source-
        Specific Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1684  lo0    0    
128.224.166.0/23                vxTarget                      UC       1554  gei2   0    
vxTarget                        vxTarget                      UH       5764  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       216696lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x95A2 (38306)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x8F6A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2),
    <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0089 (137)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23CA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECEB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 4
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3: Source Address [3]          = 64.64.64.3
IGMPv3: Source Address [4]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008A (138)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF4 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008B (139)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF3 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x8B00 (35584)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB17D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x008C (140)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23CF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Waiting (up to 2.000 seconds) for no IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

Correctly did not receive IGMPv3 Group And Source Specific Query
for group 239.255.255.2 from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1692  lo0    0    
128.224.166.0/23                vxTarget                      UC       1561  gei2   0    
vxTarget                        vxTarget                      UH       5796  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       218792lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.7: Passed

>> IGMPV3-9.8
TEST_DESCRIPTION
As a rule, once a group record with a filter-mode of
EXCLUDE is received, the router filter-mode for that
group will be EXCLUDE
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.2.1 p27 Definition of Router
Filter-Mode
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>, <S3>, <S4>
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S5>, <S6>, <S7>, <S8>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> and the corresponding sources to
        its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S11>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S9>, <S10>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> and the corresponding sources to
        its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S11>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1708  lo0    0    
128.224.166.0/23                vxTarget                      UC       1563  gei2   0    
vxTarget                        vxTarget                      UH       5830  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       220832lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xFEED (65261)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x261F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2),
    <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x008D (141)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23C6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECEB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 4
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3: Source Address [3]          = 64.64.64.3
IGMPv3: Source Address [4]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x9803 (38915)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x8D09 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S5> (64.64.64.5), <S6> (64.64.64.6),
    <S7> (64.64.64.7), <S8> (64.64.64.8)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x008E (142)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23C5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECDB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 4
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.5
IGMPv3: Source Address [2]          = 64.64.64.6
IGMPv3: Source Address [3]          = 64.64.64.7
IGMPv3: Source Address [4]          = 64.64.64.8
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.11 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008F (143)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE5 (Correct)
IP: Source Address         = 64.64.64.11
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.11

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0090 (144)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE4 (Correct)
IP: Source Address         = 64.64.64.11
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x2D84 (11652)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xF788 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S9> (64.64.64.9), <S10> (64.64.64.10)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0091 (145)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23CA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEC65 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.9
IGMPv3: Source Address [2]          = 64.64.64.10
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.11 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0092 (146)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE2 (Correct)
IP: Source Address         = 64.64.64.11
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.11

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0093 (147)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE1 (Correct)
IP: Source Address         = 64.64.64.11
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x9300 (37632)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA973 (Correct)
IP: Source Address         = 64.64.64.11
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1716  lo0    0    
128.224.166.0/23                vxTarget                      UC       1604  gei2   0    
vxTarget                        vxTarget                      UH       5862  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       222894lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.8: Passed

>> IGMPV3-9.9
TEST_DESCRIPTION
When a router in state INCLUDE (A), receiving Current-State
Records IS_IN (B), it updates the Router State to INCLUDE
(A+B) and source timer (B)=GMI.
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.4.1 p30 Reception of
Current-State Records
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> and the corresponding sources to
        its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S2>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: Wait for <GMI> seconds for DUT
        to delete sources <S1>, <S2> from the source list
        for <MCAST_GRP_1>
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S2>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>, <S3>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> and the corresponding sources to
        its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S2>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1732  lo0    0    
128.224.166.0/23                vxTarget                      UC       1605  gei2   0    
vxTarget                        vxTarget                      UH       5897  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       224960lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xA660 (42592)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x7EAC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0094 (148)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23C7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.2 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0095 (149)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE8 (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0096 (150)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE7 (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x9600 (38400)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA67C (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Waiting for 261 seconds for DUT to delete sources 64.64.64.1
and 64.64.64.2 from its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.2 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0097 (151)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE6 (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0098 (152)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE5 (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xC2A9 (49833)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x6263 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2), <S3> (64.64.64.3)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0099 (153)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23C2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED73 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3: Source Address [2]          = 64.64.64.3
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.2 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009A (154)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE3 (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009B (155)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE2 (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x9B00 (39680)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA17C (Correct)
IP: Source Address         = 64.64.64.2
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1740  lo0    0    
128.224.166.0/23                vxTarget                      UC       1657  gei2   0    
vxTarget                        vxTarget                      UH       5929  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       227120lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.9: Passed

>> IGMPV3-9.10
TEST_DESCRIPTION
When a router in state INCLUDE (A), receiving Current-State
Records IS_EX (B), it updates the Router State to EXCLUDE
(A*B,B-A) and source timer (B-A)=0, Delete (A-B).
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.4.1 p30 Reception of
Current-State Records
Filter-Mode
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_EXCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S2>, <S3>
- ANVL: Wait for <ProcessTime> seconds for DUT to process
        new record
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S1>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Source Address field set to <S3>
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       1756  lo0    0    
128.224.166.0/23                vxTarget                      UC       1660  gei2   0    
vxTarget                        vxTarget                      UH       5964  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       229078lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xE49D (58525)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x406F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x009C (156)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23BF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xED75 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xEA83 (60035)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x3A89 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 2 (IS_EX)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S2> (64.64.64.2), <S3> (64.64.64.3)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x009D (157)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23BE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xEC73 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.2
IGMPv3: Source Address [2]          = 64.64.64.3
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to process the new record
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009E (158)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE0 (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009F (159)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADF (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x9F00 (40704)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9D7D (Correct)
IP: Source Address         = 64.64.64.1
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A0 (160)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADC (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.3

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A1 (161)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADB (Correct)
IP: Source Address         = 64.64.64.3
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 TRUE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       1764  lo0    0    
128.224.166.0/23                vxTarget                      UC       1684  gei2   0    
vxTarget                        vxTarget                      UH       5998  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       231412lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       8     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.10: Passed

>> IGMPV3-9.11
TEST_DESCRIPTION
When a router in state INCLUDE (A), receiving BLOCK (B),
it updates the Router State to  INCLUDE (A) and sends
Q(G,A*B) [Last Member Query Count] times, in order to
maintain protocol robustness
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.4.2 p31 Reception of Filter-
Mode-Change and Source-List-Change Records
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>, <S3>, <S4>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S3>, <S4>
- ANVL: Listen (for upto <[Last Member Query Count] *
        GrpSrcSpecQueryRecvWaitTime> seconds) on <DIface-0>
-  DUT: Multicast [Last Member Query Count] IGMPv3
        Group-and-Source-Specific Query Message
- ANVL: Verify that all of the received IGMPv3 Group-
        and-Source-Specific Query Message contains:
        - Group Address field set to <MCAST_GRP_1>
        - Number of Sources (N) field set to 2
        - Source Addresses <S3>, <S4>
        - No other Source Addresses
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xEC88 (60552)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x3884 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2),
    <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x00A2 (162)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23B1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECEB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 4
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3: Source Address [3]          = 64.64.64.3
IGMPv3: Source Address [4]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x00A3 (163)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23B8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xE871 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.3
IGMPv3: Source Address [2]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Waiting (up to 3.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0BAA (2986)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x0A5A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFCEB (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 2
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.4
IGMPv3: Source Address [2]    = 64.64.64.3
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0BAC (2988)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x0A58 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xF4EB (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 1 (Suppress Router-Side Processing)
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 2
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.4
IGMPv3: Source Address [2]    = 64.64.64.3
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Received expected 2 IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Group Address field of received 1st IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received 1st IGMPv3 Group And Source Specific Query
is correctly set to 2

Correctly the source address 64.64.64.3 is present
in the received 1st IGMPv3 Group And Source Specific Query

Correctly the source address 64.64.64.4 is present
in the received 1st IGMPv3 Group And Source Specific Query

Correctly no other Source Addresses are present in
the received 1st IGMPv3 Group And Source Specific Query

Group Address field of received 2nd IGMPv3 Group And Source Specific Query
is correctly set to 239.255.255.2

Number of sources (N) field of received 2nd IGMPv3 Group And Source Specific Query
is correctly set to 2

Correctly the source address 64.64.64.3 is present
in the received 2nd IGMPv3 Group And Source Specific Query

Correctly the source address 64.64.64.4 is present
in the received 2nd IGMPv3 Group And Source Specific Query

Correctly no other Source Addresses are present in
the received 2nd IGMPv3 Group And Source Specific Query

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.11: Passed

>> IGMPV3-9.12
TEST_DESCRIPTION
When a router in state INCLUDE (A), receiving BLOCK (B),
it updates the Router State to  INCLUDE (A) and sends
Q(G,A*B) at [Last Member Query Intrval] interval,
in order to maintain protocol robustness
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.4.2 p31 Reception of Filter-
Mode-Change and Source-List-Change Records
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to MODE_IS_INCLUDE
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S1>, <S2>, <S3>, <S4>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv3 Report Message to <DIface-0>
        containing:
        - one IGMP Group Record containing:
          - Record Type field set to BLOCK_OLD_SOURCES
          - Multicast Address field set to <MCAST_GRP_1>
          - Source Address <S3>, <S4>
- ANVL: Listen (for upto <[Last Member Query Count] *
        GrpSrcSpecQueryRecvWaitTime> seconds) on <DIface-0>
-  DUT: Multicast [Last Member Query Count] IGMPv3
        Group-and-Source-Specific Query Message
- ANVL: Verify that the second IGMPv3 Group-and-Source-
        Specific Query Message was received just at
        [Last Member Query Intrval] time after receiving
        the first IGMPv3 Group-and-Source- Specific
        Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xA4DB (42203)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x8031 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 1 (IS_IN)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S1> (64.64.64.1), <S2> (64.64.64.2),
    <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x00A4 (164)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23AF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xECEB (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 1 (IS_IN)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 4
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.1
IGMPv3: Source Address [2]          = 64.64.64.2
IGMPv3: Source Address [3]          = 64.64.64.3
IGMPv3: Source Address [4]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Successfully sent IGMPv3 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv3 Membership Report to <DIface-0> (30.1.1.5) containing:
- one IGMP Group Record containing:
  - Record Type field set to 6 (BLOCK)
  - Multicast Address field set to <MCAST_GRP_1> (239.255.255.2)
  - Source Address <S3> (64.64.64.3), <S4> (64.64.64.4)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x00A5 (165)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23B6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xE871 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 6 (BLOCK)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 2
IGMPv3: Multicast Address           = 239.255.255.2
IGMPv3:
IGMPv3: Source Address [1]          = 64.64.64.3
IGMPv3: Source Address [2]          = 64.64.64.4
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Waiting (up to 3.000 seconds) for IGMPv3 Group And Source Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x035F (863)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x12A5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFCEB (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 2
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.4
IGMPv3: Source Address [2]    = 64.64.64.3
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0361 (865)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x12A3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xF4EB (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 1 (Suppress Router-Side Processing)
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 2
IGMPv3:
IGMPv3: Source Address [1]    = 64.64.64.4
IGMPv3: Source Address [2]    = 64.64.64.3
IGMPv3:
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Received expected 2 IGMPv3 Group And Source Specific Query for group 239.255.255.2 from
<DIface-0> (30.1.1.5)

Correctly the second IGMPv3 Group And Source Specific Query was received at 1 sec interval
after receiving the first IGMPv3 Group And Source Specific Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.12: Passed

>> IGMPV3-9.13
TEST_DESCRIPTION
When a router receives a query with a lower IP address,
it sets the Other-Querier-Present timer to Other Querier
Present Interval and ceases to send queries on the network
if it was the previously elected querier
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.6.2 p34 Querier Election
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 General Query Message to <DIface-0>
        containing:
        - IP Source Address field set to <LowerSrcAddress>
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Do not multicast an IGMPv3 General Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x6F76 (28534)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xB596 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 General Query to <DIface-0> (30.1.1.5) containing:
- IP Source Address field set to <LowerSrcAddress> (30.1.1.1)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x00A6 (166)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x246B (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Waiting (up to 126.000 seconds) for no IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


Correctly did not receive IGMPv3 General Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.13: Passed

>> IGMPV3-9.14
TEST_DESCRIPTION
When a router receives a query with a lower IP address ...
After its Other-Querier Present timer expires, it should
begin sending General Queries
TEST_REFERENCE
RFC 3376, IGMP Version 3, s6.6.2 p34 Querier Election
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv3 General Query Message to <DIface-0>
        containing:
        - IP Source Address field set to <LowerSrcAddress>
- ANVL: Listen (for upto <OtherQuerierPresentTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x32EA (13034)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xF222 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv3 General Query to <DIface-0> (30.1.1.5) containing:
- IP Source Address field set to <LowerSrcAddress> (30.1.1.1)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x00A7 (167)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x246A (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Waiting (up to 256.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv3 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:16
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE4F7 (Correct)
IP: Source Address         = 30.1.1.1
IP: Destination Address    = 224.0.0.22
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version                     = 3
IGMPv3: Type                        = IGMPv3 Membership Report (0x22)
IGMPv3: Reserved                    = 0
IGMPv3: Checksum                    = 0xFB02 (Correct)
IGMPv3: Reserved                    = 0
IGMPv3: Number of Group Records (M) = 1
IGMPv3:
IGMPv3: ---- Group Record [1]  ----
IGMPv3: Record Type                 = 2 (IS_EX)
IGMPv3: Aux Data Len                = 0
IGMPv3: Number of Sources (N)       = 0
IGMPv3: Multicast Address           = 224.0.0.251
IGMPv3:
IGMPv3: ---- Auxiliary Data [0 bytes]  ----
IGMPv3:
IGMPv3: ---- Group Record [1] End ----
IGMPv3:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x2ADF (10975)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xFA2D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-9.14: Passed

>> IGMPV3-10.1
TEST_DESCRIPTION
The IGMP version of a Membership Query message is
determined as follows:
IGMPv1 Query: length = 8 octets AND Max Resp Code
field is zero
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.1 p35 Query Version
Distinctions
TEST_METHOD
 SETUP: Configure DUT in IGMP Version 1 mode
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv1 General Query Message
- ANVL: Verify that the received IGMPv1 General Query
        Message is of length 8 octets and it contains:
        - Max Resp Code field set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Configuring IGMPv3 DUT to enter version 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-enter-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "1"
sysvar: ipmcp.igmp.CompatibilityMode=1 ok
-> cmd ipd start ipmcp
ipd: start ipmcp failed: already started
-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv1 Membership Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv1 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x8114 (33044)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xA3FC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = Membership Query (0x11)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xEEFF (Correct)
IGMP: Group Address = 0.0.0.0
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Received expected IGMPv1 Membership Query from <DIface-0> (30.1.1.5)

Correctly, length of the received IGMPv1 Membership Query is of 8 octet

Max Resp Code field of received IGMPv1 Membership Query
is correctly set to 0

Configuring IGMPv3 DUT to leave version 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-leave-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "3"
sysvar: ipmcp.igmp.CompatibilityMode=3 ok
-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.1: Passed

>> IGMPV3-10.2
TEST_DESCRIPTION
The IGMP version of a Membership Query message is
determined as follows:
IGMPv2 Query: length = 8 octets AND Max Resp Code
field is non-zero
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.1 p35 Query Version
Distinctions
TEST_METHOD
 SETUP: Configure DUT in IGMP Version 2 mode
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv2 General Query Message
- ANVL: Verify that the received IGMPv2 General Query
        Message is of length 8 octets and it contains:
        - Max Resp Code field set to a non-zero value
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Configuring IGMPv3 DUT to enter version 2
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-enter-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "2"
sysvar: ipmcp.igmp.CompatibilityMode=2 ok
-> cmd ipd start ipmcp
ipd: start ipmcp failed: already started
-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv2 Membership Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv1 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x57CD (22477)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xCD43 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = Membership Query (0x11)
IGMP: Max Resp Time = 100 (tenths of a second)
IGMP: Checksum      = 0xEE9B (Correct)
IGMP: Group Address = 0.0.0.0
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Received expected IGMPv2 Membership Query from <DIface-0> (30.1.1.5)

Correctly, length of the received IGMPv2 Membership Query
is 8

Max Resp Code field of received IGMPv2 Membership Query
is correctly set to 100 (non-zero value)

Configuring IGMPv3 DUT to leave version 2
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-leave-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "3"
sysvar: ipmcp.igmp.CompatibilityMode=3 ok
-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.2: Passed

>> IGMPV3-10.3
TEST_DESCRIPTION
The IGMP version of a Membership Query message is
determined as follows:
IGMPv3 Query: length >= 12 octets
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.1 p35 Query Version
Distinctions
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Verify that the received IGMPv3 General Query
        Message is of length equal to or greater than
        12 octets
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv1 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xE8BD (59581)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x3C4F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)

Correctly, length of the received IGMPv3 General Query is 12 bytes.
The expected length is greater than or equal to 12 bytes

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.3: Passed

>> IGMPV3-10.17
TEST_DESCRIPTION
When in IGMPv1 mode, routers MUST send Periodic Queries
with a Max Resp Code of 0
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.3.1 p37 In the Presence of
Older Version Queriers
TEST_METHOD
 SETUP: Configure DUT in IGMP Version 1 mode
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv1 General Query Message
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv1 General Query Message
- ANVL: Verify that both of the received IGMPv1 General
        Query Messages are of length 8 octets and both of
        them contain:
        - Max Resp Code field set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Configuring IGMPv3 DUT to enter version 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-enter-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "1"
sysvar: ipmcp.igmp.CompatibilityMode=1 ok
-> cmd ipd start ipmcp
ipd: start ipmcp failed: already started
-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv1 Membership Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv1 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x8B1E (35614)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x99F2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = Membership Query (0x11)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xEEFF (Correct)
IGMP: Group Address = 0.0.0.0
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Received expected IGMPv1 Membership Query from <DIface-0> (30.1.1.5)

Waiting (up to 126.000 seconds) for IGMPv1 Membership Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv1 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x77C6 (30662)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xAD4A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = Membership Query (0x11)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xEEFF (Correct)
IGMP: Group Address = 0.0.0.0
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Received expected IGMPv1 Membership Query from <DIface-0> (30.1.1.5)

Correctly, length of the received 1st IGMPv1 Membership Query
is 8

Max Resp Code field of received 1st IGMPv1 Membership Query
is correctly set to 0

Correctly, length of the received 2nd IGMPv1 Membership Query
is 8

Max Resp Code field of received 2nd IGMPv1 Membership Query
is correctly set to 0

Configuring IGMPv3 DUT to leave version 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-leave-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "3"
sysvar: ipmcp.igmp.CompatibilityMode=3 ok
-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.17: Passed

>> IGMPV3-10.18
TEST_DESCRIPTION
When in IGMPv1 mode, routers MUST ignore Leave Group messages
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.3.1 p37 In the Presence of
Older Version Queriers
TEST_METHOD
 SETUP: Configure DUT in IGMP Version 1 mode
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv1 General Query Message
- ANVL: Send an IGMPv1 Report Message to <DIface-0>
        containing:
        - Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv2 Leave Group Message to <DIface-0>
        containing:
        - Group Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <GrpSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not multicast IGMPv2 Query Message for <MCAST_GRP_1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Configuring IGMPv3 DUT to enter version 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-enter-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "1"
sysvar: ipmcp.igmp.CompatibilityMode=1 ok
-> cmd ipd start ipmcp
ipd: start ipmcp failed: already started
-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv1 Membership Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x0CCB (3275)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x1846 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = Membership Query (0x11)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xEEFF (Correct)
IGMP: Group Address = 0.0.0.0
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Received expected IGMPv1 Membership Query from <DIface-0> (30.1.1.5)
Sending an IGMPv1 Membership Report to <DIface-0> (30.1.1.5) containing:
- Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00A8 (168)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x14D7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = IGMPv1 Membership Report (0x12)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFEFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv1 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv2 Leave to <DIface-0> (30.1.1.5) containing:
- Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00A9 (169)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23D6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = Leave Group (0x17)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xF9FC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for no IGMPv2 Membership Query
packet from <DIface-0> (30.1.1.5)

Correctly did not receive IGMPv2 Membership Query from <DIface-0> (30.1.1.5)

Configuring IGMPv3 DUT to leave version 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-leave-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "3"
sysvar: ipmcp.igmp.CompatibilityMode=3 ok
-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.18: Passed

>> IGMPV3-10.19
TEST_DESCRIPTION
When in IGMPv2 mode, routers MUST send Periodic Queries
truncated at the Group Address field (i.e., 8 bytes long)
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.3.1 p37 In the Presence of
Older Version Queriers
TEST_METHOD
 SETUP: Configure DUT in IGMP Version 2 mode
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv2 General Query Message
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv2 General Query Message
- ANVL: Verify that both of the received IGMPv2 General
        Query Messages are of length 8 octets and both of
        them contain:
        - Max Resp Code field set to a non-zero value
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Configuring IGMPv3 DUT to enter version 2
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-enter-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "2"
sysvar: ipmcp.igmp.CompatibilityMode=2 ok
-> cmd ipd start ipmcp
ipd: start ipmcp failed: already started
-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv2 Membership Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv1 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0xA984 (43396)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x7B8C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = Membership Query (0x11)
IGMP: Max Resp Time = 100 (tenths of a second)
IGMP: Checksum      = 0xEE9B (Correct)
IGMP: Group Address = 0.0.0.0
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Received expected IGMPv2 Membership Query from <DIface-0> (30.1.1.5)

Waiting (up to 126.000 seconds) for IGMPv2 Membership Query
packet from <DIface-0> (30.1.1.5)

Ignoring IGMPv1 Membership Report message

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0xCC01 (52225)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x590F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = Membership Query (0x11)
IGMP: Max Resp Time = 100 (tenths of a second)
IGMP: Checksum      = 0xEE9B (Correct)
IGMP: Group Address = 0.0.0.0
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Received expected IGMPv2 Membership Query from <DIface-0> (30.1.1.5)

Correctly, length of the received 1st IGMPv2 Membership Query
is 8

Max Resp Code field of received 1st IGMPv2 Membership Query
is correctly set to 100 (> 0)

Correctly, length of the received 2nd IGMPv2 Membership Query
is 8

Max Resp Code field of received 2nd IGMPv2 Membership Query
is correctly set to 100 (> 0)

Configuring IGMPv3 DUT to leave version 2
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-leave-older-version-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipmcp.igmp.CompatibilityMode "3"
sysvar: ipmcp.igmp.CompatibilityMode=3 ok
-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.19: Passed

>> IGMPV3-10.22
TEST_DESCRIPTION
When Group Compatibility Mode is IGMPv2, a router
internally translates the IGMPv2 Report messages
for that group to their IGMPv3 equivalents as IS_EX( {} )
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.3.2 p38 In the Presence of
Older Version Group Members
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv2 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to <MCAST_GRP_1>
        - IGMPv2 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       2160  lo0    0    
128.224.166.0/23                vxTarget                      UC       1801  gei2   0    
vxTarget                        vxTarget                      UH       6532  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       240132lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       9     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xAEA6 (44710)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x7666 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv2 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to <MCAST_GRP_1> (239.255.255.2)
- IGMPv2 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00AA (170)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x14D5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = IGMPv2 Membership Report (0x16)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFAFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv2 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AB (171)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A70 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AC (172)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A6F (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0xAC00 (44032)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x901A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       2168  lo0    0    
128.224.166.0/23                vxTarget                      UC       1810  gei2   0    
vxTarget                        vxTarget                      UH       6564  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       242452lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       9     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.22: Passed

>> IGMPV3-10.23
TEST_DESCRIPTION
When Group Compatibility Mode is IGMPv2, a router
internally translates the IGMPv2 Leave messages
for that group to their IGMPv3 equivalents as TO_IN( {} )
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.3.2 p38 In the Presence of
Older Version Group Members
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv2 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to <MCAST_GRP_1>
        - IGMPv2 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv2 Leave Message to <DIface-0>
        containing:
        - IP Destination Address field set to ALL-ROUTERS
        - IGMPv2 Group Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Multicast an IGMPv2 Group-Specific Query Message
- ANVL: Wait for <LastMemberQueryTime(LastMemberQueryInterval*
        LastMemberQueryCount)> seconds for DUT to remove
        <MCAST_GRP_1> from its list
- ANVL: Multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Reject the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       2184  lo0    0    
128.224.166.0/23                vxTarget                      UC       1811  gei2   0    
vxTarget                        vxTarget                      UH       6598  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       244618lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       9     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x8AB9 (35513)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x9A53 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv2 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to <MCAST_GRP_1> (239.255.255.2)
- IGMPv2 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00AD (173)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x14D2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = IGMPv2 Membership Report (0x16)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFAFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv2 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv2 Leave to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to ALL-ROUTERS (224.0.0.2)
- IGMPv2 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00AE (174)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23D1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = Leave Group (0x17)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xF9FC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for IGMPv3 Group Specific Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x4D8F (19855)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xC87C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 10
IGMPv3: Checksum              = 0xFD75 (Correct)
IGMPv3: Group Address         = 239.255.255.2
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 Group Specific Query from <DIface-0> (30.1.1.5)

Waiting (up to 2.000 seconds) so that DUT removes <MCAST_GRP_1> from its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AF (175)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A6C (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B0 (176)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A6B (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for no multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


DUT correctly did not route multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       2192  lo0    0    
128.224.166.0/23                vxTarget                      UC       1824  gei2   0    
vxTarget                        vxTarget                      UH       6630  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       247022lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       9     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.23: Passed

>> IGMPV3-10.24
TEST_DESCRIPTION
When Group Compatibility Mode is IGMPv1, a router
internally translates the IGMPv1 Report messages
for that group to their IGMPv3 equivalents as IS_EX( {} )
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.3.2 p38 In the Presence of
Older Version Group Members
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv1 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to <MCAST_GRP_1>
        - IGMPv1 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: As a router multicast a remotely-originated UDP packet
        to <DIface-1> containing:
        - IP Destination Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <RoutedPacketRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Route the UDP packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-3:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|                 | <DIface-0>           <AIface-0> |                 |
	|                 |---------------------------------|                 |
	|       DUT       |             L0                  |      ANVL       |
	| (IGMPv3 ROUTER) +                                 + (IGMPv3 ROUTER  |
	|                 |             L1                  |    AND HOST)    |
	|                 |---------------------------------|                 |
	|                 | <DIface-1>           <AIface-1> |                 |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+



Adding Static Route for Source Network in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 TRUE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    add net 64.64.64.0: netmask 255.255.255.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
64.64.64.0/24                   link#14                       US       0     gei1   0    
localhost                       localhost                     UH       2208  lo0    0    
128.224.166.0/23                vxTarget                      UC       1829  gei2   0    
vxTarget                        vxTarget                      UH       6665  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       249372lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0xE124 (57636)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x43E8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv1 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to <MCAST_GRP_1> (239.255.255.2)
- IGMPv1 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00B1 (177)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x14CE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = IGMPv1 Membership Report (0x12)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFEFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv1 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending multicast seed packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100 to prime DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B2 (178)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A69 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 1.000 seconds) after sending seed packet

Sending multicast packet (UDP port 10000) for group 239.255.255.2
on interface <DIface-1> (40.1.1.5) from Source 64.64.64.100

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B3 (179)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 16
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A68 (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 10.000 seconds) for multicast packet (UDP port 10000) for
group 239.255.255.2 on interface <DIface-0> (30.1.1.5)


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0xB300 (45824)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 15
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x891A (Correct)
IP: Source Address         = 64.64.64.100
IP: Destination Address    = 239.255.255.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 10000 (10000)
UDP: Destination Port = 10000 (10000)
UDP: Length           = 24 
UDP: Checksum         = 0x0000 
UDP:
UDP: --- Trailing Data [16 bytes] ---
UDP:  49 47 4D 50 56 33 5F 54 45 53 54 5F 44 41 54 41   IGMPV3_TEST_DATA
UDP: --- Trailing Data End ---
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT correctly routed multicast packet on interface <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 2 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Removing Static Route for Source Network from DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
64.64.64.0 255.255.255.0 1 FALSE 40.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-configure-static-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -dev gei1 -net -netmask 255.255.255.0 64.64.64.0
    delete net 64.64.64.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       2216  lo0    0    
128.224.166.0/23                vxTarget                      UC       1836  gei2   0    
vxTarget                        vxTarget                      UH       6697  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       251440lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       2     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       10    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.24: Passed

>> IGMPV3-10.25
TEST_DESCRIPTION
When Group Compatibility Mode is IGMPv1, IGMPv2 Leave
messages and IGMPv3 TO_IN() messages are also ignored
TEST_REFERENCE
RFC 3376, IGMP Version 3, s7.3.2 p38 In the Presence of
Older Version Group Members
TEST_METHOD
- ANVL: Listen (for upto <GeneralQueryRecvWaitTime> seconds)
        on <DIface-0>
-  DUT: Multicast an IGMPv3 General Query Message
- ANVL: Send an IGMPv1 Report Message to <DIface-0>
        containing:
        - IP Destination Address field set to <MCAST_GRP_1>
        - IGMPv1 Group Address field set to <MCAST_GRP_1>
- ANVL: Wait for <ProcessTime> seconds for DUT to add
        <MCAST_GRP_1> to its list
- ANVL: Send an IGMPv2 Leave Message to <DIface-0>
        containing:
        - IP Destination Address field set to ALL-ROUTERS
        - IGMPv2 Group Address field set to <MCAST_GRP_1>
- ANVL: Listen (for upto <GrpSrcSpecQueryRecvWaitTime>
        seconds) on <DIface-0>
-  DUT: Do not multicast any IGMPv1 Query Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Initiating IGMPv3 interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-init-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> cmd ipd start ipmcp
ipd: start ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.


	IGMPv3 Topology-1:
	------------------

	+-----------------+                                 +-----------------+
	|                 |                                 |                 |
	|       DUT       | <DIface-0>           <AIface-0> |      ANVL       |
	| (IGMPv3 ROUTER) +---------------------------------+ (IGMPv3 ROUTER  |
	|                 |                L0               |    AND HOST)    |
	|                 |                                 |                 |
	+-----------------+                                 +-----------------+
	        | <AIface-1>
	        |
	        |                                           +-----------------+
	        |                                <AIface-1> |                 |
	   L1   +------------------------------------------+|     MRTR-1      |
	                                                    |                 |
	                                                    +-----------------+



Waiting (up to 126.000 seconds) for IGMPv3 General Query
packet from <DIface-0> (30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x44DF (17631)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0xE02D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.1
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMPv3: ---- IGMPv3 Packet ----
IGMPv3:
IGMPv3: Version               = 3
IGMPv3: Type                  = Membership Query (0x11)
IGMPv3: Max Resp Code         = 100
IGMPv3: Checksum              = 0xEC1E (Correct)
IGMPv3: Group Address         = 0.0.0.0
IGMPv3: Resv                  = 0
IGMPv3: S                     = 0 
IGMPv3: QRV                   = 2
IGMPv3: QQIC                  = 125
IGMPv3: Number of Sources (N) = 0
IGMPv3:
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---


Received expected IGMPv3 General Query from <DIface-0> (30.1.1.5)
Sending an IGMPv1 Membership Report to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to <MCAST_GRP_1> (239.255.255.2)
- IGMPv1 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00B4 (180)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x14CB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 239.255.255.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 1
IGMP: Type          = IGMPv1 Membership Report (0x12)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xFEFC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Successfully sent IGMPv1 Membership Report to <DIface-0> (30.1.1.5)

Waiting for <ProcessTime> (2) seconds for DUT
to add group 239.255.255.2 to its list
Sending an IGMPv2 Leave to <DIface-0> (30.1.1.5) containing:
- IP Destination Address field set to ALL-ROUTERS (224.0.0.2)
- IGMPv2 Group Address field set to <MCAST_GRP_1> (239.255.255.2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 6 (24 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x00B5 (181)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = IGMP (2)
IP: Header Checksum        = 0x23CA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.2
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x94 (Router Alert)
IP OPT: Length             = 4
IP OPT: Value              = 0x0000 (Router shall examine packet)
IP:
IGMP: ---- IGMP Packet ----
IGMP:
IGMP: Version       = 2
IGMP: Type          = Leave Group (0x17)
IGMP: Max Resp Time = 0 (tenths of a second)
IGMP: Checksum      = 0xF9FC (Correct)
IGMP: Group Address = 239.255.255.2
IGMP:
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---


Waiting (up to 2.000 seconds) for no IGMPv1 Membership Query
packet from <DIface-0> (30.1.1.5)

Correctly did not receive IGMPv1 Membership Query from <DIface-0> (30.1.1.5)

Resetting IGMPv3 Interfaces on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 ROUTER 2 125 100 260 255 31 2 10 2 1 260 1 FALSE 64.64.64.0 255.255.255.0 239.255.255.0 0.0.0.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IGMPV3/igmpv3-interface-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure ipmcp
ipd: reconfigure ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IGMPV3-10.25: Passed
Executing system command:
  "./DocScriptQ35/IGMPV3/IGMPV3postsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill iprip
ipd: kill iprip failed: not started
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar unset ipmcp.UpstreamIf 
sysvar: 'ipmcp.UpstreamIf' unset ok
-> cmd sysvar unset ipmcp.DownstreamIfs 
sysvar: 'ipmcp.DownstreamIfs' unset ok
-> cmd sysvar unset ipmcp.igmp.CompatibilityMode 
sysvar: 'ipmcp.igmp.CompatibilityMode' unset ok
-> cmd ipd kill ipmcp
ipd: kill ipmcp ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          73
Number of tests passed:       73
Number of tests failed:       0
Number of tests inconclusive: 0
