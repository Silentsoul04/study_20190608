ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6716296 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlike_aggressive_resp ike 14.1-14.16 14.18-18.5 18.7-18.14 18.16-18.27 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlike_aggressive_resp.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IKE/IKEpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IKE Suite Setup Command                  "./DocScriptQ35/IKE/ike-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE ISAKMP SA Initiate Command           "./DocScriptQ35/IKE/ike-isakmp-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE IPSec SA Initiate Command            "./DocScriptQ35/IKE/ike-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Another IPSec SA Initiate Command    "./DocScriptQ35/IKE/ike-another-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Restart Command                      "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Specify DES MD5 Attribute Command    "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Specify DES SHA Attribute Command    "./DocScriptQ35/IKE/ike-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Combined SA Initiate Command         "./DocScriptQ35/IKE/ike-combined-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Two SA Initiate Command              "./DocScriptQ35/IKE/ike-two-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Aggressive Mode Initiate Command     "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE New Group Mode Initiate Command      "./DocScriptQ35/IKE/ike-new-group-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Aggressive Mode Configure Command    "./DocScriptQ35/IKE/ike-aggressive-mode-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE SA Down Command                      "./DocScriptQ35/IKE/ike-sa-down-command.exp $ANVL_DUTHOSTNAME"
IKE Certificate Data                     "abcdefghijklmnop"
IKE Certificate Type                     2                   # (0x00000002)
IKE Signature Data                       "ABCDEFGHIJKLMNOP"
IKE Retransmit Count                     3                   # (0x00000003)
IKE Unique Cookie Test Count             3                   # (0x00000003)
IKE Test Timeout                         60                  # (0x0000003C)
IKE DUT Major Version                    1                   # (0x00000001)
IKE DUT Minor Version                    1                   # (0x00000001)
IKE Non Zero Value                       1                   # (0x00000001)
IKE Nonce Payload Invalid Length         7                   # (0x00000007)
IKE ID Payload Invalid Port              10                  # (0x0000000A)
IKE ID Payload Invalid Protocol          10                  # (0x0000000A)
IKE Invalid Exchange Type                10                  # (0x0000000A)
IKE Invalid Message ID                   10                  # (0x0000000A)
IKE Invalid DOI                          10                  # (0x0000000A)
IKE Invalid Protocol ID                  10                  # (0x0000000A)
IKE Invalid Transform ID                 10                  # (0x0000000A)
IKE Invalid Attribute Class              20                  # (0x00000014)
IKE Invalid SPI                          210                 # (0x000000D2)
IKE DUT Supports Certificate Payload Processing True
IKE DUT Supports Main Mode As Initiator  True
IKE DUT Supports Main Mode As Responder  True
IKE DUT Supports Quick Mode As Initiator True
IKE DUT Supports Quick Mode As Responder True
IKE DUT Supports Aggressive Mode As Initiator True
IKE DUT Supports Aggressive Mode As Responder True
IKE DUT Supports New Group Mode As Initiator False
IKE DUT Supports New Group Mode As Responder False
IKE DUT Supports Sending of Notification Message True
IKE DUT Supports Traffic Processing before CONNECTED Notify False
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlike_aggressive_resp.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               4                 # (0x00000004)
  IPV6 DUT Address                         ::
  IPV6 ANVL Address                        ::
  IPV6 Gateway                             ::
  IPV6 Subnet Mask                         0                 # (0x00000000)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               4                 # (0x00000004)
  IPV6 DUT Address                         ::
  IPV6 ANVL Address                        ::
  IPV6 Gateway                             ::
  IPV6 Subnet Mask                         0                 # (0x00000000)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Remote Host Address             30.1.1.150
  IPSec IP Local Host Address              40.1.1.150
  IPSec IP Encapsulation                   v4Ov4
  IPSec Configuration                      Auto
  IPSec IPv6 Remote Host Address           ::
  IPSec IPv6 Local Host Address            ::
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          SHA
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP1024
  IKE IPSec SA Transform ID                ESP_DES
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Encapsulation Mode          TUNNEL
  IKE IPSec SA Authentication Algorithm    HMAC_SHA
  IKE Alternative ISAKMP SA Encryption Algorithm DES_CBC
  IKE Alternative ISAKMP SA Hashing Algorithm MD5
  New Group Description                    32768             # (0x00008000)
  New Group Prime                          "FFFDFF6FF2FF3FFFC90FDAA22168C234C6C6628B86DC6CD129064E088A676C74020B6EA636139B62564A06798634646D6F6569B3CD3A431B302B0A6DF25F14676FE6366D66516245E4656576665E6EC6F66662E9A6"
  New Group Generator                      "3"
  New Group Modulus Length                 680               # (0x000002A8)
  IKE Pre-Shared Key                       abcdef

# Configuration File End.
%% VALIDATE CFG GLOBAL WARNING: 
! The following test should run for ISAKMP group-1 mode
! Therefore the following test cannot be run: 16.9 16.10 14.5 14.6 18.11 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
0:DUT_HOSTNAME:128.224.166.238
1 ENCRYPTED_DIFACE_INDEX:0
1ENCRYPTED_DIFACE:30.1.1.5
1UNENCRYPTED_DIFACE:40.1.1.5
1ENCRYPTED_SESSION_STARTPOINT:40.1.1.150
ENCRYPTED_SESSION_ENDPOINT:30.1.1.150
IPSEC_MODE:TUNNEL
AUTH_METHOD:PRESHARED-KEY
ISAKMP_HASHING_ALGO:SHA
ISAKMP_ENCRYPTION_ALGO:DES_CBC
ISAKMP_GROUP_DESCRIPTION:MODP1024
ALTERNATE_ISAKMP_HASHING_ALGO:MD5
ALTERNATE_ISAKMP_ENCRYPTION_ALGO:DES_CBC
IPSEC_AUTH_ALGO:HMAC_SHA
IPSEC_ENCRYPTION_ALGO:ESP_DES
IPSEC_GROUP_DESCRIPTION:MODP1024
IPSEC_PROTOCOL:ESP
PRESHARED_KEY:abcdef
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask 255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask 255.255.255.0 up
-> cmd ifconfig -a
lo0	Link type:Local loopback
	inet 127.0.0.1  mask 255.255.255.255
	inet6 unicast fe80::1%lo0  prefixlen 64  automatic
	inet6 unicast ::1  prefixlen 128
	UP RUNNING LOOPBACK MULTICAST NOARP ALLMULTI 
	MTU:1500  metric:1  VR:0  ifindex:1
	RX packets:1085259 mcast:3388 errors:0 dropped:0
	TX packets:1085259 mcast:3388 errors:0
	collisions:0 unsupported proto:0
	RX bytes:80943383 (80 M)  TX bytes:80943383 (80 M)

gei2	Link type:Ethernet  HWaddr 00:25:90:04:e2:de
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 128.224.166.238  mask 255.255.254.0  broadcast 128.224.167.255
	inet6 unicast fe80::225:90ff:fe04:e2de%gei2  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:2
	RX packets:346927 mcast:17481 errors:0 dropped:1892
	TX packets:57017 mcast:1117 errors:0
	collisions:0 unsupported proto:0
	RX bytes:23451610 (23 M)  TX bytes:6168705 (6168 k)

gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:45
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:46
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> cmd sysvar set -co ipike.strict_lifetime_policy "1"
sysvar: ipike.strict_lifetime_policy=1 ok
-> cmd sysvar get ipike.strict_lifetime_policy 
sysvar: ipike.strict_lifetime_policy=1
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill iprip
ipd: kill iprip failed: not started
-> cmd ipd kill ipike
ipd: kill ipike failed: not started
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5


! Couldn't find DUT at 30.1.1.5
! Some tests may fail because of this
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite Internet Key Exchange (IKE)
RFC 2407: 'The Internet IP Security Domain of Interpretation
for ISAKMP'
(D. Piper Network Alchemy, November 1988)
RFC 2408: 'Internet Security Association and Key Management
Protocol (ISAKMP)'
(D. Maughan National Security Agency,
M. Schertler Securify, Inc.
M. Schneider National Security Agency,
J. Turner RABA Technologies, Inc., November 1998)
RFC 2409: The Internet Key Exchange (IKE)
(D. Harkins, D. Carrel, Cisco Systems, November 1998


ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the machine on which ANVL is running
be connected to 2 interfaces that are connected
to the device under test.

The ANVL config file must contain 2 IP interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IKE-14.1
TEST_DESCRIPTION
IKE MUST negotiate SA Attributes for Enc. algo, Hash algo, Auth. method, Group information.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Externally cause DUT to initiate ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with SA Attributes for Enc.algo,
        Hash algo, Auth. method, Group information 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> c
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x1194 (4500)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2969 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xB2F2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AB E8 6C 08 60 DF E8 9E                           ..l.`...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9F DF 4B 69 18 11 CC 7E 8F 80 2C 5A A6 7C FE 41   ..Ki...~..,Z.|.A
ISAKMP:  81 0D 94 FB DD B4 DB 88 EA 26 10 F3 F9 1C 39 DB   .........&....9.
ISAKMP:  03 6C 11 14 80 EF D8 E1 11 78 A0 13 27 37 93 DF   .l.......x..'7..
ISAKMP:  99 7F 68 8E 4D 68 73 FA FD 3F F0 09 C8 69 DF 43   ..h.Mhs..?...i.C
ISAKMP:  DB 31 45 E8 B7 AE 26 09 46 2C 27 D9 C2 26 D4 90   .1E...&.F,'..&..
ISAKMP:  8B 93 53 2F 3C C1 14 51 84 16 9F 05 EE 9F B6 30   ..S/<..Q.......0
ISAKMP:  4C 01 08 25 EE AA 0D 0B 19 4D E1 11 A9 6F 56 DB   L..%.....M...oV.
ISAKMP:  8A E1 39 15 B8 13 9E 94 13 E9 7F 6B 06 CD 22 68   ..9........k.."h
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  E3 63 34 ED 2A DC F6 00 1D 2D AD 90 71 D6 A7 AA   .c4.*....-..q...
ISAKMP:  54 9E 6F 5A 19 5F 69 EC 76 03 D1 09 32 BC F2 22   T.oZ._i.v...2.."
ISAKMP:  9F 90 6E A6 D1 30 81 44 A6 1F 52 34 D3 BE 4D DC   ..n..0.D..R4..M.
ISAKMP:  14 81 A4 01 F9 DE 1B C4 82 E3 D3 81 BD 2E E4 E5   ................
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
4 mandatory SA Attrbitues

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_xit
Au revoir!
Connection closed by foreign host.
ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.1: Passed

>> IKE-14.2
TEST_DESCRIPTION
IKE MUST set the Message ID field to 0 in an outbound ISAKMP Packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p25 ISAKMP Header Format
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with Message ID field in the HDR
        set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x1195 (4501)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2968 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x9EF8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D4 80 8F 0D FE D1 CE 2E                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  84 62 C0 29 59 D3 83 8F 9B B2 72 C5 DD A6 A2 E5   .b.)Y.....r.....
ISAKMP:  B9 79 8D A2 08 88 5C 76 17 2C 15 1A 41 A8 24 C6   .y....\v.,..A.$.
ISAKMP:  0D E3 EA C3 E9 34 63 16 21 1D 5C 19 D9 A9 72 23   .....4c.!.\...r#
ISAKMP:  73 5F 7F 3D 8A B8 74 D5 33 64 70 ED 79 BA 22 A3   s_.=..t.3dp.y.".
ISAKMP:  18 44 6D 98 7F C5 13 13 E6 21 1F 9A 37 1C 24 98   .Dm......!..7.$.
ISAKMP:  9B 21 4C 05 31 66 56 B2 7D 11 17 20 16 1F 75 07   .!L.1fV.}.. ..u.
ISAKMP:  D2 F4 38 9E 45 4E BC D8 A3 B9 36 09 26 8B 71 DE   ..8.EN....6.&.q.
ISAKMP:  0F 00 44 3A 1F 62 AA 4C BD 76 22 47 4F 3A 91 27   ..D:.b.L.v"GO:.'
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F4 62 87 B2 43 91 AF 28 9A 88 FB D0 5A 85 B3 49   .b..C..(....Z..I
ISAKMP:  8C F2 29 EE 1C 77 C9 C4 50 A9 11 E6 A1 A4 3D E2   ..)..w..P.....=.
ISAKMP:  C9 0F 66 D0 F3 16 99 04 62 D9 0D 9F CF AF BC 06   ..f.....b.......
ISAKMP:  59 FA 43 4F 09 B7 CB E9 DF F2 BE ED D8 7D A9 FC   Y.CO.........}..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received ISAKMP Packet with Message ID:0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikexit
Au revoir!
Connection closed by foreign host.
v1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.2: Passed

>> IKE-14.3
TEST_DESCRIPTION
IKE MUST not set the NP field of Security Association Payload
to Proposal
Payload.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
      Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with the NP field in SA not set to 
        Proposal Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x1196 (4502)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2967 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xC22C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6C 31 FD 28 B8 12 59 F8                           l1.(..Y.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  24 98 7C 17 C7 81 0F C5 2A 75 21 1C 08 43 9C 33   $.|.....*u!..C.3
ISAKMP:  22 D7 92 C2 F0 3D AF 89 5A 8F 2E 6C D7 56 84 EE   "....=..Z..l.V..
ISAKMP:  45 35 28 1D 33 AC B9 BE F7 1A 76 19 B1 60 F1 36   E5(.3.....v..`.6
ISAKMP:  D1 8E B9 33 D1 24 68 E2 96 E6 26 A7 72 4A 19 44   ...3.$h...&.rJ.D
ISAKMP:  BC EB 4C A6 D4 DC 65 79 BD DE C0 42 04 93 1A 49   ..L...ey...B...I
ISAKMP:  DA 08 05 C5 F8 C8 2D EA EC 69 61 23 8B 0D 1B 31   ......-..ia#...1
ISAKMP:  C5 FF A0 0B C6 82 20 83 9E FE 6E C7 19 8F 5F F5   ...... ...n..._.
ISAKMP:  34 00 62 62 D9 25 A3 5C A4 CC 28 87 79 1E BC F6   4.bb.%.\..(.y...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  72 BC 03 4C 2A B4 A8 F9 D8 49 F5 E5 CA 0D 09 33   r..L*....I.....3
ISAKMP:  24 13 54 99 5D 2F 51 5D B7 7D 94 34 C1 15 3A 0C   $.T.]/Q].}.4..:.
ISAKMP:  95 17 54 D8 2E 82 78 BA A3 18 D5 E7 FC 6C 42 89   ..T...x......lB.
ISAKMP:  D4 68 BA EF 13 60 FC B2 0E CB 2C A0 1C A4 EC 10   .h...`....,.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
with Next Payload of SA Payload
set to: (4)(Should be 0)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ixit
Au revoir!
Connection closed by foreign host.
kev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.3: Passed

>> IKE-14.4
TEST_DESCRIPTION
During SA Payload exchange, IKE MUST set the Encryption flag to 0 in an
outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2408 s5.2 p60 ISAKMP Header Processing
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
      Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with the Encryption flag in the 
      HDR set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x1197 (4503)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2966 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x0137 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  66 FD AE 11 FD 9D 05 6B                           f......k
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4F 9A 03 91 A6 4D D4 35 CF E2 CB 8F 43 0F 8A DB   O....M.5....C...
ISAKMP:  35 0A 2B F6 E8 06 ED 42 B3 0C BA DB ED FF 55 F4   5.+....B......U.
ISAKMP:  7F 84 C4 96 F0 B3 FF 8E 1A D2 67 56 57 EB A8 B1   ..........gVW...
ISAKMP:  C0 1D 08 6C 53 26 81 6B 15 9E 9F 3D 30 08 23 51   ...lS&.k...=0.#Q
ISAKMP:  E0 58 89 17 C7 30 EB D9 DF 8B 3F 07 2E D3 D4 18   .X...0....?.....
ISAKMP:  2D 47 6D 02 65 21 0D EA BC 56 FC 99 5C 90 20 27   -Gm.e!...V..\. '
ISAKMP:  00 A5 4F 16 41 91 2C 89 9C 04 8F 78 B9 35 E6 DA   ..O.A.,....x.5..
ISAKMP:  F6 1B 72 2F EC 1D 84 E1 B7 02 3F 31 58 63 26 CE   ..r/......?1Xc&.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  5F E9 E5 DC 3D B0 49 53 8F 75 49 65 F4 C5 89 F8   _...=.IS.uIe....
ISAKMP:  A2 6F 17 91 1B 33 AE 11 E1 49 41 67 CB 95 62 38   .o...3...IAg..b8
ISAKMP:  76 2F B0 89 85 D0 67 01 15 97 DB D0 BE 5D 75 A7   v/....g......]u.
ISAKMP:  19 00 03 9D 17 4B F0 F2 DC E3 AC 9B 09 AC CD 39   .....K.........9
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
Header Flag set to: 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_xit
Au revoir!
Connection closed by foreign host.
ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.4: Passed

>> IKE-14.7
TEST_DESCRIPTION
SA Payload MUST precede all other Payloads in an outbound
ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting SA Payload immediately 
        after HDR
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x1198 (4504)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2965 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x5452 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  56 D0 8D 3E EF 44 02 0B                           V..>.D..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  78 10 04 00 8F DC 25 0A 29 75 06 36 43 93 96 78   x.....%.)u.6C..x
ISAKMP:  3F 68 27 00 82 09 3A 11 B5 4B 3D C7 D9 0B 8F 55   ?h'...:..K=....U
ISAKMP:  CA 85 21 A6 1F 35 02 60 E4 3B 86 32 EF 03 0D F0   ..!..5.`.;.2....
ISAKMP:  02 43 3E 58 31 17 67 9D 39 A8 B8 D2 D4 99 25 E4   .C>X1.g.9.....%.
ISAKMP:  5F 36 CF 12 EE 32 7E 1D FD 26 B6 A7 1B F4 49 D0   _6...2~..&....I.
ISAKMP:  A1 A5 36 F0 08 27 EA 84 E6 BA 71 FE A6 EC F1 BB   ..6..'....q.....
ISAKMP:  53 F4 E1 94 D9 BE 76 E7 10 6F 81 37 BF 13 A3 E2   S.....v..o.7....
ISAKMP:  ED 8F 1D 04 31 04 41 EB F9 CB 3F DB EA 53 59 C0   ....1.A...?..SY.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  6D 9B 7C F3 DF 8E 6F 75 99 2A CA 92 AD 84 AA 3D   m.|...ou.*.....=
ISAKMP:  11 EA 82 A9 E1 A5 90 D4 2D 87 4B 57 44 2F A8 42   ........-.KWD/.B
ISAKMP:  1C FD EE 4A 7D 4F 1F 8E FA CD A8 90 41 2D C6 F5   ...J}O......A-..
ISAKMP:  B0 C3 C1 AB B4 8A 03 29 60 FE 9E DB 60 E9 5F C4   .......)`...`._.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikexit
Au revoir!
Connection closed by foreign host.
v1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.7: Passed

>> IKE-14.8
TEST_DESCRIPTION
IKE MUST support SIT_IDENTITY_ONLY for Situation field in the Security
Association Payload. 
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2407 s4.2 p3 IPSEC Situation Definition
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
        with Situation field in SA set to SIT_IDENTITY_ONLY
-  DUT: Send <HDR,SA,KE,Ni,IDii> with Situation field in SA set to 
        SIT_IDENTITY_ONLY    
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x1199 (4505)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2964 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x6C15 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CC BB DB 3B 0E 20 21 2E                           ...;. !.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2B C3 78 D5 E0 15 A7 F9 9C 96 AA 72 F2 65 E9 AA   +.x........r.e..
ISAKMP:  A0 AE 16 3B E2 56 57 E3 1D 3B 68 23 BA 8F 09 9D   ...;.VW..;h#....
ISAKMP:  42 76 FD BB 5B D4 C6 79 72 4F FF 22 ED E1 D7 D4   Bv..[..yrO."....
ISAKMP:  B3 E3 DD 9D 71 BD 4F 65 EC E1 C8 0E DB 0E 38 DD   ....q.Oe......8.
ISAKMP:  13 9E A5 5C CD 53 A9 DD B7 F7 FB B2 7C EC B6 4E   ...\.S......|..N
ISAKMP:  FC B3 62 63 EB 00 30 E4 53 03 A8 F5 07 A9 6F AF   ..bc..0.S.....o.
ISAKMP:  FC E5 AA AE 6F BC 6A 24 A9 B0 74 D6 E0 7D CC 33   ....o.j$..t..}.3
ISAKMP:  E9 60 75 25 41 1E ED 7C 4A 0D EF CB 3E 3B B8 07   .`u%A..|J...>;..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  DF 5E 6E 48 81 BC 7C B5 9F 92 80 AC FC 40 01 9C   .^nH..|......@..
ISAKMP:  58 BB 41 53 10 80 74 D1 55 B3 7E 28 E1 5C 01 24   X.AS..t.U.~(.\.$
ISAKMP:  07 F6 AE 67 52 5F FB 29 54 CF BF 48 3A 7A 85 60   ...gR_.)T..H:z.`
ISAKMP:  80 D5 94 B9 BC E6 58 40 F1 A4 F8 77 AC 54 39 2B   ......X@...w.T9+
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii>
Packet from DUT with situation field set to SIT_IDENTITY_ONLY

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikexit
Au revoir!
Connection closed by foreign host.
v1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.8: Passed

>> IKE-14.9
TEST_DESCRIPTION
IKE MUST set the Payload Length field of Proposal Payload
to (PROPL_HLEN + 
Total length of all Transforms) in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.5 p28 Proposal Payload             
RFC 2408 s5.1 p58 General Message Processing 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Payload Length of Proposal to 
        (PROPL_HLEN + Total length of all Transforms)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x119A (4506)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2963 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xF951 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EE E7 D3 07 07 63 E6 43                           .....c.C
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  76 99 0A 6D 64 26 60 AF 99 80 DC 3F B3 C1 B7 6A   v..md&`....?...j
ISAKMP:  7A 88 33 06 66 DD FE C3 18 3D 7F AA CC 89 DA 8F   z.3.f....=......
ISAKMP:  19 E8 0F 8A F7 5A 6F B4 A9 31 7C 1C AE 51 E1 00   .....Zo..1|..Q..
ISAKMP:  40 B5 B7 D6 62 44 B3 41 75 DD EE 14 C2 63 C3 03   @...bD.Au....c..
ISAKMP:  AE 3B 55 3B B9 91 0A E5 C2 9A 6A EF 7E 77 BD 86   .;U;......j.~w..
ISAKMP:  1A 0E 2F A2 FF 2D 6F 1D 97 FF D0 36 AF CE 25 83   ../..-o....6..%.
ISAKMP:  5D 6A 1F 98 54 86 4C E4 33 09 42 8E 12 83 9E BA   ]j..T.L.3.B.....
ISAKMP:  40 8C 88 9F A3 24 6F FE 2D B4 E2 22 C8 B0 36 16   @....$o.-.."..6.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F9 51 7D D8 7E 40 4A F1 E3 8A 53 C1 1E 4A D1 29   .Q}.~@J...S..J.)
ISAKMP:  AB 69 06 52 F3 F4 31 24 2E 2C 10 0D 00 D3 69 52   .i.R..1$.,....iR
ISAKMP:  B1 16 FD 88 97 C6 B9 E7 5D 8B 39 27 DD 09 DC 7F   ........].9'....
ISAKMP:  74 0B DB 51 54 0B 78 53 9C 27 E2 84 AD D7 6F AD   t..QT.xS.'....o.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
with valid Proposal Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1xit
Au revoir!
Connection closed by foreign host.
_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.9: Passed

>> IKE-14.10
TEST_DESCRIPTION
IKE MUST set the Payload Length field of Transform Payload to
(TRANS_HLEN + Total length of all SA Attributes) in an outbound
ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s5.1 p58 General Message Processing
RFC 2408 s3.6 p29 Transform Payload              
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
      Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Payload Length of the
        Transform to 
        (TRANS_HLEN + Total length of all SA Attributes)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x119B (4507)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2962 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xFBA2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5A BB 29 A4 6E 34 E4 FB                           Z.).n4..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  63 C2 E7 03 FE 8B 22 76 41 3D 2B 76 42 A7 3B B1   c....."vA=+vB.;.
ISAKMP:  FB E1 91 03 D1 37 84 EB 4B 0B 52 20 BC EE 51 31   .....7..K.R ..Q1
ISAKMP:  81 62 44 F3 80 6D 77 6D 2C ED B4 FF 9C D0 D4 76   .bD..mwm,......v
ISAKMP:  41 CB 4C 8A 0B 7F 12 F7 CA E0 98 82 8E 7C D4 F0   A.L..........|..
ISAKMP:  67 24 1A 80 0D 2D A8 B1 1A 01 0C 32 93 B4 43 66   g$...-.....2..Cf
ISAKMP:  00 80 71 54 84 71 30 8E E7 8F CE 6C A8 8B EF 16   ..qT.q0....l....
ISAKMP:  38 8E CF 77 B8 8F 3F 89 0D B6 57 D7 FC 34 74 EC   8..w..?...W..4t.
ISAKMP:  98 6C 65 88 58 95 4A 77 63 DE 95 6D B4 C1 1B 68   .le.X.Jwc..m...h
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  3E 1B A1 B9 31 E1 E0 79 B1 DF 7C 56 6B 0E 35 98   >...1..y..|Vk.5.
ISAKMP:  80 7F 51 C8 C8 D2 4F 36 8D BD 61 EF 53 B7 9C 7B   ..Q...O6..a.S..{
ISAKMP:  CB 0B A1 C4 C6 EC 85 B3 91 BA 91 22 F4 48 38 22   ...........".H8"
ISAKMP:  19 61 A9 45 02 9C D0 CD E9 F8 EB D8 AA B8 D1 E9   .a.E............
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
d ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romxit
Au revoir!
Connection closed by foreign host.
fs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.10: Passed

>> IKE-14.11
TEST_DESCRIPTION
IKE MUST set the DOI field of Security Asociation Payload to 0 or 1
in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408, s3.4 p27 Security Association Payload
RFC 2408, s5.4 p62 Security Association Payload Processing 
RFC 2409  s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with DOI field in SA set to 0 or 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x119C (4508)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2961 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x86AB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EC EB 78 35 DD A9 6C B6                           ..x5..l.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3E 18 7D 16 40 BE F1 95 49 CC 49 01 ED 91 21 4C   >.}.@...I.I...!L
ISAKMP:  D7 D1 EE FC 8F 0B 1D 6B 07 E2 F2 8B B5 04 1E 9A   .......k........
ISAKMP:  4C CF 9D 7F D7 8F 4C 95 50 C6 AC 6F DC 1E 3B 2D   L.....L.P..o..;-
ISAKMP:  94 C3 2F CE 5E 18 78 17 11 B9 93 5A 79 30 AB B7   ../.^.x....Zy0..
ISAKMP:  DC 70 B6 5C DC 02 7D AF 8F 06 88 12 88 2B 2F DF   .p.\..}......+/.
ISAKMP:  CE B7 45 F0 36 1D 13 4D 5F 06 01 A4 FA 6A A2 85   ..E.6..M_....j..
ISAKMP:  E3 95 A7 38 AD 42 B8 35 18 5D 5F 23 84 1E 19 80   ...8.B.5.]_#....
ISAKMP:  FB C3 80 B1 9B 1C 39 A1 36 8E CF 5B 35 E5 E8 95   ......9.6..[5...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  0D BB 5C 38 AB 12 22 B0 8D FD 4F 42 B3 3E 5B 79   ..\8.."...OB.>[y
ISAKMP:  91 92 C8 8A 24 68 9E 09 42 B7 66 6C 7E E0 CD 95   ....$h..B.fl~...
ISAKMP:  51 2D FB 5B 1E AD 42 4B 29 28 7A 80 71 03 55 A9   Q-.[..BK)(z.q.U.
ISAKMP:  06 D7 02 B6 E2 51 1E A4 AE F4 52 12 1F 7E 0A FB   .....Q....R..~..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150) with DOI set to 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikevxit
Au revoir!
Connection closed by foreign host.
1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.11: Passed

>> IKE-14.12
TEST_DESCRIPTION
During SA Payload exchange, IKE MUST set the Responder Cookie field of 
the ISAKMP Header to 0 in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s2.4 p18 Identifying Security Associations
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with CKY-R field in HDR set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x119D (4509)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2960 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x1838 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D6 CD 4F C3 11 12 A6 7C                           ..O....|
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D5 F9 D0 A6 84 C7 B0 78 8A 9B 93 4A 62 6A 70 A2   .......x...Jbjp.
ISAKMP:  CB 7D E9 2D B9 FF 8E C3 76 0D C2 BB 57 7F 08 BF   .}.-....v...W...
ISAKMP:  1F 6E AE 5C 29 1A 50 13 47 B9 46 6A 09 D7 70 85   .n.\).P.G.Fj..p.
ISAKMP:  2C 51 61 23 F3 60 F8 F4 17 F0 41 1A 19 38 1E 1C   ,Qa#.`....A..8..
ISAKMP:  A7 EA 2A 85 B7 54 35 6D F5 F2 EB 50 BD 90 B5 64   ..*..T5m...P...d
ISAKMP:  8C A9 34 C4 F8 FB 28 08 72 DE A7 95 9E 06 38 A4   ..4...(.r.....8.
ISAKMP:  69 95 99 56 07 5F 74 1A 63 B4 CC 88 42 32 B5 71   i..V._t.c...B2.q
ISAKMP:  0E FC 6D 10 48 C7 3C C0 B5 39 DF 1B 13 D8 D4 F0   ..m.H.<..9......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  44 82 1C 58 D5 B2 F0 61 EF 18 B5 3A 65 BF 67 37   D..X...a...:e.g7
ISAKMP:  08 F6 00 8E 16 91 24 D7 43 33 8C 37 B3 C4 4E 3B   ......$.C3.7..N;
ISAKMP:  F6 A3 39 F2 6E 6C 70 1B FD AE 03 1D E2 CA 36 E6   ..9.nlp.......6.
ISAKMP:  DA 34 67 9C 3A 2F CE 45 B4 ED E0 94 15 B8 17 7D   .4g.:/.E.......}
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
valid Cookies

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1xit
Au revoir!
Connection closed by foreign host.
_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.12: Passed

>> IKE-14.13
TEST_DESCRIPTION
IKE MUST set the Length field of ISAKMP Header to (ISKMP_HLEN + Total
length of all Payloads) in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p25 ISAKMP Header Format              
RFC 2408 s 5.1 p58 General Message Processing 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Length of the HDR to 
        (ISAKMP_HLEN + Total length of all Payloads)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x119E (4510)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x295F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x2FAF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  43 74 60 21 02 9D CE 69                           Ct`!...i
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  81 89 1D E5 72 5A 0D 7E 3E 76 08 78 71 D6 6E C0   ....rZ.~>v.xq.n.
ISAKMP:  E9 7D A0 92 87 B5 B3 D9 91 2F A7 71 99 12 21 E9   .}......./.q..!.
ISAKMP:  34 FE 0F 54 12 BC 33 6C 1D A8 E4 70 87 18 05 DC   4..T..3l...p....
ISAKMP:  DA 9B E3 05 44 D0 95 C0 D0 DE A1 CE CB CB 69 5F   ....D.........i_
ISAKMP:  3E 01 78 A6 55 66 6F E5 7A 1E 3F 61 65 6A F1 70   >.x.Ufo.z.?aej.p
ISAKMP:  9A AE B2 44 7B 15 BB 23 27 70 C4 4D CC 92 BA 6B   ...D{..#'p.M...k
ISAKMP:  E1 F2 B5 13 BC 6D C1 C3 66 19 D6 11 AD 9A C3 7B   .....m..f......{
ISAKMP:  93 FF 2E B9 67 D8 0A B0 A9 3F 20 98 92 C0 EA A2   ....g....? .....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  2F 16 0D 83 DB BC 50 DC 72 84 22 EF 48 A3 AA 97   /.....P.r.".H...
ISAKMP:  42 85 BE 59 6D 89 6C 61 DD C6 7D AF 34 76 64 3D   B..Ym.la..}.4vd=
ISAKMP:  98 5B B0 32 43 A4 37 B1 6B 09 21 3E E0 C0 39 43   .[.2C.7.k.!>..9C
ISAKMP:  CA 3F 5B 21 9B CB 59 9C 9D 6A F1 A4 92 06 7E 69   .?[!..Y..j....~i
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150) with ISAKMP Header Payload Length 312 bytes

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_xit
Au revoir!
Connection closed by foreign host.
ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.13: Passed

>> IKE-14.14
TEST_DESCRIPTION
IKE MUST not set the NP field of Security Association Payload to 
Transform Payload.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with NP field in SA not set to 
        Transform Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x119F (4511)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x295E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x0C29 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D8 8B B7 6F E5 7B 0C 6A                           ...o.{.j
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  BA 5B 26 E4 44 1A 4B C0 7F 0A 42 A3 FE 0E 2F 25   .[&.D.K...B.../%
ISAKMP:  B9 73 D6 5A 1D 22 79 13 9B 0E 9B 11 87 E9 92 8F   .s.Z."y.........
ISAKMP:  A1 FF 94 74 EC 29 DD 91 7B C7 7A AA 0A 01 54 5F   ...t.)..{.z...T_
ISAKMP:  D9 15 B4 8F 8B 29 80 B8 77 E1 84 9E A6 17 58 F4   .....)..w.....X.
ISAKMP:  A6 00 FC 1C 16 1E 8C 41 70 EC 48 83 2E 82 93 87   .......Ap.H.....
ISAKMP:  46 B1 1A E3 CD 9B C7 A6 8E DE 83 EF 61 FD 4F 02   F...........a.O.
ISAKMP:  50 6B BD 81 B6 48 AF F8 C9 CA 53 B0 8A A1 B0 B1   Pk...H....S.....
ISAKMP:  A4 42 67 90 9E B2 BE A3 F3 E8 47 86 2F 11 2F 58   .Bg.......G././X
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  9B 64 C5 9A 90 DA 8B 11 CC 53 1F 55 C1 D0 23 55   .d.......S.U..#U
ISAKMP:  B4 00 64 FE 97 F7 23 19 91 DE EF 29 53 4C 9F 4E   ..d...#....)SL.N
ISAKMP:  59 E9 F2 70 6F DE 21 1E 37 53 14 38 72 88 68 5C   Y..po.!.7S.8r.h\
ISAKMP:  84 39 39 72 2D FD 42 7B 80 E4 D3 00 B6 0B 39 C4   .99r-.B{......9.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with valid SA Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipikxit
Au revoir!
Connection closed by foreign host.
e.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.14: Passed

>> IKE-14.15
TEST_DESCRIPTION
There MUST NOT be multiple Proposal Payloads for a single SA Payload.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p9 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with only one Proposal Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11A0 (4512)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x295D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xC00A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8C 0C 5D AE 1E F6 38 48                           ..]...8H
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F5 CC 48 0B 1A B6 AA F1 55 71 85 26 C2 30 AF D3   ..H.....Uq.&.0..
ISAKMP:  0F 3E E9 41 FC D9 53 BB F0 CD 84 8B BE 6F B1 8F   .>.A..S......o..
ISAKMP:  F0 C1 CB E7 54 74 1F 25 06 44 F7 98 D2 1E 47 BF   ....Tt.%.D....G.
ISAKMP:  FF 8E FF 97 27 BD 92 F8 D6 77 EF B9 EC 54 42 76   ....'....w...TBv
ISAKMP:  1E C2 81 5C D2 5B 71 02 DD 23 85 52 52 C0 40 70   ...\.[q..#.RR.@p
ISAKMP:  F5 A5 7B 70 20 B8 8B EE 93 CC 28 EF B9 5A 8F A2   ..{p .....(..Z..
ISAKMP:  63 5F 52 9F BE 62 A8 0F C8 A0 46 D1 C7 8D 1B 05   c_R..b....F.....
ISAKMP:  B7 15 D0 D3 D6 E3 BD 13 BC 7D 72 71 42 BC 8A 9E   .........}rqB...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  54 CC DC E1 B0 1E 79 2B 12 C0 03 77 5B 89 06 1F   T.....y+...w[...
ISAKMP:  83 F4 4F 22 40 6B 11 10 73 13 49 52 54 F2 24 32   ..O"@k..s.IRT.$2
ISAKMP:  74 6C 33 DA 17 90 63 DC D8 C7 B0 56 33 8F A2 AC   tl3...c....V3...
ISAKMP:  9C E1 15 A2 08 61 B1 28 48 A8 5B B9 6E E9 DB 66   .....a.(H.[.n..f
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with only 1 Proposal Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipxit
Au revoir!
Connection closed by foreign host.
ike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.15: Passed

>> IKE-14.16
TEST_DESCRIPTION
IKE MUST set the REMAINING_BITS of the Flags field in
ISAKMP Header to 0.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p3 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with REMAINING_BITS in HDR set 
        to {0,0,0,0,0} 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11A1 (4513)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x295C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x7B78 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FE EF 92 C5 06 1A 56 CB                           ......V.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  37 25 C9 35 5F 22 0D C5 9D 4F F2 79 C4 5A 12 C8   7%.5_"...O.y.Z..
ISAKMP:  C3 2B DD DB BD 60 80 C5 46 76 60 31 11 42 E4 96   .+...`..Fv`1.B..
ISAKMP:  87 B2 3C 39 EE 4F 72 59 D6 A4 E8 9D CE 6C 75 1A   ..<9.OrY.....lu.
ISAKMP:  4D DD E3 53 7E A8 F9 9A E9 B2 C9 E1 B5 28 AD 03   M..S~........(..
ISAKMP:  1E 05 40 12 18 F8 10 94 49 6B 94 EF 4F B5 74 3D   ..@.....Ik..O.t=
ISAKMP:  6E CF 1A 27 F4 E7 FD 85 BB 8F 6C B0 CD D2 9D 50   n..'......l....P
ISAKMP:  AF 7C 73 78 2F F3 D0 30 9D 1C 6D A5 7C 3D 5F 88   .|sx/..0..m.|=_.
ISAKMP:  F6 FC 57 B1 03 9E C7 82 DE 40 AF 56 F7 AF B9 B6   ..W......@.V....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  08 3B A3 93 60 B7 6B 15 95 FC C8 32 F2 2A 92 59   .;..`.k....2.*.Y
ISAKMP:  2F 2D 13 21 65 FA E1 D5 FD F1 A3 EB 9C D3 C2 A9   /-.!e...........
ISAKMP:  65 5D 05 47 80 65 11 32 33 63 1F 98 56 FE 28 22   e].G.e.23c..V.("
ISAKMP:  53 02 CA 6A 8E AF 0F 4E 29 8D 91 E7 55 17 E8 9D   S..j...N)...U...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with valid Flags in Header

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1xit
Au revoir!
Connection closed by foreign host.
_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.16: Passed

>> IKE-14.18
TEST_DESCRIPTION
IKE MUST set the RESERVED field in ISAKMP Payloads to 0 in an outbound 
ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
-  DUT: Send <HDR,SA,KE,Ni,IDii> with RESERVED field 
        of SA, Proposal, Transform, KE, Ni and ID 
        all set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11A2 (4514)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x295B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x7131 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F2 46 E3 0E 25 00 76 23                           .F..%.v#
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  14 16 89 B4 28 51 9B 63 AB A4 73 3E F1 16 69 50   ....(Q.c..s>..iP
ISAKMP:  89 71 9F 5A 43 E2 CA 82 0F F0 66 AC A5 26 F9 71   .q.ZC.....f..&.q
ISAKMP:  63 0B 6B 52 49 C8 D7 77 A0 1D E1 67 18 FC 64 67   c.kRI..w...g..dg
ISAKMP:  6D 28 2E DC B1 64 D4 30 FF 92 20 6A 4A 47 5C EF   m(...d.0.. jJG\.
ISAKMP:  1F 89 85 54 11 49 50 73 74 CA B1 7C D1 93 DA 37   ...T.IPst..|...7
ISAKMP:  15 4C 83 DE 87 C5 59 CA 34 6D 11 86 8B 69 0F 06   .L....Y.4m...i..
ISAKMP:  C7 7E 3B A7 A3 4A 42 0E 73 05 F1 7F 35 57 96 A5   .~;..JB.s...5W..
ISAKMP:  09 9D 4E A0 CF 71 A2 72 05 5D 90 98 CA D4 39 2D   ..N..q.r.]....9-
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7C BD C3 27 52 58 B6 3C C2 52 E2 0F C1 4D 4C F2   |..'RX.<.R...ML.
ISAKMP:  1E E5 D5 1F 68 06 C8 05 62 1A 81 09 02 A0 3D DB   ....h...b.....=.
ISAKMP:  92 F4 00 43 86 EB D6 17 68 BD 7F B4 68 8B D2 02   ...C....h...h...
ISAKMP:  E0 37 D7 94 36 49 58 63 51 27 97 B8 69 F3 23 F9   .7..6IXcQ'..i.#.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii>
packet from DUT with RESERVED field of SA, Proposal,
Transform, KE, Nonce, ID set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVLxit
Au revoir!
Connection closed by foreign host.
_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.18: Passed

>> IKE-14.19
TEST_DESCRIPTION
IKE MUST set the RESERVED field of Hash Payload to 0 in an outbound
ISAKMP Packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
        with Authentication method is Pre-shared key
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>
-  DUT: Send <HDR,HASH_I> with RESERVED field in HASH_I set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11A3 (4515)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x295A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x2F5D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4D 6E 64 D8 BB 47 23 DC                           Mnd..G#.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  34 AE A0 F9 63 D4 DE 10 E2 64 11 7B 6C 16 EB 9A   4...c....d.{l...
ISAKMP:  99 7C 08 67 E9 A2 CA 1A 8B A4 98 B6 81 CB 1B 89   .|.g............
ISAKMP:  87 97 4F DC 3F 9D CE 1E E6 49 20 89 C7 58 7F 86   ..O.?....I ..X..
ISAKMP:  3D 89 5A AA 8C 86 C7 C5 78 EC 79 B9 EB 8C FA C3   =.Z.....x.y.....
ISAKMP:  5B B7 6C 81 B7 29 04 09 4D 41 78 AD D3 B9 9B 4F   [.l..)..MAx....O
ISAKMP:  33 E4 CD 1E 18 21 7B D0 DA 79 BB AB 89 91 ED EC   3....!{..y......
ISAKMP:  0C A8 DF 05 BD 32 2B EF 29 3C AC 93 14 7F CC 0E   .....2+.)<......
ISAKMP:  D8 6D 81 95 EA C1 76 C0 22 87 C9 C4 FA C7 CC 7C   .m....v."......|
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  05 A3 E2 CF EB 23 E3 92 7D 4C F8 3D 69 4D D1 99   .....#..}L.=iM..
ISAKMP:  70 32 71 E8 FF 0E 73 59 C8 6B 30 FD E3 BE D8 A9   p2q...sY.k0.....
ISAKMP:  FD 54 21 34 6B B7 8F E7 85 D4 3B 26 F0 77 91 ED   .T!4k.....;&.w..
ISAKMP:  AF 9F E0 30 46 13 03 9C 6C 16 11 75 1E 37 D6 D6   ...0F...l..u.7..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir,HASH_R> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B28 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x835D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4D 6E 64 D8 BB 47 23 DC                           Mnd..G#.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B8 39 C7 13 B9 84 7D 02                           .9....}.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  65 69 19 FB F8 3A 49 8B CF 02 6D 5F A6 70 2F 76   ei...:I...m_.p/v
ISAKMP:  AD 1F 10 45 28 5D E3 67 AD F9 07 86 B3 AA 57 09   ...E(].g......W.
ISAKMP:  90 5D 11 90 39 0D E2 D6 36 51 36 C3 8D 17 59 2F   .]..9...6Q6...Y/
ISAKMP:  D5 B7 3F E9 CE B5 56 A6 2A F7 97 0E C9 46 76 1D   ..?...V.*....Fv.
ISAKMP:  63 3D 72 2B 30 77 70 A3 EE 7C 72 9A F9 0F 4A CE   c=r+0wp..|r...J.
ISAKMP:  33 F8 1A 36 3F 19 BC 52 B6 4E 7D 14 25 27 77 DA   3..6?..R.N}.%'w.
ISAKMP:  7A 75 54 32 E4 7C 64 97 48 76 24 7D 59 91 FB BB   zuT2.|d.Hv$}Y...
ISAKMP:  10 45 23 14 F6 FA 77 65 30 54 02 D4 B5 65 86 FE   .E#...we0T...e..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A1 22 CB 1A 32 3A 76 36 7E E7 8D 71 87 0B 71 34   ."..2:v6~..q..q4
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  CD F7 0D 06 6D 63 5C 73 0C BC EC 50 D4 74 2A 30   ....mc\s...P.t*0
ISAKMP:  E1 EB D6 29                                       ...)
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x11A4 (4516)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A5D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 60 
UDP: Checksum         = 0x9586 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4D 6E 64 D8 BB 47 23 DC                           Mnd..G#.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B8 39 C7 13 B9 84 7D 02                           .9....}.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 52 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  D7 98 3C 5D AF 84 A0 AB 4A BD 53 84 0F 83 AA 79   ..<]....J.S....y
ISAKMP:  68 C0 80 F7                                       h...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:

Received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received <HDR,HASH_I> Packet with
reserved field of Hash Payload is set to zero

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename xit
Au revoir!
Connection closed by foreign host.
"/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.19: Passed

>> IKE-14.20
TEST_DESCRIPTION
IKE MUST set the Port field of Identification Payload to 0 or
UDP Port 500 in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Port field of IDii 
        to 0 or 500    
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11A7 (4519)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2956 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x6F99 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A2 E0 0A A1 BD D6 C2 55                           .......U
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5D C9 4A 8D E8 97 16 2C AD C0 66 6E 14 41 47 C0   ].J....,..fn.AG.
ISAKMP:  91 1B D9 A2 0E 8D 45 91 79 36 86 BA 51 BB 1A D6   ......E.y6..Q...
ISAKMP:  1C 5A B7 34 4B DF F9 97 C8 F2 32 69 9F 20 BC 69   .Z.4K.....2i. .i
ISAKMP:  BE 35 3A 48 86 20 25 22 63 BF E8 9C 3B 9D 65 04   .5:H. %"c...;.e.
ISAKMP:  F4 99 A8 B3 6A 85 F3 49 B9 49 E9 BF 24 C7 2F BF   ....j..I.I..$./.
ISAKMP:  EA FE 5B B7 87 16 8B 0A 7F 05 23 9C E5 64 33 E0   ..[.......#..d3.
ISAKMP:  3A F8 BE FF 8B EE 62 0F 1B 7A E4 8B D7 2C 57 35   :.....b..z...,W5
ISAKMP:  6E 74 2C 28 A6 4D F0 22 EF 95 98 20 30 42 10 BF   nt,(.M."... 0B..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  48 19 1C 1C 11 96 40 82 D9 76 70 8A 65 6E 5E 19   H.....@..vp.en^.
ISAKMP:  1A 26 E1 30 1D 12 22 EA 33 40 E3 71 14 00 6B F7   .&.0..".3@.q..k.
ISAKMP:  31 7E F5 BD 90 2B C8 A0 35 A4 35 F3 AD 46 8F 9F   1~...+..5.5..F..
ISAKMP:  72 5E 3D F4 1A 90 2C 40 76 3E 67 68 B1 51 67 C2   r^=...,@v>gh.Qg.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received ISAKMP Packet from DUT with
ID Port Field set to (0) (Should be 0 or 500)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ixit
Au revoir!
Connection closed by foreign host.
pike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.20: Passed

>> IKE-14.21
TEST_DESCRIPTION
IKE MUST set the Protocol ID field of Identification Payload to
0 or UDP 
Protocol(0x11) in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Protocol ID field of IDii 
        to 0 or UDP(0x11)    
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11A8 (4520)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2955 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x420B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  46 DE 5C BE C4 C7 5C 35                           F.\...\5
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  64 4A 3D BE E8 8F B9 84 5E 34 42 BF 19 B9 00 E9   dJ=.....^4B.....
ISAKMP:  3B C8 54 EB 33 03 4F F6 22 8A D7 69 B9 6C 12 4B   ;.T.3.O."..i.l.K
ISAKMP:  5D 44 04 5D 64 68 B4 8D F4 60 29 E4 F1 6F F9 4D   ]D.]dh...`)..o.M
ISAKMP:  73 C3 B3 7B A9 65 9D 86 F0 0B C3 A1 8F F0 E0 EE   s..{.e..........
ISAKMP:  E4 3A 22 F8 8C A6 E2 6D 7C CC 07 0E C9 7D 9F DB   .:"....m|....}..
ISAKMP:  6B FC 1B 62 1A C0 14 82 26 37 C6 97 1F 36 21 08   k..b....&7...6!.
ISAKMP:  13 56 11 53 93 BB 2C 3D EF F4 B7 87 A8 DC B6 FB   .V.S..,=........
ISAKMP:  F1 55 F0 34 2B 37 B9 39 38 BD C7 6F 57 C4 A7 3C   .U.4+7.98..oW..<
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  2E 4F AC FA 7D 54 77 C1 33 16 20 E8 FE E7 CE 60   .O..}Tw.3. ....`
ISAKMP:  36 FB FE B2 D9 99 FC B4 B8 22 14 9A B3 53 3E C4   6........"...S>.
ISAKMP:  41 CB A0 24 9C DC 43 29 2B 7D C9 4C D0 39 70 BF   A..$..C)+}.L.9p.
ISAKMP:  96 7C 98 0E FD 89 ED 9B A0 1C B5 56 24 99 6E 25   .|.........V$.n%
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
 from DUT with ID Protocol Field set to (0)
 (Should be 0 or UDP)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikevxit
Au revoir!
Connection closed by foreign host.
1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.21: Passed

>> IKE-14.22
TEST_DESCRIPTION
IKE MUST set the Payload Length field of the Nonce Payload between 8 
and 256 bytes in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Payload Length of Nonce 
        Payload to a number which lies in between 8 and 256
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11A9 (4521)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2954 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x4BC4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6B EA A8 EB 9D 85 7A A9                           k.....z.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A0 A7 B1 9F 29 55 BC CC 3C 5C 2C 63 52 47 7C 64   ....)U..<\,cRG|d
ISAKMP:  FD 90 02 98 0F 55 B0 D3 60 69 79 9D 4E E1 D0 32   .....U..`iy.N..2
ISAKMP:  99 3F 02 57 17 38 EB 20 AC 48 28 64 53 E2 48 6F   .?.W.8. .H(dS.Ho
ISAKMP:  46 CC B0 CA 0C 12 E3 14 A0 17 61 36 4F 75 33 85   F.........a6Ou3.
ISAKMP:  8F 36 34 C3 B1 56 1A 8E 7A 6A 6C A9 B3 56 C8 40   .64..V..zjl..V.@
ISAKMP:  71 DD 5C C8 65 1E 7E EB 61 86 6F 8B DF 78 16 F4   q.\.e.~.a.o..x..
ISAKMP:  DC D2 D8 ED 01 5A BB CE A4 4F EB 5F C9 1F 98 23   .....Z...O._...#
ISAKMP:  9E 2B 7B E2 33 B8 41 3E 93 78 8A 09 B9 D3 BB BA   .+{.3.A>.x......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7D 13 33 1A CE 6F 7C FE 24 98 A9 C1 94 4C 63 CB   }.3..o|.$....Lc.
ISAKMP:  7E 1E 11 F6 60 84 3B 89 8A 68 3C F3 88 F2 17 2D   ~...`.;..h<....-
ISAKMP:  7C C9 D0 4D 39 55 47 F7 1A 51 68 A1 00 AB 13 A4   |..M9UG..Qh.....
ISAKMP:  70 4C 52 E5 3A CA 69 D5 02 60 02 33 36 33 37 D1   pLR.:.i..`.3637.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii>
Packet from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
d ipd start ipike
ipd: start ipike ok
-> ex
-> cmd sysvar set -co ipike.filename "/romfit
Au revoir!
Connection closed by foreign host.
s/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.22: Passed

>> IKE-14.23
TEST_DESCRIPTION
IKE MUST set the Exchange Type field of ISAKMP Header to Aggressive 
in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2408 s5.2 p60 ISAKMP Header Processing
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
-  DUT: Send HDR,SA,KE,Nr,IDii setting the Exchange Type field to 
        Aggressive 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11AA (4522)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2953 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xDEAE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  32 70 63 1F 70 22 78 34                           2pc.p"x4
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  48 44 33 AB B7 7C AD D1 43 31 D2 69 0E 4B 75 BF   HD3..|..C1.i.Ku.
ISAKMP:  C5 FE AF 11 0C 27 6C A5 84 F7 BD DC F7 92 FC B3   .....'l.........
ISAKMP:  CB 65 D4 3C 83 20 05 91 98 45 8E D8 38 0C 6A 69   .e.<. ...E..8.ji
ISAKMP:  64 39 F6 DF A2 24 42 BD 48 A3 25 11 2F 27 14 86   d9...$B.H.%./'..
ISAKMP:  C2 B7 19 0A FC 49 2C 34 74 61 0F 25 CA 2B AD B5   .....I,4ta.%.+..
ISAKMP:  C1 5D E1 1C 09 77 28 D8 AC 3F 3D 2B 1C CB B0 50   .]...w(..?=+...P
ISAKMP:  E6 E5 05 14 66 F7 35 57 EE A4 6D 17 D5 AC 7C 91   ....f.5W..m...|.
ISAKMP:  EB 34 47 4E 5D 13 7F D7 9F 10 3D 1D 64 9E 26 83   .4GN].....=.d.&.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  CB 4F 35 35 BF CD AE 56 A0 5B A6 74 E4 33 CE E0   .O55...V.[.t.3..
ISAKMP:  D4 C4 50 0B 73 EE FB 18 E1 8D 2F A9 DC 92 4D AA   ..P.s...../...M.
ISAKMP:  44 BB 0E 11 1E AD C1 90 D8 40 1B 90 77 70 01 0E   D........@..wp..
ISAKMP:  11 A3 F1 02 64 30 29 99 C7 EE 84 7C EF A1 E9 02   ....d0)....|....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with Exchange Type in HDR set to
Aggressive
Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
d ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_xit
Au revoir!
Connection closed by foreign host.
resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.23: Passed

>> IKE-15.1
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with invalid Cookie
and MAY notify INVALID-COOKIE. 
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with CKY-I field
        set to <CKY-I> and CKY-R field set to <CKY-R>
-  DUT: Do not send <HDR,HASH_I>
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11AB (4523)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2952 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x1E0F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  94 20 E5 84 8F E1 2C 0A                           . ....,.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E7 A7 DE 22 97 3A 08 2D E4 40 89 86 C4 DF AA E1   ...".:.-.@......
ISAKMP:  3A 75 7E CC 69 A3 28 73 4F 56 8C FB 44 B5 0D 08   :u~.i.(sOV..D...
ISAKMP:  14 C4 DF 85 2D 25 41 45 85 D8 BC 54 2A 7B 79 DB   ....-%AE...T*{y.
ISAKMP:  BA 6C A2 20 C6 A9 75 FF D1 4D 4A B2 37 52 16 A0   .l. ..u..MJ.7R..
ISAKMP:  86 9A F8 FF ED 8F F3 AD 5F 84 13 0A 66 87 96 20   ........_...f.. 
ISAKMP:  C3 E6 51 D6 E9 D2 91 0E 1C 99 84 7F 3B 6E 49 42   ..Q.........;nIB
ISAKMP:  B0 E9 8A E9 70 F2 8D 1B 96 92 B8 B4 FB 4C B8 AF   ....p........L..
ISAKMP:  E1 9B 3A 59 F5 02 6C C8 3C 4E 55 F0 C2 33 94 D1   ..:Y..l.<NU..3..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  70 A3 A8 50 69 FE 62 C2 05 B2 55 E4 D4 33 6C 9B   p..Pi.b...U..3l.
ISAKMP:  C6 0A 4C 7D DF 6A C4 DE C8 FB 82 81 0D 55 BC 2F   ..L}.j.......U./
ISAKMP:  5F 32 92 C4 E0 94 80 CB 85 93 C7 FF C1 29 81 4C   _2...........).L
ISAKMP:  F8 17 2D C6 AA 8F 50 36 00 EA 75 94 71 67 E3 C4   ..-...P6..u.qg..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Case:1 Set CKY-I to 0 and CKY-R to 0.

Sending  <HDR,SA,KE,Nr,IDir,HASH_R> Packet with CKY-I field
set to <CKY-I> and CKY-R field set to <CKY-R>
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0002 (2)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B27 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0xFF58 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  56 A8 63 61 C1 AA E8 9F 30 EC 68 B8 D9 2A FD 3C   V.ca....0.h..*.<
ISAKMP:  8B AF E1 AD A2 F2 3C 4B CF C9 C5 7B 96 7A A9 BB   ......<K...{.z..
ISAKMP:  9A B5 5A 31 14 7F 93 68 76 46 DA 53 9B 4F 76 A0   ..Z1...hvF.S.Ov.
ISAKMP:  A1 8B 9B FB 2E E9 41 87 C6 22 52 FE CE FC 0B 39   ......A.."R....9
ISAKMP:  68 C6 CF EE BC BC 9D 62 EE 35 4D 2F BC D7 E1 27   h......b.5M/...'
ISAKMP:  37 0F 49 41 00 72 BF 07 F6 A7 54 7A F0 75 E1 AE   7.IA.r....Tz.u..
ISAKMP:  7C 0E 63 DF 6B 3B 21 54 D4 C0 D7 E8 F4 91 4D D2   |.c.k;!T......M.
ISAKMP:  4F 19 C2 60 F2 6D 0F D1 D3 72 9B 28 56 16 7C 5D   O..`.m...r.(V.|]
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  C6 18 23 37 8C A0 6D E0 1C 8B 6F B1 48 C9 BC 93   ..#7..m...o.H...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  1F 8D D9 32 BB BB 8E C4 26 C4 9C 56 EF D4 86 CD   ...2....&..V....
ISAKMP:  AF F3 51 2E                                       ..Q.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11AC (4524)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A61 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xACC0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar sexit
Au revoir!
Connection closed by foreign host.
t -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11AD (4525)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2950 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xFF4A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EA D1 19 43 BC F9 6F B5                           ...C..o.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  63 25 C3 3A 60 B4 EE A9 3B FB 40 8C 20 4A 5C E0   c%.:`...;.@. J\.
ISAKMP:  AB BA 25 1D B1 8B CA 3C AC 13 88 E5 60 76 8A 33   ..%....<....`v.3
ISAKMP:  E2 55 70 FD 2C D4 F8 E9 F8 04 5F 73 43 3F E9 65   .Up.,....._sC?.e
ISAKMP:  29 C1 76 54 C6 E6 9A 0A DD 97 F1 A5 46 70 7B 8E   ).vT........Fp{.
ISAKMP:  E6 67 44 22 1E 2D C3 F9 13 31 D4 BB B5 94 40 F8   .gD".-...1....@.
ISAKMP:  A0 1F E5 1A BE 72 43 A7 9C 76 83 80 B0 CB D0 9E   .....rC..v......
ISAKMP:  07 65 87 FE C0 6F AB 33 86 0A 5C 01 E8 B5 AC 69   .e...o.3..\....i
ISAKMP:  62 3F F7 90 39 F3 91 77 B2 CB 26 82 49 83 A3 EC   b?..9..w..&.I...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  65 88 76 ED 97 4D F5 2E 0A 5D 3C A3 D5 DA F5 D1   e.v..M...]<.....
ISAKMP:  1F 25 65 47 61 24 45 EC 03 AA 4A 96 FE 93 E0 6E   .%eGa$E...J....n
ISAKMP:  A2 02 4A 37 C8 5D D3 29 AB E6 A6 3B 4A E8 97 B0   ..J7.].)...;J...
ISAKMP:  DD 30 D2 31 16 01 28 80 B5 CB C7 F2 AC 33 EE 6D   .0.1..(......3.m
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending  <HDR,SA,KE,Nr,IDir,HASH_R> Packet with CKY-I field
set to <CKY-I> and CKY-R field set to <CKY-R>
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B26 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0xF6B4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  82 4E 6F A6 56 38 05 86 8C 47 E4 20 3D 30 56 DC   .No.V8...G. =0V.
ISAKMP:  75 1A D0 8A 9B D4 2A A7 9F B9 E0 7B 31 7D 20 3C   u.....*....{1} <
ISAKMP:  F4 FF 1D 4C 9E AD 41 3C 52 8B 94 49 35 9C 6E 05   ...L..A<R..I5.n.
ISAKMP:  AB 24 E5 85 EB 58 8D 61 45 41 EE 05 48 0C DF 5B   .$...X.aEA..H..[
ISAKMP:  5C 17 A2 60 0E BE 10 AD B1 B9 1E 03 75 4B 43 18   \..`........uKC.
ISAKMP:  37 D3 9E E5 92 89 43 C8 B4 81 01 85 5A 6E 24 5D   7.....C.....Zn$]
ISAKMP:  E2 1B BC 52 50 96 B2 E0 F3 E2 A4 67 CD D9 1B D6   ...RP......g....
ISAKMP:  8A A0 B4 DF F0 2C A0 82 D4 61 76 4D A2 A3 59 FA   .....,...avM..Y.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6D 5E 85 02 2C A2 A2 C3 83 C2 8E 85 AD 03 8C 37   m^..,..........7
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  AF 2F DA D1 EF 1F A0 8A 1B C8 76 BE 29 86 55 68   ./........v.).Uh
ISAKMP:  1D 20 DF 25                                       . .%
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11AE (4526)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A5F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA8BC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVLxit
Au revoir!
Connection closed by foreign host.
_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.1: Passed

>> IKE-15.2
TEST_DESCRIPTION
IKE MUST notify INVALID-COOKIE for an incoming ISAKMP packet with 
invalid Cookie. 
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> CKY-I field set to
        <CKY-I> and CKY-R field set to <CKY-R>
-  DUT: Notify INVALID-COOKIE
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11AF (4527)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x294E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xB492 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6F B9 70 1D 54 39 B7 AC                           o.p.T9..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6B 2E 35 E9 A8 33 CA C8 CA 51 08 B4 4F F4 55 E3   k.5..3...Q..O.U.
ISAKMP:  B0 22 78 50 70 AF 3D A1 6B F6 1B 9E B3 4F D1 2E   ."xPp.=.k....O..
ISAKMP:  ED 11 0D EC 91 0F 0F 4B 8C BC 3B 6F 7F A1 1B C0   .......K..;o....
ISAKMP:  16 F2 9D FE C3 4E E7 4C 4A FA DD F2 1B 52 9C 92   .....N.LJ....R..
ISAKMP:  AC C6 F9 12 56 5D 60 A5 9B BD 04 6F B6 EB 50 3A   ....V]`....o..P:
ISAKMP:  4A D4 D4 9E 9D 74 08 D2 11 AB C7 2F D6 54 B5 9C   J....t...../.T..
ISAKMP:  7A D3 C7 05 3E DC F4 A9 A9 E8 A7 3D DA 3F CD 92   z...>......=.?..
ISAKMP:  7D 8F BB AD 74 86 3B 63 98 67 28 F3 BE A4 72 B7   }...t.;c.g(...r.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  91 60 E5 9A 7F FE 22 02 7B D9 03 20 FC 12 CF D3   .`....".{.. ....
ISAKMP:  E9 80 97 9E F0 20 B5 5B B0 6B EC DC E6 91 89 82   ..... .[.k......
ISAKMP:  99 35 96 2A 36 CA 7F 48 D6 E4 34 EF 2D 6C EA 11   .5.*6..H..4.-l..
ISAKMP:  B7 A3 CC C4 51 75 DF 5E 9C 55 29 DC 9D 74 22 9D   ....Qu.^.U)..t".
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Case:1 Set CKY-I to 0 and CKY-R to 0.

Sending <HDR,SA,KE,Nr,IDir, HASH_R> CKY-I field set to
<CKY-I> and CKY-R field set to <CKY-R> to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B25 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x49FF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  29 69 1C 6E 29 93 CB C4 2C E3 80 02 C5 22 3C F0   )i.n)...,...."<.
ISAKMP:  53 B2 A8 60 55 69 1D D7 38 62 8A F8 6A 2D 3C 39   S..`Ui..8b..j-<9
ISAKMP:  0D B9 73 1F 9E A5 67 91 C2 5C 28 BB 7F 04 04 6D   ..s...g..\(....m
ISAKMP:  11 8E 68 21 F2 1A 6C 48 59 1A CC A7 6C 2F A7 64   ..h!..lHY...l/.d
ISAKMP:  63 A2 F4 8E 0C AE 4F 7F B7 EF 98 7C 1B 0C 80 99   c.....O....|....
ISAKMP:  E5 17 BB F9 75 94 6E C5 48 DB 57 93 FB B3 41 46   ....u.n.H.W...AF
ISAKMP:  C1 88 C9 02 AF 4B DD C6 6B 55 0F 9E D3 7F F2 1F   .....K..kU......
ISAKMP:  43 3E D9 58 80 1C 53 FD 2F 59 E0 1A 55 BE CE 24   C>.X..S./Y..U..$
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  42 A0 4A 98 9C 58 00 52 8E F6 87 C9 78 35 5E 9C   B.J..X.R....x5^.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E0 FD 6D 7F 83 1E D5 BE D3 36 55 7A 83 4A 4F 19   ..m......6Uz.JO.
ISAKMP:  A5 7C 10 83                                       .|..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11B0 (4528)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A5D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xACC0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikevxit
Au revoir!
Connection closed by foreign host.
1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11B1 (4529)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x294C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x9CA8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A1 6F 26 F9 AC 8F B6 4E                           .o&....N
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  14 DA 4C 38 61 FE 00 52 90 3D 95 D6 70 58 AE D5   ..L8a..R.=..pX..
ISAKMP:  E9 EF 92 8E 3E B7 6D FB FA 80 F2 C0 FC 0D DB 19   ....>.m.........
ISAKMP:  2E 14 FD 25 7B C4 87 32 E4 71 2F F9 B5 04 07 F7   ...%{..2.q/.....
ISAKMP:  10 21 97 6A A4 33 3A BF 5B C6 CE 5B 80 2E 8C 21   .!.j.3:.[..[...!
ISAKMP:  58 18 82 B4 94 71 9F 90 40 FD 10 B2 D0 4D B1 A8   X....q..@....M..
ISAKMP:  9B 20 78 08 E7 BB FC 67 6D 33 2D 30 1E 16 1B A4   . x....gm3-0....
ISAKMP:  7F CE 0E 73 58 8A A7 D8 20 0B E1 6A 23 11 1F 3F   ...sX... ..j#..?
ISAKMP:  2F E3 CA 02 2E 3E 4F B2 08 F5 39 19 E4 AB AB BE   /....>O...9.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F6 0A 71 A6 85 65 E0 E2 FF 93 D2 94 2A 75 C9 F3   ..q..e......*u..
ISAKMP:  05 AB 95 00 9C BE E0 7C D1 D7 81 68 90 C3 78 FA   .......|...h..x.
ISAKMP:  A0 08 60 67 41 32 F8 7F 61 7D 4C 67 1B 4B 33 5D   ..`gA2..a}Lg.K3]
ISAKMP:  8C E0 CF B7 62 A2 0B EE 93 DB 9D 49 1B 3E 07 64   ....b......I.>.d
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending <HDR,SA,KE,Nr,IDir, HASH_R> CKY-I field set to
<CKY-I> and CKY-R field set to <CKY-R> to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B24 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0xB873 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  29 E3 9A 16 4C 25 B1 7B BC 61 04 2C EA A7 22 52   )...L%.{.a.,.."R
ISAKMP:  D3 A8 9D C4 FD 9B F9 B4 B5 92 F8 CB 84 BB 7B 74   ..............{t
ISAKMP:  54 BE 2D 62 5E 6C 7C 64 E9 CF 33 EF 7F 5C 6E 5E   T.-b^l|d..3..\n^
ISAKMP:  F0 00 1D 2E 2B 44 C4 57 BD D0 71 74 72 08 BB 98   ....+D.W..qtr...
ISAKMP:  A1 34 60 F7 60 A6 51 D6 A3 B8 0A 96 CC 4F 11 7D   .4`.`.Q......O.}
ISAKMP:  26 1D 79 35 0F C5 4E C3 81 A2 44 FA 77 29 84 03   &.y5..N...D.w)..
ISAKMP:  63 8A DA 8A 33 9B 5A B5 29 7E 44 15 8D 55 B3 28   c...3.Z.)~D..U.(
ISAKMP:  0E 4A B5 9A 6B C8 E5 06 E5 C6 DE AF 15 E6 4E F8   .J..k.........N.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E8 7E EF A9 51 79 CA 11 BE DC DF 42 0E B6 DF 91   .~..Qy.....B....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  07 B4 E7 BF 22 E7 B9 A4 C1 DF 66 B2 39 51 2F B6   ....".....f.9Q/.
ISAKMP:  B1 3E 96 BF                                       .>..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11B2 (4530)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A5B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA8BC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_rxit
Au revoir!
Connection closed by foreign host.
esp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.2: Passed

>> IKE-15.3
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with a Major Version
number larger than its own and MAY notify INVALID-MAJOR-VERSION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> Major Version set
        to DUT_IKE_MAJ_VER + 1
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11B3 (4531)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x294A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x82EF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  25 A7 BF BA 4A 6A 6C 3B                           %...Jjl;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AA 8B 59 28 1C 7E 78 12 99 A6 C1 D0 2C 9F C6 7D   ..Y(.~x.....,..}
ISAKMP:  9A D8 62 77 47 ED 74 4C 1E C1 6C A4 15 F9 6B 78   ..bwG.tL..l...kx
ISAKMP:  64 8A B1 63 D8 6C 7A 34 5A E5 08 1E 72 FB 26 38   d..c.lz4Z...r.&8
ISAKMP:  47 E0 C4 5E 4A 64 9B 55 44 3E CD 35 A3 28 7D 3D   G..^Jd.UD>.5.(}=
ISAKMP:  B2 4F A3 3C 41 3C 71 32 54 7D 6E DB 95 CB C5 F5   .O.<A<q2T}n.....
ISAKMP:  83 CB FA 45 31 D8 5D 6C D3 FB 43 AC 9B 0F 8B 5E   ...E1.]l..C....^
ISAKMP:  A3 C8 07 B8 83 C6 5C 24 C5 25 C6 29 32 F5 0A 39   ......\$.%.)2..9
ISAKMP:  CE C2 DB 92 5A 96 84 1B ED 1A 21 BA 93 8F C2 B3   ....Z.....!.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  12 BC B9 F4 E0 CD D1 3E DC FA B8 74 34 47 97 63   .......>...t4G.c
ISAKMP:  EA F8 E8 DE FA C8 1A CF 8C 7B 22 33 F0 78 4B 04   .........{"3.xK.
ISAKMP:  3A 4F 61 88 E8 2B 01 E9 A4 7E 94 30 96 0F 2A D2   :Oa..+...~.0..*.
ISAKMP:  29 46 AD AB B4 22 D5 0F 2A 73 9D E0 1E 31 21 73   )F..."..*s...1!s
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> packet with Major Version set
to 2 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B23 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x3799 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  25 A7 BF BA 4A 6A 6C 3B                           %...Jjl;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  29 44 7B 79 57 60 4A 43                           )D{yW`JC
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  FF 31 C3 2D E0 2F 49 27 4D 4C 3B 64 22 C6 30 8C   .1.-./I'ML;d".0.
ISAKMP:  55 D0 A4 47 93 5E 5F 4D E6 40 AD 9D 25 49 15 4B   U..G.^_M.@..%I.K
ISAKMP:  FE B6 AB 15 DF 7A 72 B0 84 EF 90 FB 0E EE BE 61   .....zr........a
ISAKMP:  96 4C 52 62 8E 21 C6 4B 61 E9 B6 31 EC 5C 72 05   .LRb.!.Ka..1.\r.
ISAKMP:  B1 81 EF 26 47 4C 2E B0 93 2C 16 3E 4D 3D 3B 8A   ...&GL...,.>M=;.
ISAKMP:  F0 1C B7 44 77 39 1C 40 A9 1C 81 75 03 4E 43 0C   ...Dw9.@...u.NC.
ISAKMP:  30 18 31 49 5F D3 C2 3B 7C 5E 9C 9F EB 2D 4A 3C   0.1I_..;|^...-J<
ISAKMP:  0E BE 30 AE 22 AA 4C 45 89 AE 51 4A 31 B1 61 A3   ..0.".LE..QJ1.a.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  44 38 AD 87 6E C0 F7 AC 22 79 29 88 BB 6C D7 83   D8..n..."y)..l..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  59 82 A7 66 63 DC C6 8A C2 0A 16 5E 73 23 BC 2E   Y..fc......^s#..
ISAKMP:  7A A6 0B E0                                       z...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11B4 (4532)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A49 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x19D7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  25 A7 BF BA 4A 6A 6C 3B                           %...Jjl;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xF2256763
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 5 (Invalid Major Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  25 A7 BF BA 4A 6A 6C 3B 00 00 00 00 00 00 00 00   %...Jjl;........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
d ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikexit
Au revoir!
Connection closed by foreign host.
v1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.3: Passed

>> IKE-15.4
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with a Major Version number
larger than its own and MUST notify INVALID-MAJOR-VERSION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Major Version set to 
        DUT_IKE_MAJ_VER + 1
-  DUT: Notify with INVALID-MAJOR-VERSION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11B5 (4533)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2948 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xD3F9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1A 3B B0 DB 52 90 B9 9C                           .;..R...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  27 B6 15 20 95 85 F8 25 B1 C5 CB 27 68 E8 F1 F5   '.. ...%...'h...
ISAKMP:  21 38 34 A7 FF 43 CB 5B 83 6E 1F DB B9 14 D4 9D   !84..C.[.n......
ISAKMP:  9D EA 23 6F 75 41 B7 8B F6 F3 E0 83 1D 5B 54 5A   ..#ouA.......[TZ
ISAKMP:  88 05 F8 49 4C 11 31 C2 48 DD 07 3B D5 EF E7 7D   ...IL.1.H..;...}
ISAKMP:  E1 EE CC A5 1C 5E 5A DD B6 DE D6 CA 3F F1 E1 9D   .....^Z.....?...
ISAKMP:  C4 0B E1 C1 05 3D 7E 90 D5 90 12 7E 08 2B BF DC   .....=~....~.+..
ISAKMP:  DA 62 31 3E 37 5C 3E 7F 79 8A A6 4F 5B A7 F6 2A   .b1>7\>.y..O[..*
ISAKMP:  D0 37 0C 49 F2 E8 9B 73 40 47 81 C7 64 F5 D2 3B   .7.I...s@G..d..;
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  60 A7 F6 18 24 9E E2 25 43 FA 29 26 E4 03 3F 68   `...$..%C.)&..?h
ISAKMP:  9D D5 B1 65 DB 70 C5 8E 55 5C 58 0C 66 6A 59 BF   ...e.p..U\X.fjY.
ISAKMP:  CB C0 C5 AA CA 00 4D 88 ED FB 52 C4 E6 8E 73 2D   ......M...R...s-
ISAKMP:  20 A7 9D E7 1D 92 41 8A E6 DE F9 FE E6 FA 47 8A    .....A.......G.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> packet with Major Version set
to 2 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B22 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0xD3F3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1A 3B B0 DB 52 90 B9 9C                           .;..R...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  45 84 F5 33 A0 FB 62 7E                           E..3..b~
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  28 2D 76 A1 83 34 D8 0A 98 C7 43 3C 52 42 30 40   (-v..4....C<RB0@
ISAKMP:  14 61 4D 23 84 B2 05 84 27 7C CA B5 EB AE 51 2D   .aM#....'|....Q-
ISAKMP:  76 7D 11 9B 78 FC A9 AB 9B 8C 86 C7 23 3D 1D 56   v}..x.......#=.V
ISAKMP:  2F C2 93 7B EE BC 7A AD F2 CA AE 99 A4 62 66 F1   /..{..z......bf.
ISAKMP:  1F DB AB 2C 2C 01 97 02 D5 69 B3 18 F6 DA 2F BD   ...,,....i..../.
ISAKMP:  81 F7 F6 96 3D 05 FE 8F 07 80 F3 C2 CD 9E 48 D0   ....=.........H.
ISAKMP:  BA BF 70 39 35 9D 24 28 18 F0 56 74 6D 05 95 5D   ..p95.$(..Vtm..]
ISAKMP:  01 85 C8 40 4E 33 EC 76 06 63 6F 8D 95 B9 74 47   ...@N3.v.co...tG
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A 56 25 49 D4 33 C6 00 E3 A4 08 5C 12 35 35 AA   *V%I.3.....\.55.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  08 5A BF A7 12 6E A8 D2 2D 84 37 BA FA A1 EC A3   .Z...n..-.7.....
ISAKMP:  C3 2E 91 33                                       ...3
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11B6 (4534)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A47 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x2696 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1A 3B B0 DB 52 90 B9 9C                           .;..R...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6C8CF89
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 5 (Invalid Major Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  1A 3B B0 DB 52 90 B9 9C 00 00 00 00 00 00 00 00   .;..R...........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 5

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> ex
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1it
Au revoir!
Connection closed by foreign host.
_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.4: Passed

>> IKE-15.5
TEST_DESCRIPTION
IKE SHOULD never accept inbound ISAKMP packets with a Minor Versioin
number larger than its own and MAY notify INVALID-MINOR-VERSION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 
        DUT_IKE_MIN_VER + 1
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11B7 (4535)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2946 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xBA8E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C4 85 10 7D 5B CE ED D3                           ...}[...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  EB D6 2F 4D 02 67 A8 C7 0B 03 E3 04 7C 9C 39 E5   ../M.g......|.9.
ISAKMP:  CD 5B 47 67 67 55 59 B9 8D 0C C0 19 22 7B 1A BF   .[GggUY....."{..
ISAKMP:  D7 C8 6A 64 70 94 02 8E 83 6C 72 FF 2A F5 1E 0E   ..jdp....lr.*...
ISAKMP:  39 D0 C4 A8 6C B7 41 1F 01 76 69 E6 FF CB 0C 73   9...l.A..vi....s
ISAKMP:  AA 72 23 55 A4 48 4D E9 54 BF 7F CC 0F 9B 4F 7E   .r#U.HM.T.....O~
ISAKMP:  55 D2 7C 59 1E 5D AE 45 57 EC 51 64 20 2D FA F3   U.|Y.].EW.Qd -..
ISAKMP:  88 50 BD 6A 6C 23 06 DC CD 71 78 8E B6 A0 0F 49   .P.jl#...qx....I
ISAKMP:  93 6F 73 C0 20 E6 89 3B 6E 59 28 B7 0B 9D E6 FF   .os. ..;nY(.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AB 26 05 F0 1E AD CA 30 2B 81 9C 6E 31 2E E2 25   .&.....0+..n1..%
ISAKMP:  17 51 A6 02 E1 30 0D 5D 19 4F CE FD EC C0 23 F4   .Q...0.].O....#.
ISAKMP:  91 15 70 46 1D E1 DE 31 8D 36 66 AD C1 84 09 CC   ..pF...1.6f.....
ISAKMP:  28 AC 66 17 4A 10 9A E2 4D D9 E8 1A 1D 46 F3 41   (.f.J...M....F.A
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 0
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x6F00 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C4 85 10 7D 5B CE ED D3                           ...}[...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  AA 35 5A 0A 23 F7 4B 13                           .5Z.#.K.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 1
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  40 94 36 47 26 3E 03 4E 74 AA A7 73 1D CA 05 DC   @.6G&>.Nt..s....
ISAKMP:  8F 27 6A 97 C4 87 67 01 79 47 04 3E 23 C4 09 40   .'j...g.yG.>#..@
ISAKMP:  40 64 67 12 C6 31 BE B6 42 A9 95 74 CE 08 18 AA   @dg..1..B..t....
ISAKMP:  DA 0F 59 0E 3C 15 85 41 81 B1 28 0A 0D 09 92 1A   ..Y.<..A..(.....
ISAKMP:  3E E1 07 D6 B2 14 08 5C 1A 16 51 C5 7F 75 5D D8   >......\..Q..u].
ISAKMP:  B8 D4 DE B5 BE 73 D6 DA 61 C4 87 32 8F 3B 0F 8D   .....s..a..2.;..
ISAKMP:  32 18 6E 90 15 CD 73 21 24 BA A7 88 9F 69 30 CB   2.n...s!$....i0.
ISAKMP:  1F F1 55 CC 46 14 B2 1A E8 66 EE 6E D7 C7 C3 FF   ..U.F....f.n....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D8 BF FC DD 82 50 4C 05 A2 41 E2 67 42 F0 A8 67   .....PL..A.gB..g
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  5B 70 45 3A F3 C7 45 43 06 30 C0 8B 54 FE 3C D4   [pE:..EC.0..T.<.
ISAKMP:  EB E5 52 8C                                       ..R.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11B8 (4536)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A45 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6AD7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C4 85 10 7D 5B CE ED D3                           ...}[...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE88A1AC2
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  C4 85 10 7D 5B CE ED D3 00 00 00 00 00 00 00 00   ...}[...........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ixit
Au revoir!
Connection closed by foreign host.
kev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.5: Passed

>> IKE-15.6
TEST_DESCRIPTION
IKE SHOULD never accept inbound ISAKMP packets with a Minor Version
number larger than its own and MUST notify INVALID-MINOR-VERSION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 
        DUT_IKE_MIN_VER + 1
-  DUT: Notify with INVALID-MINOR-VERSION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11B9 (4537)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2944 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x6283 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  16 C9 08 95 EC 94 DC EB                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  FE 43 20 19 C3 37 B6 B9 AB ED 0D 31 5F 5E 89 0C   .C ..7.....1_^..
ISAKMP:  73 99 92 6A 9E 64 2C 94 9A D4 ED 04 6E 35 70 2E   s..j.d,.....n5p.
ISAKMP:  A4 B3 3B 61 37 47 50 8B B7 3D 09 80 58 42 9B 85   ..;a7GP..=..XB..
ISAKMP:  7C 71 5A 54 69 A3 D7 57 02 3D 16 8F DC CB D8 25   |qZTi..W.=.....%
ISAKMP:  FB 83 75 B1 15 56 E8 B9 8C 46 6A 6E BD B1 C9 91   ..u..V...Fjn....
ISAKMP:  5D F8 80 D3 AF 4C F5 CD 29 A8 72 18 EE 61 42 C6   ]....L..).r..aB.
ISAKMP:  72 7D 41 37 B0 52 89 EB DE E5 40 0B 07 F9 DD 43   r}A7.R....@....C
ISAKMP:  7E FD DF 26 26 2C AF 24 0D 23 BE 9A C4 03 9B 67   ~..&&,.$.#.....g
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D6 00 A6 26 2B 63 92 66 94 EE 29 DD 52 C6 39 E0   ...&+c.f..).R.9.
ISAKMP:  E6 8B C3 90 7A 20 C5 FA 5E D4 C5 84 33 D9 E0 3B   ....z ..^...3..;
ISAKMP:  DF 2F A7 68 73 BF 9B 25 3E AD 99 AE D1 AE 7A FC   ./.hs..%>.....z.
ISAKMP:  C9 B4 75 79 64 E0 22 49 73 72 86 BE D3 AA 60 73   ..uyd."Isr....`s
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 0
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B20 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x3EE6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  16 C9 08 95 EC 94 DC EB                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  2C A4 32 12 55 95 E5 5C                           ,.2.U..\
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 1
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6E 44 B5 4A F2 E4 66 14 B1 11 51 27 CE 75 87 0B   nD.J..f...Q'.u..
ISAKMP:  46 2B 4C DA 93 95 BE D1 78 41 51 5B 54 7C 59 11   F+L.....xAQ[T|Y.
ISAKMP:  B5 39 93 70 25 09 74 EC CC 58 BD 03 96 4A 81 99   .9.p%.t..X...J..
ISAKMP:  81 C2 50 73 2E 42 A2 4F A8 39 ED 12 81 09 DD 24   ..Ps.B.O.9.....$
ISAKMP:  47 F7 DD DC 7E 60 1D A4 C0 31 8B B7 02 F0 5C 14   G...~`...1....\.
ISAKMP:  2A 20 FB 86 49 66 56 46 D2 DC A3 66 9E C5 20 8C   * ..IfVF...f.. .
ISAKMP:  8B 7E 3C 24 94 42 9C D4 31 69 4D 8D 25 71 45 C8   .~<$.B..1iM.%qE.
ISAKMP:  46 73 4A 55 B7 70 2D 31 D0 4F D2 F7 8C CB 56 7A   FsJU.p-1.O....Vz
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  62 5D 3A 9B 09 7E C8 51 0E 01 71 04 EA 45 6E CA   b]:..~.Q..q..En.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  33 83 8D DB 1D 3E F3 E8 CA F2 19 8B 88 5C C2 C7   3....>.......\..
ISAKMP:  53 AE 13 EF                                       S...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11BA (4538)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A43 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x32C3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  16 C9 08 95 EC 94 DC EB                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xDC89925
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  16 C9 08 95 EC 94 DC EB 00 00 00 00 00 00 00 00   ................
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 6

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikexit
Au revoir!
Connection closed by foreign host.
v1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.6: Passed

>> IKE-15.7
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet for non zero
Message ID field and MAY notify INVALID-MESSAGE-ID.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
        HDR set to <prm_inv_ph1_msg_id>
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11BB (4539)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2942 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x6E22 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EB 8E 0C 6A 47 A2 84 1F                           ...jG...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4C 01 96 63 81 F6 80 26 C6 A9 08 09 83 0C B6 AF   L..c...&........
ISAKMP:  5B E5 E0 CD C2 55 7D 83 96 81 44 5D 4E 57 D0 FA   [....U}...D]NW..
ISAKMP:  16 8B F2 DB B9 85 53 93 DB FA AA E5 98 C4 B4 E1   ......S.........
ISAKMP:  57 82 AC 5B 28 24 41 F5 65 6B 32 1E 1F 68 93 3D   W..[($A.ek2..h.=
ISAKMP:  33 3D 11 AA 38 65 11 33 9E 34 9E 4D 0D 08 B2 D8   3=..8e.3.4.M....
ISAKMP:  EC B4 AC FF 0D F1 B2 34 A5 2C 53 50 9B CE 14 B8   .......4.,SP....
ISAKMP:  FA 34 DA C8 14 2A 7E 0C B0 DA FD BC F5 A2 31 9B   .4...*~.......1.
ISAKMP:  F2 7F 49 6B 61 99 59 4A B2 81 B8 BE 37 20 6D 6E   ..Ika.YJ....7 mn
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  5E F0 3D 1F FD 62 00 C2 82 F3 8A 4A 8B 92 23 E5   ^.=..b.....J..#.
ISAKMP:  70 74 35 33 88 C0 82 FD 55 35 5E 01 97 A5 7D 03   pt53....U5^...}.
ISAKMP:  71 8D 69 90 C9 09 6F AB 80 B3 F6 A7 7B FE AA 87   q.i...o.....{...
ISAKMP:  10 B7 96 46 1F 9B 4F 09 56 C7 1C B5 BC 3E D2 FE   ...F..O.V....>..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
HDR set to <prm_inv_ph1_msg_id> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x65DD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EB 8E 0C 6A 47 A2 84 1F                           ...jG...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FA 0D A1 79 FB 86 8F 03                           ...y....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DF 72 75 3B DD CA 1C 0F 16 83 67 7F 18 07 EB 0C   .ru;......g.....
ISAKMP:  F4 DF CE DB 59 FE AF 50 CE B4 32 B6 5C F1 7F D6   ....Y..P..2.\...
ISAKMP:  DD 2F CE F5 E7 CF CB B6 F3 EE 51 65 4A 9B A9 16   ./........QeJ...
ISAKMP:  49 5D 55 FF 06 52 C8 3D 58 58 86 37 F6 CB 8E 27   I]U..R.=XX.7...'
ISAKMP:  7C 3E 75 E8 CA 52 10 DD D3 DD 80 F1 D3 3D 7A 0B   |>u..R.......=z.
ISAKMP:  E8 12 9C 4C 6C 51 AD DC 75 4A B4 52 6E 9F 45 87   ...LlQ..uJ.Rn.E.
ISAKMP:  BA C2 ED FB BD 7D 6F F0 A9 FF 47 34 A7 7D D1 E4   .....}o...G4.}..
ISAKMP:  87 A1 E0 93 84 0A 30 5E 48 8C 49 80 0C 46 CC A3   ......0^H.I..F..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F5 CD C9 CD BD 93 59 A5 BB 7B 67 95 0C 45 9E 1C   ......Y..{g..E..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  AC BE E0 8D FA 55 BB 96 72 8B 39 4D 97 99 C3 EF   .....U..r.9M....
ISAKMP:  61 5D CA 94                                       a]..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11BC (4540)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A41 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6276 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EB 8E 0C 6A 47 A2 84 1F                           ...jG...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xDB4EE630
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  EB 8E 0C 6A 47 A2 84 1F 00 00 00 00 00 00 00 00   ...jG...........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikevxit
Au revoir!
Connection closed by foreign host.
1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.7: Passed

>> IKE-15.8
TEST_DESCRIPTION
IKE MUST notify INVALID-MESSAGE-ID for an incoming ISAKMP packet
with non zero Message ID field.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
        HDR set to <prm_inv_ph1_msg_id>
-  DUT: Notify INVALID-MESSAGE-ID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11BD (4541)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2940 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xE383 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8F 59 1B 37 AC DE F9 ED                           .Y.7....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D6 E1 53 51 81 04 E4 EA E5 F2 A2 2D 01 C3 01 73   ..SQ.......-...s
ISAKMP:  B4 94 6E EA 80 8D 68 2C 91 30 DF 78 CE C4 2A 14   ..n...h,.0.x..*.
ISAKMP:  1D FD 4D DE 38 F3 25 85 A4 A4 56 AE D2 40 C7 5E   ..M.8.%...V..@.^
ISAKMP:  50 D7 B2 28 2B 5E 0C BE 43 5E DB 5A 81 37 37 5C   P..(+^..C^.Z.77\
ISAKMP:  ED 95 45 DE D1 C9 D5 68 F9 6D 7F 15 AE 16 8E A3   ..E....h.m......
ISAKMP:  48 22 53 1B C6 38 14 66 43 4D FC FF C5 CA 05 67   H"S..8.fCM.....g
ISAKMP:  D9 E4 5F 6C E6 87 7B AD FA A8 50 53 68 EB 2D B0   .._l..{...PSh.-.
ISAKMP:  7A AD CB 64 BA 2A 51 26 3F C5 F9 03 2C 23 0A 9B   z..d.*Q&?...,#..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  C5 24 1A D7 34 5C 0D 52 3F 45 D6 5E FE 88 1B 28   .$..4\.R?E.^...(
ISAKMP:  A5 FA D8 3C 6B 43 F4 8A 72 50 EE D4 3E 34 C5 E4   ...<kC..rP..>4..
ISAKMP:  F1 DE CE 68 65 14 88 D7 3D 55 88 F4 4A FD 2C 7E   ...he...=U..J.,~
ISAKMP:  ED E1 F1 DF 15 95 16 BE FD A9 9A 00 62 9D 96 BA   ............b...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
HDR set to <prm_inv_ph1_msg_id> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x04DF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8F 59 1B 37 AC DE F9 ED                           .Y.7....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 8E 73 54 77 AD 87 1D                           ..sTw...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5D 78 FA A2 B1 5A 46 EA F0 F1 65 F8 FF 99 D8 59   ]x...ZF...e....Y
ISAKMP:  3A 58 DF 5B 6E 8D 37 96 0F B3 29 ED EE C1 98 19   :X.[n.7...).....
ISAKMP:  0D 3D B3 5B 42 1B 57 9C D2 0D DC 87 AF 2D 98 3D   .=.[B.W......-.=
ISAKMP:  AE DD 70 00 E0 0B 62 E7 98 B6 20 26 12 05 65 65   ..p...b... &..ee
ISAKMP:  26 8F 53 B7 48 EB D2 C8 1D A8 A5 50 64 13 F3 FE   &.S.H......Pd...
ISAKMP:  65 AD 73 FA C9 D5 CC 62 C0 84 15 41 DD 12 DF D3   e.s....b...A....
ISAKMP:  80 5A 50 79 8B 72 FF 33 3C E2 8C DC 33 01 BF 79   .ZPy.r.3<...3..y
ISAKMP:  D9 70 02 E3 CA 82 F3 D2 54 65 4B 7B CC 21 2F CB   .p......TeK{.!/.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A FB E9 39 7C 81 EA CC DA CC 98 7A B0 2E FD DB   *..9|......z....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  9A F4 DC AF 45 11 5D F1 67 5D E9 99 23 34 E5 B1   ....E.].g]..#4..
ISAKMP:  29 F4 1A A5                                       )...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11BE (4542)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A3F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xC6BE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8F 59 1B 37 AC DE F9 ED                           .Y.7....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE52B5CC6
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  8F 59 1B 37 AC DE F9 ED 00 00 00 00 00 00 00 00   .Y.7............
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 9

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1xit
Au revoir!
Connection closed by foreign host.
_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.8: Passed

>> IKE-15.9
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if SA Payload does
not precede all other payloads and MAY notify INVALID-PAYLOAD-TYPE
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send HDR,KE,SA,Nr,IDir, HASH_R
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11BF (4543)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x293E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x79D6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  08 BD 47 30 D8 C1 1E 9B                           ..G0....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  79 1F D6 9F 98 71 99 20 65 07 86 B0 02 48 51 DE   y....q. e....HQ.
ISAKMP:  8B BF AE CE 9F 4C B1 04 FF 8E 0A 48 9A 35 CE F6   .....L.....H.5..
ISAKMP:  DF 1C 05 72 DC C2 5A 21 7B FC 55 AB 70 F6 6D 7B   ...r..Z!{.U.p.m{
ISAKMP:  86 99 DC B5 CA D8 52 C4 67 12 3F 4D 13 B8 7D 89   ......R.g.?M..}.
ISAKMP:  D4 84 30 31 25 A8 E6 57 78 EB FB A4 A5 E7 22 58   ..01%..Wx....."X
ISAKMP:  6F 2C 29 25 D3 DB 9B 29 62 5F FB A4 72 0B 44 1C   o,)%...)b_..r.D.
ISAKMP:  9D 32 F5 30 5B 6F 7E 60 AF 9B AC 13 63 74 00 33   .2.0[o~`....ct.3
ISAKMP:  6B 67 02 EB 13 21 07 68 DE DE 88 44 63 D7 EB 11   kg...!.h...Dc...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  89 57 AB 55 5D 4A 26 67 42 69 B2 D2 38 65 1E C4   .W.U]J&gBi..8e..
ISAKMP:  82 03 D4 7E 89 7F EC D8 AD D5 97 B5 30 19 F4 A0   ...~........0...
ISAKMP:  CC 32 55 65 92 69 0B BE FC BE 2B C6 EC F1 3F E3   .2Ue.i....+...?.
ISAKMP:  D9 83 4C 9A 39 38 7A D2 8A 30 B3 CF 24 53 3F 1E   ..L.98z..0..$S?.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,KE,SA,Nr,IDir,HASH_R> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x869D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  08 BD 47 30 D8 C1 1E 9B                           ..G0....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CA FB CE 53 57 BD 54 1E                           ...SW.T.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  8C 8C 31 64 FA 09 C2 27 1A D6 A1 62 CB 4C B2 82   ..1d...'...b.L..
ISAKMP:  B4 2A 02 C2 15 1B E5 25 07 9F 34 5D BF 34 8F 93   .*.....%..4].4..
ISAKMP:  DA 1F F4 10 F6 DA 70 1E 68 5D F4 B0 78 AF 72 A2   ......p.h]..x.r.
ISAKMP:  06 2E 67 E8 32 D5 55 A4 B2 DD 5D AD 41 3E 1D D1   ..g.2.U...].A>..
ISAKMP:  C7 67 39 F2 90 4C F3 8C 83 B5 71 E6 82 1B A0 1D   .g9..L....q.....
ISAKMP:  7B 6E CF 42 BD 5E 57 77 3F 4A 7A F4 BE BE 48 9E   {n.B.^Ww?Jz...H.
ISAKMP:  08 25 CA 14 5F 83 97 3B EC 2C 25 F8 F0 F5 F3 FB   .%.._..;.,%.....
ISAKMP:  1E 23 7C 4E 36 02 E8 F5 D6 4D C6 F0 DA 85 68 49   .#|N6....M....hI
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E8 FE 53 8C 39 3F 47 A5 49 0E 14 AA 67 0A DC 80   ..S.9?G.I...g...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  EE 70 5B 5B DE 6E 88 AE 2F 40 AF 25 E5 10 56 27   .p[[.n../@.%..V'
ISAKMP:  41 80 9A 4D                                       A..M
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11C0 (4544)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A3D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xAFAF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  08 BD 47 30 D8 C1 1E 9B                           ..G0....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CA FB CE 53 57 BD 54 1E                           ...SW.T.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x79FDB39
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  08 BD 47 30 D8 C1 1E 9B CA FB CE 53 57 BD 54 1E   ..G0.......SW.T.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.xit
Au revoir!
Connection closed by foreign host.
filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.9: Passed

>> IKE-15.10
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE an incoming ISAKMP packet if
SA Payload does not precede all other payloads.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
          RFC 2408 s5.2 p59 ISAKMP Header Processing
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send HDR,KE,SA,Nr,IDir, HASH_R
-  DUT: Notify INVALID-PAYLOAD-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11C1 (4545)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x293C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xE4CC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 76 4F A2 52 3B 15 E5                           bvO.R;..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  69 66 A5 43 5E 37 1C AD 3E F4 51 69 76 EF 6B 75   if.C^7..>.Qiv.ku
ISAKMP:  A1 C2 1B 20 06 36 A6 9D CF FD 5C 54 D3 9F 39 B9   ... .6....\T..9.
ISAKMP:  89 B1 B2 46 B0 31 71 E8 83 00 6F 1B F6 E3 14 EA   ...F.1q...o.....
ISAKMP:  90 6B 41 0D D8 F1 3E D8 18 29 6A 6E 74 DE 7B 56   .kA...>..)jnt.{V
ISAKMP:  90 72 67 6A FD 9B B5 31 45 8E 4A CF 6A 4B 7F 32   .rgj...1E.J.jK.2
ISAKMP:  09 E6 E3 13 4B C3 FA 2D 04 7E CA 65 67 4E B3 D3   ....K..-.~.egN..
ISAKMP:  C0 04 34 D0 E2 38 69 25 B1 B4 58 52 B5 73 25 2C   ..4..8i%..XR.s%,
ISAKMP:  87 AA A5 80 92 81 26 4B 08 CB B1 87 FB 7D 76 81   ......&K.....}v.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  C2 86 60 79 B0 B2 50 7A 4C AF 2D 47 D0 B0 85 70   ..`y..PzL.-G...p
ISAKMP:  51 DC B0 2B 6F 99 32 C1 FF 10 50 B4 D9 A0 BF 2E   Q..+o.2...P.....
ISAKMP:  69 16 65 0D C7 D4 78 CA 90 0B 09 F5 C8 52 77 02   i.e...x......Rw.
ISAKMP:  1F 7F FF 37 D9 F6 E3 05 26 03 0B 8D ED 1C 71 4C   ...7....&.....qL
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,KE,SA,Nr,IDir,HASH_R> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0xA87E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 76 4F A2 52 3B 15 E5                           bvO.R;..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E8 53 E0 05 2A 63 7F 4F                           .S..*c.O
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  99 CC 07 B4 15 1C 7F B3 64 91 26 96 5F 4B 1E 58   ........d.&._K.X
ISAKMP:  2D 92 32 5A 7C C8 8B D9 40 FD 30 C9 81 D1 AA 37   -.2Z|...@.0....7
ISAKMP:  F4 05 58 FE C1 0F 7A 03 E2 E1 60 1E D3 5B D2 AD   ..X...z...`..[..
ISAKMP:  9F A4 EB 70 A8 A9 25 5E 3A D3 3A C9 06 54 BB 14   ...p..%^:.:..T..
ISAKMP:  57 15 50 64 25 9A 4B C4 99 47 79 AA E7 E4 2F E4   W.Pd%.K..Gy.../.
ISAKMP:  18 C7 F2 2C 53 AE 3C 2F 5C 75 1A 0E 21 8A DD A6   ...,S.</\u..!...
ISAKMP:  FD 59 4F 25 B2 CB 90 CB 74 7F 86 85 0E D9 5A 17   .YO%....t.....Z.
ISAKMP:  F9 D7 20 32 BE D3 7C C1 DE F3 B0 CD 94 E5 AB 2B   .. 2..|........+
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  89 DE B8 53 56 FE 97 29 06 0D D3 96 0E EF D7 0D   ...SV..)........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  BF C2 E1 85 E7 78 5E BB 9B 1E 12 13 C6 45 EF CE   .....x^......E..
ISAKMP:  61 C2 7E 07                                       a.~.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11C2 (4546)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A3B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xAB04 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 76 4F A2 52 3B 15 E5                           bvO.R;..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E8 53 E0 05 2A 63 7F 4F                           .S..*c.O
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xEF37F8AB
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  62 76 4F A2 52 3B 15 E5 E8 53 E0 05 2A 63 7F 4F   bvO.R;...S..*c.O
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_xit
Au revoir!
Connection closed by foreign host.
resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.10: Passed

>> IKE-15.14
TEST_DESCRIPTION
IKE MUST notify BAD-PROPOSAL-SYNTAX or PAYLOAD-MALFORMED for an
incoming packet if Transform number of selected Transform does not
match with that of the offer. 
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s4.2 p48 Security Association Establishment
          RFC 2408 s5.6 p65 Transform Payload Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode with 2 Transforms
-  DUT: Send <HDR,SA,KE,Ni,IDii> with 2 Transforms
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> containing the
        first Transform with Transform Number set to 2
-  DUT: Notify PAYLOAD-MALFORMED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11C3 (4547)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x293A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xED73 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE 46 49 E4 D9 41 C2 32                           .FI..A.2
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  1F 31 5A 87 1D EA D3 0D 56 38 8D F6 1F BC 3E 46   .1Z.....V8....>F
ISAKMP:  80 9B 39 BD E2 28 AB 23 9F 31 74 55 F7 E1 D4 AD   ..9..(.#.1tU....
ISAKMP:  98 B0 44 7C EA D6 48 1D E2 F4 10 70 D3 85 3D 5C   ..D|..H....p..=\
ISAKMP:  B2 E2 56 AB 59 43 D5 FD D8 8E 3D A8 F1 6D 02 2C   ..V.YC....=..m.,
ISAKMP:  E1 E1 7F C2 E4 A6 36 E8 DB D8 83 A5 9E 15 26 A7   ......6.......&.
ISAKMP:  0F F1 C7 96 6B F4 B7 D8 0A 9F 84 E1 30 65 A5 75   ....k.......0e.u
ISAKMP:  2B 01 9A 7F 69 7C 8B 05 DD 1A 88 EF 07 37 3D B1   +...i|.......7=.
ISAKMP:  94 62 BB 40 B6 0A AB 30 59 B5 EB D3 AC 35 FF 72   .b.@...0Y....5.r
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F4 A1 83 12 2D 58 85 51 E4 32 97 E4 FC 31 64 9A   ....-X.Q.2...1d.
ISAKMP:  6C BD 2D 91 62 59 5B A0 F5 CD 4A E5 69 C5 89 48   l.-.bY[...J.i..H
ISAKMP:  79 D0 56 83 77 42 4A 19 AD 9C 1F 8C 46 0F D2 54   y.V.wBJ.....F..T
ISAKMP:  56 55 A9 B3 AC A4 C5 62 E6 58 75 58 36 F6 BF 43   VU.....b.XuX6..C
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,KE,SA,Nr,IDir,HASH_R> Packet with two
Transform and transform number of first Transform
setting to 2 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 320 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B03 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 300 
UDP: Checksum         = 0xCF28 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE 46 49 E4 D9 41 C2 32                           .FI..A.2
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E3 4C 9F 3D A0 03 0B 07                           .L.=....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 292 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 64 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  86 7F CC 74 C9 C1 22 12 E0 96 D7 A7 55 E8 0A A5   ...t..".....U...
ISAKMP:  70 68 2B F6 3B AC B8 A6 6D DB E8 F0 7D 35 57 2E   ph+.;...m...}5W.
ISAKMP:  69 28 20 B9 97 3E 9E F6 13 78 C2 A2 72 22 D9 C6   i( ..>...x..r"..
ISAKMP:  80 9E A7 61 79 84 00 DE D9 44 F5 48 06 68 DC E3   ...ay....D.H.h..
ISAKMP:  80 93 5A 5F B1 B9 BD 06 68 51 BD 1B AA 6F 6B 85   ..Z_....hQ...ok.
ISAKMP:  A9 63 A5 51 E8 F6 80 1E BF 32 6D CE 77 E1 A5 6C   .c.Q.....2m.w..l
ISAKMP:  4C BB 1C 93 C1 24 3E FF 0D 12 C3 9C CF D8 31 30   L....$>.......10
ISAKMP:  E6 7D D2 F1 D3 3E C0 82 A3 E1 99 EC 23 75 31 0C   .}...>......#u1.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  3E EF 9A C9 7D C9 D3 D4 47 E9 79 C0 9E 55 7D 2B   >...}...G.y..U}+
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  63 AC 97 8A 10 BE 96 55 17 5E 2E 49 31 35 8B 98   c......U.^.I15..
ISAKMP:  3E 09 75 AD                                       >.u.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11C4 (4548)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A39 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7AE8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE 46 49 E4 D9 41 C2 32                           .FI..A.2
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x8D033C39
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  CE 46 49 E4 D9 41 C2 32 00 00 00 00 00 00 00 00   .FI..A.2........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipikxit
Au revoir!
Connection closed by foreign host.
e.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.14: Passed

>> IKE-15.15
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if Port field
of Identification Payload is other than 0 or 500 and MAY
notify INVALID-ID-INFORMATION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set ID Port field of IDir
        to an invalid <prm_inv_Id_port>
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11C5 (4549)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2938 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x2489 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 3A 6D E2 B5 83 06 BB                           b:m.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  15 D4 EF 74 96 0C 57 2D 76 2D AD 7B 20 D1 17 24   ...t..W-v-.{ ..$
ISAKMP:  8E 9C 87 44 23 7D 76 E4 40 62 C9 79 CD 89 0C FA   ...D#}v.@b.y....
ISAKMP:  9C 52 73 32 DB B4 AA D8 15 5A E4 89 15 B0 76 15   .Rs2.....Z....v.
ISAKMP:  33 83 57 CA 77 2E A9 DA EB 62 41 C8 B2 55 CE 5B   3.W.w....bA..U.[
ISAKMP:  D9 48 80 25 C3 B4 30 70 77 91 CC E2 17 E5 D2 08   .H.%..0pw.......
ISAKMP:  0D 25 B0 4F E3 C2 3F FF A5 9F 74 93 10 4B 57 95   .%.O..?...t..KW.
ISAKMP:  A9 6A 78 6E D8 CC 3B EB E9 79 99 D8 E8 F9 01 6F   .jxn..;..y.....o
ISAKMP:  F4 6A AB F7 03 11 32 FB 74 67 36 E0 15 C1 80 3F   .j....2.tg6....?
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  A2 00 5B 1F 2A F2 E4 FD B0 08 EB 98 28 33 F8 BE   ..[.*.......(3..
ISAKMP:  6E CB DF 71 EC D5 72 BB 7F 36 1A C7 83 46 8E 37   n..q..r..6...F.7
ISAKMP:  FB 01 ED D0 E9 DF B4 42 63 3B 25 28 EC AA 40 4B   .......Bc;%(..@K
ISAKMP:  2B 4E 6A FB 92 47 93 3B AA 3E 5C B4 0F AA CD DF   +Nj..G.;.>\.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir,HASH_R> Packet
to DUT with invalid Id Port 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x9B6A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 3A 6D E2 B5 83 06 BB                           b:m.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F5 59 F7 77 17 D9 49 42                           .Y.w..IB
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  CC 7D 7B 1F 62 7C D4 27 A7 F0 0D 05 D2 20 C7 B6   .}{.b|.'..... ..
ISAKMP:  29 F5 4A 9A F1 DF EC 9E 51 30 89 67 F1 15 72 45   ).J.....Q0.g..rE
ISAKMP:  9E 72 2F B6 98 9E E6 11 BC 1F F6 9A BE 7A 0C 78   .r/..........z.x
ISAKMP:  4C 66 01 86 0C DD E6 4F 7A 60 F4 24 A2 B7 B0 01   Lf.....Oz`.$....
ISAKMP:  27 58 A2 2C FB 46 2C B5 CB 95 DE CC 19 6B 27 90   'X.,.F,......k'.
ISAKMP:  43 BF FE 12 51 48 D6 04 04 B0 AD 0F 9B 46 42 5A   C...QH.......FBZ
ISAKMP:  6F 80 A0 E6 0C 9D 5A 1D C7 37 77 8A FF F7 39 20   o.....Z..7w...9 
ISAKMP:  01 CB 1F B2 9D 30 7A 76 9D 9D 65 2A BC 2B 97 94   .....0zv..e*.+..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B4 F4 E2 AC ED 7D 51 AA B7 16 D5 3B B4 F1 03 58   .....}Q....;...X
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  0B 39 55 4D 5E F3 57 93 EA A1 5D 3A 82 F2 6A 4A   .9UM^.W...]:..jJ
ISAKMP:  51 2F 58 25                                       Q/X%
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11C6 (4550)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A37 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0402 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 3A 6D E2 B5 83 06 BB                           b:m.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F5 59 F7 77 17 D9 49 42                           .Y.w..IB
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x45A0AD2E
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  62 3A 6D E2 B5 83 06 BB F5 59 F7 77 17 D9 49 42   b:m......Y.w..IB
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ixit
Au revoir!
Connection closed by foreign host.
pike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.15: Passed

>> IKE-15.16
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP packet
if Port field of Identification Payload is other than 0 or 500.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2408 s5.8 p66 Identification Payload Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set ID Port field of IDir to 
        an invalid <prm_inv_Id_port>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11C7 (4551)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2936 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x720B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  73 DB BE C7 56 48 7A A6                           s...VHz.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D3 6C C0 94 0C 3F 64 84 99 4B DC 81 F1 6C BC E2   .l...?d..K...l..
ISAKMP:  52 AA 50 99 C2 FD B5 08 23 00 A7 C5 85 4E 3E 5B   R.P.....#....N>[
ISAKMP:  A9 48 D9 7F 53 60 50 E4 44 C8 97 CE C4 05 6F 28   .H..S`P.D.....o(
ISAKMP:  92 88 CA F1 0D E9 DD E2 79 36 AB 74 33 F5 14 3E   ........y6.t3..>
ISAKMP:  1C EA 4D 93 5D 13 82 3D 29 72 1A 22 B8 60 B9 9B   ..M.]..=)r.".`..
ISAKMP:  06 86 66 E1 9C 81 CB F3 94 B1 98 09 F6 EF 6A DB   ..f...........j.
ISAKMP:  E1 3A A5 88 C3 C7 4D 2D F2 75 49 6D 95 98 89 18   .:....M-.uIm....
ISAKMP:  D8 8E 52 0B B7 53 31 40 93 9E D4 FF 14 7B 68 DA   ..R..S1@.....{h.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AB C5 14 8B 93 67 DE E8 87 7C DB 31 F3 11 6B 60   .....g...|.1..k`
ISAKMP:  72 9E C7 1B B8 4A 9F EF BC 13 6B 20 F8 3E 8F D7   r....J....k .>..
ISAKMP:  74 8F 4A 38 4C B5 A4 92 EA AE FE D4 E9 AC E5 B2   t.J8L...........
ISAKMP:  A7 03 11 4C 58 E2 61 0B 54 E8 D9 E2 BF BB 21 48   ...LX.a.T.....!H
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir,HASH_R> Packet
to DUT with invalid Id Port 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B19 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0xBC01 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  73 DB BE C7 56 48 7A A6                           s...VHz.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B3 50 00 65 46 8E AE 6E                           .P.eF..n
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E1 87 E7 AD 05 52 C3 D1 C1 A3 6D FF 78 FA A7 D6   .....R....m.x...
ISAKMP:  08 9A 08 24 20 B8 C6 79 C6 91 BF 5B D8 B1 AE 83   ...$ ..y...[....
ISAKMP:  7E 7C 23 CD 25 7A CB B0 C9 E6 F2 D5 76 D4 00 F7   ~|#.%z......v...
ISAKMP:  3B E5 FD DD B3 63 51 E3 05 60 2F CB B5 8E A8 1E   ;....cQ..`/.....
ISAKMP:  B9 6E F6 C5 92 33 74 98 F3 80 4F B9 56 74 A5 90   .n...3t...O.Vt..
ISAKMP:  54 21 35 B3 8F A2 E4 0F B0 4F 2B 82 F6 91 4E 38   T!5......O+...N8
ISAKMP:  98 35 05 46 B4 A2 70 68 45 E7 AA D1 79 FC 9D 2B   .5.F..phE...y..+
ISAKMP:  F4 7F 33 17 EE 6D D2 BE B7 6F 6A 32 97 17 3D EB   ..3..m...oj2..=.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D1 DE 59 F0 3E 70 EE D4 B8 45 9F FE 26 F9 D4 7B   ..Y.>p...E..&..{
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  D5 4F EA EE 98 59 00 5D 68 E6 35 64 FD 1C 45 A5   .O...Y.]h.5d..E.
ISAKMP:  A4 8F D1 F0                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11C8 (4552)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A35 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6AFB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  73 DB BE C7 56 48 7A A6                           s...VHz.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B3 50 00 65 46 8E AE 6E                           .P.eF..n
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xB89D2F40
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  73 DB BE C7 56 48 7A A6 B3 50 00 65 46 8E AE 6E   s...VHz..P.eF..n
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 18

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_xit
Au revoir!
Connection closed by foreign host.
ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.16: Passed

>> IKE-15.17
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet with Protocol ID
field of ID Payload other than 0 or UDP protocol (0x11) and MAY
notify
INVALID-ID-INFORMATION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set Protocol-ID field
        of IDii to an invalid <prm_inv_id_proto>
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11C9 (4553)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2934 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x857A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 10 23 BA 03 44 68 D6                           L.#..Dh.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DB 7D 58 76 14 2D 5D C4 7D 2A 6C 92 39 E3 4D BB   .}Xv.-].}*l.9.M.
ISAKMP:  08 24 4E E0 20 BF EC 46 96 E4 50 B5 11 7A 96 D7   .$N. ..F..P..z..
ISAKMP:  2A B8 49 35 39 45 FD 1A FB A1 4C D8 37 48 05 75   *.I59E....L.7H.u
ISAKMP:  B7 0B 5F 3C 40 B5 B2 05 8B 0A D9 24 0D C9 05 16   .._<@......$....
ISAKMP:  46 45 F3 54 DB AC EF BD 45 0C 0C 4B E3 B6 FA A3   FE.T....E..K....
ISAKMP:  9A D6 56 67 BA 38 F3 34 8A 0C CA CE 4D C5 37 BF   ..Vg.8.4....M.7.
ISAKMP:  5B 6B 19 61 12 3D FF 44 69 84 62 8C C0 D5 FF AA   [k.a.=.Di.b.....
ISAKMP:  C6 BD C7 07 08 49 92 99 DF 42 33 EC 7C 7F CF BF   .....I...B3.|...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  19 DF C9 B9 E7 01 42 59 8C A7 D0 27 FC 55 33 AB   ......BY...'.U3.
ISAKMP:  9E 2C 9A 14 31 A2 68 41 81 48 B3 19 23 AB 30 04   .,..1.hA.H..#.0.
ISAKMP:  2E BC 58 8A AD 91 B0 BB 0C A8 AA 0A CD 9A 31 22   ..X...........1"
ISAKMP:  01 74 B6 96 39 46 97 89 54 B6 C3 C7 BB D1 53 53   .t..9F..T.....SS
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir,HASH_R> Packet
with invalid Portocol-Id 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B18 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x4D04 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 10 23 BA 03 44 68 D6                           L.#..Dh.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 C2 7C 5D 15 F3 66 27                           D.|]..f'
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F7 8A 81 7A EC EC 18 2F 75 C3 BA BB 03 D4 0A D9   ...z.../u.......
ISAKMP:  42 E0 B0 8D 21 86 D6 A6 E4 54 22 1C 1B 74 04 4D   B...!....T"..t.M
ISAKMP:  6B 2A 44 94 EC 54 13 03 C5 94 ED 9D 9D AC 41 04   k*D..T........A.
ISAKMP:  44 CC 98 22 0F 32 46 24 51 4C 05 E1 80 FC AD 60   D..".2F$QL.....`
ISAKMP:  5C 90 AA C1 F9 1E D8 44 F0 EA 9D 2E E2 48 6E FA   \......D.....Hn.
ISAKMP:  57 B4 78 FB 90 E6 1D 58 CF 09 E3 C8 AA B6 AC E9   W.x....X........
ISAKMP:  A8 99 76 53 F9 E9 1A 74 D1 0A E0 91 67 BE BA E9   ..vS...t....g...
ISAKMP:  07 21 0C 63 23 31 F2 97 3D F0 D0 A2 AF 87 1E B5   .!.c#1..=.......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F0 75 F8 E4 33 F4 31 7D AC 87 08 B4 83 E3 CB D1   .u..3.1}........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  A6 CB DA B4 8C FB 7A 92 73 46 77 07 75 8C A4 DC   ......z.sFw.u...
ISAKMP:  20 29 84 D2                                        )..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11CA (4554)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A33 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD8FE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 10 23 BA 03 44 68 D6                           L.#..Dh.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 C2 7C 5D 15 F3 66 27                           D.|]..f'
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x19F48631
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4C 10 23 BA 03 44 68 D6 44 C2 7C 5D 15 F3 66 27   L.#..Dh.D.|]..f'
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filxit
Au revoir!
Connection closed by foreign host.
ename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.17: Passed

>> IKE-15.18
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP packet
with Protocol ID field of ID Payload other than 0 or UDP
protocol (0x11).
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2408 s5.8 p66 Identification Payload Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set Protocol-ID
        field of IDii to an invalid <prm_inv_id_proto>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11CB (4555)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2932 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x2454 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4E 28 83 65 37 A4 2A 04                           N(.e7.*.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C2 02 D1 0C 99 0C AA 05 4C 61 85 3F CF C2 1F 17   ........La.?....
ISAKMP:  EF EE 7A 11 A7 0F 4D 77 64 17 B5 A1 95 04 BB 18   ..z...Mwd.......
ISAKMP:  A5 65 DD F7 4C C0 DC 0B E3 8C F0 CD 20 2B 35 FA   .e..L....... +5.
ISAKMP:  31 D8 A1 FF 90 CE 02 A9 35 04 B4 0C 18 A9 B8 FE   1.......5.......
ISAKMP:  4E 56 73 D6 A4 05 A2 AC 2B 37 66 63 5D 5E AF A7   NVs.....+7fc]^..
ISAKMP:  7E CE D1 B5 E8 21 5C E0 77 94 B0 90 4B 83 9C D3   ~....!\.w...K...
ISAKMP:  D0 F2 5D 4B 5F FB 2F 8A 02 E1 60 65 BB 41 C6 15   ..]K_./...`e.A..
ISAKMP:  73 20 A3 8C D6 C5 E2 5F 08 36 CF DB D9 82 14 76   s ....._.6.....v
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AF D8 00 85 33 BE 32 D4 58 23 3B 45 6C 77 B8 4D   ....3.2.X#;Elw.M
ISAKMP:  85 7F CB 4F 7C 28 05 1B 45 B6 6F FF 37 D1 D5 C6   ...O|(..E.o.7...
ISAKMP:  B6 99 E9 73 7D B9 55 F1 27 11 CD FF 6E DE 60 AD   ...s}.U.'...n.`.
ISAKMP:  D4 B6 8E AD 8A 6A B2 9A A0 3E 99 1E 31 5B C7 74   .....j...>..1[.t
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir,HASH_R> Packet
with invalid Portocol-Id 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B17 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0xD7FA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4E 28 83 65 37 A4 2A 04                           N(.e7.*.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  90 B0 7C 2F 53 E1 5A 39                           ..|/S.Z9
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  34 98 74 55 37 A7 B2 F8 7F 49 B8 E6 6A 15 AA D2   4.tU7....I..j...
ISAKMP:  BD B0 36 88 BE 61 3C 97 80 7F F7 73 53 E1 38 84   ..6..a<....sS.8.
ISAKMP:  23 4F DD 39 17 E3 62 C5 DB E2 37 42 76 6D A2 9C   #O.9..b...7Bvm..
ISAKMP:  18 E7 16 6A 3A BE 69 E2 49 38 A7 AD 2D 4A B3 35   ...j:.i.I8..-J.5
ISAKMP:  DD 73 8B 2B 28 9E 20 D7 5C 24 8F CF C6 3C 2F BF   .s.+(. .\$...</.
ISAKMP:  22 B8 FD 00 16 73 98 E9 32 3C BB 70 35 DB 2F 5A   "....s..2<.p5./Z
ISAKMP:  A0 43 8C B9 34 57 F3 8D 78 97 44 E5 1D 1D 1B 89   .C..4W..x.D.....
ISAKMP:  D2 7D BC F2 D5 63 E0 57 96 DE 69 05 A8 B1 6C 51   .}...c.W..i...lQ
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  CB 50 41 3C 89 F4 53 77 DA 54 6B 87 88 5A 30 00   .PA<..Sw.Tk..Z0.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  0F 88 1D 76 C1 D2 6E 23 CC 62 64 5C 03 24 25 F8   ...v..n#.bd\.$%.
ISAKMP:  B5 27 6D 56                                       .'mV
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11CC (4556)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A31 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x462B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4E 28 83 65 37 A4 2A 04                           N(.e7.*.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  90 B0 7C 2F 53 E1 5A 39                           ..|/S.Z9
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xCB2CBDA8
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4E 28 83 65 37 A4 2A 04 90 B0 7C 2F 53 E1 5A 39   N(.e7.*...|/S.Z9
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 18

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co xit
Au revoir!
Connection closed by foreign host.
ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.18: Passed

>> IKE-15.19
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with a Nonce Payload
if Length of Nonce Payload is not between 8 and 256 bytes and
MAY notify PAYLOAD-MALFORMED.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>.
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>.Set the value of the Payload
        Length field of Nonce Payload to <prm_inv_nonce_len> which is
        less than 8 or greater than 256
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11CD (4557)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2930 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xED74 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B5 88 15 5A CD 71 26 DD                           ...Z.q&.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B0 BD 14 74 74 E8 6C D4 EF 26 53 E8 A2 98 D3 FC   ...tt.l..&S.....
ISAKMP:  50 CB 4C 28 34 1A BB 8E 88 AC EC 5F C7 20 5F 2A   P.L(4......_. _*
ISAKMP:  A7 95 4F C3 66 F4 6D AB 50 B3 F7 79 59 B0 10 A6   ..O.f.m.P..yY...
ISAKMP:  37 8A 73 D6 D5 0C 8B 59 81 B1 E3 AA D5 44 E8 58   7.s....Y.....D.X
ISAKMP:  0F 37 F7 5D 75 98 B3 F9 DB A0 07 68 7E B8 86 C0   .7.]u......h~...
ISAKMP:  10 41 95 C5 8F CD B3 35 8C 97 BF 65 15 3B 35 A5   .A.....5...e.;5.
ISAKMP:  21 68 4D 8D 7E 4F 1C 8A 34 01 B8 F5 18 A5 26 41   !hM.~O..4.....&A
ISAKMP:  0F 03 47 61 CB 8F FE 8A 04 E0 FA CE 35 F3 B9 C1   ..Ga........5...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  57 52 CF 24 A0 D0 5A 68 16 CD AF 0C A4 6D 7A 8C   WR.$..Zh.....mz.
ISAKMP:  96 13 D6 AE F1 49 20 0C 6D F4 F9 F7 5E B0 CF 60   .....I .m...^..`
ISAKMP:  8B A6 09 87 CA A5 5C 53 01 32 7A A8 BC 83 99 28   ......\S.2z....(
ISAKMP:  47 F0 EA C8 C9 2F 5E 10 4A 3B 7D ED 90 05 89 67   G..../^.J;}....g
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
! 30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with the value of the Payload
Length field of Nonce Payload to <prm_inv_nonce_len> 167 which is
less than 8 or greater than 256 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 283 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B23 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 263 
UDP: Checksum         = 0x30C4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B5 88 15 5A CD 71 26 DD                           ...Z.q&.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  4B 95 29 56 DD F9 CE 1F                           K.)V....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 167 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  BE 17 A7 B9 13 52 18 81 E8 C5 CD 16 78 F1 92 AB   .....R......x...
ISAKMP:  F1 CD 1E 9F 17 7D 81 66 0E 4D D4 20 AC 52 48 7F   .....}.f.M. .RH.
ISAKMP:  9F A4 81 74 ED 4B 08 38 5C 3E D0 5E 5C 46 DF CF   ...t.K.8\>.^\F..
ISAKMP:  A4 77 24 0D 4E EA 3E 56 8A 22 E1 61 2A F9 8C 2A   .w$.N.>V.".a*..*
ISAKMP:  16 61 29 89 3C 1E 59 B1 AF 9F A9 59 B1 B4 5C CF   .a).<.Y....Y..\.
ISAKMP:  D6 E0 06 62 0D A5 9B 22 4B 2C 20 7E DA 72 3C 11   ...b..."K, ~.r<.
ISAKMP:  B9 A1 81 AC ED D4 5E D2 62 71 5F 84 71 02 9C 03   ......^.bq_.q...
ISAKMP:  C4 B2 CF 77 8C 17 CA 52 29 1E 7B 6E 50 31 DB A0   ...w...R).{nP1..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 7 bytes
ISAKMP: --- Nonce Data [3 bytes] ---
ISAKMP:  55 85 FF                                          U..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  C4 EE 26 61 02 FA 3D 3F 11 AC 89 C2 86 DA 05 A1   ..&a..=?........
ISAKMP:  6B 62 C0 10                                       kb..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11CE (4558)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A3F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xCC6F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B5 88 15 5A CD 71 26 DD                           ...Z.q&.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  4B 95 29 56 DD F9 CE 1F                           K.)V....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
d ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filenaxit
Au revoir!
Connection closed by foreign host.
me "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.19: Passed

>> IKE-15.20
TEST_DESCRIPTION
IKE MUST notify PAYLOAD-MALFORMED for an incoming ISAKMP packet with a
Nonce Payload if Length of Nonce Payload is not between 8 and 256
bytes.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>.
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>.Set the value of the Payload 
        Length field to <prm_inv_nonce_len> which is less than 8 or 
        greater than 256
-  DUT: Notify PAYLOAD-MALFORMED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 340 bytes
IP: Identification         = 0x11CF (4559)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x292E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0x1681 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  68 9E 42 A6 CB F6 BA 2D                           h.B....-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F9 7E B6 07 A7 39 E2 0A 18 D8 E2 15 F1 6D DD B4   .~...9.......m..
ISAKMP:  33 CB 8A 46 09 20 82 14 AF C0 D8 B7 EF 5D D0 4C   3..F. .......].L
ISAKMP:  5A A7 3A 00 D0 59 9C D0 E5 BD A9 9A 8D 6A 0E 72   Z.:..Y.......j.r
ISAKMP:  3F 3E 75 A5 D0 45 E6 97 A8 67 F0 BC 23 5F 3C 67   ?>u..E...g..#_<g
ISAKMP:  C1 46 A5 FD 56 B1 7A C8 C6 86 19 F4 79 C7 E3 E2   .F..V.z.....y...
ISAKMP:  2C FD 37 94 45 27 B1 1C 9D 06 C1 8F 7A E7 13 EF   ,.7.E'......z...
ISAKMP:  58 68 43 28 E8 85 AA 3E 57 CE 96 9D DC A7 8E 81   XhC(...>W.......
ISAKMP:  C8 92 5C 6E F6 81 4E AC 89 0A BF D9 23 A8 B2 2E   ..\n..N.....#...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  C5 2D F7 B0 ED FD F0 0B 2C 55 9F DE 36 B1 92 56   .-......,U..6..V
ISAKMP:  37 A2 02 E9 DA 2C D4 40 F6 16 C6 8A 2A A1 AE D1   7....,.@....*...
ISAKMP:  81 0E 74 A4 24 2C 98 DA D5 01 60 9D C4 FB EC DE   ..t.$,....`.....
ISAKMP:  B7 EE FD 16 B9 B9 8F E4 0B 9D 26 00 BF 07 2D D6   ..........&...-.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with the value of the Payload
Length field of Nonce Payload to <prm_inv_nonce_len> 7 which is
less than 8 or greater than 256 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 283 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B22 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 263 
UDP: Checksum         = 0x4CD7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  68 9E 42 A6 CB F6 BA 2D                           h.B....-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  41 2B 47 09 D1 55 05 13                           A+G..U..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 255 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2E E7 C8 EA D6 A7 BA A5 BA 3E B7 B2 D0 53 BF 0D   .........>...S..
ISAKMP:  EE 8E DF C1 A1 E0 7D BD 59 1E BB F4 C5 97 6A F1   ......}.Y.....j.
ISAKMP:  93 EA 7D 99 CA AA 9C 3D 87 38 45 93 83 31 EE F6   ..}....=.8E..1..
ISAKMP:  57 9E B8 6C F3 9F 8F 96 A8 EE 80 D0 7D AE 2A A5   W..l........}.*.
ISAKMP:  0E 1A A0 8D 4F BF 2F 21 F1 4A 14 FD 10 3A 65 60   ....O./!.J...:e`
ISAKMP:  2E 61 09 FE 23 FB 12 EF 76 5C E2 1B 67 9A 94 64   .a..#...v\..g..d
ISAKMP:  6A FF F3 AC B8 5F E0 6E 6F 04 70 77 7E 5F 3F E0   j...._.no.pw~_?.
ISAKMP:  DE B0 38 56 A6 7E 9F 07 EA 59 F5 53 19 E1 BF DB   ..8V.~...Y.S....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 7 bytes
ISAKMP: --- Nonce Data [3 bytes] ---
ISAKMP:  A3 27 95                                          .'.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  70 45 6B 1C BE 27 4B 02 2A 16 08 E5 09 99 54 56   pEk..'K.*.....TV
ISAKMP:  D3 A0 0E 4F                                       ...O
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11D0 (4560)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A2D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE1A0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  68 9E 42 A6 CB F6 BA 2D                           h.B....-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x54E81209
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  68 9E 42 A6 CB F6 BA 2D 00 00 00 00 00 00 00 00   h.B....-........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/rxit
Au revoir!
Connection closed by foreign host.
omfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-15.20: Passed

>> IKE-16.1
TEST_DESCRIPTION
IKE MUST send ISAKMP packet using User Datagram Protocol(UDP)
on port 500
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.1 p20 Transport Protocol
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> using User Datagram
        Protocol(UDP) on Port 500
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B34 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x6711 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D4 01 FB 3B 59 9C BF 2A                           ...;Y..*
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  88 BD 49 1D 67 C2 58 FC D3 F7 73 E2 2C EF DC 7E   ..I.g.X...s.,..~
ISAKMP:  41 81 9A 69 D4 24 65 44 69 5A 77 DE 09 0B 67 BD   A..i.$eDiZw...g.
ISAKMP:  82 73 74 94 89 EF 08 29 9A 79 BA 3A 66 E8 E5 A3   .st....).y.:f...
ISAKMP:  9C 09 B4 CA 1C 83 1E AB 2D 1C B1 85 98 6F 19 E3   ........-....o..
ISAKMP:  AF F2 FA 4D E3 3F 82 78 33 E5 11 BB 55 6E 46 84   ...M.?.x3...UnF.
ISAKMP:  25 8A CA BA 3E 68 52 CE EA 6C 23 92 CA 5B DA C9   %...>hR..l#..[..
ISAKMP:  45 A1 18 51 8B 32 AA D5 5A E2 4C 76 9F 19 AC BE   E..Q.2..Z.Lv....
ISAKMP:  5B 4F 6D 77 44 0B 28 75 A8 6D A7 BE 38 29 E3 BC   [OmwD.(u.m..8)..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  96 B5 84 82 55 C7 46 A5 3F D3 1F F8 1B 9D 19 66   ....U.F.?......f
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D1 (4561)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2914 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x1754 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D4 01 FB 3B 59 9C BF 2A                           ...;Y..*
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  3A 81 8F B6 EE 23 70 69                           :....#pi
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F2 BA 49 66 89 0D 09 89 5A 06 2E EA EB 52 F7 66   ..If....Z....R.f
ISAKMP:  C8 BF E5 0A 7E 80 5C F2 DF 8D 03 B3 E8 64 5B 27   ....~.\......d['
ISAKMP:  D4 F8 94 4D C6 E0 87 E6 34 83 11 09 1D 24 AB 30   ...M....4....$.0
ISAKMP:  BE 61 58 F6 FF 80 AC 71 72 48 5E A6 9B 39 E9 A5   .aX....qrH^..9..
ISAKMP:  BD 83 E1 B7 EE F7 55 EA 58 A7 B7 B0 0B 22 F2 6F   ......U.X....".o
ISAKMP:  9E D0 43 A0 F5 D0 C9 C2 5F 8C 14 34 8F C1 4A D4   ..C....._..4..J.
ISAKMP:  9F FD 86 D6 A1 0B 65 B5 EF BE C7 E0 E7 80 E0 ED   ......e.........
ISAKMP:  C0 E1 AC A3 DA 6C D5 99 CD 64 24 A1 0E 95 CF F3   .....l...d$.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D9 C7 0A 1A 6E 2E 0E 72 52 55 17 A3 8B 52 F5 68   ....n..rRU...R.h
ISAKMP:  3A E3 65 60 DF CB 38 46 33 53 D1 E4 C1 71 E5 EC   :.e`..8F3S...q..
ISAKMP:  37 4E 92 A4 8B 2C D9 29 61 84 EE B5 D8 26 AF 5C   7N...,.)a....&.\
ISAKMP:  52 4D 81 08 69 08 00 8C 89 72 82 36 79 A1 C7 49   RM..i....r.6y..I
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  CE 46 BB CD 06 CB C5 03 DA B2 84 6E D6 E3 D8 7C   .F.........n...|
ISAKMP:  7E 18 7A A9                                       ~.z.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with UDP as transport protocol
on port 500

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.1: Passed

>> IKE-16.2
TEST_DESCRIPTION
IKE MUST set the RESERVED field of Notification Payload to 0 in
an outbound ISAKMP Packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2408 s3.4 p27 Security Association Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with NP field of SA Payload set to 2
-  DUT: Send <HDR,NOT> with RESERVED field of NOT Payload to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with NP field of SA Payload set to 2
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B33 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xFA81 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  33 02 60 29 81 30 56 73                           3.`).0Vs
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11D2 (4562)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A2B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE064 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  33 02 60 29 81 30 56 73                           3.`).0Vs
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  35 8A 13 71 E8 2D C8 2B                           5..q.-.+
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x287BDA4A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  33 02 60 29 81 30 56 73 35 8A 13 71 E8 2D C8 2B   3.`).0Vs5..q.-.+
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received Responder's <HDR,NOT> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,NOT> packet from DUT
with RESERVED field set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.2: Passed

>> IKE-16.3
TEST_DESCRIPTION
IKE MUST set the Message ID field to 0 in an outbound ISAKMP Packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p25 ISAKMP Header Format
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Message ID field in the
        HDR set to 0
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the selected Proposal
        with Message ID field in the HDR set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Message ID field in the
HDR set to 0 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0017 (23)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B32 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x1556 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  16 BC A4 68 03 FA 8B 17                           ...h....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  04 FD 9D 09 1E 49 FB 8C 4E 38 CA FF E6 25 4F 5B   .....I..N8...%O[
ISAKMP:  EA 88 CB 15 9B 59 2B 21 D2 D7 17 27 5D 8E 30 C6   .....Y+!...'].0.
ISAKMP:  C1 AB A1 9A 4D 28 68 5A D3 8A 95 90 4B A1 01 9B   ....M(hZ....K...
ISAKMP:  5E 9D C3 A2 BC 88 12 59 15 E4 3E BA 1C 31 B6 BE   ^......Y..>..1..
ISAKMP:  A3 FE 45 65 F4 1D DD 86 B8 CF 54 03 91 EB 14 96   ..Ee......T.....
ISAKMP:  45 EF 17 C9 8A 65 A7 EE D1 F7 AF 42 4D 34 12 85   E....e.....BM4..
ISAKMP:  18 51 79 34 09 1E 1C 0A FD F6 8C 92 F6 A8 66 4C   .Qy4..........fL
ISAKMP:  7C FE 8B 74 8A E3 85 A8 C3 BD 68 51 94 6F F2 68   |..t......hQ.o.h
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  73 B1 F5 2E 49 3E 60 69 FE CB E8 96 71 86 81 87   s...I>`i....q...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D3 (4563)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2912 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x1AB0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  16 BC A4 68 03 FA 8B 17                           ...h....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  0E 6E 04 73 CC 2C 11 BC                           .n.s.,..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  FF DE 36 CE B2 5D AB 59 BC B2 72 C2 73 2F 39 0A   ..6..].Y..r.s/9.
ISAKMP:  37 72 D6 43 E2 24 CD E8 5F 98 81 7E 5F FF BD AE   7r.C.$.._..~_...
ISAKMP:  FB C1 CD 14 32 16 50 DF 80 B0 B4 5E 9F B5 64 CB   ....2.P....^..d.
ISAKMP:  39 FC D9 BC F0 E3 80 80 5E FF 29 51 82 B9 AA 70   9.......^.)Q...p
ISAKMP:  2B 20 AF 96 82 FE EC 4E E0 7E 28 AB B8 AF F1 F5   + .....N.~(.....
ISAKMP:  10 4C 85 E6 6F 95 60 DD 01 A0 B5 73 3F 63 A9 03   .L..o.`....s?c..
ISAKMP:  D0 B1 16 FF 35 1D 8F 97 2C 82 73 3E 87 03 F1 1A   ....5...,.s>....
ISAKMP:  21 04 E3 FB 7C 68 74 8B E6 42 67 68 CE 90 05 EA   !...|ht..Bgh....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  B4 DA DF FE 53 34 8B 46 59 15 5C 36 A0 A0 8E C6   ....S4.FY.\6....
ISAKMP:  7C 4A 76 2F 5B 5A 12 45 20 76 F0 D8 A2 86 85 18   |Jv/[Z.E v......
ISAKMP:  B7 72 D8 AB EB 54 58 73 60 18 CA 78 77 DA E9 62   .r...TXs`..xw..b
ISAKMP:  8F B2 22 BE 70 83 A2 B9 27 5F 3C 98 61 17 9A 7C   ..".p...'_<.a..|
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  FA E0 78 69 42 49 11 75 F1 6C E3 30 8C 14 29 61   ..xiBI.u.l.0..)a
ISAKMP:  E2 E1 3F F4                                       ..?.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R>
Packet
! from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Message ID: 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.3: Passed

>> IKE-16.4
TEST_DESCRIPTION
IKE MUST not set the NP field of Security Association Payload to
Proposal Payload
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with NP field in SA
        not set to Proposal Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B31 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x4183 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  10 AC 9F 58 C7 8F CC 47                           ...X...G
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7A 5A D6 25 C8 EE 89 7A 0F C0 DD FE 9E E7 90 C8   zZ.%...z........
ISAKMP:  F3 AA 20 D7 36 57 CF 2A 96 E6 4D 45 D4 B4 83 9A   .. .6W.*..ME....
ISAKMP:  26 29 EA A2 55 1D 31 B8 1C AC E6 36 75 26 1C E8   &)..U.1....6u&..
ISAKMP:  9A 8F EE 75 00 85 0B 2B C1 A4 4D 27 F6 62 CC 43   ...u...+..M'.b.C
ISAKMP:  DC B6 92 E4 48 04 5C 37 C8 F4 BA 89 E4 66 0D D1   ....H.\7.....f..
ISAKMP:  DE D7 3D 3D 8C F0 47 DB A2 91 43 9D 30 6C 57 1E   ..==..G...C.0lW.
ISAKMP:  BB F9 8D 7F 4D 4E 0C A2 05 1F BB 16 60 40 07 8E   ....MN......`@..
ISAKMP:  92 47 AE B2 7C 1D B0 D8 32 19 0B DE 05 41 69 30   .G..|...2....Ai0
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B7 5B A4 DC 9F AE 10 FD CB 1F E9 2E 70 E9 4D CC   .[..........p.M.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D4 (4564)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2911 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x65F3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  10 AC 9F 58 C7 8F CC 47                           ...X...G
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B1 07 58 0D A3 48 90 D7                           ..X..H..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C0 42 27 98 54 10 CB 3D 12 4D 14 09 19 1F 07 15   .B'.T..=.M......
ISAKMP:  BE 91 C5 AB C4 6C 46 1B 6E 80 CC D7 73 9A 7D C1   .....lF.n...s.}.
ISAKMP:  9B 71 B9 FC 3D E6 1A 0C 47 A5 59 B7 77 29 CE 43   .q..=...G.Y.w).C
ISAKMP:  83 0B D0 2A 98 B8 DB 70 FF 1C 6C CF 82 DB 36 08   ...*...p..l...6.
ISAKMP:  FD 43 2E 8B 48 FB 7A 4D 5C 9E D6 3E EA 45 CC 34   .C..H.zM\..>.E.4
ISAKMP:  35 98 ED 39 36 17 2F 41 19 F4 DF 05 7F 73 DF E8   5..96./A.....s..
ISAKMP:  2D B6 0D 6F EF FE 83 0A 3D BA A8 09 00 F7 F5 D6   -..o....=.......
ISAKMP:  13 25 CA C2 FE A1 DB 22 35 20 19 1B 01 21 18 21   .%....."5 ...!.!
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  4A B9 E4 DE EE 2D 94 0D 98 FE E7 60 D3 A4 5B 88   J....-.....`..[.
ISAKMP:  CF 8B 39 6D 43 D9 69 B6 5A EB 20 79 38 68 58 5A   ..9mC.i.Z. y8hXZ
ISAKMP:  CA F0 A0 8A C1 6F 45 A0 A9 A8 A3 1E 26 9B BD 65   .....oE.....&..e
ISAKMP:  0C 07 90 FD 5F CE 27 61 A1 CA 23 14 D2 A9 0B C9   ...._.'a..#.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  60 4A ED 39 81 9B 86 E9 6F 1F 0A 53 7C 62 13 C4   `J.9....o..S|b..
ISAKMP:  6C C2 DD CD                                       l...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Next Payload of SA (4)(Should
be: 4) not set to Proposal

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.4: Passed

>> IKE-16.5
TEST_DESCRIPTION
During SA Payload exchange, IKE MUST set the Encryption flag to 0
in an outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s5.2 p60 ISAKMP Header Processing
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Encryption flag in
        the HDR set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B30 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x9B08 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3C 35 E0 0C BD AC C4 0E                           <5......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  EC 6B 76 B9 A4 1B 8D 91 93 0B D8 26 60 1F D3 58   .kv........&`..X
ISAKMP:  61 F8 7F AF 64 8C E1 A4 E3 AC CD A3 7D E8 C5 E3   a...d.......}...
ISAKMP:  5E 68 37 F1 0D 10 13 B3 AF 95 35 C7 AB 35 AE 92   ^h7.......5..5..
ISAKMP:  7D 5B 3C 5E 0A 8B 84 9A 58 B6 3E A5 27 17 62 AE   }[<^....X.>.'.b.
ISAKMP:  8C 8A CD CE 7D 41 C7 7D C1 27 ED 73 C4 6B 8F 7D   ....}A.}.'.s.k.}
ISAKMP:  0A F2 F1 D9 23 D0 80 C2 3B 07 A5 4B 72 1B 0C 76   ....#...;..Kr..v
ISAKMP:  43 E2 2F 44 3D EF E1 CF CA A2 CB 56 61 E5 8A 1A   C./D=......Va...
ISAKMP:  CB 48 12 13 B7 B9 05 BF EA 85 A5 5E 0D BB 0C F4   .H.........^....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  0C 01 22 EB E1 F5 49 37 12 18 0E DA A2 45 79 95   .."...I7.....Ey.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D5 (4565)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2910 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x2D7D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3C 35 E0 0C BD AC C4 0E                           <5......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7C C7 C3 88 92 8E 7B 95                           |.....{.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AA F2 5E 33 92 93 5A 39 57 BD 38 8B D2 C2 4C 2F   ..^3..Z9W.8...L/
ISAKMP:  58 50 6F FC 39 EE AC 2E A1 26 19 97 5C A5 DC 5E   XPo.9....&..\..^
ISAKMP:  40 E3 E7 4C 0A 7A D6 B1 32 AB B7 2D 00 C1 43 A5   @..L.z..2..-..C.
ISAKMP:  63 F8 5A AC 3A 38 5B 37 94 04 00 80 CB 9E 35 0B   c.Z.:8[7......5.
ISAKMP:  76 B8 3D B0 FB 12 4C 8E 05 F6 DB B6 1F 5F 54 7F   v.=...L......_T.
ISAKMP:  3A 82 35 28 A8 71 DC 18 33 6E 89 8E D8 58 50 91   :.5(.q..3n...XP.
ISAKMP:  A9 F1 E6 44 DD A6 0A 65 41 AE AD 93 00 14 8F 23   ...D...eA......#
ISAKMP:  3C 11 AA C1 21 B2 87 FC 05 B4 8C D3 D8 6B 77 78   <...!........kwx
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  A0 53 4E 96 A6 F2 E4 0C 02 C0 AF 14 5F C9 44 1D   .SN........._.D.
ISAKMP:  F6 48 25 E0 4F 9A 9F 36 60 AD E6 0D A7 D3 7D 22   .H%.O..6`.....}"
ISAKMP:  93 64 CA F6 1F AB CB FD A7 B9 EA C7 BF CF C8 92   .d..............
ISAKMP:  9E 12 B6 FC 13 E3 77 70 27 F4 D9 BF D5 16 03 8B   ......wp'.......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  FD 89 3D 1B E3 1C 6E B6 11 6B E2 9F 37 D0 98 26   ..=...n..k..7..&
ISAKMP:  85 F4 B8 A2                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Encryption bit set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.5: Passed

>> IKE-16.6
TEST_DESCRIPTION
IKE MUST set the NP field of the Transform Payload to 0 in an outbound 
ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.6 p30 Transform Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> using Aggressive Mode with
        one Proposal Payload and two Transforms Payloads
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the selected Transform,
        with the NP field of Transform Payload set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> using Aggressive Mode with
one Proposal Payload and two Transforms Payloads to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B17 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x6210 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0D CE 35 69 71 75 E2 17                           ..5iqu..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D1 A4 62 DD B1 B8 DD 6A 10 DF 87 22 AA 87 2F 8B   ..b....j..."../.
ISAKMP:  EE 4A CE 1E F2 6E 3A 57 9C CC D2 43 64 98 3F C8   .J...n:W...Cd.?.
ISAKMP:  17 16 B1 23 CF B3 7C 5F D7 0D A3 68 04 43 50 06   ...#..|_...h.CP.
ISAKMP:  72 B9 2F 99 0C EF 5E F7 A1 55 AE F2 80 0C F4 C0   r./...^..U......
ISAKMP:  CC 7A FF E6 3E 3A 7C A4 B7 1C 1B 2B 34 87 48 82   .z..>:|....+4.H.
ISAKMP:  08 F7 1F B0 05 F9 FB 36 B7 1B AF A8 BD 7E 56 FB   .......6.....~V.
ISAKMP:  AA E7 41 7C 18 29 9E 6F A9 32 C9 A3 E5 BE 25 37   ..A|.).o.2....%7
ISAKMP:  12 E2 94 13 BC EF 72 2B 3A BF DD 48 76 12 11 FE   ......r+:..Hv...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  BC 70 79 C3 0C 7E 76 5E E4 83 EF 4B EC 42 09 DE   .py..~v^...K.B..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D6 (4566)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x290F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x1ED3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0D CE 35 69 71 75 E2 17                           ..5iqu..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CB CC FD 9F 35 55 E0 79                           ....5U.y
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2A B8 41 B2 C6 49 76 DA B2 44 A4 32 E4 0B 12 F4   *.A..Iv..D.2....
ISAKMP:  E7 41 17 B8 84 46 4C AC 7B FB 69 05 9C E6 F0 0F   .A...FL.{.i.....
ISAKMP:  9E A1 64 00 AB B4 9B D5 2D 26 F9 0F AF 0F 6D FC   ..d.....-&....m.
ISAKMP:  40 CE A4 A9 36 47 F4 6A 41 DC 23 01 09 81 DA 21   @...6G.jA.#....!
ISAKMP:  E1 5B D1 FB 3B 22 D3 5E 88 18 C7 C0 BC 26 BE 03   .[..;".^.....&..
ISAKMP:  0A DD B7 B7 B8 4D 50 9D 63 9A B0 B1 50 D7 42 A1   .....MP.c...P.B.
ISAKMP:  D6 D4 EC 4A C8 A4 DC FA 2D 4F 1E 09 C4 96 09 4F   ...J....-O.....O
ISAKMP:  8C FB 26 25 03 FE 7C F4 FF 91 8D 5B E6 D9 BA A8   ..&%..|....[....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AE 53 7D 62 2A A1 B9 71 0C 4F EE B0 FE D9 2C A1   .S}b*..q.O....,.
ISAKMP:  40 26 0E 40 D4 DD ED 34 91 92 5D 05 8A 13 95 E2   @&.@...4..].....
ISAKMP:  77 24 B6 05 72 C2 16 18 2B 01 46 05 CB 50 A6 BB   w$..r...+.F..P..
ISAKMP:  3E 54 7E A8 3B 83 D5 44 6D 83 03 EE 90 1E 65 D8   >T~.;..Dm.....e.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  75 A3 5D 84 C7 E7 1D 8D 14 99 62 AC 59 05 41 D8   u.].......b.Y.A.
ISAKMP:  77 6B 0F 50                                       wk.P
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R>
Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.6: Passed

>> IKE-16.7
TEST_DESCRIPTION
IKE MUST select a single Transform for each protocol in a Proposal 
Payload in an outbound ISAKMP packet. 
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s4.2 p47 Security Association Establishment
RFC 2409 s5.1 p11 IKE Phase 1 Authenticated With Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
        two Transforms
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with one Transform Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
two Transforms to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B16 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x5622 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E2 CC 40 26 21 C0 A3 27                           ..@&!..'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C3 D3 FC C9 AC 1D 6D EB 82 EB 84 43 61 76 A9 A4   ......m....Cav..
ISAKMP:  5A 98 F0 E3 2F C2 C5 BD 9E 2B A7 F2 3C 55 E3 31   Z.../....+..<U.1
ISAKMP:  71 62 68 EA 06 38 6C D0 DD FD 2D C1 5D 03 0A 0F   qbh..8l...-.]...
ISAKMP:  38 76 3C 96 DE 60 64 CC 75 50 10 AF 57 DA F3 A5   8v<..`d.uP..W...
ISAKMP:  31 5D 9C 61 B5 F4 56 AF 90 9B 32 78 EA 1B E1 C2   1].a..V...2x....
ISAKMP:  21 DE 71 C8 DC CD 9D FB 60 14 FC DF 8B 60 27 27   !.q.....`....`''
ISAKMP:  3D 7F D5 97 13 72 A5 A1 30 53 A4 E5 C8 70 F0 64   =....r..0S...p.d
ISAKMP:  69 6C 72 CF BB 41 0E ED 39 02 51 5C E2 A7 2C A8   ilr..A..9.Q\..,.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2D 99 C6 57 C3 46 C6 E6 DD 7F 00 DB 12 FF CA AA   -..W.F..........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D7 (4567)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x290E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xEAE8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E2 CC 40 26 21 C0 A3 27                           ..@&!..'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  31 45 33 FA 8D 0A 5C 9C                           1E3...\.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A0 63 97 68 EE 19 0B D1 47 7D 19 0C 96 EE 4A 53   .c.h....G}....JS
ISAKMP:  54 AD B6 58 DE 17 7E 10 BF C2 EE 8E D8 71 87 F9   T..X..~......q..
ISAKMP:  93 CC 47 26 77 F3 A1 39 20 2A 8F BF 57 DD 2D 5B   ..G&w..9 *..W.-[
ISAKMP:  38 31 34 E3 00 95 48 F5 75 29 B3 42 7D AD B9 2E   814...H.u).B}...
ISAKMP:  B1 DC 35 B6 4C D8 8F C9 69 EC D5 19 7D 24 40 71   ..5.L...i...}$@q
ISAKMP:  DE FB 76 3F 72 0E 2E 98 8C A0 15 ED 85 A7 97 9B   ..v?r...........
ISAKMP:  5B AD 64 2D 2F 66 74 08 1B 19 3F F6 87 46 82 4F   [.d-/ft...?..F.O
ISAKMP:  27 7A 4B 87 3F 51 E5 71 42 93 C7 CE B2 16 3F DF   'zK.?Q.qB.....?.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  02 E5 1D 68 BB E2 35 4D 12 F7 F4 17 C1 CA AC DC   ...h..5M........
ISAKMP:  8D 6D 35 28 2C E5 61 D0 82 76 1E 5A 0F 58 E1 8D   .m5(,.a..v.Z.X..
ISAKMP:  F7 20 FE 88 3F 7C 6A 09 69 E0 BC D0 F0 0B DB 93   . ..?|j.i.......
ISAKMP:  E2 B9 F5 AB A7 93 15 C9 CD 48 C3 93 33 B6 CE 31   .........H..3..1
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  A0 F7 BB 53 BE 9E 1D CA 20 08 28 F7 FF 23 4A FF   ...S.... .(..#J.
ISAKMP:  0A 32 F5 6D                                       .2.m
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet from DUT
containing only one Transform Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.7: Passed

>> IKE-16.8
TEST_DESCRIPTION
IKE SHOULD retain the Transform Number field in the Transform Payload 
in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s4.2 p48 Security Association Establishment
RFC 2409 s5.1 p11 IKE Phase 1 Authenticated With Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
        two Transforms 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the selected Transform
        Payload without changing the Transform Number field 
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
two Transforms to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B15 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x1C09 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5A 4A 4D 28 71 05 BC 17                           ZJM(q...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5C FA 9B 36 CC 0B A8 83 69 57 4F D4 7E 39 F7 19   \..6....iWO.~9..
ISAKMP:  88 66 14 4C 90 92 B2 33 95 F3 16 76 FD 54 8C 28   .f.L...3...v.T.(
ISAKMP:  A2 14 86 03 D8 59 C8 3F 01 B0 6E DD 59 EC EA 43   .....Y.?..n.Y..C
ISAKMP:  03 42 C9 DA DB D4 9C F8 52 76 62 59 6A C4 A8 B6   .B......RvbYj...
ISAKMP:  0C 17 F3 B3 0A A5 01 F4 40 D1 39 EA 29 B3 D5 8B   ........@.9.)...
ISAKMP:  81 1B 7E 48 C7 EB 2D 0C A9 50 E5 6B F7 04 02 BA   ..~H..-..P.k....
ISAKMP:  0E A2 36 2E CB BB A8 5D 20 98 29 20 B2 4C C7 23   ..6....] .) .L.#
ISAKMP:  75 4B 15 E5 0E 2A 08 1B 3D 3B AD 15 F1 67 5A A7   uK...*..=;...gZ.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DD 00 50 DC 24 65 B1 E3 A8 F0 86 48 46 9C 79 30   ..P.$e.....HF.y0
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D8 (4568)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x290D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xF6B7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5A 4A 4D 28 71 05 BC 17                           ZJM(q...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  AF 34 9F D0 6D 23 08 72                           .4..m#.r
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B8 AC 5C E3 A3 49 FC A3 6D A9 A6 AD 5E E6 2A 5F   ..\..I..m...^.*_
ISAKMP:  45 94 FB AB 01 52 38 A9 DC B2 25 38 67 F7 2A C3   E....R8...%8g.*.
ISAKMP:  94 8C 34 FD 1F 2B 87 71 A1 6C 59 63 8F 48 4D 76   ..4..+.q.lYc.HMv
ISAKMP:  AC FC 57 BB 72 C5 72 FA 93 C9 79 DC 66 C8 CE 68   ..W.r.r...y.f..h
ISAKMP:  78 DC 0B 1F E7 9A E4 C7 E6 0C E2 8E 8E 45 8B F9   x............E..
ISAKMP:  1E 1D FD 5C A9 BB 0B 08 C8 56 C4 4C 8E F1 57 63   ...\.....V.L..Wc
ISAKMP:  2F 4B B3 2F DC C8 59 83 B7 F6 3E A9 BD 20 ED B5   /K./..Y...>.. ..
ISAKMP:  9F 4E 0B BB A9 6F A5 9A A0 9B AD 98 89 87 C3 C7   .N...o..........
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  9E BA B1 64 00 BB 6F 96 37 00 74 AD 5C 79 76 0D   ...d..o.7.t.\yv.
ISAKMP:  DE 84 B1 E6 82 D4 BD B4 D7 24 B7 F8 9B 97 B0 57   .........$.....W
ISAKMP:  0A A9 E9 5A 39 C4 CD D6 B6 00 75 5F 31 22 70 CC   ...Z9.....u_1"p.
ISAKMP:  3A 49 DB 8B F1 E4 F2 10 91 8A EF 50 E8 DD 6A FA   :I.........P..j.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  BF 27 F8 18 2A 79 D1 31 07 15 8E 43 23 D1 85 EA   .'..*y.1...C#...
ISAKMP:  29 08 41 41                                       ).AA
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.8: Passed

>> IKE-16.11
TEST_DESCRIPTION
SA Payload MUST precede all other Payloads in an outbound
ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send the <HDR,SA,KE,Nr,IDir, HASH_R> setting SA Payload
        immediately after HDR
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B2C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x7699 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6F 29 53 08 DF EB E5 09                           o)S.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  30 D5 68 96 A1 AF 98 35 1A A7 15 AB 94 24 FC 44   0.h....5.....$.D
ISAKMP:  AF C3 67 6F 6F FC 34 2B 8C 14 F7 A3 77 5C 00 6C   ..goo.4+....w\.l
ISAKMP:  FE 74 6E DE 8E 51 3D 74 74 73 11 81 DB EE 91 E3   .tn..Q=tts......
ISAKMP:  59 F7 11 63 7E A0 FD 1B 17 A7 A6 4B A1 78 DF 6D   Y..c~......K.x.m
ISAKMP:  9B 65 67 27 04 9B F4 21 84 08 AA 87 00 C9 08 33   .eg'...!.......3
ISAKMP:  6F 84 72 43 47 82 65 53 BD F0 04 DB 87 E1 08 7B   o.rCG.eS.......{
ISAKMP:  DA EB 39 7D EC 9E DB 6D 3B BA 63 B5 53 F5 74 B2   ..9}...m;.c.S.t.
ISAKMP:  9D 9C E2 18 16 7A 4B 4E 25 D6 13 13 F1 FB 83 88   .....zKN%.......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 91 75 DD 45 92 2C CA 07 D8 43 A8 81 C4 9F 2B   ..u.E.,...C....+
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11D9 (4569)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x290C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x5505 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6F 29 53 08 DF EB E5 09                           o)S.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7D 35 D2 9E 52 05 B3 5F                           }5..R.._
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  60 F5 B2 B9 86 71 29 D1 6C 0A CC E8 56 ED 41 E7   `....q).l...V.A.
ISAKMP:  D9 C9 72 74 7D C5 C0 01 9D C6 28 40 14 13 E3 1E   ..rt}.....(@....
ISAKMP:  A6 5A E0 B1 D3 11 B7 C7 5F 27 CD 79 FB 1D D4 BB   .Z......_'.y....
ISAKMP:  24 0E 55 B7 11 C7 22 02 81 4D 9A 23 82 B9 02 57   $.U..."..M.#...W
ISAKMP:  DE 4E 21 E1 60 8A 37 89 E5 8B 97 46 9A 39 16 8F   .N!.`.7....F.9..
ISAKMP:  40 71 84 80 EB 89 F6 B4 F2 F4 13 FA B6 DA 32 A8   @q............2.
ISAKMP:  3E 49 B2 75 92 ED 47 50 0E FD FA 0C 41 64 7B FE   >I.u..GP....Ad{.
ISAKMP:  50 2E C5 D4 34 29 F6 C9 76 87 EE 1A 22 30 66 86   P...4)..v..."0f.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  87 7A 15 5F A0 0B FB A2 85 80 0A 5E 72 6A 18 37   .z._.......^rj.7
ISAKMP:  92 AF EC 7D 5F 57 0A 0F 6A DE CA 36 D0 F4 F2 0D   ...}_W..j..6....
ISAKMP:  4F CC 3F 4A C3 06 E4 00 CB 3F 59 BE 6F 68 99 66   O.?J.....?Y.oh.f
ISAKMP:  BA ED 4D 96 27 47 70 3A 2A D9 24 24 29 39 CF 6C   ..M.'Gp:*.$$)9.l
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  26 7F F3 F8 64 F9 6E 8A 1A D5 CD 0E EB 35 7D 24   &...d.n......5}$
ISAKMP:  0B 54 BB A3                                       .T..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with next payload of ISAKMP HDR set to SA

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.11: Passed

>> IKE-16.12
TEST_DESCRIPTION
IKE MUST not modify SA Attributes of any offer in an outbound
ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p9 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal containing 
        one Transform with SA Attributes
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with one Proposal containing
        one Transform with the same SA Attributes with the same values
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal containing 
one Transform with SA Attributes Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B2B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x1499 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 1C 3E 40 27 26 B1 40                           L.>@'&.@
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  70 58 22 09 C5 3B AF C9 5A 0D CD 70 FD 0F 24 99   pX"..;..Z..p..$.
ISAKMP:  F4 F4 F0 5A EB A8 63 F3 27 6C B7 28 59 2E 9A 48   ...Z..c.'l.(Y..H
ISAKMP:  BC F2 B9 2D D2 FA 7E 0D E9 39 42 B7 BF D9 D1 61   ...-..~..9B....a
ISAKMP:  CB D7 4E 49 C4 9D 51 F3 21 BA 73 3C CD AB DB A0   ..NI..Q.!.s<....
ISAKMP:  CE DA 7A 03 5A 2D DE B5 DF E2 59 D5 00 AB 99 A1   ..z.Z-....Y.....
ISAKMP:  5C F3 99 92 2C F3 57 AE 77 58 70 46 2D 45 66 51   \...,.W.wXpF-EfQ
ISAKMP:  3F 92 1E 23 00 31 E4 60 8D BC 63 10 EA 76 54 7E   ?..#.1.`..c..vT~
ISAKMP:  BC 6E 0F 4A 66 37 07 C8 FA EF 31 DA 89 B7 76 38   .n.Jf7....1...v8
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DA DE 21 13 E7 4E C4 F8 3C 85 DE E7 0D 31 C5 25   ..!..N..<....1.%
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11DA (4570)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x290B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x6D3B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 1C 3E 40 27 26 B1 40                           L.>@'&.@
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  0D E5 BC AE CD 2A B2 A3                           .....*..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  76 EE 7E 5D 4D 86 86 19 F4 5E 5D FA 4C 60 49 54   v.~]M....^].L`IT
ISAKMP:  72 E5 91 83 15 03 8B FC 64 6F 95 40 F1 13 BC 25   r.......do.@...%
ISAKMP:  46 0B EB DD BE 93 49 CE 68 B8 34 DB 2E 36 A1 AB   F.....I.h.4..6..
ISAKMP:  79 33 CA D8 9B 89 56 A6 39 AD 92 29 69 C6 23 3D   y3....V.9..)i.#=
ISAKMP:  70 B8 0E FF 49 3C 06 3F 5B 35 4D EB 31 40 87 98   p...I<.?[5M.1@..
ISAKMP:  C4 89 9A BE 73 74 9D C0 7A BB A7 7C BD A4 09 1C   ....st..z..|....
ISAKMP:  51 6D 8C 10 1E 7B 45 F5 1C 92 CE A6 26 08 AD CF   Qm...{E.....&...
ISAKMP:  C8 1B 36 EB 0F F6 D4 43 1A 84 7B C5 B2 FF 6C 7F   ..6....C..{...l.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  0D 0C 69 9E 3C 9D 36 4A D5 AF 9A 64 05 28 3D FD   ..i.<.6J...d.(=.
ISAKMP:  C1 0E 8A 6F AD 9D 02 0A C9 D2 49 DD 31 DA B3 1B   ...o......I.1...
ISAKMP:  5A ED 72 DD 85 6A D7 BB 17 D4 2F C6 3A 45 80 5B   Z.r..j..../.:E.[
ISAKMP:  88 42 3E A2 9D 95 39 C0 BE 59 5E B4 D3 8C 84 E3   .B>...9..Y^.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  AC C1 65 8E 0E D3 DC 66 09 24 43 5B B2 09 C2 E9   ..e....f.$C[....
ISAKMP:  A4 99 64 41                                       ..dA
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received 1 Proposal payload
Correctly, received 1 Transform payload
Received SA Attributes are same with
Encryption Algo = 1
Hash Algo = 2
Authentication Method = 1
Group Description = 2

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.12: Passed

>> IKE-16.13
TEST_DESCRIPTION
IKE MUST support SIT_IDENTITY_ONLY for Situation field in the Security
Association Payload
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2407 s4.2 p3 IPSEC Situation Definition
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Situation field of SA set
        to SIT_IDENTITY_ONLY
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Situation field of SA
        set to SIT_IDENTITY_ONLY
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Situation field of SA set
to SIT_IDENTITY_ONLY to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B2A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x2234 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  14 20 F5 32 1A D2 B4 33                           . .2...3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C8 1A C0 59 BE 92 B3 ED D3 7B 28 E8 96 6C 6B 84   ...Y.....{(..lk.
ISAKMP:  63 F1 53 05 9F A5 D0 4E 75 B0 B0 CA 19 7F 33 68   c.S....Nu.....3h
ISAKMP:  D7 34 96 1C 92 5F 17 DB FD 0C 5A 38 F9 F2 42 01   .4..._....Z8..B.
ISAKMP:  39 2D BD 6D CB 09 DA EA 0C 14 A1 8B B5 B1 0B 5C   9-.m...........\
ISAKMP:  CE 4F 16 03 6A 4C 1B A9 4F 6F 3F 03 81 EF C2 92   .O..jL..Oo?.....
ISAKMP:  EC AD E5 98 A7 E5 87 29 FA A8 F9 8A F6 FE AD 6B   .......).......k
ISAKMP:  86 CA 46 5D 3B E0 B4 A5 0B A0 C7 0A 7F 75 38 CE   ..F];........u8.
ISAKMP:  47 25 0C 31 02 E6 29 A0 0F BE AF F4 4B 1C A7 8C   G%.1..).....K...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F6 EF 52 18 06 88 C8 38 17 4A 4F 18 FF 47 69 29   ..R....8.JO..Gi)
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11DB (4571)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x290A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xAEE3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  14 20 F5 32 1A D2 B4 33                           . .2...3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  21 0E 22 DC 2B 62 8D F3                           !.".+b..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  67 E3 44 6B D7 24 56 DA A0 47 88 C7 EC 91 55 31   g.Dk.$V..G....U1
ISAKMP:  C7 84 04 FD D5 7A 5F 24 25 8D F7 A5 6C 69 E3 E6   .....z_$%...li..
ISAKMP:  74 08 D7 D1 D9 95 0D CA EF 9C 1C C3 9C DA 55 E6   t.............U.
ISAKMP:  0E BF AF ED F0 1B F1 BE 86 F8 5C 03 2B 25 83 5E   ..........\.+%.^
ISAKMP:  9E 79 C0 6D 93 94 DC F7 52 68 6C 53 26 A5 B0 0D   .y.m....RhlS&...
ISAKMP:  06 2F 02 98 88 B8 36 95 D3 25 3A C5 6D 42 5E 00   ./....6..%:.mB^.
ISAKMP:  FD C4 33 66 C6 3A 19 0E B2 B0 5B 5C 70 4C 63 45   ..3f.:....[\pLcE
ISAKMP:  11 32 68 39 9E 91 41 B1 76 CF 72 2F 3C 73 8A 4C   .2h9..A.v.r/<s.L
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  72 FE 4F DB C2 D2 BB F5 F1 37 A2 B9 9C 09 7A BA   r.O......7....z.
ISAKMP:  E1 9D CE 6E 6F 82 94 EA 67 D9 39 86 F7 FB 31 C6   ...no...g.9...1.
ISAKMP:  80 85 54 23 02 28 65 73 F8 16 09 8B FC 5A 61 EC   ..T#.(es.....Za.
ISAKMP:  6C BD 86 7C 3C 20 16 B1 7B 17 1B F0 2D CB 75 16   l..|< ..{...-.u.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E3 C6 C8 03 23 70 A6 DC 9B FE F5 5A 2D A1 12 C2   ....#p.....Z-...
ISAKMP:  DB B9 C2 97                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R>
Packet from DUT with situation field set to
SIT_IDENTITY_ONLY

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.13: Passed

>> IKE-16.14
TEST_DESCRIPTION
IKE MUST set the Payload Length field of Proposal Payload
to (PROPL_HLEN + Total length of all Transforms) in an outbound
ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s5.1 p58 General Message Processing
RFC 2408 s3.5 p28 Proposal Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Payload Length
        of Proposal to (PROPL_HLEN + Total length of all Transforms)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B29 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x8B2C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  16 50 47 72 08 40 28 33                           .PGr.@(3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A9 85 E3 E3 D6 3A 83 07 28 9B 1A 71 4C A7 97 0A   .....:..(..qL...
ISAKMP:  7C 42 A3 F9 64 04 FB 7D 79 30 BE 01 09 13 07 D1   |B..d..}y0......
ISAKMP:  1F C9 AA F4 CB 47 12 2E 77 16 E0 9E 62 F0 6A 52   .....G..w...b.jR
ISAKMP:  A1 E9 1F D6 1E 33 03 1A 59 EA CA 06 11 77 64 D8   .....3..Y....wd.
ISAKMP:  A9 84 B5 E7 56 53 A3 E5 33 76 23 A7 C0 AB 1A 80   ....VS..3v#.....
ISAKMP:  DB 84 83 77 A0 2D 71 75 7D 31 F2 6B 54 8D 03 D2   ...w.-qu}1.kT...
ISAKMP:  F5 3B B0 55 BD 51 3F B0 D6 5C 33 0A 04 7D D6 DB   .;.U.Q?..\3..}..
ISAKMP:  9B AA 96 A7 EC 73 43 35 98 4B 2D 05 EE C7 F7 8B   .....sC5.K-.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4E 3D 91 DE 0C C2 B5 3C C0 4A 36 69 0A 26 47 3D   N=.....<.J6i.&G=
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11DC (4572)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2909 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x3BD1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  16 50 47 72 08 40 28 33                           .PGr.@(3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C1 C4 31 5D 17 76 AA 47                           ..1].v.G
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6F 56 18 C5 18 14 51 EC 16 0D F2 52 BA F4 8B 17   oV....Q....R....
ISAKMP:  45 B7 16 41 E3 C8 7E BA 81 7A 40 5B 98 29 6A 07   E..A..~..z@[.)j.
ISAKMP:  6E 38 1F CD 1C 0D 3D 3E A8 7D 55 3A 9A CD EF C2   n8....=>.}U:....
ISAKMP:  2F 88 B1 4C 05 2F 3E 48 80 65 D1 F8 A5 66 CA 05   /..L./>H.e...f..
ISAKMP:  47 62 F2 FD 5F C1 C6 C9 D6 9F F7 27 F2 9C A4 E6   Gb.._......'....
ISAKMP:  46 EF CD AB 12 19 FA 40 18 E2 DC 35 A6 31 9C 58   F......@...5.1.X
ISAKMP:  28 5C 51 B0 76 46 6D 25 75 FE 4D 7B CD 68 26 20   (\Q.vFm%u.M{.h& 
ISAKMP:  F4 3C FB 1A 55 80 62 0E FD 4D F2 3C E8 69 C5 36   .<..U.b..M.<.i.6
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  03 AC 1F C7 A1 9C DF 42 38 82 C9 4A 48 CE 1B 87   .......B8..JH...
ISAKMP:  05 A3 FC 2D B8 97 ED 2B 5C 18 96 29 8C C6 48 1C   ...-...+\..)..H.
ISAKMP:  34 F7 1B C5 53 12 C5 E3 1D 3F 18 6D A9 A1 A1 D3   4...S....?.m....
ISAKMP:  38 F8 0B AA BF 3B FC D7 A0 7A 67 D4 F9 43 80 C9   8....;...zg..C..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  5B 97 07 10 1B A2 02 8B 10 7F 49 70 7F F3 43 79   [.........Ip..Cy
ISAKMP:  3F 63 38 DE                                       ?c8.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.14: Passed

>> IKE-16.15
TEST_DESCRIPTION
IKE MUST set the Payload Length field of Transform Payload to
(TRANS_HLEN + Total length of all SA Attributes) in an outbound
ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s5.1 p58 General Message Processing
RFC 2408 s3.6 p29 Transform Payload              
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Payload Length
        of the Transform to (TRANS_HLEN + Total length of all
        SA Attributes)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B28 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x0B8F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4B 02 C1 77 40 52 B1 26                           K..w@R.&
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  52 79 8B E2 95 1E F4 BC 97 85 5F DF 6B 0C C4 05   Ry........_.k...
ISAKMP:  B7 99 87 21 F8 48 B6 4D 5E 53 95 BA C0 6A 2E 0C   ...!.H.M^S...j..
ISAKMP:  36 FF 37 15 A7 54 69 FE 8F 10 2D BA 04 D0 F7 50   6.7..Ti...-....P
ISAKMP:  89 71 2A F5 9D 1C ED 3E 80 80 E6 07 78 13 FD 40   .q*....>....x..@
ISAKMP:  EA AA EA F6 86 0D A4 DC 7B 8A 13 C5 28 7A DE 6F   ........{...(z.o
ISAKMP:  B2 54 52 B8 60 84 0D 2F B9 42 24 96 48 9C F6 CB   .TR.`../.B$.H...
ISAKMP:  F3 AA CA 1F B5 FC 5B DC D4 17 B9 93 E9 A9 10 0B   ......[.........
ISAKMP:  C6 20 59 7B 1C 65 81 EC A4 BB F3 BC 0E 79 6F 2F   . Y{.e.......yo/
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  93 F9 66 7B 61 B6 52 BE 21 00 73 8A 33 E9 F8 98   ..f{a.R.!.s.3...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11DD (4573)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2908 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x1842 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4B 02 C1 77 40 52 B1 26                           K..w@R.&
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C5 88 7F C9 5E 60 E7 AA                           ....^`..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5E E7 38 FE 66 F0 A8 1F F6 6D 88 44 3B FC 14 58   ^.8.f....m.D;..X
ISAKMP:  1B 58 D8 B3 C7 77 DA EE 6A 2F AA 88 29 C8 C5 FD   .X...w..j/..)...
ISAKMP:  88 1B 86 4E 00 52 4D CE A9 86 49 57 E6 CE B2 14   ...N.RM...IW....
ISAKMP:  44 98 5B C0 65 E3 BB 8D 3A 92 A8 74 50 71 9B 82   D.[.e...:..tPq..
ISAKMP:  00 7F 8E 1C 50 4C 2B 19 E3 46 CC 7C 24 B6 76 9C   ....PL+..F.|$.v.
ISAKMP:  CB 27 8B E2 E4 41 8C 28 96 55 8E 3D 7F 47 16 4B   .'...A.(.U.=.G.K
ISAKMP:  A3 F0 24 3B F6 AC 4C 28 DC CE 15 40 2A 9A D8 AC   ..$;..L(...@*...
ISAKMP:  7B F3 BD FB 39 E4 66 1B DA 05 FA 0A 76 7C 9D EC   {...9.f.....v|..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F5 FD 3A 4B EB 51 10 FE D8 1C F7 8D D3 5E 78 72   ..:K.Q.......^xr
ISAKMP:  C8 F3 64 35 C8 AD 1B DD 8F F3 1F C4 5B C0 F0 4E   ..d5........[..N
ISAKMP:  E0 3C 66 4E 2C 41 A6 ED 1A BB C6 FC F0 BB 51 00   .<fN,A........Q.
ISAKMP:  50 FC 8D 97 52 34 1C AF 9C C6 1D 2A 63 A3 33 84   P...R4.....*c.3.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  56 2E 4D AD 47 50 B3 AC C1 B4 81 82 75 9D AF 7E   V.M.GP......u..~
ISAKMP:  92 F2 7C 15                                       ..|.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.15: Passed

>> IKE-16.16
TEST_DESCRIPTION
IKE MUST set the DOI field of Security Asociation Payload
to 0 or 1 (for IPSec) in an outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408, s3.4 p27 Security Association Payload
RFC 2408, s5.4 p62 Security Association Payload Processing
RFC 2409  s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir,HASH_R> setting DOI field
        in SA to 0 or 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B27 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x71BB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EC 6E 00 07 4A 2D 73 48                           .n..J-sH
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  CE C6 4C E1 C5 A4 79 C9 59 B9 E5 89 BC 98 39 83   ..L...y.Y.....9.
ISAKMP:  93 86 FB 34 55 4E 00 7D D8 2C A3 35 1F 5A 3E 37   ...4UN.}.,.5.Z>7
ISAKMP:  6F 98 94 1D FF A9 BB DF B1 8E 58 1A C0 85 B3 0A   o.........X.....
ISAKMP:  3B 73 E9 75 30 1C 0B CC 55 70 B0 3A BD 48 BA F2   ;s.u0...Up.:.H..
ISAKMP:  33 A2 BD 3D 19 AB 33 FA 41 80 C2 89 F8 C7 30 FD   3..=..3.A.....0.
ISAKMP:  78 35 E5 C1 C4 6D F7 CD 48 F3 02 A5 B1 7A D7 0B   x5...m..H....z..
ISAKMP:  82 7D C3 E9 00 4A 16 68 A2 7C 08 EC 79 5A ED 85   .}...J.h.|..yZ..
ISAKMP:  65 AE 9C 13 06 1F 3F FA 3F A3 9A 2C 3E 7E BC DC   e.....?.?..,>~..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E6 F2 B1 AE 4B 76 09 BF 04 C4 9F DA C0 1F BE 5D   ....Kv.........]
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11DE (4574)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2907 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x32BF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EC 6E 00 07 4A 2D 73 48                           .n..J-sH
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  4C 9D 45 22 EF 16 6C DC                           L.E"..l.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  29 E2 9E DC 47 8C B9 06 1B 60 2B 42 6F A9 E4 4F   )...G....`+Bo..O
ISAKMP:  94 AE B1 34 39 2A 95 90 15 5E 5A 91 3A 0A 6B 3B   ...49*...^Z.:.k;
ISAKMP:  F6 C5 92 70 48 54 52 95 41 C2 6F 56 81 7D 3F 13   ...pHTR.A.oV.}?.
ISAKMP:  E4 72 65 66 8E BA 49 E4 93 2F 7D 1A 11 41 C3 A4   .ref..I../}..A..
ISAKMP:  4C 39 6F 3E CD FD 9A 21 1B 58 FE 0D E4 BD 61 E8   L9o>...!.X....a.
ISAKMP:  7A F9 CA 36 0B 38 1C C3 22 3B 5E C7 A7 A8 81 A3   z..6.8..";^.....
ISAKMP:  26 D2 8E 73 30 E2 95 F0 AF 94 6D 17 A1 12 47 0F   &..s0.....m...G.
ISAKMP:  CC 07 7E F7 2B 3F A8 AF AB 04 20 02 9A 33 EB EA   ..~.+?.... ..3..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  6D 2A 7E 34 5C F2 94 FE 4E 64 73 87 D2 E0 25 3F   m*~4\...Nds...%?
ISAKMP:  DC C8 D4 94 62 A8 97 D7 1B 5F 94 74 5A BE CA FD   ....b...._.tZ...
ISAKMP:  CD 99 7A 44 4F 9B 03 9A 83 E3 55 26 9C 11 D2 3E   ..zDO.....U&...>
ISAKMP:  D1 1E CF 21 93 FD 99 DD 71 29 2C 51 70 A3 71 7B   ...!....q),Qp.q{
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E1 F4 D9 2C 90 FE 5C FF E2 C8 5C E2 B0 99 51 53   ...,..\...\...QS
ISAKMP:  31 CC 25 6C                                       1.%l
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT with DOI field of SA set to 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.16: Passed

>> IKE-16.17
TEST_DESCRIPTION
During SA Payload exchange, the Responder Cookie field of the ISAKMP
Header MUST be present in an outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.4 p18 Identifying Security Associations
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting CKY-R field in HDR to 
        NON_ZERO_VAL (e.g. 2 )
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B26 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x7479 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9D 24 A6 2F F1 4B A5 70                           .$./.K.p
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A6 4A 21 C2 8C 1E B5 F0 43 BC BE E6 A3 2A B8 80   .J!.....C....*..
ISAKMP:  2C A4 2C 62 2F F8 FB 56 D2 21 E2 EB 77 9D 3C A9   ,.,b/..V.!..w.<.
ISAKMP:  0A A6 44 2C 7B 5B ED 06 06 FE AD 14 C5 6E 2B 41   ..D,{[.......n+A
ISAKMP:  88 D2 BB A0 5F 77 4B 1A A6 A8 93 DA A8 57 8D D3   ...._wK......W..
ISAKMP:  AC 1F EE E3 9B B2 DD 0B E7 B9 01 36 4B 56 F0 E4   ...........6KV..
ISAKMP:  48 2C EF 7E D2 76 D9 7D 95 E0 73 C3 B9 47 A0 C5   H,.~.v.}..s..G..
ISAKMP:  CD 32 E2 0A 67 8D B8 51 C4 FF 83 F7 33 32 65 A8   .2..g..Q....32e.
ISAKMP:  74 A3 CF 19 C9 F9 0D 9D 8D 79 1A BF DC 4A 00 46   t........y...J.F
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  65 09 7D 43 7C 96 75 1D C5 34 90 90 AD 05 74 6A   e.}C|.u..4....tj
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11DF (4575)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2906 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x1238 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9D 24 A6 2F F1 4B A5 70                           .$./.K.p
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B5 FB B2 65 67 34 74 17                           ...eg4t.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2A 0A DC CE AA BD D5 85 F4 20 27 93 69 22 B1 1D   *........ '.i"..
ISAKMP:  31 A5 A5 82 A9 CC 10 1B 42 D0 1C 06 3E 4E A1 84   1.......B...>N..
ISAKMP:  3B AA 2B A5 82 CA 82 AC 9D 61 8E 3F 86 33 1D 9A   ;.+......a.?.3..
ISAKMP:  A2 AF 42 33 C6 B1 45 88 BC 10 BB 96 3C 33 C0 A6   ..B3..E.....<3..
ISAKMP:  FC DA 91 7C 6D DE 08 95 EF 0B 99 93 46 1C CC F9   ...|m.......F...
ISAKMP:  44 60 9F 18 86 25 A8 8E 49 CB 50 12 FF B3 53 51   D`...%..I.P...SQ
ISAKMP:  01 DE 93 B4 CF AF C4 67 BA E2 9A 5F 21 D3 84 53   .......g..._!..S
ISAKMP:  3E 3F 5F 0B 0B 8B 82 21 C2 40 52 D0 3A 1A 1C BC   >?_....!.@R.:...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  23 63 2F 81 38 0A 75 D5 AD 62 21 73 45 E8 37 09   #c/.8.u..b!sE.7.
ISAKMP:  AD 9E 45 31 9C 18 E4 8B EE 68 B4 DB B4 C7 9A 76   ..E1.....h.....v
ISAKMP:  72 DD E7 A4 A4 CB F7 98 B5 32 52 B7 6A 17 39 43   r........2R.j.9C
ISAKMP:  E3 3B CB BA F4 C7 43 A3 90 23 42 12 E2 60 2E E6   .;....C..#B..`..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F7 88 BF C6 35 B8 D8 32 27 0F 3B 64 A6 03 C8 A3   ....5..2'.;d....
ISAKMP:  7B BF 20 CC                                       {. .
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT with valid Cookies

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.17: Passed

>> IKE-16.18
TEST_DESCRIPTION
IKE MUST set the Length field of ISAKMP Header to (ISKMP_HLEN + Total
length of all Payloads) in an outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s 5.1 p58 General Message Processing 
RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Length of the HDR to 
         (ISAKMP_HLEN + Total length of all Payloads)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B25 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x1FE3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  92 13 FF 00 F5 FB 54 02                           ......T.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2F F6 11 6F 24 7D 9C 57 C6 7E 38 D8 CF 9E 6C 06   /..o$}.W.~8...l.
ISAKMP:  B1 6F 90 24 6C D4 8A E4 29 27 8F 0D E1 4E 96 0F   .o.$l...)'...N..
ISAKMP:  10 55 B1 3D D3 E1 36 92 34 ED 8A 28 00 A3 1F 01   .U.=..6.4..(....
ISAKMP:  83 E4 F7 5B AF 50 09 99 FB 57 E0 DB B1 8E 97 1B   ...[.P...W......
ISAKMP:  A6 10 93 C4 62 44 50 5D AE C6 75 8C BC 71 5C 81   ....bDP]..u..q\.
ISAKMP:  1A 4D A4 72 24 74 70 64 6A 8E EF F0 20 BA C3 BA   .M.r$tpdj... ...
ISAKMP:  F6 EB 75 51 84 EA DB 4A 73 22 9D E4 0C EB 5B BC   ..uQ...Js"....[.
ISAKMP:  2E 43 9B 6E CC D9 B0 10 E4 8A 92 F0 A3 FD FA 65   .C.n...........e
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  64 0F 07 25 8D 4F 86 75 10 7D 49 D7 77 4C 28 74   d..%.O.u.}I.wL(t
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E0 (4576)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2905 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x69EC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  92 13 FF 00 F5 FB 54 02                           ......T.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FA 6E 56 AD 3B BB DD BE                           .nV.;...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4A C3 16 A4 B5 80 4D 20 88 F8 4D 72 3D CE 2F 3B   J.....M ..Mr=./;
ISAKMP:  1E 5E 5C 59 39 AE 76 B6 5A EA AC B3 86 73 E9 16   .^\Y9.v.Z....s..
ISAKMP:  D4 E0 88 95 F0 0C A1 6E D2 94 5F BD 63 F7 9C 74   .......n.._.c..t
ISAKMP:  0A 3E F3 54 04 5B 64 B0 70 6E BC 78 32 1E 44 6D   .>.T.[d.pn.x2.Dm
ISAKMP:  E5 79 3B E9 29 95 00 02 3B E9 BE 0B 7F 05 57 44   .y;.)...;.....WD
ISAKMP:  D3 62 3B 45 8B 85 FD 00 0D 6F F6 C0 80 7A 80 C7   .b;E.....o...z..
ISAKMP:  52 01 0F C1 AD E8 01 27 C6 52 63 F2 8D 4B 53 2C   R......'.Rc..KS,
ISAKMP:  57 C3 EE 62 DF 97 F3 C1 2F F2 2F ED E2 FD 8A BB   W..b...././.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  BB F0 98 58 9E A4 6C 01 B4 5B 16 0D A0 72 36 97   ...X..l..[...r6.
ISAKMP:  1F 7C 65 BE 09 89 AF C3 74 47 17 D0 57 41 A5 77   .|e.....tG..WA.w
ISAKMP:  E3 F3 47 52 A6 D1 F2 73 2D 54 9F 97 0B 00 61 39   ..GR...s-T....a9
ISAKMP:  78 F9 B0 19 BD 5C 10 59 FD 8B FF 44 3A 7B BD D6   x....\.Y...D:{..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  7E 0C 35 0F C3 09 94 53 59 60 F9 A2 82 F3 48 4D   ~.5....SY`....HM
ISAKMP:  3E 94 14 42                                       >..B
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet with
correct HDR payload length 336
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.18: Passed

>> IKE-16.19
TEST_DESCRIPTION
IKE MUST not set the NP field of Security Association Payload to 
Transform Payload
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting NP field in SA not to
        Transform Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B24 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x6490 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE BC 57 3A F8 52 BF 3B                           ..W:.R.;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E3 03 48 5A 16 E3 B8 B0 93 92 2B B9 8B A6 18 15   ..HZ......+.....
ISAKMP:  4F 33 0E 46 0F 19 B3 79 1A A4 E4 B7 AB 28 F6 80   O3.F...y.....(..
ISAKMP:  47 0F 28 BA C5 5E DB 70 EB 6E 5E 22 B8 92 AE 25   G.(..^.p.n^"...%
ISAKMP:  29 EB 55 BF 4E 79 A1 FF 5C 51 1C AC CF 71 57 0D   ).U.Ny..\Q...qW.
ISAKMP:  13 24 12 38 D2 7D EF 4B F3 2C 6C C8 FA AB 80 16   .$.8.}.K.,l.....
ISAKMP:  5A 9B 13 60 2B 21 45 ED E5 CB 75 CA 11 14 3E B3   Z..`+!E...u...>.
ISAKMP:  F7 03 D7 6B 5E AC 39 95 E3 D7 81 23 06 A5 02 92   ...k^.9....#....
ISAKMP:  01 4E DE B2 4B 49 8A 4D F2 8F 50 3F 14 9A AB BD   .N..KI.M..P?....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  3D 1C E5 C0 A4 AF 25 FF 23 DA 23 7F 92 D9 A9 7F   =.....%.#.#.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E1 (4577)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2904 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xAC1F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE BC 57 3A F8 52 BF 3B                           ..W:.R.;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  6B 70 6B D0 FE 0F 7C A4                           kpk...|.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  73 A5 EA 43 AB 98 7E D3 0C 82 45 2B BA B5 F6 50   s..C..~...E+...P
ISAKMP:  FF 9F 27 2A CD A6 D6 61 C6 E7 24 ED 4B D5 6F F4   ..'*...a..$.K.o.
ISAKMP:  71 F4 79 EA E4 12 B1 A2 D3 5B BD B0 B6 C9 71 A0   q.y......[....q.
ISAKMP:  E2 BD A6 87 BD ED 8F E7 9A F4 0C 14 2A DD 55 CD   ............*.U.
ISAKMP:  03 52 BF 98 AB BB 26 3E 5B 1F AF 45 38 9A CA 3C   .R....&>[..E8..<
ISAKMP:  22 15 0F 09 91 76 0A 53 9E 5E D1 D9 3C 90 DA EA   "....v.S.^..<...
ISAKMP:  EA 36 4E 5A 36 8D E7 CD CD 50 D0 DA 92 44 32 3F   .6NZ6....P...D2?
ISAKMP:  14 21 83 B6 39 10 B5 C5 8E 94 46 E0 EF FA 7C CC   .!..9.....F...|.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D5 9F CF 9E C4 28 A3 3A FE E1 CA 91 87 AF E5 B3   .....(.:........
ISAKMP:  27 00 7A 09 C6 65 CE 7A 86 86 D3 1B 3B 4C 41 20   '.z..e.z....;LA 
ISAKMP:  1C E5 06 4A 27 A8 85 EF 67 2C EA CA 4B 9A 7B 61   ...J'...g,..K.{a
ISAKMP:  BE EB C6 C5 44 1E C3 F7 1C EF 12 27 5F E3 8A 86   ....D......'_...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  AF AB 25 85 C0 9D AE 09 5C 88 65 CE 5C 1E BA 17   ..%.....\.e.\...
ISAKMP:  51 3A 32 40                                       Q:2@
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Next Payload of SA (4)(Should
be: 4) not set to Transform

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.19: Passed

>> IKE-16.20
TEST_DESCRIPTION
In Phase 1, the SPI Size is irrelevant and MAY be from 0 to 16, if
SPI Size is non-zero the content of SPI field MUST be ignored
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.5 p29 Proposal Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the SPI Size in SA set
        to <SPI-SIZE>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R>
- CASE: <SPI-SIZE> = 0
- CASE: <SPI-SIZE> = 16
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:1 Set SPI Size to 0 in Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with the SPI Size in SA set to <SPI-SIZE> 0 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B23 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x54A2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  97 99 4F 28 0F 77 B9 17                           ..O(.w..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  46 94 98 E4 F1 66 E7 A8 3F 52 89 64 8C 62 33 5F   F....f..?R.d.b3_
ISAKMP:  60 B5 52 DA A6 1A 1B 45 08 D1 C0 5E 48 D2 1A C7   `.R....E...^H...
ISAKMP:  28 69 57 4A 0A D5 0A 22 CD 45 B1 65 77 8A B3 66   (iWJ...".E.ew..f
ISAKMP:  42 A9 C9 42 6B 1C 74 49 A5 9B 70 08 4B 0D 5A 00   B..Bk.tI..p.K.Z.
ISAKMP:  EA F2 B2 06 FC E8 EE A0 8B 21 30 43 5C 0C 08 0D   .........!0C\...
ISAKMP:  2B 23 29 7F 8F 4F 67 48 8D 4B 85 D0 11 C4 C2 CE   +#)..OgH.K......
ISAKMP:  51 67 41 E3 3F 12 09 08 D4 20 00 12 45 72 A5 30   QgA.?.... ..Er.0
ISAKMP:  C4 FE D2 86 F0 BE DA 62 CB 5D 05 1D A7 27 C0 52   .......b.]...'.R
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A6 4C DC 21 43 24 D0 EB 3C C3 27 B7 13 9E 93 79   .L.!C$..<.'....y
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E2 (4578)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2903 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xF206 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  97 99 4F 28 0F 77 B9 17                           ..O(.w..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F2 85 52 1B 2D A6 85 08                           ..R.-...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  72 C3 53 26 6F AB D0 20 37 B3 62 A2 B1 1F 95 BB   r.S&o.. 7.b.....
ISAKMP:  8E 53 AF 1F CD DC 9D 66 7F 35 24 79 29 38 BE 0A   .S.....f.5$y)8..
ISAKMP:  7A DC 79 28 DC 5A 36 6B DD 48 9B F8 C1 E7 7F A1   z.y(.Z6k.H......
ISAKMP:  8A E1 CF C7 B9 15 9E A5 19 E5 A4 E3 86 CC 89 E9   ................
ISAKMP:  F5 89 F4 EF 1A B0 07 11 AE 52 69 A9 DF D5 FA 88   .........Ri.....
ISAKMP:  E1 ED 48 2A 4D 33 27 A4 01 E9 29 50 D0 75 EF 89   ..H*M3'...)P.u..
ISAKMP:  85 93 DC E1 79 F2 74 A0 77 BA DE 84 1E AD C3 4D   ....y.t.w......M
ISAKMP:  23 DA 7B 4F 6C 04 79 F4 A9 F0 03 04 84 B1 7E C1   #.{Ol.y.......~.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  6D C7 CE 54 C1 04 90 A4 8D 36 6C F9 63 D1 4A 1F   m..T.....6l.c.J.
ISAKMP:  76 38 01 1D 7F FB E5 26 CA 8A D6 89 AB 18 19 E8   v8.....&........
ISAKMP:  63 2D 41 1E 14 55 FF FE E8 25 03 30 E1 B0 CE AA   c-A..U...%.0....
ISAKMP:  6A 3C A6 D5 8D B7 0A 72 58 9D AC D4 7C 21 C1 84   j<.....rX...|!..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F1 1F A4 3C 8B 75 05 E8 F9 B6 D1 6D 5E 86 99 3C   ...<.u.....m^..<
ISAKMP:  65 B3 C5 DA                                       e...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:2 Set SPI Size to 16 in Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with the SPI Size in SA set to <SPI-SIZE> 16 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 280 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B12 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 260 
UDP: Checksum         = 0x5892 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  70 75 4A 53 95 9C 5A 14                           puJS..Z.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 252 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 60 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 48 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 16
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [16 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3E 7D 70 88 DD 8D 39 70 A8 8E FB 76 D6 D0 03 BE   >}p...9p...v....
ISAKMP:  CB 96 6E F6 5D 5D 47 37 2E E4 C4 C4 67 31 7C EE   ..n.]]G7....g1|.
ISAKMP:  73 24 97 B3 2E 68 9A 36 0E 93 21 02 3D 2E DD EB   s$...h.6..!.=...
ISAKMP:  60 FF 9D 96 E0 85 34 B8 67 74 B9 14 8C FD F5 C9   `.....4.gt......
ISAKMP:  6D 62 25 52 E8 2C B1 1F 9E A2 29 1E 36 C7 A7 0A   mb%R.,....).6...
ISAKMP:  15 5E A5 CC D3 A2 9F 1B 9C AE 3F 02 03 24 F8 9A   .^........?..$..
ISAKMP:  63 9D 49 70 65 3B 6D EA 21 B7 16 6A DA 75 18 93   c.Ipe;m.!..j.u..
ISAKMP:  63 AA F6 A2 D6 8F BE 95 9B C1 DD CB 12 40 3A AF   c............@:.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6B E9 6B D9 3E 7D 6F 64 4C 98 F4 FA AE B1 E2 74   k.k.>}odL......t
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 380 bytes
IP: Identification         = 0x11E3 (4579)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x28F2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 360 
UDP: Checksum         = 0x8BA2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  70 75 4A 53 95 9C 5A 14                           puJS..Z.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  95 FD BE 3A 9D 48 F8 F5                           ...:.H..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 352 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 16
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [16 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D7 2F 03 C9 21 3B 79 63 91 7F B1 DE A2 83 37 FE   ./..!;yc......7.
ISAKMP:  BB BE C8 51 64 6D 6D 28 5B 6A F2 CE EC 3A 62 AD   ...Qdmm([j...:b.
ISAKMP:  66 D3 A6 1F D6 DF 7A A3 23 90 1B 47 B1 BC C0 EE   f.....z.#..G....
ISAKMP:  A6 2B 94 35 45 24 81 A7 53 83 C8 46 D0 4C 62 2F   .+.5E$..S..F.Lb/
ISAKMP:  77 68 B8 43 53 BB 86 64 BE 34 41 78 49 13 B9 C8   wh.CS..d.4AxI...
ISAKMP:  F3 54 5D 39 C5 1B F1 69 7A 8C 64 F7 51 9A 99 2F   .T]9...iz.d.Q../
ISAKMP:  FA CE E5 E9 6C B0 18 E2 B5 63 AD A8 9A 61 EA 1A   ....l....c...a..
ISAKMP:  BE 54 96 BC 3F 08 1A A4 9B C5 52 FD 72 60 D8 F9   .T..?.....R.r`..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  88 70 74 F9 52 42 D4 49 D3 58 EE D8 1F 8F 24 24   .pt.RB.I.X....$$
ISAKMP:  3C E0 9F 3F EC 70 78 C9 22 4A 35 30 89 68 79 26   <..?.px."J50.hy&
ISAKMP:  FB 3D 52 13 C7 41 99 27 F6 68 98 5E 6C 24 07 A9   .=R..A.'.h.^l$..
ISAKMP:  66 20 0B 03 7C 15 8A 8E 34 CD F8 CF 6F 0E BD 4E   f ..|...4...o..N
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  06 0C D9 FE 03 9C 14 9C CC 8A 18 BC AA F7 66 DC   ..............f.
ISAKMP:  B6 AE EC 29                                       ...)
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.20: Passed

>> IKE-16.21
TEST_DESCRIPTION
IKE MUST set the RESERVED field in ISAKMP Payloads to 0 in an
outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with RESERVED fields of
        SA, Proposal, Transform, KE, Nr, IDir and HASH_R all 
        set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x7CDF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 A5 D3 6B C4 1E FC 6B                           ...k...k
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  92 53 5D D4 B2 C4 63 EA 02 8A B2 C5 8A F6 10 A6   .S]...c.........
ISAKMP:  42 A1 B8 49 03 70 C7 56 21 9B BA CB 83 96 E6 A8   B..I.p.V!.......
ISAKMP:  7A F8 0A 57 68 89 17 BC 84 1D 1B 6B F4 C2 59 F3   z..Wh......k..Y.
ISAKMP:  45 F9 B1 97 0D FE FE 46 3D 71 D6 24 3A 22 0B E9   E......F=q.$:"..
ISAKMP:  AA A9 B9 31 10 F7 EB D9 5F 70 88 09 4A DD CD 7B   ...1...._p..J..{
ISAKMP:  95 21 21 BF 7B 4E EB D3 75 5F E6 BC 42 FE 0A 1E   .!!.{N..u_..B...
ISAKMP:  7F D4 5A 1A 21 7C C1 23 7A 19 BE CB A0 04 32 5F   ..Z.!|.#z.....2_
ISAKMP:  35 05 4F 39 86 17 6E 29 75 21 49 DF 58 54 60 EC   5.O9..n)u!I.XT`.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  81 08 61 91 D0 D7 69 36 F3 6F A5 25 7F 86 F8 CF   ..a...i6.o.%....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E4 (4580)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2901 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xA058 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 A5 D3 6B C4 1E FC 6B                           ...k...k
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  5D 71 30 61 AF 98 B3 32                           ]q0a...2
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  8B 95 1E 47 EE F0 A1 B1 83 E3 8C D8 A9 FA 56 C1   ...G..........V.
ISAKMP:  64 AC 9D 2F 05 9A 7E E0 D5 B0 A2 7C 74 73 7C BF   d../..~....|ts|.
ISAKMP:  21 53 F7 3B 4E A7 07 8F 95 D4 6A 3D 76 E6 81 D1   !S.;N.....j=v...
ISAKMP:  E9 6E 86 F1 9F 40 28 CD BA F6 7D 48 A7 2C 40 3F   .n...@(...}H.,@?
ISAKMP:  C8 D6 CE EE B9 A6 F6 A0 68 6C 09 DB 13 66 0D 96   ........hl...f..
ISAKMP:  D6 EA 97 35 42 41 B1 8B 57 F5 5D 61 C3 49 5D 5E   ...5BA..W.]a.I]^
ISAKMP:  AE 92 78 CD 64 89 73 A0 4E 6C ED AF A9 A8 64 FF   ..x.d.s.Nl....d.
ISAKMP:  F6 C6 6C D6 00 43 68 3F 4E 19 CA F8 A2 4E 2B 7C   ..l..Ch?N....N+|
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  2D DE 03 EF 86 01 80 28 1D ED ED E7 E2 0F EE 2F   -......(......./
ISAKMP:  12 6C 95 1B AE 1E AC B8 6D FD C0 59 FE EF 4B DC   .l......m..Y..K.
ISAKMP:  49 07 66 96 01 84 FE BF C8 E3 35 81 5C 91 AE 16   I.f.......5.\...
ISAKMP:  4E B9 93 38 A3 21 D2 80 61 AD B4 55 6E 30 50 07   N..8.!..a..Un0P.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  D7 CC 9B 37 7F 43 8A BC EC 26 BC FE 26 0B CA 8B   ...7.C...&..&...
ISAKMP:  25 CD 82 37                                       %..7
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R>
Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with RESERVED field of SA, Proposal,
Transform, KE, Nonce, ID, HASH_R set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.21: Passed

>> IKE-16.22
TEST_DESCRIPTION
IKE MUST set the RESERVED field of Hash Payload to 0 in an outbound
ISAKMP Packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Authentication method is 
        Pre-shared key
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting RESERVED field
        to 0 in HASH_R
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Authentication method is
Pre-shared key Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B20 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xA1B6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  12 B5 53 2C E5 8B 78 6D                           ..S,..xm
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DA 2B 54 58 04 D2 C9 EC 29 72 98 BD A7 2F 66 D0   .+TX....)r.../f.
ISAKMP:  ED 02 AC B2 20 5A 13 CC E3 78 53 74 0D 02 2E 9F   .... Z...xSt....
ISAKMP:  31 4D 90 28 0F F2 B6 8A 7E 50 D8 12 47 13 B5 BD   1M.(....~P..G...
ISAKMP:  C3 52 93 17 FE BD 9D 24 6B 2D 50 81 A5 79 21 35   .R.....$k-P..y!5
ISAKMP:  D1 A6 1E E6 47 5A B8 A4 88 04 CF F6 9D 1C 09 02   ....GZ..........
ISAKMP:  45 A9 64 6E 21 89 38 23 23 E7 F6 10 30 7C F8 32   E.dn!.8##...0|.2
ISAKMP:  1F ED C9 DA 71 DB 1E E0 A4 B1 0E F7 71 B1 B8 FB   ....q.......q...
ISAKMP:  26 C6 4F 7E 4F AF 27 89 9E FC 21 5B B8 6A F1 6E   &.O~O.'...![.j.n
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  17 48 7F ED 6D 87 E5 D0 12 16 6C 58 2F A6 3B 4F   .H..m.....lX/.;O
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E5 (4581)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2900 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x670B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  12 B5 53 2C E5 8B 78 6D                           ..S,..xm
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C2 46 1F E5 09 61 A2 5A                           .F...a.Z
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C5 46 CD 98 D0 1D 2B 2F 21 30 BF 45 1C 5F 67 C2   .F....+/!0.E._g.
ISAKMP:  F2 46 38 D0 AE 01 57 A9 81 5C 6F 48 4D BA E5 D8   .F8...W..\oHM...
ISAKMP:  90 62 15 98 94 69 DE 24 EA 41 3A E3 5A 8A 03 D3   .b...i.$.A:.Z...
ISAKMP:  59 22 0D B8 E7 AD F5 0C 7F 03 24 0D 18 30 99 29   Y"........$..0.)
ISAKMP:  33 E3 DF E2 72 D7 7E B0 A8 39 E9 79 86 B6 4D 54   3...r.~..9.y..MT
ISAKMP:  0C 20 E8 5D AB F9 B0 F3 F5 7C 9B EC 8B DD A9 34   . .].....|.....4
ISAKMP:  A3 B7 BE 25 C9 82 34 04 FE B0 21 4A 2A 50 CC 29   ...%..4...!J*P.)
ISAKMP:  63 70 90 52 05 D6 7B 0C 86 67 E7 6F 9B 08 EA 77   cp.R..{..g.o...w
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  03 CC 41 B3 59 B6 C1 88 AE 77 5A 95 B0 ED D9 7C   ..A.Y....wZ....|
ISAKMP:  8C DE 04 47 CB E3 40 05 7F 36 45 45 B4 09 7B B1   ...G..@..6EE..{.
ISAKMP:  D4 65 69 E7 63 2E 28 F1 1A 66 14 CE 50 57 FD D6   .ei.c.(..f..PW..
ISAKMP:  0F D7 50 57 0C 49 03 21 D9 86 20 41 50 07 61 75   ..PW.I.!.. AP.au
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  BC B0 A7 FA 51 19 20 3B F7 E2 F0 6C 14 9A E3 2B   ....Q. ;...l...+
ISAKMP:  34 01 A4 E3                                       4...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with RESERVED field of HASH_R set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.22: Passed

>> IKE-16.23
TEST_DESCRIPTION
IKE MUST set the Port field of Identification Payload to 0 or
UDP Port 500 in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Port field of 
         IDir to 0 or 500
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x59EB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  79 2A F7 51 15 35 9E 13                           y*.Q.5..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  42 BF 3F AC 83 BE 75 9D 82 3A BF 5C B9 47 9A D4   B.?...u..:.\.G..
ISAKMP:  69 CB 9D 0E E0 CA B9 ED EE A1 48 0B F5 26 EE B1   i.........H..&..
ISAKMP:  7F 13 30 FC A7 61 C0 BA 02 26 2E D9 64 64 16 89   ..0..a...&..dd..
ISAKMP:  E4 FB 1A 5A 4D 5E A2 54 85 EF A6 5D 62 91 F3 F7   ...ZM^.T...]b...
ISAKMP:  9C 80 42 4A 60 5C 50 B5 9C C8 25 48 D9 4F 1B 8E   ..BJ`\P...%H.O..
ISAKMP:  2C E0 F7 EA B4 A4 27 0D 66 90 FF 56 D0 0D B6 AA   ,.....'.f..V....
ISAKMP:  93 62 EE 51 CC 2B 37 0F 4A 22 CB D7 DA 4D 44 C5   .b.Q.+7.J"...MD.
ISAKMP:  43 44 6A DF 0F 2F 45 E0 24 D2 3E DA AD D3 81 15   CDj../E.$.>.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D5 45 0B 12 57 1A 22 16 25 A9 CB 20 37 99 F5 F4   .E..W.".%.. 7...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E6 (4582)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x28FF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x5A69 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  79 2A F7 51 15 35 9E 13                           y*.Q.5..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C8 2E 52 50 E7 42 E9 35                           ..RP.B.5
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3C A2 7E 04 1B 29 C9 87 64 5D 87 C2 7B DC BF F1   <.~..)..d]..{...
ISAKMP:  A5 B5 F3 34 BA D0 79 06 F0 08 15 04 E1 19 52 6E   ...4..y.......Rn
ISAKMP:  AB 7F D3 C8 4B 86 A4 E6 6D AD 8C A6 F8 9E 98 31   ....K...m......1
ISAKMP:  18 DE 9C 70 21 4D 58 B9 25 11 C9 7C DD 2D D9 A1   ...p!MX.%..|.-..
ISAKMP:  70 8C A0 2B C8 84 D3 4E 89 0E 18 D3 48 01 3C CC   p..+...N....H.<.
ISAKMP:  CB 64 35 D3 E6 83 AB 17 C3 5A 30 0C 0E AF 7D 83   .d5......Z0...}.
ISAKMP:  94 03 F7 9D 8E 33 F5 A3 64 E6 82 3B C3 E4 D8 EF   .....3..d..;....
ISAKMP:  93 19 BF 6D DC C1 D3 5C 1C 07 24 53 00 2B AF D7   ...m...\..$S.+..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  54 3E 49 A8 BB C2 5F 36 41 86 43 FF 2A 53 F2 20   T>I..._6A.C.*S. 
ISAKMP:  53 3D 8C 90 86 22 18 8A 80 4C 8B CE 0C 4E 12 3A   S=..."...L...N.:
ISAKMP:  82 D2 BF 61 D6 1D 9D 95 76 FA 41 CA A4 BD 4B 9D   ...a....v.A...K.
ISAKMP:  04 97 01 0E 9C 19 E1 BE 5D 4B 43 0E 63 DE 99 CC   ........]KC.c...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E6 C6 81 E4 51 0E 77 93 7B 9F F6 9C 4E 4B 09 C9   ....Q.w.{...NK..
ISAKMP:  3B E7 DF 13                                       ;...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received ISAKMP Packet from DUT with
ID Port Field set to (0) (Should be 0 or 500)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.23: Passed

>> IKE-16.24
TEST_DESCRIPTION
IKE MUST set the Protocol ID field of Identification Payload to 0
or UDP Protocol(0x11) in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Protocol ID         field of IDir to 0 or UDP(0x11)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xCF78 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6A A8 18 36 1A A2 D0 77                           j..6...w
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  31 29 CD B5 A0 1A 02 D0 21 63 29 37 44 54 A1 62   1)......!c)7DT.b
ISAKMP:  72 F7 3B 5D 38 4C 1E 0F D6 80 F6 0B 65 44 0C 93   r.;]8L......eD..
ISAKMP:  17 95 63 EA 3D 6D 29 5E 59 ED 1F 3E B8 AC D7 F3   ..c.=m)^Y..>....
ISAKMP:  15 82 2F 64 99 74 8C 13 0B 21 A3 A2 AF 13 B7 B8   ../d.t...!......
ISAKMP:  67 7E 0C 3B C1 3F 18 8E 71 56 D6 F9 10 48 79 B3   g~.;.?..qV...Hy.
ISAKMP:  7B 50 60 4D D7 E2 E7 63 B1 94 A6 DE 5C 74 E9 1C   {P`M...c....\t..
ISAKMP:  18 E4 3F 60 95 30 02 1D 65 CF FA 8C BB 57 F6 78   ..?`.0..e....W.x
ISAKMP:  4F DA DF 74 18 A5 A3 D5 F9 DE BA 82 38 EB 71 BC   O..t........8.q.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  06 40 4D F6 EC 9F DC 33 48 CD 50 02 3E E8 24 04   .@M....3H.P.>.$.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E7 (4583)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x28FE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0x3CE2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6A A8 18 36 1A A2 D0 77                           j..6...w
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  BB C3 63 E1 92 FC 8F 09                           ..c.....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  27 86 A6 F4 94 5B 3F EB 02 79 7F E7 BC 92 17 7C   '....[?..y.....|
ISAKMP:  95 0C 44 58 B7 26 62 4F 08 41 AE 5A EF D0 E4 AC   ..DX.&bO.A.Z....
ISAKMP:  29 D2 04 54 34 28 F6 B4 3B FF 52 13 DC 9D 7E 8E   )..T4(..;.R...~.
ISAKMP:  35 5E 0A A8 3C 32 70 E5 B2 08 D7 8F BB 3C 65 4E   5^..<2p......<eN
ISAKMP:  59 17 9B AF 33 1A 53 23 4F D5 30 C2 1B 8C 36 2F   Y...3.S#O.0...6/
ISAKMP:  13 C6 F2 1B E1 B0 FB D8 FD 0A A9 67 9F B8 87 B7   ...........g....
ISAKMP:  D9 4F 36 73 33 1C FF 84 7E 4D 1F 9E 24 61 06 7D   .O6s3...~M..$a.}
ISAKMP:  8C 04 B1 79 AD 16 E3 F0 6A A9 11 63 64 50 68 F1   ...y....j..cdPh.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  2D 88 83 8B FB B8 0A AA CB 0B 24 45 84 2C 16 9F   -.........$E.,..
ISAKMP:  24 F1 9F 9F 5D D5 58 37 F1 9C E5 EB AE 42 32 54   $...].X7.....B2T
ISAKMP:  87 3A 06 9F EA 43 2C B7 FD 46 EE E2 F2 A2 12 F0   .:...C,..F......
ISAKMP:  13 51 D4 74 46 90 90 5F 5A 26 0B 56 03 C9 9A 7F   .Q.tF.._Z&.V....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  FA 15 4A ED A9 9D 31 F9 FB BF 6E C7 3C F2 AC F8   ..J...1...n.<...
ISAKMP:  09 72 61 D1                                       .ra.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R>
Packet from DUT with ID Protocol Field set to (0)
 (Should be 0 or UDP)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.24: Passed

>> IKE-16.25
TEST_DESCRIPTION
IKE MUST set the Payload Length field of the Nonce Payload
between 8 and 
256 bytes in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set Payload Length
        field to <PAYLOAD_LEN>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Payload Length
        of Nonce Payload to a number which lies in between 8 and 256
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet with Payload Length
field to <PAYLOAD_LEN> to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x116F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  04 6D AD 08 14 B9 CF 49                           .m.....I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D5 D5 83 A9 D6 E3 4E A2 31 45 0B 30 F0 9E CD 2D   ......N.1E.0...-
ISAKMP:  DE DE 17 E6 8E 07 15 DA AE 0F 70 6F FC 72 F2 0C   ..........po.r..
ISAKMP:  FE F4 A0 42 CA 87 20 44 42 C4 BB CD CC F3 48 2F   ...B.. DB.....H/
ISAKMP:  37 06 06 72 D8 E5 40 39 9E 23 8D 7A 46 E7 7E 14   7..r..@9.#.zF.~.
ISAKMP:  7F FD 6E B0 00 1C 34 0B 76 CD 17 86 19 DF 10 EE   ..n...4.v.......
ISAKMP:  4E 41 CA 79 1E EB 58 18 98 E3 1F 03 C8 F1 27 E9   NA.y..X.......'.
ISAKMP:  DC B0 0A A0 05 2D C6 F6 67 91 EA 11 F5 C6 EF 7B   .....-..g......{
ISAKMP:  FE C8 9E CF 40 A9 18 87 2E D7 E8 2A C0 3F 1C A1   ....@......*.?..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  1E 6C 41 58 6F F5 03 67 11 E2 FD 6F 0E 7C F5 9F   .lAXo..g...o.|..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E8 (4584)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x28FD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xBA9F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  04 6D AD 08 14 B9 CF 49                           .m.....I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F0 5C D1 39 D5 C5 19 EE                           .\.9....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  0A ED 93 A5 F9 03 E7 10 09 71 43 23 44 9B 44 4D   .........qC#D.DM
ISAKMP:  91 77 6A C2 70 23 DB 7F E5 95 57 FE A7 48 49 E5   .wj.p#....W..HI.
ISAKMP:  5E 41 C4 35 40 60 43 D2 1B F6 5C CB 9E C9 E5 0E   ^A.5@`C...\.....
ISAKMP:  89 1D D7 49 47 16 29 58 D8 82 4C 7D 34 96 53 AA   ...IG.)X..L}4.S.
ISAKMP:  49 9C 3B 84 D7 FA 9D D0 06 40 C9 BC 1E 5C 92 02   I.;......@...\..
ISAKMP:  84 29 B8 AC 50 A4 27 F1 33 3C 93 9C BA 3A AD 14   .)..P.'.3<...:..
ISAKMP:  F3 5A DF 42 7C 83 63 EC CE 58 40 2E 48 3D 11 D4   .Z.B|.c..X@.H=..
ISAKMP:  D8 00 56 10 C8 E7 EE 01 D5 A8 10 C4 15 33 5B 0D   ..V..........3[.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  45 0F F9 26 AC 86 8B 10 C5 1E A0 07 7C EE 05 09   E..&........|...
ISAKMP:  78 0D 55 3F 73 99 25 5C 61 D3 04 7A B1 02 76 DF   x.U?s.%\a..z..v.
ISAKMP:  16 AF 03 DB 7A EB E1 F9 E3 2C 75 F8 C8 14 E3 78   ....z....,u....x
ISAKMP:  12 4A AD FD 15 99 CB CD 4F C6 91 85 F1 44 A9 5A   .J......O....D.Z
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  1F 4C 4F 35 ED AC C6 89 5B E1 9F A9 F5 16 71 5A   .LO5....[.....qZ
ISAKMP:  64 02 95 08                                       d...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R>
Packet from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.25: Passed

>> IKE-16.26
TEST_DESCRIPTION
IKE MUST set the Exchange Type field of ISAKMP Header to
Aggressive in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Exchange Type field 
       in HDR set to Aggressive 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xC6FD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BA 0E DD 40 AB B4 D8 6F                           ...@...o
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  58 47 B7 D7 E9 FF 18 BD 45 10 E2 09 FF 97 4A C7   XG......E.....J.
ISAKMP:  D2 BC 95 EA 4E 70 4D 01 76 2B F6 05 9F 89 58 92   ....NpM.v+....X.
ISAKMP:  14 DA 8C E7 E1 3F 69 67 CE B1 25 CA D5 AD 79 D5   .....?ig..%...y.
ISAKMP:  D6 8B AA FF F1 48 72 0C 4B 51 0C 6D AA 56 B3 83   .....Hr.KQ.m.V..
ISAKMP:  C6 05 36 05 4A 7C D8 38 75 97 02 F3 BB D4 1E 58   ..6.J|.8u......X
ISAKMP:  32 30 A4 86 6A 23 29 C8 55 A9 B9 57 A0 54 AA A3   20..j#).U..W.T..
ISAKMP:  CF 79 C8 62 6D 06 15 46 3E C4 6E A6 1B 34 17 39   .y.bm..F>.n..4.9
ISAKMP:  4C 3C 61 5E B4 85 4B E7 81 3B 7F 3B F9 B3 A7 9F   L<a^..K..;.;....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F4 D9 42 F7 3D 40 1F 8C 80 E4 79 B8 4E C0 84 D9   ..B.=@....y.N...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 364 bytes
IP: Identification         = 0x11E9 (4585)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x28FC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 344 
UDP: Checksum         = 0xD6A6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BA 0E DD 40 AB B4 D8 6F                           ...@...o
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  83 AA 09 26 8A 00 FD F4                           ...&....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 336 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C7 DB 06 6F 4B 3D 90 C2 5A 50 E5 25 C8 F9 F0 FC   ...oK=..ZP.%....
ISAKMP:  D1 CA EC 1B 64 C9 01 BB D0 D8 21 8C 4C 78 78 00   ....d.....!.Lxx.
ISAKMP:  DB 8E AD 2E 7D 1D E7 3C D7 E6 E6 79 B3 19 1E D8   ....}..<...y....
ISAKMP:  07 22 95 AC 04 06 42 EB 64 19 67 04 AA 80 28 F1   ."....B.d.g...(.
ISAKMP:  D3 3C 11 E0 18 8B 20 BB 76 D6 DA 4B C2 39 FB 73   .<.... .v..K.9.s
ISAKMP:  87 8F F1 E3 40 79 CE 77 01 A2 7A 93 A3 D9 41 5A   ....@y.w..z...AZ
ISAKMP:  D6 A1 33 9C DF 3F 3D 58 E7 19 DD 64 CB 44 E9 1D   ..3..?=X...d.D..
ISAKMP:  B9 71 B2 46 13 14 2D C1 57 5A 79 21 C7 B7 9C B6   .q.F..-.WZy!....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  17 18 23 9B A5 EB 56 A1 F4 14 CB ED E0 DC 25 F8   ..#...V.......%.
ISAKMP:  DD 4F 0A FA AD FA 3F 7B E8 07 55 33 8F 3E 9F 57   .O....?{..U3.>.W
ISAKMP:  DE E6 00 1D D2 8C AD AF 55 DA BC 0C B6 B4 C4 2A   ........U......*
ISAKMP:  D9 BE 8C F9 A2 2B CD 66 6C 94 B6 1F 32 00 B9 CF   .....+.fl...2...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  EC 1F B9 4E 14 00 A0 99 4C 54 43 8C 3C 3C BA CD   ...N....LTC.<<..
ISAKMP:  A8 50 54 F5                                       .PT.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT with Exchange Type in HDR set to
Aggressive
Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.26: Passed

>> IKE-17.1
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with invalid Cookie
and MAY notify INVALID-COOKIE 
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and 
        CKY-R to <CKY-R>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R> packet
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:1 Set CKY-I to 0 and CKY-R to 0

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x447D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3A 3E 7F 99 1B 84 6B BF EB 40 57 85 B4 67 1D A2   :>....k..@W..g..
ISAKMP:  0C 27 F5 71 16 A0 14 65 48 C0 E8 40 03 1B FA C3   .'.q...eH..@....
ISAKMP:  03 25 80 9F D0 81 E5 C5 24 16 62 5D 15 8A 61 0E   .%......$.b]..a.
ISAKMP:  FE 33 7A 9F 39 40 7C 7F 44 66 BF 9D 01 5B 7B A9   .3z.9@|.Df...[{.
ISAKMP:  EF C3 F9 97 06 D1 37 8E E8 DB 5F CA 29 AA C7 73   ......7..._.)..s
ISAKMP:  FF 8B A1 B9 A7 74 BA 86 4F 40 45 0D 21 BD D9 7A   .....t..O@E.!..z
ISAKMP:  4A FB 69 83 E6 41 0E EA 51 DA AC 29 39 4F 70 13   J.i..A..Q..)9Op.
ISAKMP:  FA CF DD 29 8F E7 E0 2B D5 7D C4 A1 0B 20 9B 27   ...)...+.}... .'
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F5 11 4A 6B 42 1B 41 BA 8A 70 37 7D 30 FB 1C 28   ..JkB.A..p7}0..(
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11EA (4586)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A23 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xACC0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x9736 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3D B2 1C 67 CB 14 94 7F D1 8E 92 76 80 8D BC 8B   =..g.......v....
ISAKMP:  BA A7 52 A8 B6 49 E2 0C 5F 34 73 B7 A4 B7 8B 00   ..R..I.._4s.....
ISAKMP:  33 08 62 1C 29 A7 8D 6B 34 DD 62 8D DE CA EF 61   3.b.)..k4.b....a
ISAKMP:  C0 48 1A 64 51 A9 97 FE 8F 5B 65 41 6C C3 2E 9E   .H.dQ....[eAl...
ISAKMP:  9F 6B 23 8E 86 CC 66 82 6F 29 5F 8A 72 6C 0B 9B   .k#...f.o)_.rl..
ISAKMP:  28 85 C1 02 35 9D 36 81 D5 FC 24 DD 8F 59 AA 92   (...5.6...$..Y..
ISAKMP:  E7 ED E5 2B 17 92 B7 B9 E0 97 95 6D 95 62 1A 7B   ...+.......m.b.{
ISAKMP:  D2 EF 48 28 5D 81 6F 47 B9 B8 24 DC A8 2A C0 51   ..H(].oG..$..*.Q
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D9 45 3F C0 62 0D C5 4D 64 95 C5 C3 3D 4D B7 A3   .E?.b..Md...=M..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11EB (4587)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A22 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA8BC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.1: Passed

>> IKE-17.2
TEST_DESCRIPTION
IKE MUST notify INVALID-COOKIE for an incoming ISAKMP packet with
invalid Cookie.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and 
        CKY-R to <CKY-R>
-  DUT: Notify INVALID-COOKIE
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:1 Set CKY-I to 0 and CKY-R to 0

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B19 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x8B3E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5C 4B DD B0 30 45 7B A8 A9 E7 41 B0 95 92 5D E6   \K..0E{...A...].
ISAKMP:  F1 E4 A4 C2 6E 3A B6 A8 34 16 0A AB D2 27 2F 73   ....n:..4....'/s
ISAKMP:  1E D3 40 D5 0B 27 26 2F E9 00 75 C7 B5 4F 2D 93   ..@..'&/..u..O-.
ISAKMP:  B7 3B 33 65 E6 A5 E1 57 52 7D 71 91 2B FA 3D 83   .;3e...WR}q.+.=.
ISAKMP:  DD 43 06 7C D9 B6 85 2B C4 4C CF 01 00 66 D4 60   .C.|...+.L...f.`
ISAKMP:  8A 94 89 F4 8D D9 C5 1C 94 48 39 0D 6A D4 03 5A   .........H9.j..Z
ISAKMP:  7B 88 51 2F 3C 72 72 25 2C 9E A3 64 DD 1C 30 79   {.Q/<rr%,..d..0y
ISAKMP:  0A 62 ED 66 AE CC 2E 9B 55 D6 29 F2 AD 3D 99 12   .b.f....U.)..=..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  35 15 06 A8 19 54 B6 39 52 3B 6F 9D 64 67 0A 5D   5....T.9R;o.dg.]
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11EC (4588)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A21 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xACC0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B18 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xC7B5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  15 2D 37 00 34 7E 28 AF B2 96 D5 93 CD 12 5C EC   .-7.4~(.......\.
ISAKMP:  92 50 3B BF C9 7F 1A F4 08 DF CD 0B EB C7 17 70   .P;............p
ISAKMP:  E7 15 88 01 2F CD F4 9B F7 44 6E E1 82 FC 2B 65   ..../....Dn...+e
ISAKMP:  A0 90 26 0D 4D C3 57 3C 54 21 21 0F C7 C2 39 6B   ..&.M.W<T!!...9k
ISAKMP:  83 86 3F FF 6D 54 B8 A5 FA AC D8 A6 E4 86 E2 FA   ..?.mT..........
ISAKMP:  31 62 1D D4 AC 8A 2E 26 51 2E 97 D1 00 5C BD DC   1b.....&Q....\..
ISAKMP:  AC CC 87 B8 0A B1 EF 6B 20 58 76 3D 2C 3C B0 DB   .......k Xv=,<..
ISAKMP:  E0 D6 BA 76 3B B6 DA 32 D8 AB 7E EC D0 34 CD E6   ...v;..2..~..4..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  46 A4 77 F2 BE C5 57 70 3D C7 44 13 01 A7 48 E3   F.w...Wp=.D...H.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11ED (4589)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A20 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA8BC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.2: Passed

>> IKE-17.3
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if SA Payload
does not precede all other payloads and MAY notify
INVALID-PAYLOAD-TYPE
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Send <HDR,KE,SA,Ni,IDii>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,KE,SA,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B17 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x2B93 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  58 22 D6 6F F1 C6 81 70                           X".o...p
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7C 35 66 74 95 DC 5D 23 5B DB B3 83 67 24 E6 F8   |5ft..]#[...g$..
ISAKMP:  88 AC 98 ED B0 AB D1 47 69 1E E4 2F 7C F0 84 B0   .......Gi../|...
ISAKMP:  2E 24 6A 32 3A 0B 39 64 D1 9F BE D0 FD CE 07 19   .$j2:.9d........
ISAKMP:  51 89 3B 0A 98 36 82 46 04 53 BD DC 6D 8A C0 7E   Q.;..6.F.S..m..~
ISAKMP:  CC 3A 7C A8 B3 04 11 38 77 41 E1 F8 45 C7 5C 34   .:|....8wA..E.\4
ISAKMP:  A2 4E FD 05 3E 4C 0B 42 81 F9 AF 81 1A A0 23 79   .N..>L.B......#y
ISAKMP:  31 30 D0 93 84 CE 04 29 4F A3 C4 E0 84 9F 15 9E   10.....)O.......
ISAKMP:  21 73 E6 83 7E 09 24 A4 43 66 E3 05 34 57 8B F3   !s..~.$.Cf..4W..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  76 02 E1 8F F3 9A 01 BC FE 11 87 C0 09 5D 49 A3   v............]I.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11EE (4590)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A0F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6107 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  58 22 D6 6F F1 C6 81 70                           X".o...p
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  33 34 85 91 CF E2 1D 0F                           34......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x250F965A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  58 22 D6 6F F1 C6 81 70 33 34 85 91 CF E2 1D 0F   X".o...p34......
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.3: Passed

>> IKE-17.4
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP packet
if SA Payload does not precede all other payloads.  
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
          RFC 2408 s5.2 p59 ISAKMP Header Processing
TEST_METHOD
- ANVL: Send <HDR,KE,SA,Ni,IDii>
-  DUT: Notify INVALID-PAYLOAD-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,KE,SA,Ni,IDii> Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B16 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xB023 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7A 92 DD 02 42 07 E8 43                           z...B..C
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DC 16 08 FC B5 B9 35 F0 BC D1 48 F4 DE B2 73 E9   ......5...H...s.
ISAKMP:  F2 01 B7 FA 7F FA 82 B2 FF 4B FD E0 0B 62 91 C8   .........K...b..
ISAKMP:  F9 67 85 DD 78 8B 9B 75 F7 5B BF BD 51 A5 5E 94   .g..x..u.[..Q.^.
ISAKMP:  56 C7 F6 F3 27 4F 4A 74 0A E6 5B 69 B6 E5 B5 9A   V...'OJt..[i....
ISAKMP:  B8 07 E1 22 57 3E 42 27 FE 04 7F BC 26 CD EB 7E   ..."W>B'....&..~
ISAKMP:  DF 2A CF 8C 26 06 E3 DE BC D8 E3 45 7D 41 2B 13   .*..&......E}A+.
ISAKMP:  BD D3 C6 D9 47 AC 53 B8 98 06 3A BA 13 B6 09 43   ....G.S...:....C
ISAKMP:  17 44 BE 01 44 55 F1 DE C5 B7 5E CC 9D F4 E4 8E   .D..DU....^.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DB EA BC 57 73 54 69 57 E9 79 72 47 C3 55 33 BC   ...WsTiW.yrG.U3.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11EF (4591)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A0E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xCC39 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7A 92 DD 02 42 07 E8 43                           z...B..C
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  2B CE 4D D0 05 4F 18 CF                           +.M..O..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xB018FBE6
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  7A 92 DD 02 42 07 E8 43 2B CE 4D D0 05 4F 18 CF   z...B..C+.M..O..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Received correct Notify Message ISAKMP_NOTIFY_ERROR_INVALID_PAYLOAD_TYPE from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.4: Passed

>> IKE-17.5
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with  a Major Version number
larger than its own and MAY notify INVALID-MAJOR-VERSION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Major Version set to
        DUT_IKE_MAJ_VER + 1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Major Version set to
2 Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B15 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x9E3C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EC 03 D4 39 60 F4 9B 3A                           ...9`..:
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B6 81 8E 1E EC 12 40 96 60 86 03 8E 4D B3 03 0B   ......@.`...M...
ISAKMP:  64 1D 5A 7F 50 EE 69 60 44 26 FA D4 C0 9F E8 15   d.Z.P.i`D&......
ISAKMP:  EB 43 4E C2 AB BA 06 4F 10 05 6D E2 A5 A6 46 DB   .CN....O..m...F.
ISAKMP:  28 26 0E D0 13 F1 67 2F 75 37 80 A3 6D D4 06 9E   (&....g/u7..m...
ISAKMP:  E6 CC 80 E1 0E 13 7A 37 1C 75 23 47 7D E4 4B D6   ......z7.u#G}.K.
ISAKMP:  D8 43 DF 4C 25 08 04 79 9B 0A 64 FA 88 DC 5A 4D   .C.L%..y..d...ZM
ISAKMP:  0F 3A B7 00 6E 72 AC 11 12 F4 AD 03 56 54 19 D1   .:..nr......VT..
ISAKMP:  75 2D 2C 02 49 12 50 34 7E F5 0A 96 3F 3B 08 ED   u-,.I.P4~...?;..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6A 6F 15 5F A7 10 46 26 C3 09 F2 97 36 9A F4 82   jo._..F&....6...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
DOI Specific Use on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x11F0 (4592)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A21 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 44 
UDP: Checksum         = 0xB133 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EC 03 D4 39 60 F4 9B 3A                           ...9`..:
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Invalid Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 37 (DOI Specific Use)
ISAKMP: Flags                    = 0x20 (32)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 36 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Invalid Payload ----


Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.5: Passed

>> IKE-17.6
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with  a Major Version number
larger than its own and MUST notify INVALID-MAJOR-VERSION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Major Version set to
        DUT_IKE_MAJ_VER + 1
-  DUT: Notify with INVALID-MAJOR-VERSION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Major Version set to
2 Packet to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B14 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x10DE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BF C7 36 53 9A 24 D6 13                           ..6S.$..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6F 4C 29 A2 A8 C2 62 29 73 1E 0D CA 71 7E 5F DA   oL)...b)s...q~_.
ISAKMP:  53 37 7E 6B BF 2E 24 57 1D 30 02 8A BA 81 0F D1   S7~k..$W.0......
ISAKMP:  72 D6 2F C8 3F 6F ED F0 1F B2 60 54 3F A2 C3 7A   r./.?o....`T?..z
ISAKMP:  4A 5D E8 93 99 45 D8 62 27 D6 2C 31 9E 5D 46 62   J]...E.b'.,1.]Fb
ISAKMP:  D0 8B 63 A8 60 55 BA 3D 6E 5C 67 BE FF 16 AB 37   ..c.`U.=n\g....7
ISAKMP:  14 8E D0 13 84 CA 63 63 6B 5C D8 05 74 C6 8D 33   ......cck\..t..3
ISAKMP:  DD EB AC 62 1C A1 A2 88 F8 FC F5 B7 1C 3C A6 BA   ...b.........<..
ISAKMP:  B1 34 93 43 A7 BA D5 D7 8B 19 EB 81 4E 9F 44 6E   .4.C........N.Dn
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  FA 0E AF 83 94 85 60 5D DA 9E 05 A8 0D 00 0B C3   ......`]........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
DOI Specific Use on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x11F1 (4593)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A20 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 44 
UDP: Checksum         = 0x074D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BF C7 36 53 9A 24 D6 13                           ..6S.$..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Invalid Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 37 (DOI Specific Use)
ISAKMP: Flags                    = 0x20 (32)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 36 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Invalid Payload ----


! Did not receive expected notification packet from DUT
! 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.6: !FAILED!

>> IKE-17.7
TEST_DESCRIPTION
IKE SHOULD never accept inbound ISAKMP packets with  a Minor
Version number larger than its own and MAY notify
INVALID-MINOR-VERSION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Minor Version set to
        DUT_IKE_MIN_VER + 1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Minor Version set to 2
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B13 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x81F0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B6 89 F8 0D 37 FF EC 7C                           ....7..|
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5C 9C 99 E7 CF D1 80 61 5D 6A 53 43 29 7A F8 3C   \......a]jSC)z.<
ISAKMP:  DC 7A CC 1A 2B 6A 44 DE 60 B6 FB D1 8F A5 F3 5A   .z..+jD.`......Z
ISAKMP:  26 99 BC AE A3 37 05 B7 CB 16 C1 B7 D3 48 45 13   &....7.......HE.
ISAKMP:  FF B7 A1 E2 1E 6C F0 C4 CD 05 01 71 EB F8 8B BC   .....l.....q....
ISAKMP:  5F 72 0B C5 B7 1B 11 43 64 58 BA D6 0C 93 86 FA   _r.....CdX......
ISAKMP:  EC 62 55 9F C9 B4 62 8B D5 8B B7 97 C1 F4 7F 72   .bU...b........r
ISAKMP:  21 AC 9E DD 36 05 4E EE FB AF 83 B0 43 F3 43 EC   !...6.N.....C.C.
ISAKMP:  D4 79 FC 76 70 15 D2 66 6C 58 69 AC 3D F5 77 EB   .y.vp..flXi.=.w.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  91 7D 20 80 E8 CF 20 F1 61 6D F4 1E DE EB EE 80   .} ... .am......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F2 (4594)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A1B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xD9A8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B6 89 F8 0D 37 FF EC 7C                           ....7..|
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.7: Passed

>> IKE-17.8
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with  a Minor Version
number larger than its own and MUST notify INVALID-MINOR-VERSION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Minor Version set to
        DUT_IKE_MIN_VER + 1
-  DUT: Notify with INVALID-MINOR-VERSION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Minor Version set to 2
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B12 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x8A19 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  31 61 E8 77 4C BE 31 27                           1a.wL.1'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  51 63 BD 71 DC CB AE 94 24 1B 8B 0F 44 D9 54 9C   Qc.q....$...D.T.
ISAKMP:  00 48 48 8E 1D D2 D5 0A 75 DE 4E 84 DA FE 49 A4   .HH.....u.N...I.
ISAKMP:  A2 A6 C3 35 7F 84 2A 46 99 41 F4 12 C0 61 CA 2F   ...5..*F.A...a./
ISAKMP:  0C DC C9 7C 66 69 17 45 1C E2 40 95 94 8C 55 9C   ...|fi.E..@...U.
ISAKMP:  38 40 E2 50 BF 76 11 E6 2B 3C 05 9E 0C 95 48 DA   8@.P.v..+<....H.
ISAKMP:  81 E9 6A CA 60 C7 68 F4 7E E1 10 03 4F E6 E0 51   ..j.`.h.~...O..Q
ISAKMP:  53 19 D3 81 EE 3E 66 46 52 2D 1B C1 08 6C 31 2A   S....>fFR-...l1*
ISAKMP:  AD EC CB 3D BD 6A 66 DE 61 05 06 EF F0 B1 F3 1E   ...=.jf.a.......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  5F C3 23 C0 FE 78 FB 22 EB CB 8C 05 5F E7 47 B2   _.#..x."...._.G.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F3 (4595)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A1A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x14FE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  31 61 E8 77 4C BE 31 27                           1a.wL.1'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Received correct Notify Message ISAKMP_NOTIFY_ERROR_INVALID_MINOR_VERSION from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.8: Passed

>> IKE-17.9
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with invalid
Exchange type field and MAY notify INVALID-EXCHANGE-TYPE.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60  ISAKMP Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
        <prm_inv_aggr_exchange>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
<prm_inv_aggr_exchange> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B11 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x0267 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E1 12 9F 70 BD 55 34 72                           ...p.U4r
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 10 (ISAKMP Future Use)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E1 63 47 CD 96 29 C9 10 63 FF E0 50 0A D2 F1 77   .cG..)..c..P...w
ISAKMP:  72 E9 2C F2 71 46 C9 01 8F C7 94 F0 D9 4A 74 61   r.,.qF.......Jta
ISAKMP:  D4 4D 09 E9 37 B6 C4 A1 37 CF F7 91 13 54 55 25   .M..7...7....TU%
ISAKMP:  69 C8 F0 F5 81 B2 CA C4 E9 D0 C4 0B 60 C3 5D 3E   i...........`.]>
ISAKMP:  D7 F2 FF 32 84 2B 5A 26 3C 97 3C 23 1C 37 24 31   ...2.+Z&<.<#.7$1
ISAKMP:  3A BD F2 4D 70 E6 C0 56 22 3B 5A 80 27 09 C7 4C   :..Mp..V";Z.'..L
ISAKMP:  A3 FE 2C 4A 5B 58 D4 79 EC BA A1 B7 3C 7F C9 39   ..,J[X.y....<..9
ISAKMP:  87 39 92 2F D3 DD ED 8B C7 C6 13 B0 BB 36 C3 51   .9./.........6.Q
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  78 84 0B B2 0B 49 51 FE 9B 5E 24 90 06 33 BE 5F   x....IQ..^$..3._
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F4 (4596)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A19 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x3A72 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E1 12 9F 70 BD 55 34 72                           ...p.U4r
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 7 (Invalid Exchange Type)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.9: Passed

>> IKE-17.10
TEST_DESCRIPTION
IKE MUST notify INVALID-EXCHANGE-TYPE for an incoming ISAKMP packet with 
invalid Exchange type.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60  ISAKMP Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
        <prm_inv_aggr_exchange>
-  DUT: Notify INVALID-EXCHANGE-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
<prm_inv_aggr_exchange> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B10 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x0569 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BE 45 BA 68 2E 25 E9 29                           .E.h.%.)
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 10 (ISAKMP Future Use)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  31 82 9D D1 AD A1 84 4D 18 9B E7 C2 0C 06 4E EF   1......M......N.
ISAKMP:  E9 DF D3 F9 81 FD 33 C1 1A D6 7C D0 7C 8A FD DE   ......3...|.|...
ISAKMP:  05 3A 55 C5 B0 CC 86 37 B5 83 89 82 51 98 DC FD   .:U....7....Q...
ISAKMP:  14 6F E8 D9 E3 0E 96 A5 A4 D3 22 A5 F7 12 55 01   .o........"...U.
ISAKMP:  DF 4B 3C 4A DB 69 10 16 AC 02 AE 7D 03 DD AE 27   .K<J.i.....}...'
ISAKMP:  AA 4B 06 94 A1 F1 5E BB 62 94 75 7E 12 03 06 E7   .K....^.b.u~....
ISAKMP:  77 AD EB 9D 86 FB 7F 6E D0 9E A1 0C AB 0E 9B 52   w......n.......R
ISAKMP:  D4 59 61 63 05 0B EE 21 04 D2 2B F7 4B F7 CC 40   .Yac...!..+.K..@
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4E 81 A1 4A 20 2E E2 A0 CC 12 EA 85 E2 02 9F F1   N..J ...........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F5 (4597)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A18 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x1CC0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BE 45 BA 68 2E 25 E9 29                           .E.h.%.)
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 7 (Invalid Exchange Type)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 7

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.10: Passed

>> IKE-17.11
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet for non zero Message
ID field and MAY notify INVALID-MESSAGE-ID.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
        <prm_inv_ph1_msg_id>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
<prm_inv_ph1_msg_id> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x0125 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7C C1 04 60 E4 E6 C9 61                           |..`...a
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A0 62 F8 56 E1 E0 5C 5E A2 34 55 7E C0 C2 11 0F   .b.V..\^.4U~....
ISAKMP:  E4 D3 D4 2E F5 B5 CA B9 7E 4F E8 87 EB 5D 94 1C   ........~O...]..
ISAKMP:  A6 F5 DC 7D 66 F4 6D 5B CF 58 0C F1 01 78 CF DF   ...}f.m[.X...x..
ISAKMP:  99 E2 A9 73 5D 51 DD 28 BB 38 9D AB CD 54 F8 72   ...s]Q.(.8...T.r
ISAKMP:  FB 14 02 CF F2 BC 5B 9C 7C E8 C7 0E 10 42 BE 2F   ......[.|....B./
ISAKMP:  E7 09 54 17 A2 93 61 DF A0 4D 5A DA A6 12 31 1A   ..T...a..MZ...1.
ISAKMP:  E7 31 99 0D 53 AA 39 8F E3 4F 94 93 67 E7 39 A2   .1..S.9..O..g.9.
ISAKMP:  F0 02 F7 77 D9 03 F6 F4 E9 58 7B F4 F8 6A 4E 5B   ...w.....X{..jN[
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A6 04 E0 11 41 4E 39 A2 0B 3D 9C D1 28 43 DD B7   ....AN9..=..(C..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F6 (4598)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A17 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x7D47 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7C C1 04 60 E4 E6 C9 61                           |..`...a
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.11: Passed

>> IKE-17.12
TEST_DESCRIPTION
IKE MUST notify INVALID-MESSAGE-ID for an incoming ISAKMP packet
with non zero Message ID.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
        <prm_inv_ph1_msg_id>
-  DUT: Notify INVALID-MESSAGE_ID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
<prm_inv_ph1_msg_id> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xAF53 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  01 3F 52 76 CD EB D2 36                           .?Rv...6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  81 4C F6 00 36 EC A2 23 3E 72 3E EE 5A 34 E0 11   .L..6..#>r>.Z4..
ISAKMP:  C8 F4 94 3D D7 05 59 E1 DB 83 9C 3D 5B 24 4A FF   ...=..Y....=[$J.
ISAKMP:  B0 9E D7 19 CD D6 68 D6 4A B1 AE 7D B2 B9 3F B5   ......h.J..}..?.
ISAKMP:  58 A7 93 09 F8 5A 7D A8 97 40 D6 E4 D7 9C A8 6A   X....Z}..@.....j
ISAKMP:  BE 48 85 E8 F9 3B 13 A9 47 E4 41 93 E6 FA E8 1B   .H...;..G.A.....
ISAKMP:  06 B0 69 BD 7D A7 2D 38 8E B3 92 A0 68 F0 5F 5D   ..i.}.-8....h._]
ISAKMP:  86 B3 D3 1F AE 5D AD CF 28 E2 8B C4 D4 1F 72 79   .....]..(.....ry
ISAKMP:  01 05 C8 26 CF E9 7A EF 39 F6 90 5A E5 47 CB 31   ...&..z.9..Z.G.1
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  10 A3 D3 D4 07 94 4F EC FA FC 81 5F 50 BB 33 F9   ......O...._P.3.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F7 (4599)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A16 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xB8D9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  01 3F 52 76 CD EB D2 36                           .?Rv...6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 9

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.12: Passed

>> IKE-17.13
TEST_DESCRIPTION
IKE MUST not respond for an incoming ISAKMP packet containing ISAKMP
Header with its Length field not equal to (ISAKMP_HLEN+Total length
of all payloads).
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
        (ISAKMP_HLEN+Total length of all payloads)+1 
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
(ISAKMP_HLEN+Total length of all payloads)+1 (237) to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xD253 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F7 00 00 14 BE AF 08 15                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 237 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  0C C3 99 1F A5 A3 DF FD 1E 36 8B F7 6A 38 B7 23   .........6..j8.#
ISAKMP:  F1 7D 25 87 77 7C 15 89 5D A1 2B 2F BD AC 39 15   .}%.w|..].+/..9.
ISAKMP:  DF BE 42 ED CF 4C 07 5E 21 C6 E7 26 6D 80 8C 3B   ..B..L.^!..&m..;
ISAKMP:  5B A7 50 F8 E0 68 36 89 E4 F8 63 E2 39 67 3C D3   [.P..h6...c.9g<.
ISAKMP:  41 BF 6E 21 6C B1 79 FE 11 97 D3 7E 6B 86 BA FF   A.n!l.y....~k...
ISAKMP:  0D 83 0C 84 75 E5 96 AE 1F 75 6C A6 AB A2 6C F8   ....u....ul...l.
ISAKMP:  40 7B A8 91 C2 A1 84 2E 70 B9 9A 2A 2C CA 98 C9   @{......p..*,...
ISAKMP:  3B 99 46 16 F4 5B 77 B0 5E 90 8A 4F E1 00 41 FA   ;.F..[w.^..O..A.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  36 D6 6B DE 0B E8 18 E8 63 A2 F3 38 BC 92 10 EC   6.k.....c..8....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F8 (4600)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A15 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xEECC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F7 00 00 14 BE AF 08 15                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.13: Passed

>> IKE-17.14
TEST_DESCRIPTION
IKE MUST notify UNEQUAL-PAYLOAD-LENGTHS for an incoming ISAKMP packet with 
Header Length field not equal to (ISAKMP_HLEN+Total length of
all payloads).
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
        (ISAKMP_HLEN+Total length of all payloads)+1 
-  DUT: Notify UNEQUAL-PAYLOAD-LENGTHS
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
(ISAKMP_HLEN+Total length of all payloads)+1 (237) to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xD14C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  85 2A 49 51 D5 04 B0 51                           .*IQ...Q
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 237 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AD D1 A8 78 49 28 CC A0 61 70 4E F3 58 2D 6C 1F   ...xI(..apN.X-l.
ISAKMP:  FC 1F 24 C2 F9 77 38 90 48 0F B9 21 A5 DB D7 E5   ..$..w8.H..!....
ISAKMP:  02 1E DF A3 70 EC 3C 71 8E D3 2F 8C A6 DA C7 DE   ....p.<q../.....
ISAKMP:  BF B8 93 85 A1 B5 CE 98 D5 B2 6F 3D BD AE 9C 66   ..........o=...f
ISAKMP:  FE 29 91 00 32 6E A3 11 45 54 02 73 01 DA 3E 15   .)..2n..ET.s..>.
ISAKMP:  E8 F3 F4 52 0A C2 4F A2 78 F2 04 34 EA C0 72 A2   ...R..O.x..4..r.
ISAKMP:  38 C4 77 A6 73 23 B7 96 93 B7 A0 FE 7C 3D 49 80   8.w.s#......|=I.
ISAKMP:  A4 C8 F6 BB AE 81 31 25 50 4C 8D FB CC 6F D1 0F   ......1%PL...o..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A6 B0 5E 56 1E F5 91 BC B6 63 7B 81 E9 E0 E9 9D   ..^V.....c{.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x11F9 (4601)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A14 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x58D4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  85 2A 49 51 D5 04 B0 51                           .*IQ...Q
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 30

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.14: Passed

>> IKE-17.15
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet and MAY notify
INVALID-PAYLOAD-TYPE
if NP field of the SA Payload contains Proposal or Transform Payloads.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s3.1 p22 ISAKMP Header Format
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the NP field of SA Payload to <NP>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
- CASE: <NP> = Proposal (2)
- CASE: <NP> = Transform (3)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Next Payload of SA Payload is Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 2 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x8B89 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  44 70 8C 41 19 51 2D 1F                           Dp.A.Q-.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11FA (4602)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A03 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x899B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  44 70 8C 41 19 51 2D 1F                           Dp.A.Q-.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  65 E6 58 B6 6B FF 6D 2F                           e.X.k.m/
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x120FB1ED
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  44 70 8C 41 19 51 2D 1F 65 E6 58 B6 6B FF 6D 2F   Dp.A.Q-.e.X.k.m/
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Next Payload of SA Payload is Transform Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 3 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x737C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  13 1F 2B 04 5C 72 27 46                           ..+.\r'F
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11FB (4603)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A02 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x091F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  13 1F 2B 04 5C 72 27 46                           ..+.\r'F
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E3 9B B7 8C 99 B0 02 6B                           .......k
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6FED4027
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  13 1F 2B 04 5C 72 27 46 E3 9B B7 8C 99 B0 02 6B   ..+.\r'F.......k
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.15: Passed

>> IKE-17.16
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP packet if NP field 
of the SA Payload contains Proposal or Transform Payloads.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s3.1 p22 ISAKMP Header Format
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the NP field of SA Payload to <NP>
-  DUT: Notify INVALID-PAYLOAD-TYPE
- CASE: <NP> = Proposal (2)
- CASE: <NP> = Transform (3)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Next Payload of SA Payload is Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 2 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0xF681 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B9 8B A6 7F BD EB 70 40                           ......p@
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11FC (4604)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A01 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF153 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B9 8B A6 7F BD EB 70 40                           ......p@
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  55 45 27 84 BE FD D2 20                           UE'.... 
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xB00AD1D5
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  B9 8B A6 7F BD EB 70 40 55 45 27 84 BE FD D2 20   ......p@UE'.... 
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Next Payload of SA Payload is Transform Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 3 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0xAA27 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD D8 8F 03 65 65 A7 44                           ....ee.D
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11FD (4605)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2A00 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE9F8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD D8 8F 03 65 65 A7 44                           ....ee.D
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  36 24 C1 B9 C8 01 58 8A                           6$....X.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD01CCD7C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  DD D8 8F 03 65 65 A7 44 36 24 C1 B9 C8 01 58 8A   ....ee.D6$....X.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.16: Passed

>> IKE-17.17
TEST_DESCRIPTION
IKE MUST not respond to an ISAKMP packet if DOI field of SA Payload is not 
set to 0 and MAY notify DOI-NOT-SUPPORTED.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s5.4 p62 Security Association Payload Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to 
        <prm_inv_ph1_doi>    
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to
<prm_inv_ph1_doi> 10 to DUT 30.1.1.5
from interface 30.1.1.150
!Invalid Domain of Interpretation received 10
!Invalid Domain of Interpretation received 10

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B07 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xB50F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4F AF D5 60 31 9F AE 21                           O..`1..!
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 10
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6E E4 68 46 66 1E 5C 63 F4 D1 4D CD 7A B2 E2 6F   n.hFf.\c..M.z..o
ISAKMP:  1E 4C 33 76 39 A5 D9 D8 FC 05 66 14 11 86 82 6F   .L3v9.....f....o
ISAKMP:  20 29 8A 50 12 E4 53 DC 81 66 BD 41 4B CA 03 81    ).P..S..f.AK...
ISAKMP:  D3 DE F5 DE 3F DA C6 7C 2F 06 4F A6 BC 23 31 59   ....?..|/.O..#1Y
ISAKMP:  B7 49 7B C0 DC 23 C5 E8 62 8B 36 15 5F E3 36 F1   .I{..#..b.6._.6.
ISAKMP:  DA 48 F2 E9 94 DF 1B D3 8F C2 86 68 B8 69 92 EC   .H.........h.i..
ISAKMP:  9C 63 E1 15 6F 80 E4 F4 13 FB 42 D5 1E C8 5F 76   .c..o.....B..._v
ISAKMP:  3D B2 A9 D6 A8 12 F6 2F AB CA 9C 56 0B 93 0F 96   =....../...V....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6C BD D6 8E 95 F5 8A 11 1A 53 29 9E 7A E2 BC 88   l........S).z...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11FE (4606)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29FF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x59CF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4F AF D5 60 31 9F AE 21                           O..`1..!
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DE 7D 82 5E 44 F9 58 A2                           .}.^D.X.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x74A5D66B
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 2 (DOI Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4F AF D5 60 31 9F AE 21 DE 7D 82 5E 44 F9 58 A2   O..`1..!.}.^D.X.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.17: Passed

>> IKE-17.18
TEST_DESCRIPTION
IKE MAY notify DOI-NOT-SUPPORTED for an ISAKMP packet if DOI field of SA 
Payload is not set to 0.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s5.4 p62 Security Association Payload Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to 
        <prm_inv_ph1_doi>    
-  DUT: Notify DOI-NOT-SUPPORTED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to
<prm_inv_ph1_doi> 10 to DUT 30.1.1.5
from interface 30.1.1.150
!Invalid Domain of Interpretation received 10
!Invalid Domain of Interpretation received 10

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B06 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x2371 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5A 79 50 12 0A C5 16 53                           ZyP....S
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 10
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  99 EB DD 1A 8E 58 56 B8 60 F8 A0 E2 C7 A8 E7 2C   .....XV.`......,
ISAKMP:  4E 51 4C D7 97 87 89 95 D2 1B 26 48 72 D1 B5 9D   NQL.......&Hr...
ISAKMP:  E7 81 1A DA DF 4F 24 00 68 35 0A 65 41 B1 F2 3F   .....O$.h5.eA..?
ISAKMP:  20 AA B3 40 34 3B 59 0A 77 57 37 26 D9 62 82 6F    ..@4;Y.wW7&.b.o
ISAKMP:  A5 E0 48 C1 DD F9 C4 32 3E B4 25 97 1B CA 68 7D   ..H....2>.%...h}
ISAKMP:  4C 84 44 02 CD BB CD 86 03 16 A9 9A AC E4 12 40   L.D............@
ISAKMP:  E3 8C 1C 88 95 62 E7 DA 78 F3 18 6A D4 69 EA B9   .....b..x..j.i..
ISAKMP:  B8 A1 44 CB 6D DA 9B A9 2E 27 4B B4 F4 B0 C3 8A   ..D.m....'K.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7E 67 15 1B 25 ED 62 45 A8 89 5D F8 D3 F9 7E 06   ~g..%.bE..]...~.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x11FF (4607)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29FE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7177 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5A 79 50 12 0A C5 16 53                           ZyP....S
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CA 21 25 5D 90 10 72 17                           .!%]..r.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xC3F8FB6C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 2 (DOI Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  5A 79 50 12 0A C5 16 53 CA 21 25 5D 90 10 72 17   ZyP....S.!%]..r.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 2

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.18: Passed

>> IKE-17.19
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with a Situation not 
supported by IPSEC DOI and MAY notify SITUATION-NOT-SUPPORTED. 
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.2 p3 IPSEC Situation Definition
          RFC 2408 s5.4 p62 Security Association Payload Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Situation field
        set to <Situation>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
- CASE: <Situation> = 0x00
- CASE: <Situation> = 0x03
- CASE: <Situation> = 0x05
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Situation of SA Payload is set to 0x00

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B05 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xAAA1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F2 82 1B 5F 51 73 CC 5F                           ..._Qs._
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 00                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F7 B6 6E 2E 82 E4 83 C9 22 6A 1A F2 43 BA 84 18   ..n....."j..C...
ISAKMP:  8A 3C D1 AA 44 DD 7F F0 F6 5F 44 81 1D 62 64 9E   .<..D...._D..bd.
ISAKMP:  7E 2C 3C 16 49 C7 E7 2F A6 58 02 34 91 4A 44 9F   ~,<.I../.X.4.JD.
ISAKMP:  64 51 A3 51 17 1F A9 3A B0 26 55 51 14 D7 FD 88   dQ.Q...:.&UQ....
ISAKMP:  24 EA ED E3 8F D1 5B 65 E3 E6 86 C0 72 89 9F 01   $.....[e....r...
ISAKMP:  50 FE B9 41 7A F6 94 48 11 3E 1B 78 C7 0A F2 DF   P..Az..H.>.x....
ISAKMP:  2E B4 87 28 16 38 51 B7 7E 1B B5 B8 4F 79 5E 5D   ...(.8Q.~...Oy^]
ISAKMP:  C2 D1 57 88 30 96 40 82 88 83 15 0C A4 C5 A0 33   ..W.0.@........3
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 2F 05 F4 A8 3B C3 6A A2 46 99 62 FB F2 D9 65   ./...;.j.F.b...e
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1200 (4608)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29FD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x4A30 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F2 82 1B 5F 51 73 CC 5F                           ..._Qs._
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F3 EB 19 A6 7F 55 72 EB                           .....Ur.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7D198D17
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  F2 82 1B 5F 51 73 CC 5F F3 EB 19 A6 7F 55 72 EB   ..._Qs._.....Ur.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Situation of SA Payload is set to 0x03

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B04 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x8CB3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 49 48 7C 87 D8 64 2B                           LIH|..d+
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 03                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  97 51 B5 22 E4 58 12 6C 5B CF 24 A9 F6 07 B9 D6   .Q.".X.l[.$.....
ISAKMP:  DF 27 F4 3C 95 DB 6A B3 21 25 8C 01 6B 5B 41 59   .'.<..j.!%..k[AY
ISAKMP:  CC 00 95 83 76 A2 10 68 88 BE 52 02 A8 3F AB 85   ....v..h..R..?..
ISAKMP:  04 91 62 D9 E7 27 F6 0A 0D D6 B8 9B E1 FD B5 20   ..b..'......... 
ISAKMP:  CA 22 5E A4 41 E3 D8 60 12 44 E5 BB 8A 40 57 6E   ."^.A..`.D...@Wn
ISAKMP:  5C 4E 4E 17 60 07 01 16 E6 F1 79 D6 85 80 AD F0   \NN.`.....y.....
ISAKMP:  49 98 3C 09 CC 91 DD 98 9C 5E 8F E0 98 7D D2 8D   I.<......^...}..
ISAKMP:  A3 05 5C A5 A7 19 7A 06 C5 77 06 E3 F8 82 CC D9   ..\...z..w......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  27 F5 B1 15 13 E1 88 18 1B F1 34 11 7C 3A 9D 57   '.........4.|:.W
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1201 (4609)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29FC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0A90 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 49 48 7C 87 D8 64 2B                           LIH|..d+
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  04 C0 E2 01 E9 D1 01 83                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xED600DC0
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4C 49 48 7C 87 D8 64 2B 04 C0 E2 01 E9 D1 01 83   LIH|..d+........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Situation of SA Payload is set to 0x05

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B03 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x08D4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 C2 24 5B FE B2 B3 1B                           ..$[....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 05                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7C B7 D7 BF 9D C5 C7 68 C3 F3 42 44 1F C8 95 CA   |......h..BD....
ISAKMP:  2E 2B E4 33 23 62 23 26 25 3B 86 ED 9F 9E AA F2   .+.3#b#&%;......
ISAKMP:  88 C2 4E 8F 24 CE 5C A5 49 5C 22 71 5D 01 B5 42   ..N.$.\.I\"q]..B
ISAKMP:  AA D4 13 6C 73 99 69 C4 F7 FF D0 94 15 13 36 09   ...ls.i.......6.
ISAKMP:  EA 95 16 C2 F8 5D 52 A7 28 62 AF 08 41 BD 64 E5   .....]R.(b..A.d.
ISAKMP:  70 B9 4F E1 E5 F3 EA 8C 4D 5E 1A D5 DD AC B4 CC   p.O.....M^......
ISAKMP:  65 C7 18 E1 30 C5 05 0E 72 DD AB 1E 5B 94 3C 14   e...0...r...[.<.
ISAKMP:  FC AA 95 83 1F DB 70 55 6C A5 72 29 27 D4 6D 59   ......pUl.r)'.mY
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  5D 3B B6 D3 DE 92 74 66 5A BF 70 E9 5C EE 6B 7F   ];....tfZ.p.\.k.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1202 (4610)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29FB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6075 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 C2 24 5B FE B2 B3 1B                           ..$[....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  0A 8E 77 5B 64 C7 14 D9                           ..w[d...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xF923ACEC
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  00 C2 24 5B FE B2 B3 1B 0A 8E 77 5B 64 C7 14 D9   ..$[......w[d...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.19: Passed

>> IKE-17.20
TEST_DESCRIPTION
IKE MUST notify SITUATION-NOT-SUPPORTED for an incoming ISAKMP packet with 
a Situation not supported by IPSEC DOI
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.2 p3 IPSEC Situation Definition
          RFC 2408 s5.4 p62 Security Association Payload Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Situation field set to
        <Situation>
-  DUT: Notify SITUATION-NOT-SUPPORTED
- CASE: <Situation> = 0x00
- CASE: <Situation> = 0x03
- CASE: <Situation> = 0x05
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Situation of SA Payload is set to 0x00

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B02 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x44EB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  69 53 F2 5E 04 52 9F 1F                           iS.^.R..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 00                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  87 64 B6 BF 7C 6C 80 87 6F 73 41 47 B1 67 36 F1   .d..|l..osAG.g6.
ISAKMP:  72 69 94 04 07 65 9A B1 BC C0 33 0C FB 64 D5 36   ri...e....3..d.6
ISAKMP:  21 1F 54 AB C0 76 2E 02 FC 47 90 A1 6E 1D 0D 56   !.T..v...G..n..V
ISAKMP:  30 3D 8C D2 94 7A 4D AB B1 8F F7 F3 97 8C 19 BA   0=...zM.........
ISAKMP:  DE A3 94 CD A7 20 A7 58 C0 07 FD 6F 1A 3F 0C 16   ..... .X...o.?..
ISAKMP:  D6 7B BE 4C 1C 93 AD 94 51 0C 79 7C C3 F9 D2 CF   .{.L....Q.y|....
ISAKMP:  74 30 67 10 AD BD 86 B4 64 3B CB 7C 08 77 64 FB   t0g.....d;.|.wd.
ISAKMP:  43 85 43 EE 8B AE A2 66 9B A4 8A 71 02 EC DD A0   C.C....f...q....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DC E1 41 83 E4 73 28 F2 07 E7 FC FF A8 8D EC BE   ..A..s(.........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1203 (4611)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29FA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x023C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  69 53 F2 5E 04 52 9F 1F                           iS.^.R..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  15 D3 2B C0 4C A6 9F D5                           ..+.L...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xCCA3822B
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  69 53 F2 5E 04 52 9F 1F 15 D3 2B C0 4C A6 9F D5   iS.^.R....+.L...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 3

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Situation of SA Payload is set to 0x03

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B01 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x5C52 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FF DF E8 4A 40 3F 2E 4C                           ...J@?.L
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 03                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4F C3 A9 F7 B1 D2 45 01 FC 95 76 17 FD 36 E3 D8   O.....E...v..6..
ISAKMP:  BB E5 58 16 66 61 CE C4 84 4D B2 86 94 33 31 AD   ..X.fa...M...31.
ISAKMP:  A2 4D 7B 47 53 9F 71 29 DF A0 06 BF 70 47 D4 C7   .M{GS.q)....pG..
ISAKMP:  C1 D4 A1 B2 A6 F7 9E BD E2 50 24 30 65 12 8E 0D   .........P$0e...
ISAKMP:  0A 1E 2E 04 44 ED B1 CC 86 93 5C 86 FA 8B E9 41   ....D.....\....A
ISAKMP:  25 2C 8F 30 3D 78 09 B3 2D 22 3D D3 C0 14 74 0B   %,.0=x..-"=...t.
ISAKMP:  EF A7 97 95 B5 71 1F 05 E3 77 2D 08 95 CA 12 AB   .....q...w-.....
ISAKMP:  49 A7 FE B0 30 65 7E 67 FC 26 B3 F2 67 1C D3 D0   I...0e~g.&..g...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6F EB F9 9C 51 81 8F 42 BB 23 BE 00 E7 21 5D 27   o...Q..B.#...!]'
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1204 (4612)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xFBDA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FF DF E8 4A 40 3F 2E 4C                           ...J@?.L
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  13 2C CB 82 DA CC 3C AE                           .,....<.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x440BD1CA
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  FF DF E8 4A 40 3F 2E 4C 13 2C CB 82 DA CC 3C AE   ...J@?.L.,....<.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 3

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Situation of SA Payload is set to 0x05

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B00 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x62BC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  26 77 E8 47 29 1E 89 49                           &w.G)..I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 05                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  84 AA 67 DB 64 14 01 AF 91 79 41 D4 1A B4 E9 71   ..g.d....yA....q
ISAKMP:  36 7A C5 81 79 6C 29 3D 66 BF 8C 2A 2C 92 CC 95   6z..yl)=f..*,...
ISAKMP:  52 36 42 B3 26 E5 E3 27 60 F4 77 51 81 D4 9C FC   R6B.&..'`.wQ....
ISAKMP:  1B 9B 9B FA D5 4D 2D 0C E1 F8 E0 E7 F0 E5 71 E1   .....M-.......q.
ISAKMP:  9E 60 F5 B5 3F F4 6A 9A 76 4B 62 2F 4C 8C 61 5E   .`..?.j.vKb/L.a^
ISAKMP:  31 0E E1 1F 6D B6 70 31 87 0D 38 F9 66 6F 1B F0   1...m.p1..8.fo..
ISAKMP:  03 8E 03 54 CA 65 60 30 59 7C 04 37 D3 18 62 1D   ...T.e`0Y|.7..b.
ISAKMP:  63 D2 A8 24 1E 00 88 62 95 16 1D CC A3 25 06 B7   c..$...b.....%..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  76 85 77 D9 15 8E E4 4A 3C C4 3A 32 F9 EB 0A AD   v.w....J<.:2....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1205 (4613)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6943 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  26 77 E8 47 29 1E 89 49                           &w.G)..I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E6 C0 9A B8 CE 8E C7 61                           .......a
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xF0E3A028
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  26 77 E8 47 29 1E 89 49 E6 C0 9A B8 CE 8E C7 61   &w.G)..I.......a
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 3

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.20: Passed

>> IKE-17.21
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing only
one Proposal Payload if NP field is not 0 and MAY notify
INVALID-PAYLOAD-TYPE.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.5 p28 Proposal Payload
          RFC 2408 s5.5 p64 Proposal Payload Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal.
        Set the NP field of Proposal Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal
with the NP field of Proposal Payload to 1
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xE2EF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E7 F7 3F 52 46 2B 9A 01                           ..?RF+..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  8A CF 8F 84 1E CA 8B 56 22 D9 6C 88 C5 FE 79 DF   .......V".l...y.
ISAKMP:  09 10 3A 91 2A 20 26 F6 30 53 67 93 86 F3 BA 31   ..:.* &.0Sg....1
ISAKMP:  17 2A BB BB 3C 45 B7 3E 8C 01 F2 3F FD 41 F2 98   .*..<E.>...?.A..
ISAKMP:  86 26 91 2E 60 DC 49 AD BC F1 23 8E 56 C3 AD 4B   .&..`.I...#.V..K
ISAKMP:  83 AB 78 22 34 65 59 0E 50 D5 25 A1 00 5C DD 11   ..x"4eY.P.%..\..
ISAKMP:  93 A1 E6 C1 C0 47 7E F7 FA 03 65 C2 34 94 4C D1   .....G~...e.4.L.
ISAKMP:  DA 16 ED 4A AD 6E 33 3E 46 6E D9 4A 2B FD BA B5   ...J.n3>Fn.J+...
ISAKMP:  A4 41 F3 0E 26 A4 63 8A 1C 3D 0C 34 A7 07 56 1E   .A..&.c..=.4..V.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  CA A4 4F C7 79 B5 83 6F C3 01 0D 68 6E 3C F1 3A   ..O.y..o...hn<.:
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1206 (4614)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xA7D6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E7 F7 3F 52 46 2B 9A 01                           ..?RF+..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  69 82 F7 11 EF 19 EA 25                           i......%
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xB7C8C93D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  E7 F7 3F 52 46 2B 9A 01 69 82 F7 11 EF 19 EA 25   ..?RF+..i......%
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.21: Passed

>> IKE-17.22
TEST_DESCRIPTION
IKE MAY notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP packet containing only one Proposal Payload if NP field is not 0.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.5 p28 Proposal Payload
NEGATIVE: RFC 2408 s5.3 p61 Generic Payload Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal.
        Set the NP field of Proposal Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Notify INVALID-PAYLOAD-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal
with the NP field of Proposal Payload to 1
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x864A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 BF 5A 58 C2 14 88 07                           b.ZX....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9B FE 19 34 53 4B 6D 8F 78 9A 4E 67 A6 9E C4 A6   ...4SKm.x.Ng....
ISAKMP:  8D 48 50 76 ED 3C E0 59 A8 C2 C9 CF 2F 99 28 68   .HPv.<.Y..../.(h
ISAKMP:  74 05 27 79 D6 ED 91 FE 81 97 3F 70 D6 22 66 37   t.'y......?p."f7
ISAKMP:  7F 7C 94 D3 3F DD DE DA F6 AF AC ED 19 61 39 B6   .|..?........a9.
ISAKMP:  9A A4 F6 0F 84 83 92 C8 69 0B 14 40 E0 36 F3 70   ........i..@.6.p
ISAKMP:  1C 91 8E FB 12 A3 6C 4A 54 66 4C 95 FA EE E9 A2   ......lJTfL.....
ISAKMP:  5C D1 E2 F3 37 89 89 DE 7E BA ED 93 A2 E0 93 EA   \...7...~.......
ISAKMP:  E1 66 36 89 BD 8D C5 03 00 96 4F 48 09 4B 4F 0C   .f6.......OH.KO.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E5 87 23 DD 48 F5 AA 66 44 7C FF 2C 4D 4D 86 D2   ..#.H..fD|.,MM..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1207 (4615)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xC8CE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 BF 5A 58 C2 14 88 07                           b.ZX....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B2 9D 18 E1 44 1C B0 9F                           ....D...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x3D1116B6
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  62 BF 5A 58 C2 14 88 07 B2 9D 18 E1 44 1C B0 9F   b.ZX........D...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.22: Passed

>> IKE-17.23
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing a
Proposal Payload 
with Payload Length not equal to (PROPL_HLEN+Total length of all
Transforms).
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
        Payload set to 
        (PROPL_HLEN+Total length of all the Transform Payloads) + 1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
Payload set to (PROPL_HLEN+Total length of all the Transform
Payloads) + 1 (33) to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x3098 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  28 45 47 0B 5D 33 2F 4D                           (EG.]3/M
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 33 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  66 B2 6B BF 22 D1 A0 30 D6 3F B2 55 3C BE BD 66   f.k."..0.?.U<..f
ISAKMP:  10 78 F0 9E 9B 52 B8 F4 47 92 4A 57 89 B3 36 85   .x...R..G.JW..6.
ISAKMP:  F2 8F 86 EB F1 E2 48 ED FD CE 1B C4 4F 9A 45 76   ......H.....O.Ev
ISAKMP:  A5 0B 3D 76 49 D1 F7 73 44 E0 BD 61 6E C5 BD BF   ..=vI..sD..an...
ISAKMP:  3E 0B 8E 78 A5 1B 83 D6 DE EF A4 43 2D 3D 8A D3   >..x.......C-=..
ISAKMP:  39 BE 11 05 61 47 9C AA D3 CE E3 08 5A 32 9F 03   9...aG......Z2..
ISAKMP:  68 7E AF FD BE 08 98 81 97 9A A9 D9 60 1A 42 CE   h~..........`.B.
ISAKMP:  FB 5A C5 86 DB 69 EC 06 3F FB B0 FA 77 38 1A B6   .Z...i..?...w8..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B8 36 42 F9 AE A2 9B B7 89 2B 67 06 13 6D 09 F3   .6B......+g..m..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1208 (4616)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0308 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  28 45 47 0B 5D 33 2F 4D                           (EG.]3/M
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  92 A4 80 5B 9D 3D 07 C1                           ...[.=..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE6985A16
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  28 45 47 0B 5D 33 2F 4D 92 A4 80 5B 9D 3D 07 C1   (EG.]3/M...[.=..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.23: Passed

>> IKE-17.24
TEST_DESCRIPTION
IKE MUST notify UNEQUAL-PAYLOAD-LENGTHS for an incoming ISAKMP packet with Proposal Payload Length not equal to
(PROPL_HLEN+Total length of all Transforms)
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
        Payload set to 
        (PROPL_HLEN+Total length of all the Transform Payloads)+1
-  DUT: Notify UNEQUAL-PAYLOAD-LENGTHS
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
Payload set to (PROPL_HLEN+Total length of all the Transform
Payloads) + 1 (33) to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xAE48 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  60 54 D7 5D 24 8B 57 5F                           `T.]$.W_
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 33 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3A D5 6C 99 90 E2 FB 2F 0D 07 D0 1C A5 C5 37 47   :.l..../......7G
ISAKMP:  F3 BF CC AE 2C BC 4A 39 B1 2D DA AB A7 41 3E 17   ....,.J9.-...A>.
ISAKMP:  5B A1 A0 91 51 C0 A6 0F 30 29 E8 E7 2A 81 44 F9   [...Q...0)..*.D.
ISAKMP:  9E 11 C9 26 BE E9 20 F0 69 60 1A EF 9C E4 96 57   ...&.. .i`.....W
ISAKMP:  7C 39 B3 EB E6 55 7F 32 53 38 4B 25 FF 50 8B 2E   |9...U.2S8K%.P..
ISAKMP:  AC 1A 6C F8 89 FA CE 22 90 18 A3 FA DB 82 2A 7F   ..l...."......*.
ISAKMP:  59 6E B4 90 6E AF 27 47 1E A5 CB 0A 64 03 7D F7   Yn..n.'G....d.}.
ISAKMP:  7E 4D 9A 61 02 A3 B9 43 52 E1 5E 61 42 C3 B9 32   ~M.a...CR.^aB..2
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A 68 15 DA 7B 63 CB C1 35 5B 9C 85 18 AE 3C 39   *h..{c..5[....<9
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1209 (4617)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x16AF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  60 54 D7 5D 24 8B 57 5F                           `T.]$.W_
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FA 3B 4D 10 53 EA A1 90                           .;M.S...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x746E3F71
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  60 54 D7 5D 24 8B 57 5F FA 3B 4D 10 53 EA A1 90   `T.]$.W_.;M.S...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 30

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.24: Passed

>> IKE-17.25
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing a
Proposal with a Protocol-Id not supported by IPSEC DOI and MAY notify
INVALID-PROTOCOL.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.5 p63 Proposal Payload Processing
          RFC 2407 s4.1 p6  IPSEC Security Protocol Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Protocol-Id field in
        the Proposal
        Payload set to <prm_inv_ph1_proto_id>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with the Protocol-Id field in the Proposal Payload set to <prm_inv_ph1_proto_id> 10
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x06D9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9D DC EA 7A D8 81 B1 7B                           ...z...{
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 10 (!Unknown Protocol)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  1E D3 D3 64 B0 31 65 92 60 C0 31 04 CB 39 F3 FA   ...d.1e.`.1..9..
ISAKMP:  67 D0 55 2D A5 46 3B 5F 19 60 35 F9 0E DD 10 1A   g.U-.F;_.`5.....
ISAKMP:  6E 55 0C D6 EF A3 1B 34 83 DC ED 72 95 FA 8B F9   nU.....4...r....
ISAKMP:  3B 4B 6B DE 2C FF F9 7B BB E5 34 74 03 1F 2A FF   ;Kk.,..{..4t..*.
ISAKMP:  24 02 8C B9 55 73 A2 1B F2 48 77 AE 10 FB FD 74   $...Us...Hw....t
ISAKMP:  E6 BB 56 85 9C DA D8 1E 9B B2 31 68 8B F1 05 CB   ..V.......1h....
ISAKMP:  49 E1 B0 D6 5C 05 5B 68 1D EC EB 3A 7A 4A 52 83   I...\.[h...:zJR.
ISAKMP:  1B 4D 31 C3 D1 BE 3A CB 67 C8 CA 1E EA 67 57 A3   .M1...:.g....gW.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A4 0A 22 03 0D 03 21 9E 3C 4D 39 85 A4 39 63 1F   .."...!.<M9..9c.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x120A (4618)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xB7FA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9D DC EA 7A D8 81 B1 7B                           ...z...{
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  1A 27 A4 38 47 25 DE ED                           .'.8G%..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x585BAD84
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 10 (Invalid Protocol ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  9D DC EA 7A D8 81 B1 7B 1A 27 A4 38 47 25 DE ED   ...z...{.'.8G%..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.25: Passed

>> IKE-17.26
TEST_DESCRIPTION
IKE MUST notify INVALID-PROTOCOL for an incoming ISAKMP packet
containing a Proposal with a Protocol-Id not supported by IPSEC DOI.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.5 p63 Proposal Payload Processing
          RFC 2407 s4.1 p6  IPSEC Security Protocol Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Protocol-Id field in the
        Proposal
        Payload set to <prm_inv_ph1_proto_id> 
-  DUT: Notify INVALID-PROTOCOL-ID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with the Protocol-Id field 10
in the Proposal to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x9321 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  04 4A C4 2C 6F C5 EF 2D                           .J.,o..-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 10 (!Unknown Protocol)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  1B FE C9 79 F7 AD 68 5F 4D E6 D8 E2 0B 31 FC A8   ...y..h_M....1..
ISAKMP:  E7 38 E8 3B 68 DF 2C 55 DA 40 D7 AA 4B 49 03 1B   .8.;h.,U.@..KI..
ISAKMP:  06 87 C2 E3 C1 38 51 E0 87 B0 79 B2 00 7E 97 5C   .....8Q...y..~.\
ISAKMP:  69 A5 55 40 84 EB 9B CD 78 C7 AB 50 BD D6 FC BF   i.U@....x..P....
ISAKMP:  90 C9 D2 3C 26 26 19 5D 77 64 8C DE D9 19 F4 60   ...<&&.]wd.....`
ISAKMP:  77 C8 AF A4 1D 2C 51 84 26 1C 2A E3 3E A4 3F 0F   w....,Q.&.*.>.?.
ISAKMP:  8C 01 41 9B 10 DE FC BA 0F 25 DE B8 A3 38 9A E7   ..A......%...8..
ISAKMP:  37 9F 94 1C 25 BB 2E 67 25 F9 81 6E 69 B2 7C 60   7...%..g%..ni.|`
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  32 D6 9E 1A 73 B0 CB 26 30 B7 F5 DB 40 BD B0 47   2...s..&0...@..G
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x120B (4619)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD48C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  04 4A C4 2C 6F C5 EF 2D                           .J.,o..-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9A 62 62 2D 36 0A 5E 02                           .bb-6.^.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x96E7CFE8
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 10 (Invalid Protocol ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  04 4A C4 2C 6F C5 EF 2D 9A 62 62 2D 36 0A 5E 02   .J.,o..-.bb-6.^.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 10

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.26: Passed

>> IKE-17.27
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing one
Transform Payload if the value of NP field is not 0 and MAY
notify INVALID-PAYLOAD-TYPE. 
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
          RFC 2408 s5.6 p65 Transform Payload Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Transform.
        Set the NP field of Transform Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Transform
with the NP field of Transform Payload to 1
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xA2BB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F0 87 FF 03 B1 46 99 33                           .....F.3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B7 94 FA 99 98 FD 26 B2 66 0A 07 B7 B4 EA F9 D0   ......&.f.......
ISAKMP:  D0 D3 F9 44 4E 33 8C 1E 44 A7 84 A9 81 62 97 90   ...DN3..D....b..
ISAKMP:  F6 BA 62 56 2F D1 8B ED B5 E5 B9 D0 3F B8 4B E9   ..bV/.......?.K.
ISAKMP:  3F 69 D5 EB B5 F6 0B 70 A0 FE A8 7F 4B FD D2 97   ?i.....p....K...
ISAKMP:  DD AD 89 E5 CD D5 82 24 9B 9C 26 40 FE 19 65 75   .......$..&@..eu
ISAKMP:  A4 47 E1 F9 30 68 89 BB 70 31 A0 75 C3 16 0F 8A   .G..0h..p1.u....
ISAKMP:  38 E4 3A 51 FC E9 AE EF 3A 39 6F 8B 20 72 80 BD   8.:Q....:9o. r..
ISAKMP:  64 CB 79 33 C4 F6 0E 91 FB 64 30 85 A2 B3 64 5E   d.y3.....d0...d^
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7D 28 82 A0 47 CD B1 03 6B 6F DC 54 D8 D2 D2 A8   }(..G...ko.T....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x120C (4620)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x9FAD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F0 87 FF 03 B1 46 99 33                           .....F.3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7B 69 A6 3D 38 56 FD 07                           {i.=8V..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x1278D736
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  F0 87 FF 03 B1 46 99 33 7B 69 A6 3D 38 56 FD 07   .....F.3{i.=8V..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.27: Passed

>> IKE-17.28
TEST_DESCRIPTION
IKE MAY notify INVALID_PAYLOAD_TYPE for an incoming ISAKMP
packet containing one Transform Payload if the value of NP field
is not 0.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
          RFC 2408 s5.6 p65 Transform Payload Processing
          RFC 2408 s5.3 p61 Generic Payload Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Transform.
        Set the NP field of Transform Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Notify INVALID_PAYLOAD_TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Transform
with the NP field of Transform Payload to 1
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x2377 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3F 18 06 07 8F E2 60 36                           ?.....`6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  08 E1 1E BE C5 35 85 7A 52 DE 73 0C D2 EB 7F 89   .....5.zR.s.....
ISAKMP:  21 35 7B E6 3A F8 64 99 77 04 66 42 12 9B 34 1B   !5{.:.d.w.fB..4.
ISAKMP:  58 9E 03 61 A5 AF B9 92 59 DB B3 87 7A C5 11 86   X..a....Y...z...
ISAKMP:  0E C1 39 35 B0 ED 32 73 A1 45 8D D1 07 20 8C 33   ..95..2s.E... .3
ISAKMP:  73 29 2B 46 95 1A 00 05 5E 30 D5 7E 4C 31 AF 16   s)+F....^0.~L1..
ISAKMP:  0B F0 E8 A2 DA 43 FF A9 50 08 4A 3A 3B 17 44 91   .....C..P.J:;.D.
ISAKMP:  3A E0 AF DC 8E D1 7F C2 90 76 85 EB 16 F1 B7 34   :........v.....4
ISAKMP:  D0 53 A2 FA 1C 2D C5 55 2E E2 EE 2D 7E 63 0A 84   .S...-.U...-~c..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  0F F0 A8 B0 0A 0E 3D 92 50 ED 89 B3 8D 01 69 97   ......=.P.....i.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x120D (4621)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29F0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3289 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3F 18 06 07 8F E2 60 36                           ?.....`6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B4 80 18 C5 41 42 A7 7B                           ....AB.{
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA2120060
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  3F 18 06 07 8F E2 60 36 B4 80 18 C5 41 42 A7 7B   ?.....`6....AB.{
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-17.28: Passed

>> IKE-18.1
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet with two Transforms,if
NP of first Transform is not 3 or NP of second is not 0 and MAY
notify INVALID-PAYLOAD-TYPE.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a 
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
        Set the NP field of first Transform to <NP1> and that of
        second Transform to <NP2>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <NP1> = 0, <NP2> = 0
- CASE: <NP1> = 1, <NP2> = 1
- CASE: <NP1> = 3, <NP2> = 2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Next Payload of first Transform Payload is
set to 0 and Next Payload of second Transform Payload
is se to 0

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 0 and that of
second Transform to 0 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x36D5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FD 56 F0 1F 2C 87 08 61                           .V..,..a
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D4 42 4F A5 28 EA D8 E4 8E 9C 26 12 44 CB E9 6A   .BO.(.....&.D..j
ISAKMP:  79 ED CB BD 23 7F C0 96 CB 86 8B 34 FD B4 29 3C   y...#......4..)<
ISAKMP:  37 3A 0F 23 11 21 79 CA BF 0D 90 E5 30 29 9B 80   7:.#.!y.....0)..
ISAKMP:  73 04 F2 9C 6D BE E4 0B 00 9A A8 89 A0 5D 45 71   s...m........]Eq
ISAKMP:  BA A2 53 5C F5 B1 74 6B C4 6B 69 65 27 2C C6 51   ..S\..tk.kie',.Q
ISAKMP:  11 A8 B4 9B B3 79 35 20 F6 41 87 68 AD DA 21 4A   .....y5 .A.h..!J
ISAKMP:  3C DB 96 38 B4 42 CF 5A 85 36 1D C7 15 31 FE 8B   <..8.B.Z.6...1..
ISAKMP:  C9 D4 28 3F 68 F5 76 A9 9D 70 83 D1 19 B5 2B 64   ..(?h.v..p....+d
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B9 68 E7 06 7A 9E E6 FA F5 0D 0F 23 00 5C 62 7C   .h..z......#.\b|
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x120E (4622)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xB5DB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FD 56 F0 1F 2C 87 08 61                           .V..,..a
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  28 19 8E 24 42 0E CD 54                           (..$B..T
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7D8DA80A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  FD 56 F0 1F 2C 87 08 61 28 19 8E 24 42 0E CD 54   .V..,..a(..$B..T
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Next Payload of first Transform Payload is
set to 1 and Next Payload of second Transform Payload
is se to 1

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 1 and that of
second Transform to 1 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x22C9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  88 30 A2 13 96 94 A2 14                           .0......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  FB 3F CC 9C 45 CD 85 AE 94 25 70 DA 06 46 AC 5C   .?..E....%p..F.\
ISAKMP:  AD 51 41 F4 9E 19 22 9F EC 72 65 06 F0 B0 27 5A   .QA..."..re...'Z
ISAKMP:  D2 6A 74 FA 79 E4 C0 E8 E4 83 00 8C BC 18 49 B7   .jt.y.........I.
ISAKMP:  8F FB 32 BA 81 48 F1 A3 F0 3F C2 91 CD 00 07 25   ..2..H...?.....%
ISAKMP:  BD D2 29 11 D3 B2 3A D0 3B 79 51 44 08 B2 17 BD   ..)...:.;yQD....
ISAKMP:  4B 34 6F 93 28 CE 91 EB D8 A1 FF C2 4C 08 FE 1F   K4o.(.......L...
ISAKMP:  CE CF 88 D4 AB 99 7D 47 B5 57 84 5C F1 24 DB FE   ......}G.W.\.$..
ISAKMP:  0D 73 FE 7B 76 96 F1 8C C7 A9 6B 5F A0 4D 65 AE   .s.{v.....k_.Me.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  02 E9 34 90 D6 01 C2 C8 9C B7 F2 43 A4 3D F1 B1   ..4........C.=..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x120F (4623)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xBE9A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  88 30 A2 13 96 94 A2 14                           .0......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  21 06 13 E7 40 91 79 D4                           !...@.y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xFFE34874
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  88 30 A2 13 96 94 A2 14 21 06 13 E7 40 91 79 D4   .0......!...@.y.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Next Payload of first Transform Payload is
set to 3 and Next Payload of second Transform Payload
is se to 2

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 3 and that of
second Transform to 2 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x11B8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2C BA 45 2F CC FD D2 1D                           ,.E/....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  57 7F 13 87 65 53 56 94 E4 8D 98 91 26 40 B0 33   W...eSV.....&@.3
ISAKMP:  EE BF 34 76 07 E2 A7 31 97 22 51 77 70 E6 4D 5B   ..4v...1."Qwp.M[
ISAKMP:  BF A2 A7 77 1E 80 1C E9 00 80 79 53 A7 50 71 12   ...w......yS.Pq.
ISAKMP:  ED 59 60 C4 F0 F1 00 AE 22 CE 8E C4 0C 8D 24 02   .Y`.....".....$.
ISAKMP:  39 53 6B DC 1A 48 BE 61 03 D9 EE D2 1E CF AE 2F   9Sk..H.a......./
ISAKMP:  1E 0C 25 16 5F D1 40 5B EC 32 1D AD 4E 59 23 EF   ..%._.@[.2..NY#.
ISAKMP:  7F C6 3E E4 6E 0B DF 0F AE 4B 4B 68 5B 6B EE 00   ..>.n....KKh[k..
ISAKMP:  BD 17 8D 92 DA CE 18 EA A0 B7 F3 F5 73 9F 2D 31   ............s.-1
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  87 F9 A6 43 5C 1F 56 E0 64 32 9D BF EE 5F D6 D6   ...C\.V.d2..._..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1210 (4624)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29ED (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x18C1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2C BA 45 2F CC FD D2 1D                           ,.E/....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 04 B2 C7 C6 A9 C5 3A                           D......:
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x19F35154
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  2C BA 45 2F CC FD D2 1D 44 04 B2 C7 C6 A9 C5 3A   ,.E/....D......:
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.1: Passed

>> IKE-18.2
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP
packet with two Transforms,if NP of first Transform is not 3 or
NP of second is not 0.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the NP 
        field of first Transform to <NP1> and that of second
        Transform to <NP2>
-  DUT: Notify INVALID-PAYLOAD-TYPE
- CASE: <NP1> = 0, <NP2> = 0
- CASE: <NP1> = 1, <NP2> = 1
- CASE: <NP1> = 3, <NP2> = 2
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Next Payload of first Transform Payload is
set to 0 and Next Payload of second Transform Payload is set
to 0

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 0 and that of
second Transform to 0 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0xEF08 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AF 27 A6 54 E4 75 B4 55                           .'.T.u.U
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5F A5 91 74 80 80 E8 64 2A 75 12 D3 72 88 89 CE   _..t...d*u..r...
ISAKMP:  4D 2D A0 E8 C3 BB A6 BD 34 77 71 EE F9 B7 8E 49   M-......4wq....I
ISAKMP:  C8 85 56 0D 57 FB 5C B3 BF 5C 67 D9 93 3C 21 3B   ..V.W.\..\g..<!;
ISAKMP:  B6 A7 17 95 4A EB AE FA C9 E1 24 D8 26 A2 62 35   ....J.....$.&.b5
ISAKMP:  44 B8 AF EA 0E 88 01 68 56 71 7A A7 11 0E 7C 5F   D......hVqz...|_
ISAKMP:  B1 12 D9 13 51 ED 61 9B 05 16 2B DB 60 A1 EA A9   ....Q.a...+.`...
ISAKMP:  0F 94 CA 2A 2F C8 AC A9 7B DD F7 E9 E0 74 0D 24   ...*/...{....t.$
ISAKMP:  20 0D 8A 6E 4A 60 B1 13 34 2B 57 30 63 4C 7F 70    ..nJ`..4+W0cL.p
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  31 25 A4 EF D1 5B E1 A7 C0 16 66 24 A7 0E F4 9C   1%...[....f$....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1211 (4625)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xB6E1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AF 27 A6 54 E4 75 B4 55                           .'.T.u.U
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B6 30 A5 6E 73 C4 25 07                           .0.ns.%.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x37BAF771
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  AF 27 A6 54 E4 75 B4 55 B6 30 A5 6E 73 C4 25 07   .'.T.u.U.0.ns.%.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Next Payload of first Transform Payload is
set to 1 and Next Payload of second Transform Payload is set
to 1

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 1 and that of
second Transform to 1 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x9E24 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  57 E6 6F 46 B5 8E 90 07                           W.oF....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C5 79 A6 D3 4B AD 41 9C CC 14 19 B0 00 0D B0 27   .y..K.A........'
ISAKMP:  CE 6B 18 70 66 03 30 01 57 30 01 D1 2D 7C DD 68   .k.pf.0.W0..-|.h
ISAKMP:  2E 0F C2 93 55 24 87 D9 93 CC B4 0D 6A 48 FC 4F   ....U$......jH.O
ISAKMP:  B6 20 BE BD 79 87 75 EF 2A 24 E2 FA 5E 09 B6 E8   . ..y.u.*$..^...
ISAKMP:  C1 C5 00 45 20 94 23 83 3D 1D B9 29 76 3C 08 D6   ...E .#.=..)v<..
ISAKMP:  CC 05 FF 68 44 5E AF 53 80 FE C6 DC D6 00 DE B8   ...hD^.S........
ISAKMP:  2E 66 F4 93 1D E1 91 FE EE AF A1 C0 AD 72 C9 69   .f...........r.i
ISAKMP:  E8 89 28 50 4E 84 4A D3 A1 E3 39 CF A1 73 C1 DF   ..(PN.J...9..s..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  FF D3 F6 61 A5 AC 70 AF 79 2A 0F 5C D6 EC F3 D8   ...a..p.y*.\....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1212 (4626)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE1E6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  57 E6 6F 46 B5 8E 90 07                           W.oF....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  EF C9 C0 BF 2A 96 A6 BD                           ....*...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xCFC9DC81
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  57 E6 6F 46 B5 8E 90 07 EF C9 C0 BF 2A 96 A6 BD   W.oF........*...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Next Payload of first Transform Payload is
set to 3 and Next Payload of second Transform Payload is set
to 2

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 3 and that of
second Transform to 2 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x91C5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BA 28 9E 09 65 C2 AF 4B                           .(..e..K
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9E 46 C6 91 17 E6 7F D4 5B 23 63 A9 CC 61 C7 F2   .F......[#c..a..
ISAKMP:  00 29 3C AF D4 E9 14 56 DB 07 DF EE A1 BF 74 BE   .)<....V......t.
ISAKMP:  BE 03 9D CB DD F7 F0 B9 6F 24 8A 2A 8D 46 23 64   ........o$.*.F#d
ISAKMP:  D9 9A 7D 45 8F 85 95 20 52 60 40 93 7C 6E CB 1E   ..}E... R`@.|n..
ISAKMP:  F7 DD 75 99 84 EB 4E 6F 54 46 13 BE 85 1F BA BE   ..u...NoTF......
ISAKMP:  77 15 75 BB 13 1E A3 CE CA 4F 1B EC 45 12 8A 9B   w.u......O..E...
ISAKMP:  19 9B B2 AE E4 E5 6E C4 E7 FD 0C 95 09 42 81 74   ......n......B.t
ISAKMP:  D7 94 69 8E 75 F4 46 C9 26 E9 B8 96 5C 76 8C 47   ..i.u.F.&...\v.G
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  FA FF 2B EF 8B 43 53 3C F7 B6 7F FA 2E 36 B1 4E   ..+..CS<.....6.N
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1213 (4627)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE88F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BA 28 9E 09 65 C2 AF 4B                           .(..e..K
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9B A2 4B 8F 3D A6 EE 91                           ..K.=...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xF446CD47
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  BA 28 9E 09 65 C2 AF 4B 9B A2 4B 8F 3D A6 EE 91   .(..e..K..K.=...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.2: Passed

>> IKE-18.3
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing a
Transform with its Payload length not equal to(TRANS_HLEN+Total
length of all SA Attributes).
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.6 p29 Transform Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload
        containing one Transform Payload. Set Payload Length
        of Transform Payload equal to (TRANS_HLEN+Total length
        of all SA Attributes)+1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload
containing one Transform Payload with Payload Length
of Transform Payload equal to (TRANS_HLEN+Total length
of all SA Attributes)+1 25 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xA323 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B6 ED AD 1F 20 13 EA 4E                           .... ..N
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 25 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F9 18 1F D9 5B CB B3 01 BF E5 FF 4E CF AC A7 81   ....[......N....
ISAKMP:  F3 99 47 20 AA 37 12 44 BB F6 95 FF 3D 3A F9 1B   ..G .7.D....=:..
ISAKMP:  95 E2 1C 4F 38 D8 C1 3C A9 32 B4 7A 2F 95 02 97   ...O8..<.2.z/...
ISAKMP:  75 AD 93 A7 BD B9 F4 68 67 8F DE 50 4E B2 C7 F0   u......hg..PN...
ISAKMP:  A5 53 8C BB 4E 6C 48 9F 89 A5 DE C9 97 71 4F AC   .S..NlH......qO.
ISAKMP:  6D C0 9C F1 16 9D A5 A0 79 78 B5 9A 16 36 F5 66   m.......yx...6.f
ISAKMP:  0C 61 FB BD 13 4A 3A E8 F4 AC F7 39 EF 5C FD E3   .a...J:....9.\..
ISAKMP:  0B 40 EF D1 79 4F 3A AF B6 5B 19 97 C1 85 41 98   .@..yO:..[....A.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  10 7D B7 5C A7 78 C3 8A C9 EF 08 52 D2 E2 95 91   .}.\.x.....R....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1214 (4628)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xC923 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B6 ED AD 1F 20 13 EA 4E                           .... ..N
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C0 79 E8 66 DC 8E 47 DD                           .y.f..G.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE71183A8
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  B6 ED AD 1F 20 13 EA 4E C0 79 E8 66 DC 8E 47 DD   .... ..N.y.f..G.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.3: Passed

>> IKE-18.4
TEST_DESCRIPTION
IKE MUST notify UNEQUAL-PAYLOAD-LENGTHS for an incoming packet
with Transform
Payload length not equal to(TRANS_HLEN+Total length of all SA Attributes).
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.6 p29 Transform Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload
        containing one Transform Payload. Set Payload Length
        of Transform Payload equal to (TRANS_HLEN+Total length of
        all SA Attributes)+1
-  DUT: Notify UNEQUAL-PAYLOAD-LENGTHS
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload
containing one Transform Payload with Payload Length
of Transform Payload equal to (TRANS_HLEN+Total length
of all SA Attributes)+1 25 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xDA2F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  40 6A 52 65 33 F3 F7 66                           @jRe3..f
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 25 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9E C9 F7 E9 0C 30 45 43 D6 7E 55 0C 34 CF 0A 08   .....0EC.~U.4...
ISAKMP:  30 D4 AB 49 A2 9A 1D D5 72 BC EC 18 99 E6 F7 04   0..I....r.......
ISAKMP:  CA 72 23 20 03 8A 16 02 8B A6 3E 41 15 51 61 4D   .r# ......>A.QaM
ISAKMP:  07 FF 02 6E F7 8F 5C 85 A9 0F DB EA 2E 84 1B B7   ...n..\.........
ISAKMP:  44 35 8E 1E BB AF 64 1E B8 BE BD 49 F8 99 37 48   D5....d....I..7H
ISAKMP:  94 ED 5D 46 4A A1 F4 5E 1E 31 3C 67 C5 6B 8D A9   ..]FJ..^.1<g.k..
ISAKMP:  9E BA 75 1E 26 4A F6 F5 66 A8 D8 16 0D B7 91 F0   ..u.&J..f.......
ISAKMP:  DD DA B6 7B CE 70 24 A4 64 D2 58 29 E0 4F BB 75   ...{.p$.d.X).O.u
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7C DB 4D 9B 9C 72 07 89 F7 B7 53 FB C1 85 AD F3   |.M..r....S.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1215 (4629)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE725 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  40 6A 52 65 33 F3 F7 66                           @jRe3..f
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  90 E5 95 22 46 51 1E 6D                           ..."FQ.m
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x172A1B26
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  40 6A 52 65 33 F3 F7 66 90 E5 95 22 46 51 1E 6D   @jRe3..f..."FQ.m
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 30

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.4: Passed

>> IKE-18.5
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with 2 Transforms not 
containing monotonic Transform number and MAY notify
INVALID-TRANSFORM-ID.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s4.2 p47 Security Association Establishment
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the Transform number of first to 1 and that of
        second to <Transform>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <Transform> = 0
- CASE: <Transform> = 3
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Transform Number of first Transform Payload is
set to 1 and Transform Number of second Transform
Payload is set to 0

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms containing Transform number of first to 1 and that of
 second to 0 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x6BAA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  26 BE 5D 60 74 02 7C 61                           &.]`t.|a
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 0
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  48 34 E0 0B 8E E9 A9 D1 5F 1E 62 1C 1A 58 0E 2D   H4......_.b..X.-
ISAKMP:  F8 AD 8F 4E E2 CB 3F 5A F2 CE 84 1E 18 8F ED E8   ...N..?Z........
ISAKMP:  A7 63 47 0E 45 DD A8 46 0F 0B 2F 04 A9 F9 17 36   .cG.E..F../....6
ISAKMP:  A1 FB 07 9C 63 4E 62 19 BE E7 D6 A8 07 A0 C1 8F   ....cNb.........
ISAKMP:  71 8C 2A 64 95 F7 88 12 DF 83 EF 9A 04 02 C9 27   q.*d...........'
ISAKMP:  3B 18 EE B2 0D C3 EB 98 97 DD 49 90 A1 64 E2 78   ;.........I..d.x
ISAKMP:  68 DA 58 80 5F E2 67 8D 3E 5A B9 5F 83 D7 51 E8   h.X._.g.>Z._..Q.
ISAKMP:  33 E4 05 4B 52 EF 49 CB 67 5C 2C 53 03 63 61 EF   3..KR.I.g\,S.ca.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  BD B9 5D E3 49 75 C7 8A 7A 87 C5 3B 9F 90 6D 4B   ..].Iu..z..;..mK
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1216 (4630)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7CCB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  26 BE 5D 60 74 02 7C 61                           &.]`t.|a
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  33 A6 42 32 DC 83 B2 37                           3.B2...7
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x598AE2E1
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  26 BE 5D 60 74 02 7C 61 33 A6 42 32 DC 83 B2 37   &.]`t.|a3.B2...7
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Transform Number of first Transform Payload is
set to 1 and Transform Number of second Transform
Payload is set to 3

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms containing Transform number of first to 1 and that of
 second to 3 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0x595F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  72 1E 1C 0F 2C DB F3 7D                           r...,..}
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 3
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4D F3 D9 A9 98 ED 25 FE 6F 8D B6 A1 47 70 7F EA   M.....%.o...Gp..
ISAKMP:  60 3B 7F 51 93 58 91 52 71 09 4E B7 6A 77 BF 2E   `;.Q.X.Rq.N.jw..
ISAKMP:  0F AE 48 76 12 44 9F 30 72 CB 06 CA BC 72 F5 A3   ..Hv.D.0r....r..
ISAKMP:  8C 86 70 2E 35 17 3A D9 B9 03 26 51 76 9F AD A8   ..p.5.:...&Qv...
ISAKMP:  74 7B A0 C4 FA 8F 27 D9 B3 DB 14 40 B3 F8 8C 44   t{....'....@...D
ISAKMP:  51 3C 3A 59 3B 43 78 A0 52 B8 D0 21 2A F1 91 41   Q<:Y;Cx.R..!*..A
ISAKMP:  5D 18 DD 90 DA 08 90 B1 99 54 34 52 EA 40 59 74   ]........T4R.@Yt
ISAKMP:  14 AC 50 1D 51 CE FB CE 09 2C 17 E0 FF 8A DD 24   ..P.Q....,.....$
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  3D 45 3A 2A 28 F6 EF 12 CD 56 9A 70 E7 43 63 19   =E:*(....V.p.Cc.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1217 (4631)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x2905 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  72 1E 1C 0F 2C DB F3 7D                           r...,..}
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  23 C3 7D 9C 10 23 EF 82                           #.}..#..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x481F9B27
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  72 1E 1C 0F 2C DB F3 7D 23 C3 7D 9C 10 23 EF 82   r...,..}#.}..#..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Transform Number of first Transform Payload is
set to 1 and Transform Number of second Transform
Payload is set to 3

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms containing Transform number of first to 1 and that of
 second to 3 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 288 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 268 
UDP: Checksum         = 0xC054 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E8 A9 A5 55 03 83 7D 56                           ...U..}V
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 260 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 3
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A1 54 40 08 8B E7 B1 66 72 0E EA 17 61 87 E6 F3   .T@....fr...a...
ISAKMP:  CB 36 67 B3 BD B4 2E 92 4B 30 C7 4D A8 63 28 39   .6g.....K0.M.c(9
ISAKMP:  E9 52 69 22 5B 68 F3 54 E7 AF C9 83 C6 9C 16 32   .Ri"[h.T.......2
ISAKMP:  55 3E D7 12 1C 87 43 DC DE A1 71 63 F2 C5 2E 8F   U>....C...qc....
ISAKMP:  8C 65 95 CA 05 6F 4A 4B 9F AB 20 A7 D7 66 E1 FC   .e...oJK.. ..f..
ISAKMP:  DA EA 4C 6F FB 67 0B C8 DB 59 BD B3 2F 27 E0 D3   ..Lo.g...Y../'..
ISAKMP:  35 9D 70 FD 06 7D 31 1C 02 33 3B 26 74 A9 34 8B   5.p..}1..3;&t.4.
ISAKMP:  0C 9E 41 78 6A B2 E7 A5 67 1B 26 A3 0B A3 60 79   ..Axj...g.&...`y
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  C5 73 1C E0 A5 A7 19 C3 B2 0B D6 88 70 3F F7 4A   .s..........p?.J
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1218 (4632)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x437B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E8 A9 A5 55 03 83 7D 56                           ...U..}V
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FB 98 4D 03 ED 25 E4 20                           ..M..%. 
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x5933BD3D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  E8 A9 A5 55 03 83 7D 56 FB 98 4D 03 ED 25 E4 20   ...U..}V..M..%. 
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.5: Passed

>> IKE-18.7
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with a Proposal
containing a 
Transform-Id not supported by the Protocol and MAY notify
INVALID-TRANSFORM-ID.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.6 p64 Transform Payload Processing
          RFC 2407 s4.2 p7  IPSEC ISAKMP Transform Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal with the
        protocol-Id as PROTO_ISAKMP and one Transform. Set the
        Transform-Id to <prm_inv_ph1_trans_id> 
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal with the
protocol-Id as PROTO_ISAKMP and one Transform containing
Transform-Id 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 263 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 243 
UDP: Checksum         = 0xB1F5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 86 D9 6F 02 2C D2 30                           ...o.,.0
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 235 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 10 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9F AA 1E 5A B5 67 75 99 8F 5A 9A 7B F7 BA 06 64   ...Z.gu..Z.{...d
ISAKMP:  8F 47 8D 00 FF B8 28 F7 4D 73 9E C1 D6 8A 8F 74   .G....(.Ms.....t
ISAKMP:  9A 1C 40 0D 3E CF 51 30 AA 73 C7 44 F3 7B F2 5C   ..@.>.Q0.s.D.{.\
ISAKMP:  6B B2 A1 AA 80 AF 31 EE 80 EE F0 04 B8 EF 41 26   k.....1.......A&
ISAKMP:  31 8A 2E C4 F7 99 72 53 F5 4B 7A A7 03 AB FD 78   1.....rS.Kz....x
ISAKMP:  A8 B9 CA 06 65 DA 80 FB 1F 9B 27 4E A0 88 B3 D8   ....e.....'N....
ISAKMP:  AC 6F E5 5B AE 59 CF EF 84 0B 41 9E DE 80 F2 D2   .o.[.Y....A.....
ISAKMP:  A3 A8 50 70 84 0B 70 53 61 20 C7 2F 06 3C CD 17   ..Pp..pSa ./.<..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 19 bytes
ISAKMP: --- Nonce Data [15 bytes] ---
ISAKMP:  18 7E 92 58 35 54 1F F8 CA 76 15 CE B8 50 AE      .~.X5T...v...P.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1219 (4633)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x991B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 86 D9 6F 02 2C D2 30                           ...o.,.0
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D2 7A C7 0A 73 AF DF 4C                           .z..s..L
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6CC76FDC
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 12 (Invalid Transform ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  00 86 D9 6F 02 2C D2 30 D2 7A C7 0A 73 AF DF 4C   ...o.,.0.z..s..L
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.7: Passed

>> IKE-18.8
TEST_DESCRIPTION
IKE MUST notify INVALID-TRANSFORM-ID for an incoming ISAKMP packet with a 
Proposal containing a Transform-Id not supported by the Protocol.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.6 p64 Transform Payload Processing
          RFC 2407 s4.2 p7  IPSEC ISAKMP Transform Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal with the
        protocol-Id as PROTO_ISAKMP and one Transform. Set the
        Transform-Id to <prm_inv_ph1_trans_id> 
-  DUT: Notify INVALID-TRANSFORM-ID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal with the
protocol-Id as PROTO_ISAKMP and one Transform containing
Transform-Id 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AEB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xF322 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4E 89 20 67 3C 5D 18 28                           N. g<].(
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 10 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5F C2 E2 4D 83 8B D6 B8 65 33 FA 6D EC C8 56 6E   _..M....e3.m..Vn
ISAKMP:  6D 4C A9 66 5F 28 E4 41 FF E9 84 DF 1B 69 56 56   mL.f_(.A.....iVV
ISAKMP:  B4 7C C8 9D 48 0B B3 C6 3D 92 38 71 32 70 81 1D   .|..H...=.8q2p..
ISAKMP:  2F CF 4D CC 4E B2 FC B0 CE 56 9B 6B 8F 4B FC BD   /.M.N....V.k.K..
ISAKMP:  01 1F 04 2A 6A EF 77 35 90 C1 19 68 88 B3 AE E5   ...*j.w5...h....
ISAKMP:  A9 EB 49 CF 4F FF 6F 8F 77 F7 63 3F D4 87 94 BE   ..I.O.o.w.c?....
ISAKMP:  2B 47 AE 94 0D 97 C9 F8 C1 05 EA 57 2F B8 8E 74   +G.........W/..t
ISAKMP:  2B 07 39 03 1B C0 E7 E8 07 CA 95 A3 13 05 E0 EB   +.9.............
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  46 59 2C CE 73 FC D5 86 52 CE 03 7C F1 42 FB D4   FY,.s...R..|.B..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x121A (4634)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0543 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4E 89 20 67 3C 5D 18 28                           N. g<].(
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  57 AA E4 23 2A D9 04 E2                           W..#*...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7D3ACAEC
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 12 (Invalid Transform ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4E 89 20 67 3C 5D 18 28 57 AA E4 23 2A D9 04 E2   N. g<].(W..#*...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 12

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.8: Passed

>> IKE-18.12
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing
multiple instances of 
same Attribute class and MAY notify ATTRIBUTE-NOT-SUPPORTED.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.5.2 p15, p16 Attribute Parsing Requirement
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
        SA Life type 
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
SA Life type to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 252 
UDP: Checksum         = 0xDCC1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4E 5C EE 7F 4D 73 B1 00                           N\..Ms..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 244 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 2 (Kilobytes)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  99 DC 5F 74 E6 A9 EB A9 25 54 87 56 0C 85 48 74   .._t....%T.V..Ht
ISAKMP:  58 1D FA F6 31 20 D8 51 CD 3E 1B A2 2A 0A B3 6D   X...1 .Q.>..*..m
ISAKMP:  D8 9A 10 D8 D7 5A 41 80 16 99 26 94 5E DD 06 58   .....ZA...&.^..X
ISAKMP:  40 2D FB 3E 76 4C 41 87 61 B3 FD A3 30 F1 A7 7E   @-.>vLA.a...0..~
ISAKMP:  FE 45 A9 3B 19 4E AE AB 71 F2 93 D3 F0 D3 22 0D   .E.;.N..q.....".
ISAKMP:  5F FA 00 39 4F F6 02 D0 B9 10 11 7C F8 78 62 73   _..9O......|.xbs
ISAKMP:  15 E2 56 49 FE 36 20 17 F2 AC 7B 80 E5 6E 14 53   ..VI.6 ...{..n.S
ISAKMP:  D7 D8 19 5E 9A DB E2 6F 0E F0 F0 DB BE 4B 6A 5F   ...^...o.....Kj_
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B2 A4 4A 65 C5 70 4E BE 6D 2B 1D 6E 6E E1 AF E2   ..Je.pN.m+.nn...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x121B (4635)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x5178 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4E 5C EE 7F 4D 73 B1 00                           N\..Ms..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C5 D8 E4 F7 D6 C4 B9 BB                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x95F5D6B6
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 13 (Attributes Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4E 5C EE 7F 4D 73 B1 00 C5 D8 E4 F7 D6 C4 B9 BB   N\..Ms..........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.12: Passed

>> IKE-18.13
TEST_DESCRIPTION
IKE SHOULD notify ATTRIBUTE-NOT-SUPPORTED for an incoming ISAKMP packet 
containing multiple instances of same Attribute class. 
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.5.2 p15, p16 Attribute Parsing Requirement
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
        SA Life type 
-  DUT: Notify ATTRIBUTE-NOT-SUPPORTED
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
SA Life type to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 252 
UDP: Checksum         = 0xBD44 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  19 DB 86 3C 1D 20 07 3E                           ...<. .>
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 244 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 2 (Kilobytes)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AE 6F FE 1E 58 7B C4 68 B1 A6 A8 3A FF AC C3 28   .o..X{.h...:...(
ISAKMP:  ED FC 5C 9F 05 B0 2A 24 BB 16 53 29 04 6A 34 49   ..\...*$..S).j4I
ISAKMP:  89 B4 69 D1 7F 4E 0C 66 3C 4B F1 55 83 20 93 5A   ..i..N.f<K.U. .Z
ISAKMP:  82 A3 0C 56 53 B9 CC 89 4A 8C A8 46 44 12 94 C3   ...VS...J..FD...
ISAKMP:  5D 35 3F 59 10 D6 58 1E 2D E1 B6 15 C5 98 AC 2E   ]5?Y..X.-.......
ISAKMP:  63 D5 2B 23 8E AE 3A F2 F8 4B 7D 00 E1 A4 27 3C   c.+#..:..K}...'<
ISAKMP:  9A 18 41 48 EC F3 04 0B 5D 0F 52 0C A4 64 C9 FB   ..AH....].R..d..
ISAKMP:  27 AF 43 3C 17 F8 01 4D 88 74 A8 70 EC 66 12 69   '.C<...M.t.p.f.i
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  61 1B CF E5 26 80 75 E0 46 B6 FB 90 86 E5 AE A3   a...&.u.F.......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x121C (4636)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xCBCA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  19 DB 86 3C 1D 20 07 3E                           ...<. .>
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  10 B9 23 ED 99 B8 50 D1                           ..#...P.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE3493507
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 13 (Attributes Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  19 DB 86 3C 1D 20 07 3E 10 B9 23 ED 99 B8 50 D1   ...<. .>..#...P.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 13

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.13: Passed

>> IKE-18.14
TEST_DESCRIPTION
There MUST not be multiple Proposal Payloads for a single SA Payload
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p9 Exchanges
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with 2 Proposals
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with 2 Proposals to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 296 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AC8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 276 
UDP: Checksum         = 0x2AB2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CC 74 19 45 8E 8A 8A 05                           .t.E....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 268 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 2
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2D FF 1D DD 22 7A F7 3D 04 A2 B0 B0 31 F9 1F 87   -..."z.=....1...
ISAKMP:  F9 42 8A 42 C5 D1 28 AA EF 61 DF CD BE 44 E5 15   .B.B..(..a...D..
ISAKMP:  67 9C 25 31 52 17 C3 37 2B BB EA 4E 6E CF 2D A6   g.%1R..7+..Nn.-.
ISAKMP:  13 B4 B0 89 76 70 CD 8D FA DE F4 E0 C8 65 88 55   ....vp.......e.U
ISAKMP:  B4 60 C9 73 3E 9C 98 8A E3 95 8F 6A 63 65 BE 4E   .`.s>......jce.N
ISAKMP:  D5 87 1A 1B 78 BD 6D C2 31 A7 A3 0B E9 F4 EA F9   ....x.m.1.......
ISAKMP:  90 51 A4 01 5D A5 E4 39 76 E7 00 4A 00 92 E5 31   .Q..]..9v..J...1
ISAKMP:  C6 4F 7B 72 A9 3D FB 48 8F D2 27 95 02 70 BA 65   .O{r.=.H..'..p.e
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F2 F5 49 FA FD F6 9E 7B F3 E0 6E 06 D8 6E B4 DF   ..I....{..n..n..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x121D (4637)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x762E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CC 74 19 45 8E 8A 8A 05                           .t.E....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  41 FE D4 94 91 78 3A 39                           A....x:9
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x2AD84940
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  CC 74 19 45 8E 8A 8A 05 41 FE D4 94 91 78 3A 39   .t.E....A....x:9
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.14: Passed

>> IKE-18.16
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if remaining
bits of Flags in HDR
is not set to 0 and MAY notify INVALID_FLAGS.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC2408 s3.1 p23 ISAKMP Header Format 
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the REMAINING_BITS set
        to <REM_BITS>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <REM_BITS> = {1,0,0,0,0}
- CASE: <REM_BITS> = {0,1,0,0,0}
- CASE: <REM_BITS> = {0,0,1,0,0}
- CASE: <REM_BITS> = {0,0,0,1,0}
- CASE: <REM_BITS> = {0,0,0,0,1} 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Set Remaining Bits to 1,0,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x80 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x910C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  93 75 AC 37 DB 47 83 78                           .u.7.G.x
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x80 (128)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C5 60 B6 F7 C4 B7 30 69 4B 1E EC CC AF 57 E1 31   .`....0iK....W.1
ISAKMP:  3A BD B4 F2 A3 2F 99 3E A7 38 49 63 B0 93 02 87   :..../.>.8Ic....
ISAKMP:  07 0F 3A E0 FC F4 CE 67 6B BE 31 C3 AC BE 62 72   ..:....gk.1...br
ISAKMP:  59 D2 22 EE A4 E9 36 41 EF 29 3A B2 05 84 52 05   Y."...6A.):...R.
ISAKMP:  15 C3 7D F9 A9 F4 FF 9F 60 53 02 3F 7D 2F 46 91   ..}.....`S.?}/F.
ISAKMP:  76 27 04 17 2D 87 50 56 45 FE 53 EA FC A2 C8 62   v'..-.PVE.S....b
ISAKMP:  FB 1B 06 50 4A 1C E1 C3 37 43 71 BE 44 48 72 59   ...PJ...7Cq.DHrY
ISAKMP:  8C AE 90 A6 7C F6 5F 88 8F A3 FF 89 97 52 66 38   ....|._......Rf8
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A 50 71 FF 52 7D 6A 50 10 67 3D 4D FB 12 3F AE   *Pq.R}jP.g=M..?.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x121E (4638)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x0E4F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  93 75 AC 37 DB 47 83 78                           .u.7.G.x
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Set Remaining Bits to 0,1,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x40 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x5F05 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD 59 05 3F 77 6E 67 40                           .Y.?wng@
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x40 (64)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C2 A0 33 CA 17 FC FC 7A B0 B7 FE 73 DE C6 18 12   ..3....z...s....
ISAKMP:  B6 25 5F 0F C9 AA 25 8E 95 DE 11 73 7F C2 E2 E2   .%_...%....s....
ISAKMP:  6A 7C 3C F1 2C DB B8 FF E4 86 77 2B B9 DC 8C 01   j|<.,.....w+....
ISAKMP:  BC B9 9E 52 24 F7 20 CD 13 2B 3D 79 5D 49 32 F8   ...R$. ..+=y]I2.
ISAKMP:  D6 66 4F 83 55 2F 5A 58 9F 38 3E 70 ED D1 6C E8   .fO.U/ZX.8>p..l.
ISAKMP:  7A 28 AA 77 FB 72 D7 51 D1 C6 A1 B3 F0 05 A7 3B   z(.w.r.Q.......;
ISAKMP:  82 D0 DF 44 2F 61 C4 8A 5D A7 D9 1F 9E 2D FA A7   ...D/a..]....-..
ISAKMP:  2A E8 FD 81 2C 24 08 8F 7B 26 9A 59 7C 2F 08 A8   *...,$..{&.Y|/..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  61 2A D3 E5 29 F8 F4 DF CB 88 30 95 8B EF 13 63   a*..).....0....c
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x121F (4639)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x1B75 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD 59 05 3F 77 6E 67 40                           .Y.?wng@
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Set Remaining Bits to 0,0,1,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x20 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x1C2A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F0 DF 6B 64 8C 69 17 25                           ..kd.i.%
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x20 (32)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  12 93 A2 17 06 87 F8 E0 3A 47 9B 20 82 8A 7A 06   ........:G. ..z.
ISAKMP:  A3 5C 08 DF 3B B1 23 C8 7F CC 7A 50 0C C9 C3 6C   .\..;.#...zP...l
ISAKMP:  22 24 59 9A C0 52 A6 4C 6B 3F 9F E9 76 71 31 88   "$Y..R.Lk?..vq1.
ISAKMP:  00 74 E0 42 D1 63 F7 05 B1 64 F2 9A 0C A0 F3 4A   .t.B.c...d.....J
ISAKMP:  46 29 F9 5E 5F 5F 02 E4 9C D2 C6 B6 B5 BE A8 32   F).^__.........2
ISAKMP:  75 10 4C 95 46 84 F4 C6 E0 C1 A2 E9 9C DF D6 F7   u.L.F...........
ISAKMP:  E9 AC 79 3B 53 F5 26 22 A9 D8 DF F9 85 B3 00 1D   ..y;S.&"........
ISAKMP:  78 50 C9 06 79 26 DE 4D 0E CA 2D 1B FB C2 3D CD   xP..y&.M..-...=.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 62 03 59 54 5C 49 C6 F2 2F 59 85 CE 93 70 48   .b.YT\I../Y...pH
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1220 (4640)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29ED (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xACE9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F0 DF 6B 64 8C 69 17 25                           ..kd.i.%
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:4 Set Remaining Bits to 0,0,0,1,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x71F5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  83 11 B5 40 4B A5 A1 41                           ...@K..A
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x10 (16)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E3 FA 6C 66 8B A7 B7 45 F5 8E EC 18 2C 69 4B 86   ..lf...E....,iK.
ISAKMP:  8B 56 B4 6B 1A 1C F2 64 73 57 9F 9D 3C 4E DB CA   .V.k...dsW..<N..
ISAKMP:  34 A2 45 86 F2 75 DF EC DD C8 16 7D 75 E4 C5 27   4.E..u.....}u..'
ISAKMP:  47 56 3E C9 E5 D1 B5 7B 9F A0 BC 2E 4C 5C 94 72   GV>....{....L\.r
ISAKMP:  41 C2 EA F6 A9 BB 3D 8F F0 21 CA 6B 91 BF D0 C5   A.....=..!.k....
ISAKMP:  D8 BA E3 37 F2 CE FD 93 E1 87 65 4B 23 64 BE D4   ...7......eK#d..
ISAKMP:  58 17 56 81 A7 07 A3 94 8B 0C 6E CC 1A D9 E3 87   X.V.......n.....
ISAKMP:  AB FC FA 6A 43 47 46 97 A9 D2 2F 1E 77 DB 5A 6D   ...jCGF.../.w.Zm
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  40 E2 E8 B3 F6 3A 7B 9D 6B BA 95 18 FE 92 39 2F   @....:{.k.....9/
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1221 (4641)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x8783 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  83 11 B5 40 4B A5 A1 41                           ...@K..A
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:5 Set Remaining Bits to 0,0,0,0,1

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x08 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xE684 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE 0B 5B 23 E5 58 AC 11                           ..[#.X..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x08 (8)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F0 9A 2B A8 8E 72 D4 3B 97 B4 30 33 7B 44 6D 76   ..+..r.;..03{Dmv
ISAKMP:  2B 57 F5 D1 55 8C A8 4B E7 40 68 43 0D 63 36 43   +W..U..K.@hC.c6C
ISAKMP:  03 3E D4 A7 79 36 B6 F1 0F 23 F9 0A AF 47 F4 B8   .>..y6...#...G..
ISAKMP:  5A 91 19 04 85 19 CA C3 2E 5D 78 1B 00 B8 48 9E   Z........]x...H.
ISAKMP:  69 B6 35 B2 83 D7 94 07 24 8D E5 0C A5 E9 3C 60   i.5.....$.....<`
ISAKMP:  E5 1B 0B 4C AD 8C 47 59 6D 1D B2 C3 7A 71 69 8C   ...L..GYm...zqi.
ISAKMP:  49 BB E0 80 39 81 21 40 0A 4E 9B B4 6D 31 CA 4A   I...9.!@.N..m1.J
ISAKMP:  79 8E 37 F8 3E A5 4C 5F B2 9F A7 9E B2 F4 E2 35   y.7.>.L_.......5
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E1 D7 6D 1B 7C 25 4E CB 89 56 7A 06 DA B3 7F A7   ..m.|%N..Vz.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1222 (4642)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xF222 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE 0B 5B 23 E5 58 AC 11                           ..[#.X..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.16: Passed

>> IKE-18.17
TEST_DESCRIPTION
IKE MUST notify INVALID_FLAGS for an incoming ISAKMP packet if
REMAINING_BITS 
in HDR is not set to 0.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC2408 s3.1 p23 ISAKMP Header Format 
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the REMAINING_BITS set
        to <REM_BITS>
-  DUT: Notify INVALID_FLAGS
- CASE: <REM_BITS> = {1,0,0,0,0}
- CASE: <REM_BITS> = {0,1,0,0,0}
- CASE: <REM_BITS> = {0,0,1,0,0}
- CASE: <REM_BITS> = {0,0,0,1,0}
- CASE: <REM_BITS> = {0,0,0,0,1} 
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Set Remaining Bits to 1,0,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x80 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x7151 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0D D4 F0 30 D0 81 F0 31                           ...0...1
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x80 (128)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  19 6D 6F 8D 50 C9 67 57 0D 4F AB 52 30 23 88 8D   .mo.P.gW.O.R0#..
ISAKMP:  B6 32 EB D5 ED 77 22 9C 8C A7 21 57 F2 FF 2B C0   .2...w"...!W..+.
ISAKMP:  1F EB 79 06 21 4C 9B BA C4 10 35 F1 F7 C0 3B 65   ..y.!L....5...;e
ISAKMP:  24 D7 AC 50 CC C8 1E A7 CE 75 36 3A 63 9A 5F FA   $..P.....u6:c._.
ISAKMP:  0A 3B F7 72 A8 91 65 7C F3 DA C4 73 0B 73 CA A7   .;.r..e|...s.s..
ISAKMP:  D1 AA E7 C3 61 F3 72 B3 78 ED D0 64 31 49 47 D2   ....a.r.x..d1IG.
ISAKMP:  6D 17 2A D6 3C DE 6C 91 0A 0C FE 61 40 03 2C EA   m.*.<.l....a@.,.
ISAKMP:  26 43 A1 1F F8 A1 75 60 B7 23 32 EA DD A0 B1 DE   &C....u`.#2.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7E 5F 43 FD BB 21 21 87 4B 73 2D D7 34 FE 71 57   ~_C..!!.Ks-.4.qW
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1223 (4643)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29EA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xEE03 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0D D4 F0 30 D0 81 F0 31                           ...0...1
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Set Remaining Bits to 0,1,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x40 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x1FF1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C7 7B 68 57 00 A8 AA 59                           .{hW...Y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x40 (64)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D2 14 0A DD D0 3A F9 82 F8 21 65 2E BE 78 8F 2D   .....:...!e..x.-
ISAKMP:  CA E3 6E E4 00 D6 A5 96 9B 29 A4 7E 6A 16 45 02   ..n......).~j.E.
ISAKMP:  D6 8D AB B8 4A 7B 10 36 0B E6 51 6E 3F AB 8B 9A   ....J{.6..Qn?...
ISAKMP:  BF 26 79 06 81 0A 66 71 3B 48 6A D9 58 DE A1 53   .&y...fq;Hj.X..S
ISAKMP:  7F 41 7C 10 2C 1F 6D BE 80 8C D1 48 5F 1B F4 AE   .A|.,.m....H_...
ISAKMP:  9B 1D 3F 77 E5 7D 74 4D 1A 86 81 7D DC 33 38 B4   ..?w.}tM...}.38.
ISAKMP:  50 B2 C6 40 14 48 00 85 5B D1 86 05 F5 B1 61 41   P..@.H..[.....aA
ISAKMP:  B6 76 1C A1 BB 91 23 F0 B2 E0 5B 71 55 C0 F3 B0   .v....#...[qU...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  19 87 BE A9 FC 0C 87 F8 E2 7F D2 AD 79 74 81 BE   ............yt..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1224 (4644)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xD1E7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C7 7B 68 57 00 A8 AA 59                           .{hW...Y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Set Remaining Bits to 0,0,1,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x20 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xE03F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5D 6A F0 3A D6 6D 53 3C                           ]j.:.mS<
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x20 (32)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  71 5E DF A1 07 39 EC 5D 8C 39 12 86 D7 CF 65 30   q^...9.].9....e0
ISAKMP:  EB 0A E1 30 DE 59 F3 62 89 A0 7F 23 36 0C 7A CE   ...0.Y.b...#6.z.
ISAKMP:  EC ED 4D 94 0C 9D CB 20 01 E9 1E 71 2D 1A 54 59   ..M.... ...q-.TY
ISAKMP:  7D 04 98 38 DC B2 E4 F6 56 62 10 B3 69 54 19 CA   }..8....Vb..iT..
ISAKMP:  5A 0D DD F3 A2 16 F4 B0 DC C4 19 CE DB 07 A1 EA   Z...............
ISAKMP:  F1 FF B5 81 94 DE 4A FB 10 19 8D B9 29 EA 5D F9   ......J.....).].
ISAKMP:  5B D0 36 E7 6A 2D 52 37 E1 2B 07 4A 5C C6 A3 F4   [.6.j-R7.+.J\...
ISAKMP:  A9 B3 16 C6 36 D3 8B 27 9C 3B 48 87 45 FE 4C 5D   ....6..'.;H.E.L]
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7B 0C 7D BF AD 30 F9 37 8B 35 70 4B 98 9E E3 6F   {.}..0.7.5pK...o
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1225 (4645)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x356D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5D 6A F0 3A D6 6D 53 3C                           ]j.:.mS<
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:4 Set Remaining Bits to 0,0,0,1,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x4759 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E7 09 CD 69 6C 5A CB 58                           ...ilZ.X
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x10 (16)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AC A2 9B B8 EC 60 13 B3 E8 20 23 44 63 77 2B 61   .....`... #Dcw+a
ISAKMP:  9A DD 12 AA 5F 82 23 AB 3D 3B 64 BF FF AB 3D 4E   ...._.#.=;d...=N
ISAKMP:  3F CF 62 0A 3D 25 9E 94 5B 26 16 13 8A B1 3A 66   ?.b.=%..[&....:f
ISAKMP:  4D 8C 54 26 0B 88 58 1B 56 12 05 F5 7B F9 9E A2   M.T&..X.V...{...
ISAKMP:  79 27 B8 D3 B9 DA 62 60 47 E8 68 47 54 E3 28 33   y'....b`G.hGT.(3
ISAKMP:  C9 86 A1 3F A7 7E EA 61 18 5B EC 6F 50 27 CA 25   ...?.~.a.[.oP'.%
ISAKMP:  72 06 A3 0C 03 57 EF 6D B7 11 11 16 97 E9 FE 45   r....W.m.......E
ISAKMP:  FF C6 48 F3 90 7D CC 7B A8 6B D4 92 21 72 61 81   ..H..}.{.k..!ra.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F4 12 72 C4 C5 07 E7 99 77 48 63 EC A1 CE F3 77   ..r.....wHc....w
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1226 (4646)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xC095 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E7 09 CD 69 6C 5A CB 58                           ...ilZ.X
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:5 Set Remaining Bits to 0,0,0,0,1

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x08 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xA398 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  07 B4 5D 72 3C 76 8D 73                           ..]r<v.s
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x08 (8)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A5 0B E2 B2 C5 AB 2D 33 32 7E 85 BD 22 FC 47 75   ......-32~..".Gu
ISAKMP:  AB BE ED A5 1B B0 88 D3 C7 99 09 BD 8F 6D D1 E1   .............m..
ISAKMP:  7A 25 A0 9E BE 1E E3 56 CC 08 11 2B 1F CD 88 8B   z%.....V...+....
ISAKMP:  1B 93 D1 E1 41 57 B9 7E 3A BF CD 63 9A 02 05 AB   ....AW.~:..c....
ISAKMP:  AB E7 B9 E7 58 FD 58 AC AB 89 98 B9 25 74 7F B5   ....X.X.....%t..
ISAKMP:  2E F8 99 7B 74 F9 00 7E E5 29 A4 8D 16 FD 75 8D   ...{t..~.)....u.
ISAKMP:  E4 A1 12 8F AD 24 FD 00 DF AB F7 08 F4 7F 00 70   .....$.........p
ISAKMP:  CC C4 22 E6 5B D3 02 F9 86 A4 17 3E C7 61 1E BB   ..".[......>.a..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 8A FA FD 97 B3 B4 7C A2 44 82 FE 04 4F 21 8E   .......|.D...O!.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1227 (4647)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29E6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x7DAC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  07 B4 5D 72 3C 76 8D 73                           ..]r<v.s
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.17: Passed

>> IKE-18.20
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if Port field of
Identification Payload is other than 0 or 500 and MAY notify
INVALID-ID-INFORMATION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set ID Port field of IDii to an
        invalid <prm_inv_id_port>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing ID Port field of IDii to an
invalid 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x2994 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2E D1 09 4D 54 82 A6 0E                           ...MT...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E2 03 C3 FD 45 96 96 A2 0A 51 87 83 B3 F2 6F 72   ....E....Q....or
ISAKMP:  05 80 D6 3C C2 72 30 66 72 30 7B C6 58 E8 5A A1   ...<.r0fr0{.X.Z.
ISAKMP:  9D 10 81 FD DF 5C 88 20 85 DD 86 6E 50 A2 C4 00   .....\. ...nP...
ISAKMP:  52 2D 24 B4 D8 CD EB BB 3B C1 11 95 23 34 A2 18   R-$.....;...#4..
ISAKMP:  0E 0E 7A 2A 70 25 46 01 49 35 21 5D 02 7F C0 1E   ..z*p%F.I5!]....
ISAKMP:  77 23 19 6B 57 E8 84 86 2C DA 3F 71 85 50 AA 5E   w#.kW...,.?q.P.^
ISAKMP:  44 52 50 7F 47 CA D5 67 FB 3D D0 EF 53 CF F0 F5   DRP.G..g.=..S...
ISAKMP:  D6 D9 94 B3 4A A7 B2 BE 95 D3 B6 17 30 68 C5 7C   ....J.......0h.|
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  8A 20 EB 73 F3 3D 1D 98 E1 6F 35 BA E6 43 1F 43   . .s.=...o5..C.C
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1228 (4648)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29D5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x1778 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2E D1 09 4D 54 82 A6 0E                           ...MT...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  11 F3 25 9B 3A 90 D8 2B                           ..%.:..+
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7DC01C37
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  2E D1 09 4D 54 82 A6 0E 11 F3 25 9B 3A 90 D8 2B   ...MT.....%.:..+
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.20: Passed

>> IKE-18.21
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP
packet if Port 
field of Identification Payload is other than 0 or 500.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set ID Port field of IDii to an
        invalid <prm_inv_Id_port>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing ID Port field of IDii to an
invalid 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xC23E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  92 F5 48 5C EC 33 F1 5D                           ..H\.3.]
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E9 26 CC 60 A3 CC 23 B2 18 FD A4 66 85 68 09 8A   .&.`..#....f.h..
ISAKMP:  DE 18 96 A4 37 BE 22 FF 6A DE 72 66 A8 44 48 AF   ....7.".j.rf.DH.
ISAKMP:  2A C6 F0 EA D6 32 98 AA 31 63 F1 88 33 7B 88 BB   *....2..1c..3{..
ISAKMP:  AA 46 A1 01 A2 93 AE BF 56 01 74 DB 61 D4 70 9B   .F......V.t.a.p.
ISAKMP:  A6 96 16 2E 15 2F DA F2 B1 38 32 E2 64 8D 2C 16   ...../...82.d.,.
ISAKMP:  D6 8B FD FF 3F C0 C2 2F B8 1F 4A D7 81 E8 46 52   ....?../..J...FR
ISAKMP:  BA 87 44 37 6E B9 9E 6A 89 9C 49 B9 94 50 77 9E   ..D7n..j..I..Pw.
ISAKMP:  4E 6F B8 9D F3 A9 A8 DC 95 26 D4 C1 8F EB F5 E9   No.......&......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4A 40 2C B5 38 33 07 77 D3 76 DF 4D 95 82 B8 34   J@,.83.w.v.M...4
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1229 (4649)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29D4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF6E7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  92 F5 48 5C EC 33 F1 5D                           ..H\.3.]
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  AE 50 05 53 B8 FC 51 14                           .P.S..Q.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7BBB4B8E
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  92 F5 48 5C EC 33 F1 5D AE 50 05 53 B8 FC 51 14   ..H\.3.].P.S..Q.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 18

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.21: Passed

>> IKE-18.22
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with Protocol ID field of ID Payload other
than 0 or UDP protocol (0x11) and MAY notify INVALID-ID-INFORMATION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set Protocol-ID field of IDii
        to an invalid <prm_inv_id_proto>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing Protocol-ID field of IDii
to an invalid <prm_inv_id_proto> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x394C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0B 13 9D 2C 39 FF B1 2E                           ...,9...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  76 EB 23 79 9A 40 D5 88 2E AC 37 B2 C1 5E 37 B8   v.#y.@....7..^7.
ISAKMP:  9C DE 2E 34 E6 A0 CE C0 38 EF 6D 7E 92 F1 BB 32   ...4....8.m~...2
ISAKMP:  2E 31 88 FF 47 D3 E2 C6 5C 1F 2D E8 C9 B7 53 27   .1..G...\.-...S'
ISAKMP:  09 82 48 E7 E8 46 F8 19 96 42 EE 20 18 9D 36 6E   ..H..F...B. ..6n
ISAKMP:  FC 03 77 31 3B 37 42 35 DF B6 FE 50 0F 9F 67 34   ..w1;7B5...P..g4
ISAKMP:  D3 9B 9A 13 CB 36 57 87 DA 0A 65 81 7D 74 9E 28   .....6W...e.}t.(
ISAKMP:  36 F7 B0 87 2B 03 C6 30 0D 31 22 0B 20 61 22 AA   6...+..0.1". a".
ISAKMP:  AC 96 41 4F BB 34 0D 82 F5 09 18 45 16 BE 58 27   ..AO.4.....E..X'
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7D 95 03 BF E1 12 E6 9D 09 02 F1 EE AA 99 A5 13   }...............
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x122A (4650)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29D3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3C52 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0B 13 9D 2C 39 FF B1 2E                           ...,9...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  02 4B B3 2B AD 80 32 4C                           .K.+..2L
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD4574956
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  0B 13 9D 2C 39 FF B1 2E 02 4B B3 2B AD 80 32 4C   ...,9....K.+..2L
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.22: Passed

>> IKE-18.23
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP packet
with Protocol ID field of ID Payload other than 0 or
UDP protocol (0x11).
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set Protocol-ID field of IDii to an
        invalid <prm_inv_id_proto>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing Protocol-ID field of IDii
to an invalid <prm_inv_id_proto> 10 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x102D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  43 99 0C 2E 8C 85 58 6E                           C.....Xn
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DE 39 2C 46 DD 3E E2 E7 E6 C9 73 FB E1 12 43 01   .9,F.>....s...C.
ISAKMP:  2F 7D FE 9D D8 8C FF F3 60 98 37 70 81 C7 26 15   /}......`.7p..&.
ISAKMP:  A0 81 CC DF 7A 7A 9E 0B C3 7E F0 6C B4 C0 38 92   ....zz...~.l..8.
ISAKMP:  E1 0D E9 25 78 9D 45 9D 5B D4 6E DC C7 9B 3B C0   ...%x.E.[.n...;.
ISAKMP:  E4 25 FD C5 C4 A8 00 28 26 B8 E7 75 1A 6A 25 A8   .%.....(&..u.j%.
ISAKMP:  C0 E8 9E 78 55 76 D5 DE 34 72 8A F4 97 8E C6 F4   ...xUv..4r......
ISAKMP:  D0 A8 EF 84 37 D1 B9 61 20 B6 66 3E B8 1D DE 81   ....7..a .f>....
ISAKMP:  F3 9A F7 8D 66 08 DC 27 80 DD BE 0B CD 9A 29 81   ....f..'......).
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  20 CD 5C 1E C4 82 7E 83 66 4F 0E 20 32 EE F3 05    .\...~.fO. 2...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x122B (4651)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29D2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7A0F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  43 99 0C 2E 8C 85 58 6E                           C.....Xn
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  3D AB 23 04 9E 6A C1 0A                           =.#..j..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x318A1609
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  43 99 0C 2E 8C 85 58 6E 3D AB 23 04 9E 6A C1 0A   C.....Xn=.#..j..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 18

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.23: Passed

>> IKE-18.24
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet with non zero value
in the RESERVED field of any Payload and MAY notify
BAD-PROPOSAL-SYNTAX or PAYLOAD-MALFORMED.  
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.3 p61 Generic Payload Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set the RESERVED field of <Payload>
        to a NON_ZERO_VAL (e.g. 2)
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <Payload> = SA 
- CASE: <Payload> = Proposal
- CASE: <Payload> = Transform
- CASE: <Payload> = KE
- CASE: <Payload> = Ni
- CASE: <Payload> = IDii
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Set RESERVED field of SA to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xB17D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0E 11 44 24 62 0E D4 64                           ..D$b..d
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E9 9C EE 27 BA 1E 0D C5 AF 97 DC B4 B3 41 56 D6   ...'.........AV.
ISAKMP:  C0 3E A0 7E F2 28 1E C0 CD 37 68 EA F4 EF 9A 72   .>.~.(...7h....r
ISAKMP:  E6 38 C2 11 68 EC 65 F4 62 52 CD 10 20 90 16 A6   .8..h.e.bR.. ...
ISAKMP:  4E F4 8F 04 C5 96 05 C7 25 B2 23 90 DB FA BB F9   N.......%.#.....
ISAKMP:  53 06 A2 98 58 99 8F BD 98 2F BD 45 DC 2E 9F 5D   S...X..../.E...]
ISAKMP:  EA FC 40 F8 8C 29 88 93 8D A2 12 76 38 D2 2D 9C   ..@..).....v8.-.
ISAKMP:  B7 56 F7 2F 79 19 A6 C3 67 94 1E E7 3B 33 4E C3   .V./y...g...;3N.
ISAKMP:  9E F8 CC DF 6F B0 73 C9 AF BC 69 80 AA AF 7F BC   ....o.s...i.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A D7 56 33 E7 DF 3B 6F D5 28 85 07 CD EF 38 9C   *.V3..;o.(....8.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x122C (4652)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29D1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x435E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0E 11 44 24 62 0E D4 64                           ..D$b..d
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  61 DD 9B AC 5E 30 3C 01                           a...^0<.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD09456A9
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  0E 11 44 24 62 0E D4 64 61 DD 9B AC 5E 30 3C 01   ..D$b..da...^0<.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Set RESERVED field of Proposal Payload
to non-zero value
Case:2 Set RESERVED field ofTransform Payload
to non-zero value
Case:2 Set RESERVED field of KE Payload
to non-zero value
Case:2 Set RESERVED field of Nonce Payload
to non-zero value
Case:2 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x19BF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  37 40 01 1F 3C 2B 58 60                           7@..<+X`
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  31 1B 9D 81 41 81 06 AB 8E CA 70 7E 36 BD F3 1E   1...A.....p~6...
ISAKMP:  BE 77 9A 61 1F 00 7C 5F 2F AC 51 93 9C 14 66 36   .w.a..|_/.Q...f6
ISAKMP:  FD 2E 0B 92 6D 3C 49 69 8A C4 12 2B 79 1C 2E B8   ....m<Ii...+y...
ISAKMP:  3F 9D E7 16 56 FB 0D BC FA EA 40 8D 39 2F 12 E5   ?...V.....@.9/..
ISAKMP:  D3 57 CB A5 12 F7 F5 48 53 31 9F 16 4C B5 D3 F0   .W.....HS1..L...
ISAKMP:  63 0D A6 9A BF 8D D2 08 B6 A7 BF B3 D8 93 7F 32   c..............2
ISAKMP:  6D 81 5D F2 B6 5C 0E B3 BE 5E 87 AE FD 74 3B DF   m.]..\...^...t;.
ISAKMP:  F8 55 42 75 25 83 AA 68 D4 AB 95 29 B1 A7 75 6A   .UBu%..h...)..uj
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7C 90 03 2E 71 5B 11 CB 98 13 86 80 0D 54 C9 69   |...q[.......T.i
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x122D (4653)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29D0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x49AD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  37 40 01 1F 3C 2B 58 60                           7@..<+X`
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  79 11 86 5B 7C BE 43 00                           y..[|.C.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x834907
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  37 40 01 1F 3C 2B 58 60 79 11 86 5B 7C BE 43 00   7@..<+X`y..[|.C.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Set RESERVED field ofTransform Payload
to non-zero value
Case:3 Set RESERVED field of KE Payload
to non-zero value
Case:3 Set RESERVED field of Nonce Payload
to non-zero value
Case:3 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x1E7D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  72 83 FF 68 32 E1 21 2A                           r..h2.!*
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3F 23 A8 A1 42 79 AE 03 A9 C9 FA 61 38 80 FE CD   ?#..By.....a8...
ISAKMP:  12 CB C3 33 B5 2E 89 53 7B 86 D6 13 9E 18 AC 52   ...3...S{......R
ISAKMP:  9D D0 EC B6 F1 9C 31 80 D5 68 48 7A 48 47 2A 0B   ......1..hHzHG*.
ISAKMP:  0D 34 E3 5C F0 3A 7E C8 65 EB A3 2C DB 5D 56 EB   .4.\.:~.e..,.]V.
ISAKMP:  56 8F 45 88 F3 E6 B3 69 21 3F C5 1C 0D 7A 64 3D   V.E....i!?...zd=
ISAKMP:  2E B1 B0 87 6E 54 4E 93 1F 9C 0E 96 EF 9E 6E 51   ....nTN.......nQ
ISAKMP:  25 B5 D0 03 F4 55 10 C3 4E 2C E8 EA 1A 1B 9D 6C   %....U..N,.....l
ISAKMP:  23 BB 0D 2D BB 3F 50 0E AE 50 DF C4 FD 05 10 F6   #..-.?P..P......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B6 F6 97 29 BC 89 8B 88 9E 17 2C 61 0C 17 69 05   ...)......,a..i.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x122E (4654)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29CF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xCADD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  72 83 FF 68 32 E1 21 2A                           r..h2.!*
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7A 61 46 F6 17 24 B4 19                           zaF..$..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xEAAA50C1
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  72 83 FF 68 32 E1 21 2A 7A 61 46 F6 17 24 B4 19   r..h2.!*zaF..$..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:4 Set RESERVED field of KE Payload
to non-zero value
Case:4 Set RESERVED field of Nonce Payload
to non-zero value
Case:4 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x3DE5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  66 56 97 35 99 EA 5F 76                           fV.5.._v
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  50 AE 9A 20 75 88 9D A0 84 8D 12 8F 29 53 B6 34   P.. u.......)S.4
ISAKMP:  4A 58 43 CF B3 33 7B 93 E4 87 C7 B3 40 D4 A2 82   JXC..3{.....@...
ISAKMP:  3B 65 6E 0E 12 70 0B D5 4B EC 3C 6C E6 E0 B3 A0   ;en..p..K.<l....
ISAKMP:  5C 2F AF F3 DE 46 57 EE 15 55 D8 C4 B0 69 62 8B   \/...FW..U...ib.
ISAKMP:  82 A8 94 E7 59 06 3A B4 20 18 B5 DE 61 13 F9 15   ....Y.:. ...a...
ISAKMP:  98 29 07 6B 2C 13 D5 01 79 D2 2E 1C B2 A2 5E 04   .).k,...y.....^.
ISAKMP:  80 D0 1D EF 08 74 3B FF 06 50 B6 54 9D 8E 26 CA   .....t;..P.T..&.
ISAKMP:  7E 86 26 60 80 A8 1E 89 A2 D0 6F 15 51 3B 5F 15   ~.&`......o.Q;_.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E2 86 70 72 F1 00 81 A6 1A A0 75 25 BE 50 A5 FC   ..pr......u%.P..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x122F (4655)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29CE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x5DD6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  66 56 97 35 99 EA 5F 76                           fV.5.._v
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  52 67 9A C3 55 15 71 AF                           Rg..U.q.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xCCFC2AD8
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  66 56 97 35 99 EA 5F 76 52 67 9A C3 55 15 71 AF   fV.5.._vRg..U.q.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:5 Set RESERVED field of Nonce Payload
to non-zero value
Case:5 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x9480 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  98 C0 B9 16 F8 29 FA 57                           .....).W
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  39 83 B1 0F 36 42 2B 06 1F 5D 21 A2 C1 3C 43 3B   9...6B+..]!..<C;
ISAKMP:  29 F0 80 A3 25 AB FC 04 48 45 D5 F7 65 86 C9 08   )...%...HE..e...
ISAKMP:  61 5E 6F C0 1A E9 D7 54 41 C0 CB 74 41 8D 06 BD   a^o....TA..tA...
ISAKMP:  8A 6D 0E 51 CB 60 58 8D 85 F6 19 B0 87 B7 EC 5B   .m.Q.`X........[
ISAKMP:  74 85 77 D9 19 19 6C 2F C8 C9 9B 29 25 B4 9D E8   t.w...l/...)%...
ISAKMP:  EB 6C 3D 48 F8 8E F0 0D 79 96 AC 3C 48 74 3C 6B   .l=H....y..<Ht<k
ISAKMP:  47 75 D8 D7 CC 0D 74 C4 1F 36 00 7C BE 5F AF 77   Gu....t..6.|._.w
ISAKMP:  69 A5 90 C6 B5 F7 D5 5A 27 3E 98 F3 BE 47 65 69   i......Z'>...Gei
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F4 38 21 EE B1 05 ED F3 76 DF 18 D4 19 02 04 EC   .8!.....v.......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1230 (4656)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29CD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x1354 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  98 C0 B9 16 F8 29 FA 57                           .....).W
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  15 1E 15 39 09 07 54 46                           ...9..TF
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x94EA6B2A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  98 C0 B9 16 F8 29 FA 57 15 1E 15 39 09 07 54 46   .....).W...9..TF
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:6 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xBE1E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  08 2C 20 43 55 C8 5D 43                           ., CU.]C
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B6 32 7C 19 9C 5D 06 24 7E 03 2F 7F 16 D1 C5 81   .2|..].$~./.....
ISAKMP:  C1 2C D4 4F BC 88 3E A0 4D 5D EC 98 0D 01 23 49   .,.O..>.M]....#I
ISAKMP:  D4 48 20 2E 6C 36 F3 9D 76 E0 86 7A C6 8D 1E C8   .H .l6..v..z....
ISAKMP:  5C 96 C1 FB 5E 3B 47 32 FE 52 62 AD 4D 03 F6 B5   \...^;G2.Rb.M...
ISAKMP:  D8 EF 79 F8 DD C8 F4 D4 4B 6A 53 E2 B6 79 80 D2   ..y.....KjS..y..
ISAKMP:  50 A3 60 07 85 55 94 57 F9 AD 9A 27 08 BA B9 5E   P.`..U.W...'...^
ISAKMP:  43 78 EF BF 72 22 32 11 1D A8 C4 39 74 F4 96 EE   Cx..r"2....9t...
ISAKMP:  58 D0 11 85 3E 02 A3 08 67 F5 BA 54 E5 2F 24 7D   X...>...g..T./$}
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B1 9A 35 30 D4 0E 46 A7 EF 9E F3 EF 30 0D 7B E6   ..50..F.....0.{.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1231 (4657)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29CC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x45C3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  08 2C 20 43 55 C8 5D 43                           ., CU.]C
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  3A 66 B2 08 7B 51 D9 51                           :f..{Q.Q
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xB57F7707
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  08 2C 20 43 55 C8 5D 43 3A 66 B2 08 7B 51 D9 51   ., CU.]C:f..{Q.Q
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.24: Passed

>> IKE-18.25
TEST_DESCRIPTION
IKE MUST notify BAD-PROPOSAL-SYNTAX or PAYLOAD-MALFORMED for an
incoming ISAKMP
packet with non zero value in the RESERVED field of any Payload.  
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.3 p61 Generic Payload Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set the RESERVED field of <Payload>
        to a NON_ZERO_VAL (e.g. 2)
-  DUT: Notify BAD-PROPOSAL-SYNTAX or PROPOSAL-MALFORMED
- CASE: <Payload> = SA 
- CASE: <Payload> = Proposal
- CASE: <Payload> = Transform
- CASE: <Payload> = KE
- CASE: <Payload> = Ni
- CASE: <Payload> = IDii
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Set RESERVED field of SA to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xA98E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0E FB A7 4B CA 7F FD 0C                           ...K....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2F 35 A4 F2 44 CB 52 7B 08 90 EF F1 AB 2E DA BE   /5..D.R{........
ISAKMP:  5C 19 56 02 B6 1B E0 B9 24 1C 4C 41 1A 01 7D 82   \.V.....$.LA..}.
ISAKMP:  AC 7C F1 10 C7 E8 BD B1 51 DB EC 65 DE 2F 55 2F   .|......Q..e./U/
ISAKMP:  E5 A6 5A 97 AC 84 E5 52 AE 18 5F 9D B4 2C 92 A9   ..Z....R.._..,..
ISAKMP:  98 5A A4 A5 20 66 AA 31 CE 64 A6 9D 07 A0 5C F5   .Z.. f.1.d....\.
ISAKMP:  AE 16 1F 39 AF 7A 38 BA 14 FB FD 79 18 00 C7 91   ...9.z8....y....
ISAKMP:  77 BB E5 2B BF 32 96 48 2F C5 85 F5 F3 49 A3 75   w..+.2.H/....I.u
ISAKMP:  51 3A 59 02 43 E2 62 A0 E6 A3 64 26 51 1D 24 94   Q:Y.C.b...d&Q.$.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  BB 18 97 A0 6D 4B F3 57 8A 78 8C C0 8E 1E 6D C4   ....mK.W.x....m.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1232 (4658)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29CB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x4988 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0E FB A7 4B CA 7F FD 0C                           ...K....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  16 72 1D 96 3D 39 82 46                           .r..=9.F
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE4379AED
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  0E FB A7 4B CA 7F FD 0C 16 72 1D 96 3D 39 82 46   ...K.....r..=9.F
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Set RESERVED field of Proposal Payload
to non-zero value
Case:2 Set RESERVED field ofTransform Payload
to non-zero value
Case:2 Set RESERVED field of KE Payload
to non-zero value
Case:2 Set RESERVED field of Nonce Payload
to non-zero value
Case:2 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xF3FD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B0 CC 61 49 11 9F 25 0B                           ..aI..%.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  BE C3 1F 5E D5 4F 53 6E 31 FF B3 76 36 31 9C B1   ...^.OSn1..v61..
ISAKMP:  82 C0 75 0C 03 59 DC 24 D8 4E B8 AA BA FD CA 87   ..u..Y.$.N......
ISAKMP:  7D 59 28 0D BC B2 13 C5 E3 48 21 85 CE A7 14 9A   }Y(......H!.....
ISAKMP:  E1 0D 26 21 38 C5 C8 65 E4 29 EE 9B 71 0E 29 23   ..&!8..e.)..q.)#
ISAKMP:  5B DC 17 FE AE E3 40 B0 B0 D8 A6 AB DB B0 57 FE   [.....@.......W.
ISAKMP:  DA 80 3E 3B 89 30 DD FD 39 2A 21 21 D5 DA 43 C3   ..>;.0..9*!!..C.
ISAKMP:  2F F6 20 BE 25 A0 25 29 EC 82 AA A4 E1 57 CA BE   /. .%.%).....W..
ISAKMP:  5D D8 B8 3E 83 9F C9 01 A5 F8 06 A6 8A C7 BA 0C   ]..>............
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B3 68 9C D1 76 5F A0 73 AA AD F8 42 43 60 5D 09   .h..v_.s...BC`].
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1233 (4659)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29CA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE6B2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B0 CC 61 49 11 9F 25 0B                           ..aI..%.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B1 C8 FB A6 01 36 E6 53                           .....6.S
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x75AF938E
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  B0 CC 61 49 11 9F 25 0B B1 C8 FB A6 01 36 E6 53   ..aI..%......6.S
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Set RESERVED field ofTransform Payload
to non-zero value
Case:3 Set RESERVED field of KE Payload
to non-zero value
Case:3 Set RESERVED field of Nonce Payload
to non-zero value
Case:3 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xB585 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  31 11 DE 66 2F 97 4D 67                           1..f/.Mg
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F5 EF CD 17 51 8C CF 04 9B 2A 90 77 CD 89 BA 10   ....Q....*.w....
ISAKMP:  6D 03 FD 3B DF 57 73 2C 7B 86 E4 04 9A CA 23 3A   m..;.Ws,{.....#:
ISAKMP:  B7 AF 01 C8 85 7B 28 CE 42 66 12 FC 37 AF 9C BB   .....{(.Bf..7...
ISAKMP:  A0 7D 58 FA 0B 49 78 66 44 45 78 A3 6D FF 71 D0   .}X..IxfDEx.m.q.
ISAKMP:  57 25 BE F5 D4 29 10 3F BB 69 59 EE E5 B5 0B 63   W%...).?.iY....c
ISAKMP:  F7 BD 14 CB 00 44 14 E1 7E 93 F1 D1 41 E7 9A FA   .....D..~...A...
ISAKMP:  15 FD 29 16 F9 D9 D5 E8 7D A9 5C 45 C3 30 BE CF   ..).....}.\E.0..
ISAKMP:  77 7C 81 B8 B2 17 BD A4 F0 8B 33 2B 18 0C 55 75   w|........3+..Uu
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  76 8A 2E E6 67 59 84 4C E5 72 1C 86 C8 B7 ED 90   v...gY.L.r......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1234 (4660)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29C9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7EB2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  31 11 DE 66 2F 97 4D 67                           1..f/.Mg
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CF 79 1B 73 BD 6C 8E 0C                           .y.s.l..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xBB7AEB7D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  31 11 DE 66 2F 97 4D 67 CF 79 1B 73 BD 6C 8E 0C   1..f/.Mg.y.s.l..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:4 Set RESERVED field of KE Payload
to non-zero value
Case:4 Set RESERVED field of Nonce Payload
to non-zero value
Case:4 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xE095 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  17 9C 70 32 40 81 8F 74                           ..p2@..t
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6B 82 92 72 4E 59 35 5F B8 04 13 D8 6A 2A 99 DE   k..rNY5_....j*..
ISAKMP:  13 40 A1 5C B8 F8 B1 E2 59 E2 38 A6 A3 4B 5F 5D   .@.\....Y.8..K_]
ISAKMP:  85 2A 40 AF A2 46 33 BA F1 87 12 1C 3C DC 3D 06   .*@..F3.....<.=.
ISAKMP:  C2 0A F7 48 6C 8E 06 F7 A9 15 E9 2C 76 04 71 C7   ...Hl......,v.q.
ISAKMP:  1B 2A C8 54 F1 46 60 CA 49 35 CB 19 1D 36 E8 94   .*.T.F`.I5...6..
ISAKMP:  18 53 05 72 A7 B9 55 6A EA A2 DB B0 31 E6 CE 24   .S.r..Uj....1..$
ISAKMP:  54 B5 7F 05 AB 90 18 EB D2 DA 60 23 23 FB B6 BF   T.........`##...
ISAKMP:  43 6D 97 88 0D CC A9 18 13 B7 42 F9 0D 22 B4 D7   Cm........B.."..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6F 28 2C 9F AB 0C 0E 4A CF D9 FF 56 54 29 84 08   o(,....J...VT)..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1235 (4661)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29C8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE7D6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  17 9C 70 32 40 81 8F 74                           ..p2@..t
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  EA F8 63 D5 99 61 67 1D                           ..c..ag.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xC0DFB48A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  17 9C 70 32 40 81 8F 74 EA F8 63 D5 99 61 67 1D   ..p2@..t..c..ag.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:5 Set RESERVED field of Nonce Payload
to non-zero value
Case:5 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0xD3CA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D4 E1 D5 7B A8 64 4E 7C                           ...{.dN|
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  85 96 59 B6 57 1D B9 26 B2 E1 34 27 A7 C3 D7 62   ..Y.W..&..4'...b
ISAKMP:  A0 E6 4F FA A2 1F AC 95 05 8D EF 6D 9D DE 40 07   ..O........m..@.
ISAKMP:  68 45 19 4E 76 C1 96 57 90 4C 63 A9 EA 14 16 2C   hE.Nv..W.Lc....,
ISAKMP:  4A 24 CA 1A DB 3C 71 EE 07 38 C5 63 74 46 D2 06   J$...<q..8.ctF..
ISAKMP:  F4 DB 45 28 62 AC 9B 0C 97 90 6A 4C 91 35 34 41   ..E(b.....jL.54A
ISAKMP:  6A 98 66 71 44 24 F4 BB D7 0D 65 AD DB E0 F6 10   j.fqD$....e.....
ISAKMP:  38 09 0C 0A C6 41 D7 94 59 62 73 00 66 21 F1 8A   8....A..Ybs.f!..
ISAKMP:  3C 0E 25 40 D6 F3 3A 7B C4 32 C6 0F 0B AF 9E 81   <.%@..:{.2......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4B 7D 13 71 FD EF F6 DE C8 5D 78 69 6C F5 E2 04   K}.q.....]xil...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1236 (4662)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29C7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7310 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D4 E1 D5 7B A8 64 4E 7C                           ...{.dN|
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  90 92 A4 9E D1 6C 7C 08                           .....l|.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xDCFD138C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  D4 E1 D5 7B A8 64 4E 7C 90 92 A4 9E D1 6C 7C 08   ...{.dN|.....l|.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:6 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> 1 to to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 264 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 244 
UDP: Checksum         = 0x48ED (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6C C0 32 7E 45 9E 73 3F                           l.2~E.s?
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 236 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F4 68 2C 97 E2 F9 92 D1 6C 08 AD 9E 9D BE B1 E2   .h,.....l.......
ISAKMP:  0F 18 A5 90 ED 3E D0 93 94 C7 5C 41 8A 6E 86 09   .....>....\A.n..
ISAKMP:  3E C4 74 5D A4 EA 88 8D 72 0D 34 D4 61 A4 56 8E   >.t]....r.4.a.V.
ISAKMP:  A0 AF 21 6B 9B 35 C7 5D 90 1B 0F 66 CF 77 61 8A   ..!k.5.]...f.wa.
ISAKMP:  5E 26 A8 39 17 CC 79 48 DF 95 CC 10 78 38 14 A5   ^&.9..yH....x8..
ISAKMP:  9B EE BA AF B2 D3 26 33 7B DE 01 31 9D 58 BD B7   ......&3{..1.X..
ISAKMP:  79 AF 88 42 3C B2 F3 CB CA 17 7F 5B 8D 63 0A 18   y..B<......[.c..
ISAKMP:  9B 33 71 E7 A6 7A 1A A9 21 EC E1 96 F1 39 68 B3   .3q..z..!....9h.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DC 40 EA C6 A8 A7 3C 4D 49 81 3F 73 61 DF 85 32   .@....<MI.?sa..2
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1237 (4663)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29C6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE8CD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6C C0 32 7E 45 9E 73 3F                           l.2~E.s?
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  97 79 E1 40 D3 61 0F 53                           .y.@.a.S
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x902527D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  6C C0 32 7E 45 9E 73 3F 97 79 E1 40 D3 61 0F 53   l.2~E.s?.y.@.a.S
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.25: Passed

>> IKE-18.26
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with a Nonce
Payload if Length of Nonce Payload is not between 8 and 256 bytes
and MAY notify PAYLOAD-MALFORMED.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>.Set the value of the Payload Length
        field of Nonce Payload to <prm_inv_nonce_len> which is
        less than 8 or greater than 256
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing the value of the
Payload Length field of Nonce Payload to <prm_inv_nonce_len> 7
which is less than 8 or greater than 256 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 251 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 231 
UDP: Checksum         = 0x3E31 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3E EB 28 1E B8 ED C6 5F                           >.(...._
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 167 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  11 A8 4C 79 B7 09 02 BE B3 3B F5 09 A2 40 6D 72   ..Ly.....;...@mr
ISAKMP:  7B C0 2D 13 3F 4E 34 32 22 D2 3B 94 45 E8 6F 12   {.-.?N42".;.E.o.
ISAKMP:  4C E8 F9 A4 4D C1 72 74 D1 CB B5 7D A0 7C 9B 59   L...M.rt...}.|.Y
ISAKMP:  DF 64 81 33 F8 82 F7 CE BF 49 A6 42 2E 64 1A 8F   .d.3.....I.B.d..
ISAKMP:  EC D5 0B 39 13 3E 2E C2 DF D6 1E 26 93 2C 1F 21   ...9.>.....&.,.!
ISAKMP:  C8 31 6A F2 38 96 63 1B 6C 12 CB 90 DA 70 CE B7   .1j.8.c.l....p..
ISAKMP:  79 95 49 E0 43 0A D1 D0 B1 7B A1 FE 19 7B 9B C0   y.I.C....{...{..
ISAKMP:  E8 E2 C6 5A C0 40 55 15 CC 4B 8A 8B B3 2B 4B 49   ...Z.@U..K...+KI
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 7 bytes
ISAKMP: --- Nonce Data [3 bytes] ---
ISAKMP:  81 6C F4                                          .l.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x1238 (4664)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29D5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xC64F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3E EB 28 1E B8 ED C6 5F                           >.(...._
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.26: Passed

>> IKE-18.27
TEST_DESCRIPTION
IKE MUST notify PAYLOAD-MALFORMED for an incoming ISAKMP packet
with a Nonce 
Payload if Length of Nonce Payload is not between 8 and 256 bytes.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>.Set the value of the Payload
        Length field of Nonce Payload to <prm_inv_nonce_len>
        which is less than 8 or greater than 256
-  DUT: Notify PAYLOAD-MALFORMED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_aggressive.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_aggressive_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing the value of the
Payload Length field of Nonce Payload to <prm_inv_nonce_len> 7
which is less than 8 or greater than 256 to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 251 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 231 
UDP: Checksum         = 0x978C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9C 45 87 65 A6 29 08 14                           .E.e.)..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 223 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DB 2B 75 ED A2 04 2A AE 38 3C CC FC 72 46 B1 40   .+u...*.8<..rF.@
ISAKMP:  CD AE 0A 9E 63 27 F3 4C AF BB 23 7F 6E 40 97 DD   ....c'.L..#.n@..
ISAKMP:  91 A2 A1 6B BA FF 73 91 A6 C0 39 20 ED FF 42 7A   ...k..s...9 ..Bz
ISAKMP:  49 3D DE BD 70 41 53 56 F9 66 F6 72 41 BB 75 E7   I=..pASV.f.rA.u.
ISAKMP:  3A FC BB 0D 37 89 BB 75 F5 0A 62 12 D9 16 06 49   :...7..u..b....I
ISAKMP:  6C E6 F7 30 07 8A 8D 3D E4 E8 A1 2E D3 3B DB 98   l..0...=.....;..
ISAKMP:  0E 98 1C 75 F4 9E B1 02 CE AE E3 F9 74 DB 64 1C   ...u........t.d.
ISAKMP:  E9 B4 90 80 A9 E7 C1 DF E0 E6 74 AD 28 33 33 65   ..........t.(33e
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 7 bytes
ISAKMP: --- Nonce Data [3 bytes] ---
ISAKMP:  0E 93 EB                                          ...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0x1239 (4665)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x29C4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x998B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9C 45 87 65 A6 29 08 14                           .E.e.)..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  A1 EC 72 20 B9 DD 6C 53                           ..r ..lS
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x73118679
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  9C 45 87 65 A6 29 08 14 A1 EC 72 20 B9 DD 6C 53   .E.e.)....r ..lS
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Informational message from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 MD5 DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.27: Passed
Executing system command:
  "./DocScriptQ35/IKE/IKEpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipike
ipd: kill ipike ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar set -o ipike.strict_lifetime_policy "0"
sysvar: ipike.strict_lifetime_policy=0 ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          109
Number of tests passed:       108
Number of tests failed:       1
Number of tests inconclusive: 0
