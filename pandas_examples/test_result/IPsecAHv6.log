ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6729192 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6ah ipsecv6-ah 1-5.3 5.7-7 9-11 12.2-14.3 16-18.1 18.3 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6ah.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IPSECV6-AH/IPSECV6AHpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IPSec AH Anti Replay Window Size         32                  # (0x00000020)
IPSec AH DUT Supports Configurable Lifetime True
IPSec AH SA Lifetime Seconds             120                 # (0x00000078)
IPSec AH SA Lifetime Bytes               1065                # (0x00000429)
IPSec AH DUT Supports Transport Mode     True
IPSec DUT Supports Configurable Outbound SPD True
IPSec DUT Supports Anti Replay           True
IPSec Wait Time                          10                  # (0x0000000A)
IPSec DUT Supports Configurable Inbound SPD True
IPSec DUT Supports Explicit Congestion Notification True
IPSecV6 AH Suite Setup Command           "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 AH Reset IP Security Command     "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 AH Reset SA with Anti Replay Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 AH Set SA Lifetime Bytes Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 AH Set SA Lifetime Seconds Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 AH DUT Mode Configure Command    "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Iterated Tunnel Command        "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-iterated-tunnel-command.exp $ANVL_DUTHOSTNAME"
IPSecV6 Set Inbound SPD for Protocol and Port Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Inbound SPD for Protocol Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Inbound SPD Policy for Subnet Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Inbound SPD Policy for Host Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 DUT Send Ping Command            "./DocScriptQ35/IPSECV6-AH/ipsecv6-dut-send-ping-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Host Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Protocol and Port Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Protocol Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Outbound SPD Policy for Subnet Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-outbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Remove ANVL from SA Command      "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
IPSec DUT ECN Configure Command          "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-ecn-configure.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for ICMP Type And Code Command "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-icmp-type-code-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Outbound SPD Policy for Host Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-outbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec DUT Verify Audit Log for Bad SPI Command "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Check Mode Command                 "./DocScriptQ35/IPSECV6-AH/ipsecv6-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 DUT Uses Wildcard Identification True
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6ah.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:1111::5555
  IPV6 ANVL Address                        3ffe:1111::1111
  IPV6 Gateway                             3ffe:1111::5555
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:2222::5555
  IPV6 ANVL Address                        3ffe:2222::1111
  IPV6 Gateway                             3ffe:2222::5555
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Encapsulation                   v6Ov6
  IPSec Configuration                      Manual
  IPSec IPv6 Remote Host Address           3ffe:1111::1111
  IPSec IPv6 Local Host Address            3ffe:2222::1111
  IPSec ANVL SPI                           768               # (0x00000300)
  IPSec DUT SPI                            770               # (0x00000302)
  IPSec AH Authentication Algorithm        HMAC_MD5_96
  IPSec AH Authentication Key              66306630663066306630663066302222
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          MD5
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                AH_MD5
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Authentication Algorithm    HMAC_MD5
  IKE Pre-Shared Key                       abcdefghijklmnopqrstuvwx

# Configuration File End.
%% VALIDATE CFG GLOBAL WARNING: 
! Since ANVL is configured for IPSec Manual Keying,
! the following tests cannot be run: 1.7 2.8 
%% VALIDATE PRM GLOBAL WARNING: 
! The DUT does not support 64-bit Extended Sequence Number.
! Therefore the following tests cannot be run: 17.1 17.2 17.3 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL NOT_CONFIGURED NOT_CONFIGURED HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 NOT_CONFIGURED NOT_CONFIGURED NOT_CONFIGURED NOT_CONFIGURED

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=655  pid=0x5de180
------------------------------------------
-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "1"
sysvar: ipnet.inet.AcceptSourceRoute=1 ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 3ffe:1111::5555/64 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 3ffe:2222::5555/64 up
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5555 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 3ffe:1111::1111 < 3ffe:1111::5555 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:1111::5555 as 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:5555 < 3ffe:2222::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 3ffe:2222::1111 < 3ffe:2222::5555 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:2222::5555 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite IPSec Authentication Header
RFC 4301: 'Security Architecture for the Internet Protocol'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)
RFC 4302: 'IP Authentication Header'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)

ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the ANVL machine is connected to two
interfaces that are connected to the Device Under Test.

The ANVL config file must define 2 IPv6 interfaces
with an IPSec interface configured on one of the 2 ports.
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IPSECV6-AH-1.1
TEST_DESCRIPTION
The receiver computes the ICV over the appropriate fields of the
packet, using the specified authentication algorithm, and verifies
that it is the same as the ICV included in the Authentication Data
field of the packet.
If the computed and received ICV's match, then the datagram is valid,
and it is accepted.
TEST_REFERENCE
RFC 4302 s3.4.4 p20 Integrity Check Value Verification
TEST_METHOD
- ANVL: Send an authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Forward the corresponding plain ICMPv6 Echo-request (unsecured)
        to the Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=3  satype=NONE  len=16  seq=656  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
Total of 0 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=657  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=658  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=659  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=660  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=661  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[523] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[522] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[524] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[525] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 1E DB 97 70 FC 57 2D 76 85 22 76               ....p.W-v."v
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected IPv6 packet on interface eth4 (3ffe:2222::1111)
(Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-1.1: Passed

>> IPSECV6-AH-1.2
TEST_DESCRIPTION
The receiver computes the ICV over the appropriate fields of the
packet, using the specified authentication algorithm, and verifies
that it is the same as the ICV included in the Authentication Data
field of the packet.
If the test fails, then the receiver MUST discard the received IP
datagram as invalid;
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.4 p20 Integrity Check Value Verification
TEST_METHOD
- ANVL: Send an authenticated ICMPv6 Echo-request containing an
        incorrectly computed ICV in the AH from Remote Host
-  DUT: Do not forward any ICMPv6 Echo-request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=662  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27615 usetime=27615 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27615 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=663  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=664  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=665  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=666  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=667  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[527] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[526] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[528] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[529] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 00 5C E1 2B 76 8B E5 60 D7 BF D4 D9               .\.+v..`....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111)(Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-1.2: Passed

>> IPSECV6-AH-1.3
TEST_DESCRIPTION
This 16-bit field is reserved for future use. It MUST be set to
"zero." (Note that the value is included in the Authentication Data
calculation, but is otherwise ignored by the recipient.)
This test checks that DUT ignores the Reserved field
and accepts the packet
TEST_REFERENCE
RFC 4302 s2.3 p6 Reserved 
TEST_METHOD
- ANVL: Send an authenticated ICMPv6 Echo-request containing a
        non-zero value in the Reserved field of the AH from
        Remote Host
-  DUT: Ignore the Reserved field of the AH
-  DUT: Forward the corresponding plain ICMPv6 Echo-request (unsecured)
        to the Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=668  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27618 usetime=27618 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27618 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=669  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=670  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=671  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=672  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=673  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[531] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[530] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[532] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[533] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 4 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 40 2C B2 DD 73 13 47 E5 9E 8C 4E 97               @,..s.G...N.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly forwarded unauthenticated ICMPv6 Echo Request packet
on interface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-1.3: Passed

>> IPSECV6-AH-1.4
TEST_DESCRIPTION
Upon receipt of a packet containing an IP Authentication Header, the
receiver determines the appropriate (unidirectional) SA, based on the
destination IP address, security protocol (AH), and the SPI.
If no valid Security Association exists for this session (e.g., the
receiver has no key), the receiver MUST discard the packet;
(Note: This test checks for invalid spi)
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.2 p18 Security Association Lookup
TEST_METHOD
- ANVL: Send an authenticated ICMPv6 Echo-request containing an SPI
        value in the AH that does not match the SPI entry of the
        established SA from Remote Host
-  DUT: Do not forward any ICMPv6 Echo-request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=674  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27630 usetime=27630 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27630 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=675  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=676  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=677  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=678  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=679  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[535] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[534] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[536] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[537] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x0000030A 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 84 57 B4 98 45 C0 B8 D0 90 2E 0B 91               .W..E.......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-1.4: Passed

>> IPSECV6-AH-1.5
TEST_DESCRIPTION
The protocol header (IPv4, IPv6, or Extension) immediately preceding
the AH header will contain the value 51 in its Protocol (IPv4) or
Next Header (IPv6, Extension) field [STD-2]
(Note: Here we check for invalid value of Next Header field)
TEST_REFERENCE
NEGATIVE: RFC 4302 s2 p4 Authentication Header Format
TEST_METHOD
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        <proto> in the Next Header field of the IPv6 header from Remote
        Host
-  DUT: Do not forward the ICMPv6 Echo-request to Local Host
- CASE: <proto> = 50
- CASE: <proto> = 52
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=680  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27632 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27632 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=681  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=682  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=683  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=684  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=685  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[539] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[538] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[540] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[541] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: set the Next Header 50 in Outer IPv6
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x29040000 
ESP: Sequence Number          = 0x00000300 
ESP:
ESP: --- Bad Encrypted Payload Data [68 bytes] ---
ESP:  00 00 00 05 57 C0 2C C1 49 18 C8 E9 29 9A F1 9E   ....W.,.I...)...
ESP:  60 00 00 00 00 18 3A FF 3F FE 11 11 00 00 00 00   `.....:.?.......
ESP:  00 00 00 00 00 00 11 11 3F FE 22 22 00 00 00 00   ........?.""....
ESP:  00 00 00 00 00 00 11 11 80 00 A0 56 00 00 00 00   ...........V....
ESP:  41 4E 56 4C                                       ANVL
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Case 1: Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)


Case 2: set the Next Header 52 in Outer IPv6
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = *UNKNOWN* (52)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
IPV6: --- Trailing Data [88 bytes] ---
IPV6:  29 04 00 00 00 00 03 00 00 00 00 06 6F 06 77 CC   )...........o.w.
IPV6:  4E 45 16 F3 85 55 DD DA 60 00 00 00 00 18 3A FF   NE...U..`.....:.
IPV6:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 11 11   ?...............
IPV6:  3F FE 22 22 00 00 00 00 00 00 00 00 00 00 11 11   ?.""............
IPV6:  80 00 A0 56 00 00 00 00 41 4E 56 4C 20 54 45 53   ...V....ANVL TES
IPV6:  54 20 44 41 54 41 20 20                           T DATA  
IPV6: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet
Case 2: Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-1.5: Passed

>> IPSECV6-AH-1.6
TEST_DESCRIPTION
IPSec MUST discard an incoming IPv6 datagram containing a Payload Length
other than 4 in the AH, in the *standard* case of 96 bit
authentication value plus the 3 32-bit word fixed portion for any
non-null authentication algorithm
TEST_REFERENCE
NEGATIVE: RFC 4302 s2.2 p5 Payload Length
TEST_METHOD
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        <length> in the Payload Length field of the AH from Remote
        Host
-  DUT: Do not forward the ICMPv6 Echo-request to Local Host
- CASE: <length> = 0
- CASE: <length> = 1
- CASE: <length> = 2
- CASE: <length> = 3
- CASE: <length> = 5
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=686  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27644 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27644 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=687  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=688  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=689  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=690  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=691  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[543] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[542] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[544] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[545] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: set Payload Length to 0 in AH
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 0 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 14 10 A9 C5 C0 DA 15 B4 22 E2 14 D3               ........"...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 0
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 7
IPv6: Payload Length       = 5136 (bytes)
IPv6: Next Header          = *UNKNOWN* (169)
IPv6: Hop Limit            = 197
IPv6: Source Address       = c0da:15b4:22e2:14d3:6000::18:3aff
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPV6: --- Trailing Data [40 bytes] ---
IPV6:  3F FE 22 22 00 00 00 00 00 00 00 00 00 00 11 11   ?.""............
IPV6:  80 00 A0 56 00 00 00 00 41 4E 56 4C 20 54 45 53   ...V....ANVL TES
IPV6:  54 20 44 41 54 41 20 20                           T DATA  
IPV6: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Case 1: Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)


Case 2: set Payload Length to 1 in AH
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 1 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 06 B1 8B B1 7D B5 66 70 3C 11 D8 5A               ....}.fp<..Z
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 0
IPv6: Traffic Class        = 107
IPv6:  |01234567
IPv6:  |011010..           = 26 DSCP (Differentiated Services Codepoint)
IPv6:  |......11           = 3 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 101297
IPv6: Payload Length       = 32181 (bytes)
IPv6: Next Header          = *UNKNOWN* (102)
IPv6: Hop Limit            = 112
IPv6: Source Address       = 3c11:d85a:6000::18:3aff:3ffe:1111
IPv6: Destination Address  = ::1111:3ffe:2222
IPv6: 
IPV6: --- Trailing Data [36 bytes] ---
IPV6:  00 00 00 00 00 00 00 00 00 00 11 11 80 00 A0 56   ...............V
IPV6:  00 00 00 00 41 4E 56 4C 20 54 45 53 54 20 44 41   ....ANVL TEST DA
IPV6:  54 41 20 20                                       TA  
IPV6: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet
Case 2: Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)


Case 3: set Payload Length to 2 in AH
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 2 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 30 2E B2 D6 6D 8B C3 C2 A3 00 C3 08               0...m.......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 216
IPv6:  |01234567
IPv6:  |110110..           = 54 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 771010
IPv6: Payload Length       = 41728 (bytes)
IPv6: Next Header          = *UNKNOWN* (195)
IPv6: Hop Limit            = 8
IPv6: Source Address       = 6000:0:18:3aff:3ffe:1111::
IPv6: Destination Address  = ::1111:3ffe:2222:0:0
IPv6: 
IPV6: --- Trailing Data [32 bytes] ---
IPV6:  00 00 00 00 00 00 11 11 80 00 A0 56 00 00 00 00   ...........V....
IPV6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
IPV6: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet
Case 3: Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)


Case 4: set Payload Length to 3 in AH
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 3 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: EF 67 4A 43 2D DB 81 1C 9F A6 0B F3               .gJC-.......
AH:
IPV6: --- Truncated Packet
 [68 bytes] ---
IPV6:  9F A6 0B F3 60 00 00 00 00 18 3A FF 3F FE 11 11   ....`.....:.?...
IPV6:  00 00 00 00 00 00 00 00 00 00 11 11 3F FE 22 22   ............?.""
IPV6:  00 00 00 00 00 00 00 00 00 00 11 11 80 00 A0 56   ...............V
IPV6:  00 00 00 00 41 4E 56 4C 20 54 45 53 54 20 44 41   ....ANVL TEST DA
IPV6:  54 41 20 20                                       TA  
IPV6: --- Truncated Packet
 End ---

Waiting (up to 10.000 seconds) for IPv6 Packet
Case 4: Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)


Case 5: set Payload Length to 5 in AH
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 5 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5A 92 B9 EB 23 BF 0E 00 00 43 7C 0B               Z...#....C|.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 0
IPv6: Traffic Class        = 1
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......01           = 1 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 539391
IPv6: Payload Length       = 16382 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 17
IPv6: Source Address       = ::1111:3ffe:2222
IPv6: Destination Address  = ::1111:8000:a056
IPv6: 
UDP: ---- UDP Packet (continuation [16382 bytes]) ----
UDP:
UDP: --- Trailing Data [16374 bytes] ---
UDP:  20 54 45 53 54 20 44 41 54 41 20 20 00 00 00 00    TEST DATA  ....
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 00 00 00 00 00                                 ......
UDP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet
Case 5: Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-1.6: Passed

>> IPSECV6-AH-2.1
TEST_DESCRIPTION
The protocol header (IPv4, IPv6, or Extension) immediately preceding
the AH header will contain the value 51 in its Protocol (IPv4) or
Next Header (IPv6, Extension) field [STD-2].
TEST_REFERENCE
RFC 4302 s2 p4 Authentication Header Format
TEST_METHOD
- ANVL: Send an ICMPv6 Echo-request from Local Host using IPv6
- ANVL: Listen up to <ParamListenTime> for authenticated packets
-  DUT: Forward the corresponding authenticated ICMPv6 Echo-request
- ANVL: Verify that the Next Header field of IPv6 Header
        in received authenticated packet is set to AH (51)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=692  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27667 usetime=27667 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27667 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=693  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=694  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=695  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=696  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=697  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[547] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[546] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[548] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[549] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received IPv6 packet with in outer IPv6 protocol: 51
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-2.1: Passed

>> IPSECV6-AH-2.2
TEST_DESCRIPTION
The Next Header is an 8-bit field that identifies the type of the
next payload after the Authentication Header.
IPSec MUST indicate the correct type of payload in the Next Header
field of the AH in an authenticated outbound IPv6 datagram
TEST_REFERENCE
RFC 4302 s2.1 p5 Next Header
TEST_METHOD
- ANVL: Send an IPv6 datagram containing a payload of type <payld>
        from Local Host through the DUT to Remote Host
-  DUT: Forward the authenticated IPv6 datagram to Remote Host ,
        setting the Next Header field in the AH to the value IPv6 and
        the Protocol field in the inner IPv6 header to <payld>
- CASE: <payld> = ICMPv6
- CASE: <payld> = TCP
- CASE: <payld> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=698  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27719 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27719 usetime=27719 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=699  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=700  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=701  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=702  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=703  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[551] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[550] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[552] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[553] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: sending ICMPv6 packet
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Case 1: Correct inner IPv6 Protocol: 58 received on interface eth3 (3ffe:1111::1111)
(Remote Host)


Case 2: sending TCP packet
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 36 41 82 62 F3 02 57 BD E2 33 73 68               6A.b..W..3sh
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Case 2: Correct inner IPv6 Protocol: 6 received on interface eth3 (3ffe:1111::1111)
(Remote Host)


Case 3: sending UDP packet
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6D 58 81 52 25 04 2B 7D 40 3D 48 16               mX.R%.+}@=H.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Case 3: Correct inner IPv6 Protocol: 17 received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-2.2: Passed

>> IPSECV6-AH-2.3
TEST_DESCRIPTION
IPSec MUST set the Payload Length field in the AH to the value 4
in an authenticated outbound IPv6 datagram, in the *standard* case
of 96 bit authentication value plus the 3 32-bit word fixed portion
for any non-null authentication algorithm
TEST_REFERENCE
RFC 4302 s2.2 p5 Payload Length
TEST_METHOD
- ANVL: Send an ICMPv6 Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IPv6 datagram with authentication to Remote Host,
        setting the Payload Length field in the AH to the value 4
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=704  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27721 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27721 usetime=27721 bytes=364
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=705  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=706  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=707  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=708  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=709  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[555] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[554] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[556] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[557] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received AH payload length: 4
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-2.3: Passed

>> IPSECV6-AH-2.4
TEST_DESCRIPTION
This 16-bit field is reserved for future use.  It MUST be set to
"zero."
Note: This test checks the Reserved field in the AH is set to
the value 0 in an authenticated outbound IPv6 datagram
TEST_REFERENCE
RFC 4302 s2.3 p6 Reserved
TEST_METHOD
- ANVL: Send an ICMPv6 Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IPv6 datagram with authentication to Remote Host,
        setting the Reserved field in the AH to the value 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=710  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27724 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27724 usetime=27724 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=711  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=712  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=713  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=714  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=715  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[559] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[558] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[560] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[561] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB803 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correct received AH reserved field: 0
on interface
eth3 (3ffe:1111::1111)  (Remote Host) 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-2.4: Passed

>> IPSECV6-AH-2.5
TEST_DESCRIPTION
IPSec MUST set the SPI field in the AH of an authenticated outbound IP
datagram to the SPI value associated with the outbound SA
TEST_REFERENCE
RFC 4302 s2.4 p7 Security Parameter Index (SPI)
TEST_METHOD
- ANVL: Send an ICMPv6 Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IPv6 datagram to Remote with authentication,
        setting the SPI field in the AH to the SPI value associated
        the outbound SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=716  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27726 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27726 usetime=27726 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=717  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=718  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=719  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=720  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=721  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[563] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[562] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[564] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[565] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received AH spi value: 770
on interface eth3 (3ffe:1111::1111)  (Remote Host) 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-2.5: Passed

>> IPSECV6-AH-2.6
TEST_DESCRIPTION
The first packet sent using a given SA will have a Sequence Number of 1;
TEST_REFERENCE
RFC 4302 s2.5 p8 Sequence Number
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT
- ANVL: Send an ICMPv6 Echo-request from Local Host through the DUT
        to Remote Host
-  DUT: Forward the IPv6 datagram with authentication to RemoteHost,
        setting the Sequence Number field in the AH to 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=722  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27728 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27728 usetime=27728 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=723  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=724  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=725  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=726  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=727  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[567] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[566] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[568] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[569] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received AH sequence number: 1
in the first authenticated outbound IPv6 datagram)
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-2.6: Passed

>> IPSECV6-AH-2.7
TEST_DESCRIPTION
IPSec MUST NOT duplicate the Sequence Number field in the AH of an
outbound authenticated IP datagram during the Lifetime of the SA
TEST_REFERENCE
RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with
        Lifetime <LifeTimeSeconds> seconds
- ANVL: Send at most 10 ICMPv6 Echo-requests within the Lifetime
        of the SA
-  DUT: Forward the corresponding ICMPv6 Echo-requests without
        duplicating the Sequence Number in the AH of any request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=728  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27730 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27730 usetime=27731 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=729  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=730  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=731  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=732  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=733  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[571] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[570] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[572] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[573] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 120 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=734  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 2000 -lh 120 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=144  seq=735  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=120 usetime=0 bytes=2000
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=736  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27733 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=2000
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 10 ICMPv6 plain Packets to DUT
Sending 1-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 2-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 88 0C BF 0B F9 F5 22 C4 77 EA 28 9D               ......".w.(.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 3-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 52 26 46 AA FD EA 78 AC 83 12 AE DA               R&F...x.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 4-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0B 65 77 F6 56 3E AF BD CA B1 FE 8E               .ew.V>......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 5-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D2 25 26 38 EA 8D 41 0C E5 83 10 CF               .%&8..A.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 6-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 32 58 1B CA 71 1B F9 A1 9F 2B 63 AC               2X..q....+c.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 7-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C1 88 E4 BA 94 DD 20 EF 16 AD 15 DB               ...... .....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 8-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: CB 7E C5 A1 B4 FA 0B E7 DC 17 A8 0C               .~..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 9-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C1 00 45 CA 84 10 06 86 5C 9A 34 A7               ..E.....\.4.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending 10-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 73 A9 4A 65 E0 41 AF E6 FF 96 9F               .s.Je.A.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly forwarded Authenticated packets without
duplicating sequence number field in AH
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27733 usetime=27733 bytes=1280
    HARD: addtime=120 usetime=0 bytes=2000
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=739  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=740  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=741  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=742  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=743  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[578] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[577] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[579] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[580] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-2.7: Passed

>> IPSECV6-AH-3.1
TEST_DESCRIPTION
Packets that contain Sequence Numbers lower than the "left" edge of
the window are rejected.
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMPv6 Echo-request containing the
        value 1 in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        (<window-size> + 2) in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the
        value 2 in the Sequence Number field of the AH
-  DUT: Do not forward ICMPv6 Echo-request
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=744  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27735 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27735 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=745  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=746  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=747  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=748  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=749  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[582] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[581] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[583] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[584] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 1
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 1E DB 97 70 FC 57 2D 76 85 22 76               ....p.W-v."v
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 34
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 55 C5 C2 64 B4 CA 2B 07 F3 50 78 5E               U..d..+..Px^
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 2
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E 5C E1 2B 76 8B E5 60 D7 BF D4 D9               ^\.+v..`....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-3.1: Passed

>> IPSECV6-AH-3.2
TEST_DESCRIPTION
Packets falling within the window are checked against a
list of received packets within the window.
Note: This test check whether IPSec accepts all IPv6 datagrams
containing distinct Sequence Numbers in the AH that fall within
the anti-replay window
TEST_REFERENCE
RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMPv6 Echo-request containing the
        value 1 in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send (<window-size> - 2) authenticated ICMPv6 Echo-requests,
        with Sequence Numbers from 2 to (<window-size> - 1)
-  DUT: Forward all the corresponding ICMPv6 Echo-requests
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=750  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27737 usetime=27738 bytes=256
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27737 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=751  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=752  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=753  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=754  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=755  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[586] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[585] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[587] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[588] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 1
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 1E DB 97 70 FC 57 2D 76 85 22 76               ....p.W-v."v
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 32
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3D CB 37 48 5B 1E A1 E2 93 A3 3D 9D               =.7H[.....=.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 2
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E 5C E1 2B 76 8B E5 60 D7 BF D4 D9               ^\.+v..`....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 2 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 3
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 80 91 19 6D 2B 02 75 E9 68 93 F4 3C               ...m+.u.h..<
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 3 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 4
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B8 B3 EE 30 50 02 54 46 C4 31 BA 58               ...0P.TF.1.X
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 4 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 5
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 57 C0 2C C1 49 18 C8 E9 29 9A F1 9E               W.,.I...)...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 5 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 6
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6F 06 77 CC 4E 45 16 F3 85 55 DD DA               o.w.NE...U..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 6 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 7
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8B 74 F5 8B CB 44 BA F7 9E 25 BD ED               .t...D...%..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 7 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 8
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9C 38 F9 B0 CA 3E D7 0D F2 BB 0B 32               .8...>.....2
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 8 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 9
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 94 A0 49 42 B9 00 0A 68 5F E1 F5 22               ..IB...h_.."
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 9 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 10
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AB 4C 7D 8B 7E 62 D3 78 92 07 BA 83               .L}.~b.x....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 10 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 11
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7F 48 6A 3B CA 22 71 3D 2B 47 3F 8F               .Hj;."q=+G?.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 11 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 12
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 16 65 F7 BC C0 79 43 8F 7A AB 1A 96               .e...yC.z...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 12 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 13
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 71 7F EA 04 5D 28 E0 32 FC D0 34 A4               q...](.2..4.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 13 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 14
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8E 77 7D 21 2B 29 31 F1 DF F8 5D BE               .w}!+)1...].
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 14 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 15
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C 54 C9 FF 19 14 B1 98 9F A2 DC E8               |T..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 15 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 16
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 88 F3 E5 72 77 63 95 BA 92 1B C3 2E               ...rwc......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 16 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 17
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 91 AD F7 C1 F6 F1 15 D6 E5 19 ED C0               ............
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 17 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 18
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 B4 48 EF 6E CF DD 21 EB DB F4 F8               ..H.n..!....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 18 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 19
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A9 B7 E0 5B 2D D4 33 FA 44 35 1D DB               ...[-.3.D5..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 19 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 20
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A2 AD 7E 13 63 CE 0C DD 2D FB 07 69               ..~.c...-..i
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 20 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 21
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 46 83 A7 07 35 2C 7C A7 E5 95 9F 9E               F...5,|.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 21 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 22
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C F7 73 10 EB 44 F5 92 20 60 6B F8               |.s..D.. `k.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 22 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 23
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2D C1 B4 E6 D8 14 50 34 C8 3E 04 90               -.....P4.>..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 23 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 24
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 29 A5 50 48 31 4F 0F 64 A1 DE C5 FA               ).PH1O.d....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 24 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 25
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 44 D6 E5 A9 1F 85 EE C3 6F C6 99 D8               D.......o...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 25 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 26
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3F 61 6F F2 66 E2 9E 00 B8 82 63 EC               ?ao.f.....c.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 26 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 27
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D0 C8 3F DB 25 17 25 27 E6 B2 22 54               ..?.%.%'.."T
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 27 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 28
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 EB D8 45 9E 5B 8C E9 65 F7 9F 4E               ...E.[..e..N
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 28 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 29
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8F CC 06 72 0A BC 1E 03 61 AF 2C 69               ...r....a.,i
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 29 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 30
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 15 70 83 5C 6D E2 EC 84 79 CD 80               ..p.\m...y..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 30 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending Authenticated ICMPv6 Echo-Request with Sequence Number: 31
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 02 D0 1A E7 A8 91 78 FD D7 EC CD 46               ......x....F
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 31 on interface eth4(3ffe:2222::1111)
(Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-3.2: Passed

>> IPSECV6-AH-3.3
TEST_DESCRIPTION
IPSec MUST reject any IPv6 datagram that has the same Sequence Number as
a previously received datagram falling within the anti-replay window
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMPv6 Echo-request containing the
        value 1 ihe Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send (<window-size> - 2) authenticated ICMPv6 Echo-requests
        with Sequence Numbers from 2 to (<window-size> - 1)
-  DUT: Forward all the corresponding ICMPv6 Echo-requests
- ANVL: Send (<window-size> - 2) authenticated ICMPv6 Echo-requests
        with Sequence Numbers from 2 to (<window-size> - 1)
-  DUT: Do not forward corresponding ICMPv6 Echo-requests
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=756  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27750 usetime=27750 bytes=4096
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27750 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=757  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=758  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=759  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=760  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=761  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[590] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[589] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[591] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[592] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 1
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 1E DB 97 70 FC 57 2D 76 85 22 76               ....p.W-v."v
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 32
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3D CB 37 48 5B 1E A1 E2 93 A3 3D 9D               =.7H[.....=.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 2
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E 5C E1 2B 76 8B E5 60 D7 BF D4 D9               ^\.+v..`....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 2 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 3
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 80 91 19 6D 2B 02 75 E9 68 93 F4 3C               ...m+.u.h..<
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 3 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 4
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B8 B3 EE 30 50 02 54 46 C4 31 BA 58               ...0P.TF.1.X
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 4 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 5
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 57 C0 2C C1 49 18 C8 E9 29 9A F1 9E               W.,.I...)...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 5 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 6
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6F 06 77 CC 4E 45 16 F3 85 55 DD DA               o.w.NE...U..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 6 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 7
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8B 74 F5 8B CB 44 BA F7 9E 25 BD ED               .t...D...%..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 7 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 8
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9C 38 F9 B0 CA 3E D7 0D F2 BB 0B 32               .8...>.....2
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 8 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 9
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 94 A0 49 42 B9 00 0A 68 5F E1 F5 22               ..IB...h_.."
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 9 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 10
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AB 4C 7D 8B 7E 62 D3 78 92 07 BA 83               .L}.~b.x....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 10 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 11
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7F 48 6A 3B CA 22 71 3D 2B 47 3F 8F               .Hj;."q=+G?.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 11 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 12
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 16 65 F7 BC C0 79 43 8F 7A AB 1A 96               .e...yC.z...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 12 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 13
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 71 7F EA 04 5D 28 E0 32 FC D0 34 A4               q...](.2..4.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 13 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 14
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8E 77 7D 21 2B 29 31 F1 DF F8 5D BE               .w}!+)1...].
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 14 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 15
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C 54 C9 FF 19 14 B1 98 9F A2 DC E8               |T..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 15 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 16
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 88 F3 E5 72 77 63 95 BA 92 1B C3 2E               ...rwc......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 16 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 17
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 91 AD F7 C1 F6 F1 15 D6 E5 19 ED C0               ............
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 17 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 18
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 B4 48 EF 6E CF DD 21 EB DB F4 F8               ..H.n..!....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 18 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 19
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A9 B7 E0 5B 2D D4 33 FA 44 35 1D DB               ...[-.3.D5..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 19 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 20
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A2 AD 7E 13 63 CE 0C DD 2D FB 07 69               ..~.c...-..i
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 20 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 21
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 46 83 A7 07 35 2C 7C A7 E5 95 9F 9E               F...5,|.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 21 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 22
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C F7 73 10 EB 44 F5 92 20 60 6B F8               |.s..D.. `k.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 22 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 23
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2D C1 B4 E6 D8 14 50 34 C8 3E 04 90               -.....P4.>..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 23 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 24
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 29 A5 50 48 31 4F 0F 64 A1 DE C5 FA               ).PH1O.d....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 24 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 25
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 44 D6 E5 A9 1F 85 EE C3 6F C6 99 D8               D.......o...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 25 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 26
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3F 61 6F F2 66 E2 9E 00 B8 82 63 EC               ?ao.f.....c.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 26 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 27
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D0 C8 3F DB 25 17 25 27 E6 B2 22 54               ..?.%.%'.."T
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 27 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 28
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 EB D8 45 9E 5B 8C E9 65 F7 9F 4E               ...E.[..e..N
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 28 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 29
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8F CC 06 72 0A BC 1E 03 61 AF 2C 69               ...r....a.,i
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 29 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 30
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 15 70 83 5C 6D E2 EC 84 79 CD 80               ..p.\m...y..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 30 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 31
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 02 D0 1A E7 A8 91 78 FD D7 EC CD 46               ......x....F
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 31 on interface eth4(3ffe:2222::1111)
(Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 2
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E 5C E1 2B 76 8B E5 60 D7 BF D4 D9               ^\.+v..`....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 3
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 80 91 19 6D 2B 02 75 E9 68 93 F4 3C               ...m+.u.h..<
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 4
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B8 B3 EE 30 50 02 54 46 C4 31 BA 58               ...0P.TF.1.X
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 5
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 57 C0 2C C1 49 18 C8 E9 29 9A F1 9E               W.,.I...)...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 6
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6F 06 77 CC 4E 45 16 F3 85 55 DD DA               o.w.NE...U..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 7
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8B 74 F5 8B CB 44 BA F7 9E 25 BD ED               .t...D...%..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 8
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9C 38 F9 B0 CA 3E D7 0D F2 BB 0B 32               .8...>.....2
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 9
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000009 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 94 A0 49 42 B9 00 0A 68 5F E1 F5 22               ..IB...h_.."
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 10
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AB 4C 7D 8B 7E 62 D3 78 92 07 BA 83               .L}.~b.x....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 11
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7F 48 6A 3B CA 22 71 3D 2B 47 3F 8F               .Hj;."q=+G?.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 12
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 16 65 F7 BC C0 79 43 8F 7A AB 1A 96               .e...yC.z...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 13
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 71 7F EA 04 5D 28 E0 32 FC D0 34 A4               q...](.2..4.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 14
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8E 77 7D 21 2B 29 31 F1 DF F8 5D BE               .w}!+)1...].
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 15
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C 54 C9 FF 19 14 B1 98 9F A2 DC E8               |T..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 16
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 88 F3 E5 72 77 63 95 BA 92 1B C3 2E               ...rwc......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 17
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 91 AD F7 C1 F6 F1 15 D6 E5 19 ED C0               ............
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 18
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 B4 48 EF 6E CF DD 21 EB DB F4 F8               ..H.n..!....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 19
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A9 B7 E0 5B 2D D4 33 FA 44 35 1D DB               ...[-.3.D5..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 20
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A2 AD 7E 13 63 CE 0C DD 2D FB 07 69               ..~.c...-..i
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 21
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 46 83 A7 07 35 2C 7C A7 E5 95 9F 9E               F...5,|.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 22
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C F7 73 10 EB 44 F5 92 20 60 6B F8               |.s..D.. `k.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 23
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2D C1 B4 E6 D8 14 50 34 C8 3E 04 90               -.....P4.>..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 24
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 29 A5 50 48 31 4F 0F 64 A1 DE C5 FA               ).PH1O.d....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 25
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 44 D6 E5 A9 1F 85 EE C3 6F C6 99 D8               D.......o...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 26
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3F 61 6F F2 66 E2 9E 00 B8 82 63 EC               ?ao.f.....c.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 27
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D0 C8 3F DB 25 17 25 27 E6 B2 22 54               ..?.%.%'.."T
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 28
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 EB D8 45 9E 5B 8C E9 65 F7 9F 4E               ...E.[..e..N
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 29
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8F CC 06 72 0A BC 1E 03 61 AF 2C 69               ...r....a.,i
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 30
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 15 70 83 5C 6D E2 EC 84 79 CD 80               ..p.\m...y..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 31
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 02 D0 1A E7 A8 91 78 FD D7 EC CD 46               ......x....F
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-3.3: Passed

>> IPSECV6-AH-3.4
TEST_DESCRIPTION
The "right" edge of the window represents the highest, validated
Sequence Number value received on this SA.
TEST_REFERENCE
RFC 4302 s3.4.3 p19 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMPv6 Echo-request containing the
        value 1 in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        (<window-size> + 2) in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value 2
        in the Sequence Number field of the AH
-  DUT: Do not forward ICMPv6 Echo-request
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=762  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=27752 usetime=27753 bytes=4096
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=27752 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=763  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=764  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=765  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=766  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=767  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[594] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[593] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[595] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[596] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 1
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 1E DB 97 70 FC 57 2D 76 85 22 76               ....p.W-v."v
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 32
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3D CB 37 48 5B 1E A1 E2 93 A3 3D 9D               =.7H[.....=.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 34
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 55 C5 C2 64 B4 CA 2B 07 F3 50 78 5E               U..d..+..Px^
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 2
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E 5C E1 2B 76 8B E5 60 D7 BF D4 D9               ^\.+v..`....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-3.4: Passed

>> IPSECV6-AH-3.5
TEST_DESCRIPTION
If the received packet falls within the window and is new, or if the
packet is to the right of the window, then the receiver proceeds to
ICV verification.  If the ICV validation fails, the receiver MUST
discard the received IP datagram as invalid;
TEST_REFERENCE
NEGATIVE: RFC 4302 s3.4.3 p20 Sequence Number Verification
TEST_METHOD
- ANVL: Reset new SA with anti-replay enabled and with window size
        set to <window-size>
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value 1
        in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value
        <window-size> in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Send an incorrectly authenticated ICMPv6 Echo-request (with an
        ICV error) containing the value (<window-size> + 2) in the
        Sequence Number field of the AH
-  DUT: Do not forward ICMPv6 Echo-request
- ANVL: Send an authenticated ICMPv6 Echo-request containing the value 2
        in the Sequence Number field of the AH
-  DUT: Forward the corresponding ICMPv6 Echo-request
- ANVL: Restore the default SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=768  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28054 usetime=28055 bytes=384
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28054 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=769  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=770  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=771  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=772  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=773  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[598] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[597] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[599] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[600] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending authenticated ICMPv6 Echo-Request with Sequence Number: 1
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A0 1E DB 97 70 FC 57 2D 76 85 22 76               ....p.W-v."v
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 32
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3D CB 37 48 5B 1E A1 E2 93 A3 3D 9D               =.7H[.....=.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 34
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 00 C5 C2 64 B4 CA 2B 07 F3 50 78 5E               ...d..+..Px^
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending authenticated ICMPv6 Echo-Request with Sequence Number: 2
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5E 5C E1 2B 76 8B E5 60 D7 BF D4 D9               ^\.+v..`....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT has forwarded the corresponding ICMPv6 Echo-Request on intreface eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-3.5: Passed

>> IPSECV6-AH-4.1
TEST_DESCRIPTION
If a field may be modified during transit, the value of the field is
set to zero for purposes of the ICV computation.
Note: This test checks whether the value of Flow Label field in an
incoming IPv6 datagram is set to zero for purposes of ICV computation
TEST_REFERENCE
RFC 4302 s3.3.3.1 p12 Handling Mutable Fields
RFC 4302 s3.3.3.1.2.1 p15  Base Header Fields
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Remote Host containing:
        - Flow Label field set to <flowLabel>
- ANVL: Listen for up to <ParamListenTime> for authenticated ICMPv6 Echo 
        Request packet
-  DUT: Forward authenticated ICMPv6 Echo Request
- ANVL: Check ICV in packet from DUT
CASE: <flowLabel> = 32
CASE: <flowLabel> = 64
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=774  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28067 usetime=28067 bytes=512
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28067 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=775  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=776  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=777  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=778  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=779  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[602] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[601] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[603] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[604] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send a plain IPv6 packet with
Flow Label field set to 32
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 32
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 67 3C 2D AA EF 31 B0 A3 CE A4 F3 1F               g<-..1......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 32
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 67 3C 2D AA EF 31 B0 A3 CE A4 F3 1F 


Case: send a plain IPv6 packet with
Flow Label field set to 64
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 64
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F5 B9 7C C6 C9 7C 29 FF F3 F9 42 D9               ..|..|)...B.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 64
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: F5 B9 7C C6 C9 7C 29 FF F3 F9 42 D9 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-4.1: Passed

>> IPSECV6-AH-5.1
TEST_DESCRIPTION
If no policy is found in the SPD that matches the packet (for either
inbound or outbound traffic), the packet MUST be discarded.
TEST_REFERENCE
NEGATIVE: RFC 4301 s5 p50 IP Traffic Processing
TEST_METHOD
- ANVL: Remove IPSec SA on the DUT with source address ANVL Local
        Host address and destination address ANVL Remote Address
- ANVL: Send an ICMPv6 Echo-request from ANVL Local Host to ANVL Remote
        Host
-  DUT: Do not forward ICMPv6 Echo Request or AH secured ICMPv6 Echo
        Request to Remote Host
- ANVL: Send an ICMPv6 Echo-request from Local Host
-  DUT: Do not forward authenticated ICMPv6 Echo-request to Remote host
- ANVL: Restore default IPSec SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=780  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28079 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28079 usetime=28080 bytes=256
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=781  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=782  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=783  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=784  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=785  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[606] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[605] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[607] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[608] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=786  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=609
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=787  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=610
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[606] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[605] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[609] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[610] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


DUT correctly did not forward unauthenticated ICMPv6
Echo Request on eth3 (3ffe:1111::1111) (Remote Host)
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


DUT correctly did not forward authenticated ICMPv6 Echo Request
on eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.1: Passed

>> IPSECV6-AH-5.2
TEST_DESCRIPTION
If no SAs were found or none match, create an appropriate SA bundle
and link the SPD entry to the SAD entry.  If no key management
entity is found, drop the packet
TEST_REFERENCE
NEGATIVE: RFC 4301 s5.1.1 p53(3b) Outbound IP Traffic Processing
TEST_METHOD
- ANVL: Remove the ANVL Local and Remote Host IPv6 addresses from the
        IPSec SAs on the DUT
- ANVL: Send an ICMPv6 Echo-request from Local Host
-  DUT: Do not forward ICMPv6 Echo-request to Remote host
- ANVL: Send an ICMPv6 Echo-request from Local Host
-  DUT: Do not forward authenticated ICMPv6 Echo-request to Remote host
- ANVL: Restore DUT IPSec SAs
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=788  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28081 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28081 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=789  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=790  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=791  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=792  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=793  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[612] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[611] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[613] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[614] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=794  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=615
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=795  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=616
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[612] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[611] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[615] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[616] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


DUT correctly did not forward unauthenticated ICMPv6 Echo Request
on eth3 (3ffe:1111::1111) (Remote Host)
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet


DUT correctly did not forward authenticated ICMPv6 Echo Request
on eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.2: Passed

>> IPSECV6-AH-5.3
TEST_DESCRIPTION
Lifetime of this Security Association: a time interval after which
an SA must be replaced with a new SA (and new SPI) or terminated,
plus an indication of which of these actions should occur.
This may be expressed as a time or byte count, or a simultaneous
use of both, the first lifetime to expire taking precedence.
A compliant implementation MUST support both types of lifetimes,
and must support a simultaneous use of both.
TEST_REFERENCE
RFC 4301 s4.4.2 p34 Security Association Database (SAD)
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with
        Lifetime <LifeTimeBytes> bytes
- ANVL: Send ICMPv6 Echo-requests within the Lifetime
        from Local Host
-  DUT: Forward the corresponding authenticated ICMPv6 Echo-requests
        to Remote Host
- ANVL: Send ICMPv6 Echo-requests beyond the Lifetime
        from Local Host
-  DUT: Do not forward the corresponding authenticated ICMPv6
        Echo-requests to Remote Host
- ANVL: Reset the SA between ANVL and DUT with
        Lifetime <LifeTimeSeconds> seconds
- ANVL: Send ICMPv6 Echo-requests within the Lifetime
        from Local Host
-  DUT: Forward the corresponding authenticated ICMPv6 Echo-requests
        to Remote Host
- ANVL: Send ICMPv6 Echo-requests beyond the Lifetime
        from Local Host
-  DUT: Do not forward the corresponding authenticated ICMPv6
        Echo-requests to Remote Host
- ANVL: Restore default IPSec SA on the DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=796  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28106 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28106 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=797  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=798  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=799  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=800  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=801  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[618] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[617] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[619] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[620] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 1065 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm update -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -bh 1065 
SADB_MSG: msgtype=UPDATE  err=0  satype=AH  len=144  seq=802  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=0 usetime=0 bytes=1065
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=803  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28130 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28130 usetime=0 bytes=0
    HARD: addtime=0 usetime=0 bytes=1065
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 1 ICMPv6 plain Packet to DUT to expire Lifetime
byte in DUT
Sending 1-th ICMPv6 plain Packets to DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1024 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F0 A8 9C 1D 18 DC EC F3 B5 69 FF 40               .........i.@
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, 1-th AH packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

No Authenticated ICMPv6 Echo Request packet received on
interface eth3 (3ffe:1111::1111) (Remote Host) as expected
DUT correctly did not forward ICMPv6 Echo Request packet
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 120 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=804  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 2000 -lh 120 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=144  seq=805  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=120 usetime=0 bytes=2000
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=806  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28141 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=2000
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting 120 seconds to expire SA Lifetime
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received ICMPv6 Echo request from 3ffe:2222::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9F56 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Got ECHO Request, sending reply
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

No Authenticated ICMPv6 Echo Request packet received on
interface DUT correctly did not forward ICMPv6 Echo Request packet
 (eth3) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=3  satype=NONE  len=16  seq=808  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
Total of 0 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=809  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=810  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=811  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=812  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=813  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[625] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[624] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[626] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[627] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.3: Passed

>> IPSECV6-AH-5.7
TEST_DESCRIPTION
IPSec MUST allow an interface to applications to obtain the information
about the mode of AH used in a received packet
(This test is for Tunnel Mode)
TEST_REFERENCE
RFC 4301 s4.4.2 p23 Security Association Database (SAD)
TEST_METHOD
- ANVL: Send an authenticated IPv6 datagram to an application on the
        DUT side
- ANVL: Verify that the application on the DUT side is able to get
        the mode information
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=814  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28273 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28273 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=815  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=816  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=817  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=818  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=819  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[629] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[628] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[630] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[631] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Application on DUT is LISTENING for TUNNEL mode information:
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
LISTEN TUNNEL

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Application succesfully started listening for
the mode information. Sending Tunnel mode
Authenticated ICMPv6 Echo Request packet to DUT
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 80 91 19 6D 2B 02 75 E9 68 93 F4 3C               ...m+.u.h..<
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


Application on DUT is REPORTING for TUNNEL mode information:
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
REPORT TUNNEL

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Application succesfully obtained
the mode (Tunnel) information

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.7: Passed

>> IPSECV6-AH-5.8
TEST_DESCRIPTION
If no policy is found in the SPD that matches the packet (for either
inbound or outbound traffic), the packet MUST be discarded.
TEST_REFERENCE
NEGATIVE: RFC 4301 s5 p30 IP Traffic Processing
TEST_METHOD
- ANVL: Remove IPSec SA on the DUT with source address ANVL Remote
        Host address and destination address ANVL Local Address
- ANVL: Send an authenticated ICMPv6 Echo-request from ANVL Remote Host
        to ANVL Local Host
-  DUT: Do not forward authenticated ICMPv6 Echo Request to Local Host
- ANVL: Send an Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Do not forward unauthenticated ICMPv6 Echo-request to Local host
- ANVL: Restore default IPSec SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=820  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28275 usetime=28276 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28275 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=821  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=822  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=823  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=824  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=825  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[633] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[632] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[634] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[635] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=826  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=636
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=827  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=637
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[633] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[632] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[636] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[637] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B8 B3 EE 30 50 02 54 46 C4 31 BA 58               ...0P.TF.1.X
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


Correctly did not receive Authenticated IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 57 C0 2C C1 49 18 C8 E9 29 9A F1 9E               W.,.I...)...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly did not receive Unauthenticated IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.8: Passed

>> IPSECV6-AH-5.9
TEST_DESCRIPTION
If no SAs were found or none match, create an appropriate SA bundle
and link the SPD entry to the SAD entry.  If no key management
entity is found, drop the packet.
TEST_REFERENCE
NEGATIVE: RFC 4301 s5.1.1 p53(3b) Outbound IP Traffic Processing
TEST_METHOD
- ANVL: Remove the ANVL Local and Remote Host IPv6 addresses from the
        IPSec SAs on the DUT
- ANVL: Send an Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Do not forward Authenticated ICMPv6 Echo-request to Local host
- ANVL: Send an Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Do not forward Unauthenticated ICMPv6 Echo-request to Local host
- ANVL: Restore DUT IPSec SAs
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=828  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28278 usetime=28290 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28278 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=829  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=830  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=831  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=832  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=833  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[639] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[638] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[640] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[641] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=834  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=642
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=835  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=643
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[639] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[638] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[642] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[643] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6F 06 77 CC 4E 45 16 F3 85 55 DD DA               o.w.NE...U..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


Correctly did not receive Authenticated ICMPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8B 74 F5 8B CB 44 BA F7 9E 25 BD ED               .t...D...%..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly did not receive Unauthenticated ICMPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.9: Passed

>> IPSECV6-AH-5.10
TEST_DESCRIPTION
For inbound processing, for unicast SAs, the SPI is used either alone
to look up an SA or in conjunction with the IPsec protocol type.
IPSec MUST discard an incoming IPv6 datagram containing a SPI and
protocol entry for which no corresponding entry exists in the SAD.
TEST_REFERENCE
NEGATIVE: RFC 4301 s4.4.2 p34 Security Association Database
TEST_METHOD
- ANVL: Send authenticated IPv6 packet from Remote Host with one of the
        elements <e> of the 2-tuple <SPI, Protocol>
        not matching the SA configuration
-  DUT: Do not forward the IPv6 packet, to Local Host
- CASE: <e> = SPI
- CASE: <e> = Protocol
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=836  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28302 usetime=28315 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28302 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=837  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=838  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=839  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=840  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=841  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[645] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[644] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[646] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[647] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending packets having some BAD value for SPI


Case: Set the SPI Value to 778 in AH Header - Wrong SPI


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x0000030A 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DD 64 72 C9 B2 B2 2B 09 FC 6E 11 FB               .dr...+..n..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Now sending packets having correct SPI but wrong 
Outer Protocol


Case: Set the Protocol to 50 in Outer IPv6 Header


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7D 32 7E C2 8B 7A 73 69 1F 13 C0 01               }2~..zsi....
ESP: --- Authentication Data End ---
ESP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7D 32 7E C2 8B 7A 73 69 1F 13 C0 01               }2~..zsi....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, didnot receive IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.10: Passed

>> IPSECV6-AH-5.11
TEST_DESCRIPTION
If an entire IP-datagram does not get delivered during the SA
lifetime the packet SHOULD be discarded
TEST_REFERENCE
RFC 4301 s4.4.2 p37 Security Association Database (SAD)
TEST_METHOD
- ANVL: Configure IPSec SA on the DUT with a lifetime
        of <LifeTimeBytes> bytes
-SETUP: Configure lifetime seconds on DUT such that
        SA doesnt get expired
- ANVL: Send as many ICMPv6 Echo-requests as possible within the
        Lifetime from Local Host to expire the lifetime bytes
-  DUT: Forward the corresponding authenticated ICMPv6 Echo-requests
        to Remote Host
- ANVL: Send ICMPv6 Echo Request of size 44 bytes
-  DUT: Do not send the authenticated ICMPv6 Echo Request
- ANVL: Restore default IPSec SA on the DUT
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=842  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28327 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28327 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=843  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=844  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=845  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=846  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=847  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[650] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[651] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 1065 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm update -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -bh 1065 
SADB_MSG: msgtype=UPDATE  err=0  satype=AH  len=144  seq=848  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=0 usetime=0 bytes=1065
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=849  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28349 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28349 usetime=0 bytes=0
    HARD: addtime=0 usetime=0 bytes=1065
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 120 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=850  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 2000 -lh 120 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=144  seq=851  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=120 usetime=0 bytes=2000
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=852  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28350 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=2000
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 1 ICMPv6 plain Packet to DUT to get close to
Lifetime byte in DUT.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1024 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F0 A8 9C 1D 18 DC EC F3 B5 69 FF 40               .........i.@
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, 1-th authenticated packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no AH packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=3  satype=NONE  len=16  seq=854  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
Total of 0 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=855  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=856  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=857  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=858  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=859  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[656] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[655] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[657] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[658] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-5.11: Passed

>> IPSECV6-AH-6.1
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for outbound traffic based on a
Destination IPv6 Address selector
TEST_REFERENCE
RFC 4301 s4.4.1 p19 The Security Policy Database
RFC 4301 s4.4.1.1 p26 Selectors
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams to be sent to the
        Remote Host's IPv6 address
- ANVL: Send ICMPv6 Echo-request from Local Host to Remote Host
-  DUT: Do not forward ICMPv6 Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams to be
        sent to the Remote Host
- ANVL: Send ICMPv6 Echo-request from Local Host
-  DUT: Forward the plain ICMPv6 Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams to be
        sent to the Remote Host
- ANVL: Send ICMPv6 Echo-request from Local Host
-  DUT: Forward the authenticated ICMPv6 Echo-request to Remote Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=860  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28362 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28362 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=861  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=862  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=863  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=864  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=865  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[660] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[659] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[661] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[662] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=866  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=663
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not forward any ICMPv6 Echo Request packet
on interface eth3 (3ffe:1111::1111) (Remote Host)


Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 BYPASS REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=867  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly forwarded plain ICMPv6 Echo Request packet
on interface eth3 (3ffe:1111::1111) (Remote Host)


Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 APPLY REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=868  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly forwarded authenticated ICMPv6 Echo Request packet
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.1: Passed

>> IPSECV6-AH-6.2
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for outbound traffic based on a
Source IPv6 Address selector
TEST_REFERENCE
RFC 4301 s4.4.1 p19 The Security Policy Database
RFC 4301 s4.4.1.1 p26 Selectors
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams sent from
        Local Host
- ANVL: Send ICMPv6 Echo-request from Local Host
-  DUT: Do not forward ICMPv6 Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams sent
        from Local Host
- ANVL: Send ICMPv6 Echo-request from Local Host
-  DUT: Forward the ICMPv6 Echo-request to Remote Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams
        from the Local Host
- ANVL: Send ICMPv6 Echo-request from Local Host
-  DUT: Forward the authenticated ICMPv6 Echo-request to Remote Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=869  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28364 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28364 usetime=28377 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=870  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=871  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=872  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=873  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=874  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[667] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[666] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[668] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[669] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 DISCARD LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=875  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=670
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)


Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=876  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected Unauthenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)


Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=877  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly forwarded authenticated ICMPv6 Echo Request packet
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.2: Passed

>> IPSECV6-AH-6.3
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for outbound traffic based on a
Transport Layer Protocol
TEST_REFERENCE
RFC 4301 s4.4.1 p19 The Security Policy Database
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        sent using Transport Layer protocol <protocol>
- ANVL: Send an IPv6 datagram using <protocol>, from Local Host
        through the DUT to Remote Host
-  DUT: Do not forward the IPv6 datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD:  Bypass IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an IPv6 datagram using <protocol>, from Local Host
        through the DUT to Remote Host
-  DUT: Forward the IPv6 datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an IPv6 datagram using <protocol>, from Local Host
        through the DUT to Remote Host
-  DUT: Forward the authenticated IPv6 datagram to Remote Host
- ANVL: Restore the DUT SPD
- CASE: <protocol> = TCP
- CASE: <protocol> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=878  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28379 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28379 usetime=28393 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=879  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=880  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=881  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=882  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=883  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[674] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[673] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[675] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[676] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 302 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=884  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -transport 6 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=885  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=677
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[674] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[673] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[675] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[677] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any TCP  -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 6 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=886  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[674] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[673] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[675] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[678] :: bypass src=3ffe:2222::/64:any dst=3ffe:1111::/64:any TCP  -> SA: BYPS
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected Unauthenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 6 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=887  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[674] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[673] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[675] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[679] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any TCP  -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8A 16 64 04 54 1B 51 41 7D A5 C7 C6               ..d.T.QA}...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=888  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28395 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28395 usetime=28406 bytes=124
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=889  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=890  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=891  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=892  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=893  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[681] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[680] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[682] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[683] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 302 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=894  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -transport 17 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=895  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=684
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[681] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[680] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[682] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[684] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any UDP  -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 17 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=896  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[681] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[680] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[682] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[685] :: bypass src=3ffe:2222::/64:any dst=3ffe:1111::/64:any UDP  -> SA: BYPS
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Received expected Unauthenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 17 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=897  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[681] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[680] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[682] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[686] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any UDP  -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 66 E6 AA 32 EE 50 51 55 8A 82 67 5E               f..2.PQU..g^
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Received expected authenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=898  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28408 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28408 usetime=28419 bytes=112
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=899  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=900  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=901  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=902  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=903  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[688] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[687] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[689] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[690] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.3: Passed

>> IPSECV6-AH-6.4
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for outbound traffic based on
TCP/UDP Source Ports
TEST_REFERENCE
RFC 4301 s4.4.1 p19 The Security Policy Database
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        sent from source port <port>
- ANVL: Send an IPv6 datagram on source port <port>, from Local Host
        through the DUT to Remote Host
-  DUT: Do not forward the IPv6 datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD: Bypass IPsec while
        processing datagrams sent from source port <port>
- ANVL: Send an IPv6 datagram on source port <port>, from Remote Host
        through the DUT to Local Host
-  DUT: Forward the IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent from source port <port>
- ANVL: Send an IPv6 datagram on source port <port>, from Local Host
        through the DUT to Remote Host
-  DUT: Forward the IPv6 datagram to Remote Host
- ANVL: Restore the DUT SPD
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=904  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28421 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28421 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=905  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=906  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=907  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=908  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=909  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[692] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[691] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[693] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[694] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 23  -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=910  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=23
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=695
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8787 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 23 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=911  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=23
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8787 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8787 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected Unauthenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 23 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=912  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=23
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8787 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 60 00 D0 59 B0 5B EC 77 31 EF 98 76               `..Y.[.w1..v
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8787 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=913  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28423 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28423 usetime=28436 bytes=124
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=914  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=915  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=916  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=917  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=918  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[699] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[698] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[700] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[701] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = TCP, <Source Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 69  -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=919  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=69
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=702
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8759 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 69 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=920  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=69
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8759 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8759 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected Unauthenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 69 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=921  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=69
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8759 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5A 70 92 23 4C 97 FE ED 12 76 E5 0E               Zp.#L....v..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x8759 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=922  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28438 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28438 usetime=28452 bytes=124
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=923  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=924  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=925  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=926  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=927  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[706] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[705] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[707] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[708] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Source Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 23  -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=928  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=23
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=709
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 23 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=929  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=23
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Received expected Unauthenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and SOURCE Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 23 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=930  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=23
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 03 9D 55 83 B1 6B 23 CD 9A 84 6F 72               ..U..k#...or
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=931  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28454 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28454 usetime=28468 bytes=112
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=932  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=933  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=934  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=935  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=936  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[713] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[712] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[714] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[715] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Source Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 69  -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=937  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=69
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=716
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 69 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=938  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=69
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Received expected Unauthenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and SOURCE Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 69 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=939  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=69
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 23 F5 46 EE 29 7D EC BF FA 0D 3C 34               #.F.)}....<4
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=940  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28470 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28470 usetime=28483 bytes=112
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=941  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=942  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=943  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=944  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=945  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[720] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[719] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[721] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[722] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.4: Passed

>> IPSECV6-AH-6.5
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for outbound traffic based on
TCP/UDP Destination Ports
TEST_REFERENCE
RFC 4301 s4.4.1 p19 The Security Policy Database
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        to be sent to destination port <port>
- ANVL: Send an authenticated IPv6 datagram to destination port <port>,
        from Remote Host through the DUT to Local Host
-  DUT: Do not forward the IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Bypass IPsec while
        processing datagrams to be sent to destination port <port>
- ANVL: Send an unauthenticated IPv6 datagram to destination port <port>,
        from Local Host through the DUT to Remote Host
-  DUT: Forward the IPv6 datagram to Remote Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams to be sent to destination port <port>
- ANVL: Send an authenticated IPv6 datagram to destination port <port>,
        from Remote Host through the DUT to Local Host
-  DUT: Forward the IPv6 datagram to Local Host
- ANVL: Send an unauthenticated IPv6 datagram on destination port <port>,
        from Local Host through the DUT to Remote Host
-  DUT: Do not forward the IPv6 datagram to Remote Host
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=946  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28485 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28485 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=947  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=948  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=949  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=950  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=951  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[724] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[723] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[725] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[726] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = TCP, <Destination Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 23 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=952  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=727
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE97 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 23 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=953  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE97 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE97 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected Unauthenticated IPv6 Packet on interface eth3
(3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 23 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=954  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE97 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 73 8B D3 EE 31 3A E8 18 0C 00 4C 54               s...1:....LT
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE97 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=955  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28488 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28488 usetime=28501 bytes=124
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=956  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=957  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=958  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=959  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=960  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[731] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[730] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[732] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[733] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = TCP, <Destination Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 69 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=961  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=734
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE69 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 69 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=962  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE69 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE69 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected Unauthenticated IPv6 Packet on interface eth3
(3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 69 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=963  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE69 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C9 57 C5 B5 20 5F A2 5C 0B C4 CC 9F               .W.. _.\....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xAE69 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=964  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28503 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28503 usetime=28516 bytes=124
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=965  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=966  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=967  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=968  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=969  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[738] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[737] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[739] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[740] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Destination Port> = 23

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 23 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=970  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=741
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 23 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=971  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Received expected Unauthenticated IPv6 Packet on interface eth3
(3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 23 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=972  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=23
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: DF 33 D0 70 01 5A 4C 96 55 E5 00 FA               .3.p.ZL.U...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x2A76 (Correct)
UDP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=973  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28518 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28518 usetime=28532 bytes=112
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=974  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=975  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=976  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=977  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=978  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[745] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[744] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[746] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[747] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Transport Protocol> = UDP, <Destination Port> = 69

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 69 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=979  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=748
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 69 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=980  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Received expected Unauthenticated IPv6 Packet on interface eth3
(3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 69 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=981  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=69
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 49 C6 5F C4 EC F4 CD 73 CC E1 56 DC               I._....s..V.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x2A48 (Correct)
UDP:

Received expected authenticated IPv6 Packet on interface eth3 (3ffe:1111::1111)
(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=982  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28534 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28534 usetime=28547 bytes=112
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=983  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=984  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=985  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=986  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=987  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[752] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[751] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[753] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[754] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.5: Passed

>> IPSECV6-AH-6.6
TEST_DESCRIPTION
IPSec MUST discard an inbound authenticated IPv6 datagram having a
matching SA entry in its SAD but incompatible protocol mode
TEST_REFERENCE
NEGATIVE: RFC 4301 s5.2.1 p34 Selecting and Using an SA or SA Bundle
TEST_METHOD
- ANVL: Send an Transport mode authenticated ICMPv6 Echo-request
-  DUT: Do not forward ICMPv6 Echo-request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=988  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28549 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28549 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=989  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=990  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=991  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=992  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=993  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[756] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[755] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[757] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[758] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to DUT virtual address 3ffe:2222::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FC 46 D5 ED 7F AB F6 51 0E D4 5E 5E               .F.....Q..^^
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 *Should be 0x6D23*
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111)(Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.6: Passed

>> IPSECV6-AH-6.7
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for inbound traffic based on a
Destination IPv6 Address selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams to be sent to the
        Local Host's IPv6 address
- ANVL: Send Authenticated ICMPv6 Echo-request from Remote Host to
        Local Host
-  DUT: Do not forward unauthenticated ICMPv6 Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams to be
        sent to the Local Host
- ANVL: Send Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Forward the Authenticated ICMPv6 Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams to be
        sent to the Local Host
- ANVL: Send Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Forward the unauthenticated ICMPv6 Echo-request to Local Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=994  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28552 usetime=28552 bytes=88
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28552 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=995  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=996  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=997  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=998  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=999  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[760] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[759] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[761] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[762] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
DISCARD IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 DISCARD LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1000  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1001  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1002  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=763
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[760] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[759] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[763] :: deny src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[761] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[762] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7F 48 6A 3B CA 22 71 3D 2B 47 3F 8F               .Hj;."q=+G?.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1003  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1004  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=1005  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[760] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[759] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[764] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[761] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[762] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 16 65 F7 BC C0 79 43 8F 7A AB 1A 96               .e...yC.z...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 16 65 F7 BC C0 79 43 8F 7A AB 1A 96               .e...yC.z...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Authenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1006  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1007  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1008  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=9 dscp=0x0 dir=in id=765
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[760] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[759] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[761] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[765] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[762] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 71 7F EA 04 5D 28 E0 32 FC D0 34 A4               q...](.2..4.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.7: Passed

>> IPSECV6-AH-6.8
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for inbound traffic based on a
Source IPv6 Address selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in DUT's SPD to discard datagrams sent from
        Remote Host
- ANVL: Send Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Do not forward unauthenticated ICMPv6 Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to bypass security for datagrams sent
        from Remote Host
- ANVL: Send Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Forward the Authenticated ICMPv6 Echo-request to Local Host
- ANVL: Reset entry in DUT's SPD to apply security for datagrams
        from the Remote Host
- ANVL: Send Authenticated ICMPv6 Echo-request from Remote Host
-  DUT: Forward the unauthenticated ICMPv6 Echo-request to Local Host
- ANVL: Restore the Default SPD
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1009  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28564 usetime=28575 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28564 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1010  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1011  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1012  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1013  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1014  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[767] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[766] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[768] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[769] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
DISCARD IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1015  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1016  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1017  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=770
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[767] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[766] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[770] :: deny src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[768] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[769] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8E 77 7D 21 2B 29 31 F1 DF F8 5D BE               .w}!+)1...].
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, No Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 BYPASS REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1018  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1019  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=1020  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[767] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[766] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[771] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[768] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[769] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C 54 C9 FF 19 14 B1 98 9F A2 DC E8               |T..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000000F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C 54 C9 FF 19 14 B1 98 9F A2 DC E8               |T..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Authenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 APPLY REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1021  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1022  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1023  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=9 dscp=0x0 dir=in id=772
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[767] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[766] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[768] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[772] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[769] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000010 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 88 F3 E5 72 77 63 95 BA 92 1B C3 2E               ...rwc......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.8: Passed

>> IPSECV6-AH-6.9
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for inbound traffic based on a
Transport Layer Protocol
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD:  Discard datagrams
        sent using Transport Layer protocol <protocol>
- ANVL: Send an authenticated IPv6 datagram using <protocol>, from
        Remote Host through the DUT to Local Host
-  DUT: Do not forward the unauthenticated IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Bypass IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an Authenticated IPv6 datagram using <protocol>, from
        Remote Host through the DUT to Local Host
-  DUT: Forward the Authenticated IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent using Transport Layer protocol
        <protocol>
- ANVL: Send an Authenticated IPv6 datagram using <protocol>, from
        Remote Host through the DUT to Remote Host
-  DUT: Forward the unauthenticated IPv6 datagram to Local Host
- ANVL: Restore the DUT SPD
- CASE: <protocol> = ICMPv6
- CASE: <protocol> = TCP
- CASE: <protocol> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1024  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28577 usetime=28578 bytes=256
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28577 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1025  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1026  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1027  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1028  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1029  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[774] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[773] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[775] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[776] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = ICMPv6

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for icmpv6 transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1030  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 0 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1031  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=777
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[774] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[773] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[777] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[776] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000011 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 91 AD F7 C1 F6 F1 15 D6 E5 19 ED C0               ............
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, No Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for icmpv6 transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1032  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 0 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1033  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[774] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[773] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[778] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[776] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 B4 48 EF 6E CF DD 21 EB DB F4 F8               ..H.n..!....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000012 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 01 B4 48 EF 6E CF DD 21 EB DB F4 F8               ..H.n..!....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for icmpv6 transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1034  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 0 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1035  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[774] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[773] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[779] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[776] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000013 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A9 B7 E0 5B 2D D4 33 FA 44 35 1D DB               ...[-.3.D5..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1036  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28590 usetime=28592 bytes=256
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28590 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1037  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1038  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1039  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1040  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1041  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[781] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[780] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[782] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[783] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1042  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1043  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=784
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[781] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[780] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[784] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any TCP  <- SA: none
[783] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000014 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FC 67 0D 69 4B 6A 41 31 90 42 3E C2               .g.iKjA1.B>.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x608D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, No Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1044  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1045  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[781] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[780] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[785] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:any TCP  <- SA: BYPS
[783] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: EB FC 55 22 AD DB B5 9A 06 26 B2 D3               ..U".....&..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x608D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000015 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: EB FC 55 22 AD DB B5 9A 06 26 B2 D3               ..U".....&..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x608D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1046  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1047  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[781] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[780] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[786] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any TCP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[783] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000016 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 17 B8 8A CD A0 D4 35 82 86 E3 2B 6E               ......5...+n
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x608D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x608D*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1048  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28609 usetime=28611 bytes=248
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28609 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1049  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1050  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1051  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1052  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1053  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[788] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[787] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[789] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[790] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1054  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1055  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=791
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[788] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[787] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[791] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any UDP  <- SA: none
[790] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000017 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2E 12 72 BA 69 67 25 F7 5D 94 A1 9A               ..r.ig%.]...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, No Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1056  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1057  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[788] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[787] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[792] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:any UDP  <- SA: BYPS
[790] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 06 10 97 04 35 D9 CB 34 C3 1E F4 9B               ....5..4....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000018 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 06 10 97 04 35 D9 CB 34 C3 1E F4 9B               ....5..4....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1058  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1059  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[788] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[787] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[793] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any UDP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[790] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000019 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 8A FB FE D6 22 32 99 EE C1 D9 9C B0               ...."2......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1060  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28628 usetime=28630 bytes=224
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28628 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1061  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1062  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1063  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1064  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1065  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[795] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[794] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[796] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[797] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.9: Passed

>> IPSECV6-AH-6.10
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for inbound traffic based on a
TCP/UDP Source Ports
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD: Discard datagrams
        sent with source port <port>
- ANVL: Send an Authenticated IPv6 datagram with source port <port> and,
        Transport protocol <Protocol> from Remote Host through the DUT to
        Local Host
-  DUT: Do not forward the unauthenticated IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD: Bypass IPsec while
        processing datagrams sent with source port <port>
- ANVL: Send an Authenticated IPv6 datagram with source port <port> and
        Transport protocol <Protocol>, from Remote Host through the DUT
        to Local Host
-  DUT: Forward the authenticated IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent with source port <port>
- ANVL: Send an authenticated IPv6 datagram with source port <port> and
        Transport protocol <Protocol> ,from Remote Host through the DUT
        to Local Host
-  DUT: Forward the unauthenticated IPv6 datagram to Local Host
- ANVL: Restore the DUT SPD
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1066  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28646 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28646 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1067  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1068  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1069  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1070  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1071  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[799] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[798] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[800] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[801] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1072  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1073  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64 port=23
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=802
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[799] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[798] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[802] :: deny src=3ffe:1111::/64:23 dst=3ffe:2222::/64:any TCP  <- SA: none
[801] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7F 76 80 B1 E5 D3 48 A0 CA 45 46 09               .v....H..EF.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8787*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1074  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 23  -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1075  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64 port=23
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[799] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[798] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[803] :: bypass src=3ffe:1111::/64:23 dst=3ffe:2222::/64:any TCP  <- SA: BYPS
[801] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 4B BF 17 8D AE 57 5D 99 F3 3D 9A               .K....W]..=.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8787*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 4B BF 17 8D AE 57 5D 99 F3 3D 9A               .K....W]..=.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8787*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1076  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1077  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64 port=23
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[799] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[798] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[804] :: use src=3ffe:1111::/64:23 dst=3ffe:2222::/64:any TCP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[801] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C5 DF CC 97 D5 EB 47 F6 EC 9B DA 58               ......G....X
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8787*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 23 (telnet)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8787*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1078  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28649 usetime=28650 bytes=248
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28649 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1079  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1080  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1081  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1082  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1083  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[806] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[805] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[807] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[808] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1084  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1085  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64 port=69
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=809
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[806] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[805] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[809] :: deny src=3ffe:1111::/64:69 dst=3ffe:2222::/64:any TCP  <- SA: none
[808] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 65 17 4C A0 9E 04 1F 21 D6 2A DD E9               e.L....!.*..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8759*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1086  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 69  -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1087  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64 port=69
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[806] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[805] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[810] :: bypass src=3ffe:1111::/64:69 dst=3ffe:2222::/64:any TCP  <- SA: BYPS
[808] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 50 E8 96 9F AC 2C A6 6A C5 80 EA 4F               P....,.j...O
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8759*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 50 E8 96 9F AC 2C A6 6A C5 80 EA 4F               P....,.j...O
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8759*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1088  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -srcport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1089  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64 port=69
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[806] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[805] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[811] :: use src=3ffe:1111::/64:69 dst=3ffe:2222::/64:any TCP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[808] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000001F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7C 30 F9 45 DA 01 D2 F0 5A 54 E5 65               |0.E....ZT.e
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8759*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 69 (69)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0x8759*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1090  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28664 usetime=28665 bytes=248
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28664 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1091  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1092  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1093  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1094  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1095  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[813] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[812] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[814] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[815] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Source Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1096  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1097  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64 port=23
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=816
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[813] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[812] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[816] :: deny src=3ffe:1111::/64:23 dst=3ffe:2222::/64:any UDP  <- SA: none
[815] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000020 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F4 DD 30 F2 36 9F 1B 78 D1 15 C6 52               ..0.6..x...R
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1098  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 23  -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1099  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64 port=23
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[813] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[812] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[817] :: bypass src=3ffe:1111::/64:23 dst=3ffe:2222::/64:any UDP  <- SA: BYPS
[815] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000021 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C4 D9 22 15 D4 48 1B 2F C2 B0 80 84               .."..H./....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000021 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C4 D9 22 15 D4 48 1B 2F C2 B0 80 84               .."..H./....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and SOURCE port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1100  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1101  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64 port=23
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[813] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[812] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[818] :: use src=3ffe:1111::/64:23 dst=3ffe:2222::/64:any UDP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[815] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000022 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D5 C5 1E 4C 73 78 7C 14 9A CC 16 29               ...Lsx|....)
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 23 (23)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1102  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28679 usetime=28680 bytes=224
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28679 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1103  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1104  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1105  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1106  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1107  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[820] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[819] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[821] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[822] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Source Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1108  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1109  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64 port=69
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=823
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[820] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[819] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[823] :: deny src=3ffe:1111::/64:69 dst=3ffe:2222::/64:any UDP  <- SA: none
[822] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000023 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C2 2C 85 05 EC 35 55 A8 0D 19 E5 11               .,...5U.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1110  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 69  -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1111  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64 port=69
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[820] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[819] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[824] :: bypass src=3ffe:1111::/64:69 dst=3ffe:2222::/64:any UDP  <- SA: BYPS
[822] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000024 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E7 AB 30 F5 5A E8 A8 15 60 5D 32 F8               ..0.Z...`]2.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000024 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E7 AB 30 F5 5A E8 A8 15 60 5D 32 F8               ..0.Z...`]2.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and SOURCE port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1112  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -srcport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1113  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64 port=69
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[820] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[819] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[825] :: use src=3ffe:1111::/64:69 dst=3ffe:2222::/64:any UDP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[822] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000025 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0C 9D 4D 11 30 58 19 B3 22 2D D6 4C               ..M.0X.."-.L
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 69 (tftp)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1114  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28693 usetime=28695 bytes=224
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28693 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1115  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1116  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1117  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1118  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1119  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[827] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[826] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[828] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[829] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.10: Passed

>> IPSECV6-AH-6.11
TEST_DESCRIPTION
Thus the administrative interface must allow the user (or system
administrator) to specify the security processing to be applied 
to any packet entering or exiting the system, on a packet by packet
basis.
Note: This test checks whether an administrative interface is allowed
to specify the security processing for inbound traffic based on
TCP/UDP Destination Ports
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add the following entry in the DUT SPD: Discard datagrams
        sent with destination port <port>
- ANVL: Send an Authenticated IPv6 datagram with destination port <port>
        and, Transport protocol <Protocol> from Remote Host through
        the DUT to Local Host
-  DUT: Do not forward the unauthenticated IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD: Bypass IPsec while
        processing datagrams sent with destination port <port>
- ANVL: Send an Authenticated IPv6 datagram with destination port <port>
        and Transport protocol <Protocol>, from Remote Host through
        the DUT to Local Host
-  DUT: Forward the authenticated IPv6 datagram to Local Host
- ANVL: Add the following entry in the DUT SPD:  Use IPsec while
        processing datagrams sent with destination port <port>
- ANVL: Send an authenticated IPv6 datagram with destination port <port>
        and Transport protocol <Protocol> ,from Remote Host through
        the DUT to Local Host
-  DUT: Forward the unauthenticated IPv6 datagram to Local Host
- ANVL: Restore the DUT SPD
- CASE: <Protocol> = TCP, <port> = 23
- CASE: <Protocol> = TCP, <port> = 69
- CASE: <Protocol> = UDP, <port> = 23
- CASE: <Protocol> = UDP, <port> = 69
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1120  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28708 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28708 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1121  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1122  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1123  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1124  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1125  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[831] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[830] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[832] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[833] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Destination Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1126  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1127  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=834
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[831] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[830] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[834] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:23 TCP  <- SA: none
[833] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000026 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 45 36 7A 14 22 F1 A7 E0 93 BF A3 56               E6z."......V
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE97*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1128  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1129  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=23
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[831] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[830] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[835] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:23 TCP  <- SA: BYPS
[833] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
exit
-> 

Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000027 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2F 4F 0E FC 3B DB D0 F7 13 24 59 68               /O..;....$Yh
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE97*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000027 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2F 4F 0E FC 3B DB D0 F7 13 24 59 68               /O..;....$Yh
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE97*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1130  pid=0x5b38d0
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1131  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=23
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[831] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[830] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[836] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:23 TCP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[833] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
exit
-> 

Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000028 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B7 28 B8 57 E1 FB 7C 5E 27 AC 68 08               .(.W..|^'.h.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE97*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from fe80::215:17ff:fec8:9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9029
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA5CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2E66 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 23 (telnet)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE97*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1132  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28710 usetime=28712 bytes=248
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28710 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1133  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1134  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1135  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1136  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1137  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[838] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[837] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[839] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[840] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Destination Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1138  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1139  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=841
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[838] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[837] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[841] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:69 TCP  <- SA: none
[840] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000029 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AA F1 5C F6 22 20 39 1E 77 00 37 97               ..\." 9.w.7.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE69*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1140  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1141  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=69
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[838] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[837] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[842] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:69 TCP  <- SA: BYPS
[840] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 52 17 FC 80 0D FC 18 C8 1E 86 C0 49               R..........I
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE69*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 52 17 FC 80 0D FC 18 C8 1E 86 C0 49               R..........I
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE69*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1142  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 6 -dstport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1143  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=69
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[838] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[837] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[843] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:69 TCP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[840] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D5 65 95 E2 03 8C ED 1A 9C FF D9 BD               .e..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE69*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 69 (69)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x0000 *Should be 0xAE69*
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1144  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28746 usetime=28748 bytes=248
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28746 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1145  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1146  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1147  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1148  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1149  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[845] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[844] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[846] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[847] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Destination Port> = 23

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1150  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1151  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=23
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=848
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[845] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[844] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[848] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:23 UDP  <- SA: none
[847] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002C 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 5C F7 59 EB B1 41 07 E2 C3 73 D4 B0               \.Y..A...s..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1152  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1153  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=23
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[845] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[844] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[849] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:23 UDP  <- SA: BYPS
[847] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0D EC A3 1A B0 76 8D 2A 51 3C D4 A1               .....v.*Q<..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002D 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0D EC A3 1A B0 76 8D 2A 51 3C D4 A1               .....v.*Q<..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and DESTINATION port 23
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 23 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1154  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 23 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1155  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=23
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[845] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[844] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[850] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:23 UDP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[847] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
exit
-> 

Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002E 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 00 68 44 E3 4F B5 F9 9F 9A 05 7B 39               .hD.O.....{9
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from fe80::215:17ff:fec8:9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9029
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA5CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2E66 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 23 (23)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1156  pid=0x5b38d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28762 usetime=28763 bytes=224
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5b38d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28762 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1157  pid=0x5b38d0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1158  pid=0x5b38d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1159  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1160  pid=0x5b38d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1161  pid=0x5b38d0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[852] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[851] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[853] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[854] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Destination Port> = 69

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1162  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1163  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=69
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=855
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[852] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[851] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[855] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:69 UDP  <- SA: none
[854] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000002F 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7E 67 C0 BF 3A 50 F4 D2 C1 75 6A C7               ~g..:P...uj.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Correctly, no Unauthenticated IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1164  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1165  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=69
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[852] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[851] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[856] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:69 UDP  <- SA: BYPS
[854] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000030 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 69 B6 59 E2 75 F6 DA 3F F3 5A D2 14               i.Y.u..?.Z..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000030 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 69 B6 59 E2 75 F6 DA 3F F3 5A D2 14               i.Y.u..?.Z..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Authenticated IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and DESTINATION port 69
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 69 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress 
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1166  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -transport 17 -dstport 69 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1167  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64 port=69
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[852] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[851] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[857] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:69 UDP  <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[854] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000031 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 26 5B F1 BA B4 30 B5 24 34 CC A8 E3               &[...0.$4...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 69 (tftp)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1168  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28788 usetime=28789 bytes=224
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28788 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1169  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1170  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1171  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1172  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1173  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[859] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[858] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[860] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[861] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.11: Passed

>> IPSECV6-AH-6.12
TEST_DESCRIPTION
The authentication provided to a authenticated inbound IPv6 packet
depends on the order in which multiple matching entries are created
in SPD.
TEST_REFERENCE
RFC 4301 p21 s4.4.1 Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound authenticated
        IP-datagrams via interface D1 with outer IPv6 Destination
        Address within Subnet-2 (specified using address + mask) are
        bypassed. Add another entry in the DUT's SPD such that
        inbound secured IP-datagrams with outer IPv6 Destination Address
        set to A2 Addr, are processed using IPSec
- ANVL: Send authenticated ICMPv6 Echo Request, from Remote Host
-  DUT: Forward authenticated ICMPv6 Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add the SPD entries again, but
        in reverse order (the SPD entry for Subnet-2 which was earlier
        added first is added second this time)
- ANVL: Send authenticated ICMPv6 Echo Request, from Remote Host
-  DUT: Forward unauthenticated ICMPv6 Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add entry in the DUT's SPD such
        that inbound secured IP-datagrams via interface D1, with inner
        IP-Header Destination Address within Subnet-2 (specified using
        address + mask) are processed using IPsec. Add another entry
        in the DUT's SPD such that inbound secured IP-datagrams with
        inner IP-Header Destination Address set to A2 Addr,
        are bypassed
- ANVL: Send authenticated ICMPv6 Echo Request, from Remote Host
-  DUT: Forward unauthenticated ICMPv6 Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add the SPD entries again just
        as last time, except that the entry for Subnet-2 is added
        second
- ANVL: Send authenticated ICMPv6 Echo Request, from Remote Host
-  DUT: Forward authenticated ICMPv6 Echo Request, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1174  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28803 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28803 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1175  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1176  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1177  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1178  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1179  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[864] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[865] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1180  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=866
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1181  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=867
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[866] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[867] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=1182  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[868] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[867] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1183  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1184  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1185  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=9 dscp=0x0 dir=in id=869
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[868] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[869] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[867] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000032 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 56 EE 69 6C DD 6A E8 EF B7 CA D8 07               V.il.j......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000032 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 56 EE 69 6C DD 6A E8 EF B7 CA D8 07               V.il.j......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, received authenticated IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1186  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=870
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1187  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=871
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[870] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[869] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[871] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
exit
-> 
Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1188  pid=0x5b38d0
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=208  seq=1189  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=9 dscp=0x0 dir=in id=869
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1190  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=9 dscp=0x0 dir=in id=872
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[870] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[872] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[871] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=1191  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[873] :: bypass src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[872] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[871] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000033 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F5 77 EB 63 29 23 CF 6F 4D 0B 1E 68               .w.c)#.oM..h
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received unauthenticated IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1192  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=874
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1193  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=875
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[874] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[872] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[875] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
exit
-> 
Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1194  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[876] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[872] :: use pri=9 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[875] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
exit
-> 
Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1195  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=208  seq=1196  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=9 dscp=0x0 dir=in id=872
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=1197  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[877] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[876] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[875] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000034 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 48 10 F1 EE A4 F0 54 F2 6B 03 EC 89               H.....T.k...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from fe80::215:17ff:fec8:9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9029
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA5CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2E66 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received non-authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received unauthenticated IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1198  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=878
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=288  seq=1199  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=879
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[877] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[878] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[879] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1200  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm delflow -proto ah -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -flowpri 9
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=AH  len=16  seq=1201  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=1202  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[880] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[878] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[879] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1203  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[863] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[862] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[880] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[881] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[879] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Authenticated ICMPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000035 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F7 1A 4F 55 E8 2C 43 B3 3B 80 0B 14               ..OU.,C.;...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000035 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: F7 1A 4F 55 E8 2C 43 B3 3B 80 0B 14               ..OU.,C.;...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received authenticated IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.12: Passed

>> IPSECV6-AH-6.14
TEST_DESCRIPTION
IPsec MUST allow an management interface to specify the security
processing for outbound traffic based on SA value - Next Layer 
protocol (e.g. ICMPv6). 
TEST_REFERENCE
rfc 4301 S4.4.1, p23, The Security Policy Database (SPD)
rfc 4301 S4.4.1.1, p28, Selectors
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD:  Discard packets 
         containing next protocol set to ICMPv6
- ANVL:  Send an ICMPv6 packet, from Local Host through the DUT 
         to Remote Host
-  DUT:  Do not forward the ICMPv6 packet to Remote Host
- SETUP: Add the following entry in the DUT SPD:  Bypass IPsec for
         packets containing next protocol set to ICMPv6
- ANVL:  Send an ICMPv6 packet, from Local Host through the DUT 
         to Remote Host  
-  DUT:  Forward the ICMPv6 packet to Remote Host  
- SETUP: Add the following entry in the DUT SPD:  Use IPsec while  
         packets containing next protocol set to ICMPv6
- ANVL:  Send an ICMPv6 packet, from Local Host through the DUT 
         to Remote Host 
-  DUT:  Forward the authenticated ICMPv6 packet to Remote Host 
- ANVL:  Restore the DUT SPD 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1204  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28806 usetime=28823 bytes=256
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28806 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1205  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1206  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1207  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1208  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1209  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[883] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[882] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[884] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[885] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 302 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1210  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1211  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=886
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[883] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[882] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[884] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[886] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1212  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[883] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[882] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[884] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[887] :: bypass src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: BYPS
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from fe80::215:17ff:fec8:9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9028
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB6E1 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x508A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected Plain IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1213  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[883] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[882] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[884] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[888] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected authenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1214  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28852 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28852 usetime=28863 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1215  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1216  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1217  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1218  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1219  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[890] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[889] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[891] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[892] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.14: Passed

>> IPSECV6-AH-6.15
TEST_DESCRIPTION
IPSec must process outbound ISAKMP packets according to SAD/SPD
entries
TEST_REFERENCE
RFC 4301 s4.4.2 p17 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound ISAKMP (UDP/500)
        IPv6-datagrams from DUT to ANVL are processed using Discard
        policy
- ANVL: Send IPv6 Packet with Transport Protocol UDP and Transport
        Protocol Destination Port 500 from Local Host
-  DUT: Do not forward authenticated IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass
- ANVL: Send IPv6 Packet with Transport Protocol UDP and Transport
        Protocol Destination Port 500 from Local Host
-  DUT: Forward IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use IPsec
- ANVL: Send IPv6 Packet with Transport Protocol UDP and Transport
        Protocol Destination Port 500 from Local Host
-  DUT: Forward authenticated IPv6 Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1220  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28865 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28865 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1221  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1222  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1223  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1224  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1225  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[894] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[893] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[895] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[896] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 500
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 500 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 500 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1226  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=500
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=897
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x2641 (Correct)
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no authenticated IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 500
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 500 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 500 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1227  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=500
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x2641 (Correct)
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x2641 (Correct)
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 500
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 500 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 500 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1228  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=500
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x2641 (Correct)
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 35 06 03 96 81 2E 0D B5 A7 7C 6A 55               5........|jU
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 36 
UDP: Checksum         = 0x2641 (Correct)
UDP:
UDP: --- Trailing Data [28 bytes] ---
UDP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
UDP:  00 10 00 00 00 00 00 00 00 00 00 1C               ............
UDP: --- Trailing Data End ---

Correctly Received authenticated IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-6.15: Passed

>> IPSECV6-AH-7.1
TEST_DESCRIPTION
The Authentication Data field is also set to zero in preparation
for this computation.  Note that by replacing each field's value
with zero, rather than omitting the field, alignment is preserved
for the ICV calculation.
TEST_REFERENCE
RFC 4302 s3.3.3.1 p13 Handling Mutable Fields
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Remote Host containing:
        - Data field set to <data>
- ANVL: Listen for up to <ParamListenTime> for AH-authenticated ICMPv6
        Echo Request packet
-  DUT: Forward AH-authenticated ICMPv6 Echo Request
- ANVL: Check ICV in packet from DUT
CASE: <data> = ANVL TEST DATA
CASE: <data> = ANVL TEST DATA OTHER
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1229  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28867 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28867 usetime=28881 bytes=140
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1230  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1231  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1232  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1233  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1234  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[901] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[900] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[902] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[903] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send a plain IPv6 packet with
ICMPv6 Data set to ANVL TEST DATA
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 22 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC077 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 1
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [14 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41         ANVL TEST DATA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 86 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: E3 C1 3E 24 16 EE C7 32 AD 4D E9 E6               ..>$...2.M..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 22 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC077 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 1
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [14 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41         ANVL TEST DATA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: E3 C1 3E 24 16 EE C7 32 AD 4D E9 E6 


Case: send a plain IPv6 packet with
ICMPv6 Data set to ANVL TEST DATA OTHER
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC077 *Should be 0x0688*
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 1
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 4F   ANVL TEST DATA O
ICMPv6:  54 48 45 52                                       THER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 4C 07 5C 90 8A 17 20 88 72 C0 E1 A0               L.\... .r...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC077 *Should be 0x0688*
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 1
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 4F   ANVL TEST DATA O
ICMPv6:  54 48 45 52                                       THER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 4C 07 5C 90 8A 17 20 88 72 C0 E1 A0 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-7.1: Passed

>> IPSECV6-AH-7.2
TEST_DESCRIPTION
IPsec MUST set the value of the Hop Count field in an incoming
IPv6 datagram to zero for purposes of the ICV computation
TEST_REFERENCE
RFC 4302 s3.3.3.1 p13 Handling Mutable Fields
RFC 4302 s3.3.3.1.2.1 p15 Base Header Fields
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Remote Host containing:
        - Hop Count field set to <hopCount>
- ANVL: Listen for up to <ParamListenTime> for authenticated ICMPv6 Echo
        Request packet
-  DUT: Forward authenticated ICMPv6 Echo Request
- ANVL: Check ICV in packet from DUT
CASE: <hopCount> = 2
CASE: <hopCount> = 64
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1235  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28883 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28883 usetime=28883 bytes=258
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1236  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1237  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1238  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1239  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1240  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[905] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[904] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[906] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[907] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send a plain IPv6 packet with
Hop Count field set to 2
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 2
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 1
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 04 05 50 CC D8 1D F5 01 B7 BC F6 8F               ..P.........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 1
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 04 05 50 CC D8 1D F5 01 B7 BC F6 8F 


Case: send a plain IPv6 packet with
Hop Count field set to 64
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 63
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: B1 A6 40 17 05 1A C9 FB E4 C1 16 42               ..@........B
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 63
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: B1 A6 40 17 05 1A C9 FB E4 C1 16 42 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-7.2: Passed

>> IPSECV6-AH-7.3
TEST_DESCRIPTION
IPsec MUST set the value of the Class field in an incoming
IPv6 datagram to zero for purposes of the ICV computation
TEST_REFERENCE
RFC 4302 s3.3.3.1 p13 Handling Mutable Fields
RFC 4302 s3.3.3.1.2.1 p15 Base Header Fields
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Remote Host containing:
        - IPv6 Class field set to <class>
- ANVL: Listen for up to <ParamListenTime> for authenticated ICMPv6 Echo
        Request packet
-  DUT: Forward authenticated ICMPv6 Echo Request
- ANVL: Check ICV in packet from DUT
 CASE: <class> = 00100000 (Precedence = 1 [001])
 CASE: <class> = 01000000 (Precedence = 2 [010])
 CASE: <class> = 10000000 (Precedence = 4 [100])
 CASE: <class> = 00000010 (Low Monetary Cost)
 CASE: <class> = 00000100 (High Reliability)
 CASE: <class> = 00001000 (High Throughput)
 CASE: <class> = 00010000 (Low Delay)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1241  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28885 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28885 usetime=28885 bytes=256
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1242  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1243  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1244  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1245  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1246  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[909] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[908] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[910] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[911] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send a plain IPv6 packet with Class fieldset to 32
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 32
IPv6:  |01234567
IPv6:  |001000..           = 8 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 32
IPv6:  |01234567
IPv6:  |001000..           = 8 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 9A 25 D6 45 7C 88 0C A9 9E F4 D3 01               .%.E|.......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 32
IPv6:  |01234567
IPv6:  |001000..           = 8 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 9A 25 D6 45 7C 88 0C A9 9E F4 D3 01 


Case: send a plain IPv6 packet with Class fieldset to 64
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 64
IPv6:  |01234567
IPv6:  |010000..           = 16 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 64
IPv6:  |01234567
IPv6:  |010000..           = 16 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: FE BB 21 D0 BE 8B 2C FC C4 88 AC B4               ..!...,.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 64
IPv6:  |01234567
IPv6:  |010000..           = 16 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: FE BB 21 D0 BE 8B 2C FC C4 88 AC B4 


Case: send a plain IPv6 packet with Class fieldset to 128
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 128
IPv6:  |01234567
IPv6:  |100000..           = 32 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 128
IPv6:  |01234567
IPv6:  |100000..           = 32 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 3B 74 C6 F9 A7 58 12 7D E5 50 9C E7               ;t...X.}.P..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 128
IPv6:  |01234567
IPv6:  |100000..           = 32 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 3B 74 C6 F9 A7 58 12 7D E5 50 9C E7 


Case: send a plain IPv6 packet with Class fieldset to 2
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 14 E7 B4 4D D7 73 B8 08 3A CB AA DB               ...M.s..:...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 14 E7 B4 4D D7 73 B8 08 3A CB AA DB 


Case: send a plain IPv6 packet with Class fieldset to 4
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 4
IPv6:  |01234567
IPv6:  |000001..           = 1 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 4
IPv6:  |01234567
IPv6:  |000001..           = 1 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000005 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 54 A1 63 B3 D0 0F 7E F5 E5 FB 00 7C               T.c...~....|
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 4
IPv6:  |01234567
IPv6:  |000001..           = 1 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 54 A1 63 B3 D0 0F 7E F5 E5 FB 00 7C 


Case: send a plain IPv6 packet with Class fieldset to 8
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 8
IPv6:  |01234567
IPv6:  |000010..           = 2 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 8
IPv6:  |01234567
IPv6:  |000010..           = 2 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000006 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 89 7D B5 61 68 9C B0 EB B2 FB 02 B2               .}.ah.......
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 8
IPv6:  |01234567
IPv6:  |000010..           = 2 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 89 7D B5 61 68 9C B0 EB B2 FB 02 B2 


Case: send a plain IPv6 packet with Class fieldset to 16
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 16
IPv6:  |01234567
IPv6:  |000100..           = 4 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 16
IPv6:  |01234567
IPv6:  |000100..           = 4 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000007 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 2F 0F 20 65 1E EB 89 20 7A 8F 21 3A               /. e... z.!:
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 16
IPv6:  |01234567
IPv6:  |000100..           = 4 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 2F 0F 20 65 1E EB 89 20 7A 8F 21 3A 


Case: send a plain IPv6 packet with Class fieldset to 16
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 16
IPv6:  |01234567
IPv6:  |000100..           = 4 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 16
IPv6:  |01234567
IPv6:  |000100..           = 4 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000008 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 0C 80 F4 5A D2 FD 13 17 9A 60 FE 16               ...Z.....`..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 16
IPv6:  |01234567
IPv6:  |000100..           = 4 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received ICV from DUT: 0C 80 F4 5A D2 FD 13 17 9A 60 FE 16 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-7.3: Passed

>> IPSECV6-AH-9.1
TEST_DESCRIPTION
The value of this field is chosen from the set of IP Protocol Numbers
defined in the most recent "Assigned Numbers" [STD-2] RFC from the
Internet Assigned Numbers Authority (IANA).
(Note: This test is for tunnel mode)
TEST_REFERENCE
RFC 4302 s2.1 p5 Next Header
TEST_METHOD
- ANVL: Send an IPv6 Datagram from local host containing:
        - Payload of type <payLoad>
- ANVL: Listen for up to <ParamListenTime> for authenticated IPv6
        Datagram
-  DUT: Forward authenticated IPv6 Datagram
- ANVL: Verify that the received packet contains:
        - Next Header field of AH Header set to IPv6
        - Next Header field of inner IPv6 packet set to <payLoad>
 CASE: <payLoad> = ICMPv6
 CASE: <payLoad> = TCP
 CASE: <payLoad> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1247  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28887 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28887 usetime=28888 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1248  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1249  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1250  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1251  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1252  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[913] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[912] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[914] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[915] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: Send a plain IPv6 packet with Payload containing
ICMPv6 Data
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


Received Authenticated IPv6 Packet from DUT
on interface eth3 (3ffe:1111::1111)
Next Header field in AH Header of received Authenticated
packet is correctly set to 41 (IPv6)
Next Header field in Inner IPv6 Header of received Authenticated packet
is correctly set to 58 (ICMPV6)


Case 2: Send a plain IPv6 packet with Payload containing
TCP Data
Sending Unauthenticated TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 36 41 82 62 F3 02 57 BD E2 33 73 68               6A.b..W..3sh
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:


Received Authenticated IPv6 Packet from DUT
on interface eth3 (3ffe:1111::1111)
Next Header field in AH Header of received Authenticated
packet is correctly set to 41 (IPv6)
Next Header field in Inner IPv6 Header of received Authenticated packet
is correctly set to 6 (TCP)


Case 3: Send a plain IPv6 packet with Payload containing
UDP Data
Sending Unauthenticated UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6D 58 81 52 25 04 2B 7D 40 3D 48 16               mX.R%.+}@=H.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x2A8D (Correct)
UDP:


Received Authenticated IPv6 Packet from DUT
on interface eth3 (3ffe:1111::1111)
Next Header field in AH Header of received Authenticated
packet is correctly set to 41 (IPv6)
Next Header field in Inner IPv6 Header of received Authenticated packet
is correctly set to 17 (UDP)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-9.1: Passed

>> IPSECV6-AH-9.2
TEST_DESCRIPTION
The field must be an integral multiple of 32 bits in length.
TEST_REFERENCE
RFC 4302 s2.6 p9 Integrity Check Value(ICV)
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Remote Host containing
- ANVL: Listen for up to <ParamListenTime> for authenticated ICMPv6 Echo
        Request packet
-  DUT: Forward authenticated ICMPv6 Echo Request
- ANVL: Verify that AH header of received authenticated packet
        contains:
        - Authentication Data of length which is integral multiple
          of 32
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1253  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28890 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28890 usetime=28890 bytes=364
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1254  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1255  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1256  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1257  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1258  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[917] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[916] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[918] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[919] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received IPv6 packet with in outer IPv6 protocol: 51
on interface eth3 (3ffe:1111::1111) (Remote Host)

AH Header in received authenticated packet contains
authentication data correctly a multiple of 32 bits

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-9.2: Passed

>> IPSECV6-AH-10.1
TEST_DESCRIPTION
IPSec on a security gateway MUST decrement the Hop Limit field in the
inner IPv6 header
TEST_REFERENCE
RFC 4301 s5.1.2.2 p59 IPv6 - Header Construction for Tunnel mode
TEST_METHOD
- ANVL: Send an ICMPv6 Echo-request from Local Host to Remote Host
        through the DUT containing:
        - IPv6 Header containing:
          - Hop Limit field set to 64
- ANVL: Listen for up to <ParamListenTime> for authenticated packets
-  DUT: Forward the authenticated IPv6 datagram to Remote Host,
- ANVL: Verify that inner IPv6 Header in received authenticated
        packet contains:
        - Hop Limit field set to 63
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1259  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28892 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28892 usetime=28892 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1260  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1261  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1262  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1263  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1264  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[921] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[920] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[922] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[923] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Send an ICMPv6 Echo-request from Local Host to Remote Host
through the DUT containing:
- IPv6 Header containing:
  - Hop Limit field set to 64
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB803 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 63
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AD 36 F9 D8 F1 EA E3 E5 7F AB C6 8F               .6..........
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 63
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Hop Limit field in Inner IPv6 Header of received Authenticated packet
is correctly set to 63

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-10.1: Passed

>> IPSECV6-AH-10.2
TEST_DESCRIPTION
src and dest addresses depend on the SA, which is used to
determine the dest address which in turn determines which src
address (net interface) is used to forward the packet.
TEST_REFERENCE
RFC 4301 s5.1.2.2 p58 IPv6 - Header Construction for Tunnel mode
TEST_METHOD
- ANVL: Send an ICMPv6 Echo-request from Local Host to Remote Host
        through the DUT
- ANVL: Listen for up to <ParamListenTime> for authenticated packets
-  DUT: Forward the authenticated IPv6 datagram to Remote Host
- ANVL: Verify that received authenticated packet contains:
        - Outer IPv6 Header contains:
          - Source Address set to IPv6 Address of DUT Interface
            connected to Remote Host
          - Destination Address set to IPv6 Address of Remote Host
        - Inner IPv6 Header contains:
          - Source Address set to IPv6 Address of Local Host
          - Destination Address set to IPv6 Address of Remote Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1265  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28894 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28894 usetime=28895 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1266  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1267  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1268  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1269  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1270  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[925] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[924] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[926] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[927] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Send an ICMPv6 Echo-request from Local Host to Remote Host
through the DUT
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 Source Address in Outer IPv6 Header in received Authenticated packet is correctly set to 3ffe:1111::5555
IPv6 Destination Address in Outer IPv6 Header in received Authenticated packet is correctly set to 3ffe:1111::1111
IPv6 Source Address in Inner IPv6 Header in received Authenticated packet is correctly set to 3ffe:2222::1111
IPv6 Destination Address in Inner IPv6 Header in received Authenticated packet is correctly set to 3ffe:1111::1111

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-10.2: Passed

>> IPSECV6-AH-11.1
TEST_DESCRIPTION
If required, IP fragmentation occurs after AH processing within an
IPSec implementation.
TEST_REFERENCE
RFC 4302 s3.3.4 p17 Fragmentation
TEST_METHOD
- ANVL: Cause an application on the DUT side to forward an
        authenticated ICMPv6 Echo-request, using the transport protocol
        mode of size greater than <MTU-size>
- ANVL: Listen for up to <ParamListenTime> for two packets
-  DUT: Add the AH header and outer IPv6 packet in the original packet
        in tunnel mode and it will be more than that of <MTU-Size>.
        Fragment the ICMPv6 Echo Request into two parts and send the two
        fragmented packets
- ANVL: Verify the first part will contain:
        - AH Header after IPv6-Header
        - Fragment Header containing:
          - M flag set on
          - Fragment Offset set to 0
- ANVL: Verify the second part will contain:
        - Fragment Header containing:
          - M flag set off
          - Fragment Offset set to non-zero value
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1271  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28897 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28897 usetime=28897 bytes=128
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1272  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1273  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1274  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1275  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1276  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[929] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[928] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[930] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[931] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Configuring DUT to Send an ICMP Echo-Request to 3ffe:1111::1111

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 1470

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-dut-send-ping-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Listen For Two IPv6 Fragments 
Waiting (up to 10.000 seconds) for  IP Packet
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping6 -c Received Authenticated IPV6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1456 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = AH (51)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 3642666549
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED B0 71 8A 22 FB E8 F9 CF 0F 9B 5D               ..q."......]
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1470 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x40C8 *Should be 0xC81B*
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 46170
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [1462 bytes] ---
ICMPv6:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMPv6:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMPv6:  40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F   @ABCDEFGHIJKLMNO
ICMPv6:  50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F   PQRSTUVWXYZ[\]^_
ICMPv6:  60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F   `abcdefghijklmno
ICMPv6:  70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20   pqrstuvwxyz{|}~ 
ICMPv6:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ICMPv6:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ICMPv6:  41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50   ABCDEFGHIJKLMNOP
ICMPv6:  51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60   QRSTUVWXYZ[\]^_`
ICMPv6:  61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70   abcdefghijklmnop
ICMPv6:  71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21   qrstuvwxyz{|}~ !
ICMPv6:  22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31   "#$%&'()*+,-./01
ICMPv6:  32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41   23456789:;<=>?@A
ICMPv6:  42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51   BCDEFGHIJKLMNOPQ
ICMPv6:  52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61   RSTUVWXYZ[\]^_`a
ICMPv6:  62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71   bcdefghijklmnopq
ICMPv6:  72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22   rstuvwxyz{|}~ !"
ICMPv6:  23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32   #$%&'()*+,-./012
ICMPv6:  33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42   3456789:;<=>?@AB
ICMPv6:  43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52   CDEFGHIJKLMNOPQR
ICMPv6:  53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62   STUVWXYZ[\]^_`ab
ICMPv6:  63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72   cdefghijklmnopqr
ICMPv6:  73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23   stuvwxyz{|}~ !"#
ICMPv6:  24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33   $%&'()*+,-./0123
ICMPv6:  34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43   456789:;<=>?@ABC
ICMPv6:  44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53   DEFGHIJKLMNOPQRS
ICMPv6:  54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63   TUVWXYZ[\]^_`abc
ICMPv6:  64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73   defghijklmnopqrs
ICMPv6:  74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24   tuvwxyz{|}~ !"#$
ICMPv6:  25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34   %&'()*+,-./01234
ICMPv6:  35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44   56789:;<=>?@ABCD
ICMPv6:  45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54   EFGHIJKLMNOPQRST
ICMPv6:  55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64   UVWXYZ[\]^_`abcd
ICMPv6:  65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74   efghijklmnopqrst
ICMPv6:  75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25   uvwxyz{|}~ !"#$%
ICMPv6:  26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35   &'()*+,-./012345
ICMPv6:  36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45   6789:;<=>?@ABCDE
ICMPv6:  46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55   FGHIJKLMNOPQRSTU
ICMPv6:  56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65   VWXYZ[\]^_`abcde
ICMPv6:  66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75   fghijklmnopqrstu
ICMPv6:  76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26   vwxyz{|}~ !"#$%&
ICMPv6:  27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36   '()*+,-./0123456
ICMPv6:  37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46   789:;<=>?@ABCDEF
ICMPv6:  47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56   GHIJKLMNOPQRSTUV
ICMPv6:  57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66   WXYZ[\]^_`abcdef
ICMPv6:  67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76   ghijklmnopqrstuv
ICMPv6:  77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27   wxyz{|}~ !"#$%&'
ICMPv6:  28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37   ()*+,-./01234567
ICMPv6:  38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47   89:;<=>?@ABCDEFG
ICMPv6:  48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57   HIJKLMNOPQRSTUVW
ICMPv6:  58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67   XYZ[\]^_`abcdefg
ICMPv6:  68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77   hijklmnopqrstuvw
ICMPv6:  78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28   xyz{|}~ !"#$%&'(
ICMPv6:  29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38   )*+,-./012345678
ICMPv6:  39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48   9:;<=>?@ABCDEFGH
ICMPv6:  49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58   IJKLMNOPQRSTUVWX
ICMPv6:  59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68   YZ[\]^_`abcdefgh
ICMPv6:  69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78   ijklmnopqrstuvwx
ICMPv6:  79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29   yz{|}~ !"#$%&'()
ICMPv6:  2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39   *+,-./0123456789
ICMPv6:  3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49   :;<=>?@ABCDEFGHI
ICMPv6:  4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59   JKLMNOPQRSTUVWXY
ICMPv6:  5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69   Z[\]^_`abcdefghi
ICMPv6:  6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79   jklmnopqrstuvwxy
ICMPv6:  7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A   z{|}~ !"#$%&'()*
ICMPv6:  2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A   +,-./0123456789:
ICMPv6:  3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A   ;<=>?@ABCDEFGHIJ
ICMPv6:  4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A   KLMNOPQRSTUVWXYZ
ICMPv6:  5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A   [\]^_`abcdefghij
ICMPv6:  6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A   klmnopqrstuvwxyz
ICMPv6:  7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B   {|}~ !"#$%&'()*+
ICMPv6:  2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B   ,-./0123456789:;
ICMPv6:  3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B   <=>?@ABCDEFGHIJK
ICMPv6:  4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B   LMNOPQRSTUVWXYZ[
ICMPv6:  5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B   \]^_`abcdefghijk
ICMPv6:  6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B   lmnopqrstuvwxyz{
ICMPv6:  7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C   |}~ !"#$%&'()*+,
ICMPv6:  2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C   -./0123456789:;<
ICMPv6:  3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C   =>?@ABCDEFGHIJKL
ICMPv6:  4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C   MNOPQRSTUVWXYZ[\
ICMPv6:  5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C   ]^_`abcdefghijkl
ICMPv6:  6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C   mnopqrstuvwxyz{|
ICMPv6:  7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D   }~ !"#$%&'()*+,-
ICMPv6:  2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D   ./0123456789:;<=
ICMPv6:  3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D   >?@ABCDEFGHIJKLM
ICMPv6:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ICMPv6:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ICMPv6:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ICMPv6:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ICMPv6:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ICMPv6:  00 00 00 00 00 00                                 ......
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Authenticated IPV6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 94 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = AH (51)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 181 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 3642666549
IPv6: 
IPV6: --- Trailing Data [86 bytes] ---
IPV6:  4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D   NOPQRSTUVWXYZ[\]
IPV6:  5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D   ^_`abcdefghijklm
IPV6:  6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D   nopqrstuvwxyz{|}
IPV6:  7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E   ~ !"#$%&'()*+,-.
IPV6:  2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E   /0123456789:;<=>
IPV6:  3F 40 41 42 43 44                                 ?@ABCD
IPV6: --- Trailing Data End ---


Received first authenticated packet correctly contains
AH and IPv6 Header

Received first authenticated packet correctly contains
MF bit set on

Received first authenticated packet correctly
contains offset set to zero

Received second IPv6 packet correctly
contains MF bit set off

Received second IPv6 packet correctly
contains offset not set to zero
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
1 -S 3ffe:2222::5555 -s 1470 3ffe:1111::1111 

Pinging 3ffe:1111::1111 (3ffe:1111::1111) with 1470 bytes of data:

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1277  pid=0x63ca80
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28899 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x63ca80
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28899 usetime=28899 bytes=1574
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> 
--- 3ffe:1111::1111 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1017 ms
-> exit
Au revoir!
Connection closed by foreign host.
cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1278  pid=0x63ca80
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1279  pid=0x63ca80
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1280  pid=0x63ca80
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1281  pid=0x63ca80
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1282  pid=0x63ca80
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[933] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[932] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[934] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[935] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-11.1: Passed

>> IPSECV6-AH-12.2
TEST_DESCRIPTION
Lifetime of this Security Association:a time interval after
which an SA must be replaced with a new SA (and new SPI) or
terminated, plus an indication of which of these actions
should occur.  This may be expressed as a time or byte count,
or a simultaneous use of both, the first lifetime to expire
taking precedence.
(Note: This test is for Manual Mode SA and indication can not
 be sent in Manual mode)
TEST_REFERENCE
RFC 4301 s4.4.2.1 p36 Data items in SAD.
TEST_METHOD
 SETUP: Configure Lifetime Second for security association
        SA-1 on <DIface-0> as <LifeTimeSecond>
- ANVL: Send an authenticated ICMPv6 Echo Request from Remote Host
- ANVL: Listen for up to <ParamListenTime> on <DIface-1>
        for ICMPv6 Echo Request packet
-  DUT: Forward the ICMPv6 Echo Request packet to Local Host
- ANVL: Wait for up to <LifeTimeSecond> to expire the SA in DUT
-  DUT: Expire the Security Association SA-1
- ANVL: Send an authenticated ICMPv6 Echo Request from Remote Host
- ANVL: Listen for up to <ParamListenTime> on <DIface-1>
        for ICMPv6 Echo Request packet
-  DUT: Do not forward the ICMPv6 Echo Request packet
        to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1283  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=28901 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28901 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1284  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1285  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1286  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1287  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1288  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[937] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[936] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[938] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[939] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 120 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1289  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 2000 -lh 120 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=144  seq=1290  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=120 usetime=0 bytes=2000
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1291  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=28904 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=2000
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting 120 seconds to expire SA Lifetime
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received ICMPv6 Echo request from 3ffe:2222::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9F56 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Got ECHO Request, sending reply
! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

No Authenticated ICMPv6 Echo Request packet received on
interface DUT correctly did not forward ICMPv6 Echo Request packet
 (eth3) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=3  satype=NONE  len=16  seq=1293  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
Total of 0 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1294  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1295  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1296  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1297  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1298  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[944] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[943] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[945] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[946] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-12.2: Passed

>> IPSECV6-AH-13.1
TEST_DESCRIPTION
A compliant Host implementation MUST support IPsec(Transport mode)
between a pair of Hosts.
(Note: Both DUT and ANVL acting as Host)
TEST_REFERENCE
rfc 4301, s3.1, p8  What IPsec does
TEST_METHOD
- ANVL:  Send an authenticated ICMPv6 echo request to <DIface-0>
- ANVL:  Listen up to <ParamListenTime> for AH-authenticated ICMPv6
         echo reply.
-  DUT:  Send an authenticated echo reply
- ANVL:  Verify that the received packet is AH-authenticated.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1299  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29036 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29036 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1300  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1301  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1302  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1303  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1304  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[948] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[947] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[949] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[950] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
COMMAND_TYPE=6

IPSEC_MODE=0

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1305  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -ingress -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1306  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1307  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:1111::5555/128
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1308  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1309  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:1111::5555/128
 DSTFLOW: addr=3ffe:1111::1111/128
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[952] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[951] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[953] :: use src=3ffe:1111::1111/128:any dst=3ffe:1111::5555/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[954] :: use src=3ffe:1111::5555/128:any dst=3ffe:1111::1111/128:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to DUT virtual address 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000036 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 4A A6 48 2C 6B B6 FF 14 DA 5A 17 86               J.H,k....Z..
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A5 6C 97 0E 40 CC DB F6 C2 9E 17 6F               .l..@......o
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


Received Expected authenticated packet on interface 
eth3 (3ffe:1111::1111) 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:1111::5555
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TRANSPORT
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TRANSPORT

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1310  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29039 usetime=29045 bytes=88
     SA2: mode=transport reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29042 usetime=29043 bytes=184
     SA2: mode=transport reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1311  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -ingress -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1312  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1313  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:1111::5555/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1314  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=17  satype=AH  len=16  seq=1315  pid=0x5de180
   ERRNO: errno = 0x11 (17)
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[956] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[955] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[957] :: use src=3ffe:1111::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
Total of 3 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-13.1: Passed

>> IPSECV6-AH-13.2
TEST_DESCRIPTION
In Transport mode, AH is inserted after the IPv6 header and before the
next layer protocol.
(Note: This is basic test for Transport Mode)
TEST_REFERENCE
rfc 4302, s3.1.1, p18, Transport mode processing
TEST_METHOD
- ANVL: Send an AH-authenticated ICMPv6 Echo Request to DUT
-  DUT: Send back a AH-authenticated ICMPv6 Echo Reply.
- ANVL: Verify that the AH Header is placed in between the original IPv6
        header and the payload data.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1316  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29047 usetime=29047 bytes=272
     SA2: mode=transport reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29047 usetime=0 bytes=0
     SA2: mode=transport reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1317  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1318  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1319  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1320  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1321  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[959] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[958] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[960] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[961] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
COMMAND_TYPE=6

IPSEC_MODE=0

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1322  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -ingress -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1323  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1324  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:1111::5555/128
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1325  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1326  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:1111::5555/128
 DSTFLOW: addr=3ffe:1111::1111/128
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[963] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[962] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[964] :: use src=3ffe:1111::1111/128:any dst=3ffe:1111::5555/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[965] :: use src=3ffe:1111::5555/128:any dst=3ffe:1111::1111/128:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to DUT virtual address 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000037 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 98 8F E1 FA 86 B8 34 DA 54 A4 18 24               ......4.T..$
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A5 6C 97 0E 40 CC DB F6 C2 9E 17 6F               .l..@......o
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


AH Header in received packet is correctly placed after
IPv6 Header and before next layer protocol (ICMPv6)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:1111::5555
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TRANSPORT
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TRANSPORT

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1327  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29050 usetime=29055 bytes=88
     SA2: mode=transport reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29052 usetime=29054 bytes=184
     SA2: mode=transport reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1328  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -ingress -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1329  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1330  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:1111::5555/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1331  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=17  satype=AH  len=16  seq=1332  pid=0x625240
   ERRNO: errno = 0x11 (17)
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[967] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[966] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[968] :: use src=3ffe:1111::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
Total of 3 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-13.2: Passed

>> IPSECV6-AH-14.1
TEST_DESCRIPTION
In transport mode, the DSCP value might change en route, but this SHOULD
not cause problems with respect to IPsec processings - since the value
is not employed for SA selection and MUST NOT be checked as part of
SA/packet validation.
TEST_REFERENCE
rfc 4301 S4.1 p14 Definition and Scope
TEST_METHOD
- ANVL: Send an Authenticated-ICMPv6 echo request from <AIface-0> to
        <DIface-0> with DSCP field set to <DSCP>
- ANVL: Listen up to <ParamListenTime> for authenticated ICMPv6
        echo reply.
-  DUT: Send an authenticated echo reply to <AIface-0>
- CASE: <DSCP> = 0x28 (EXPRESS FWDing precedence)
- CASE: <DSCP> = 0x0C (stays for IP routing protocol)
- CASE: <DSCP> = 0  (Default case. Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1333  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29057 usetime=29058 bytes=272
     SA2: mode=transport reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29057 usetime=0 bytes=0
     SA2: mode=transport reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1334  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1335  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1336  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1337  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1338  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[970] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[969] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[971] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[972] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
COMMAND_TYPE=6

IPSEC_MODE=0

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1339  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -ingress -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1340  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1341  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:1111::5555/128
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1342  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1343  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:1111::5555/128
 DSTFLOW: addr=3ffe:1111::1111/128
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[974] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[973] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[975] :: use src=3ffe:1111::1111/128:any dst=3ffe:1111::5555/128:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[976] :: use src=3ffe:1111::5555/128:any dst=3ffe:1111::1111/128:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending an authenticated packet with DSCP field set to 0x28


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to DUT virtual address 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 160
IPv6:  |01234567
IPv6:  |101000..           = 40 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000038 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 6B 51 08 24 6F A6 4C B1 A8 85 46 83               kQ.$o.L...F.
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A5 6C 97 0E 40 CC DB F6 C2 9E 17 6F               .l..@......o
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected packet on interface eth3 (3ffe:1111::1111)


 Case: Sending an authenticated packet with DSCP field set to 0xC


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to DUT virtual address 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 48
IPv6:  |01234567
IPv6:  |001100..           = 12 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000039 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: A5 3D 14 0B AA 3F CB A6 AC 00 BF 31               .=...?.....1
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 93 7C 07 07 4A 18 87 48 67 51 83 B6               .|..J..HgQ..
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected packet on interface eth3 (3ffe:1111::1111)


 Case: Sending an authenticated packet with DSCP field set to 0x0


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to DUT virtual address 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x0000003A 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 89 74 ED 48 44 60 0E CB 99 B8 81 0B               .t.HD`......
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet
Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 58 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000004 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 93 01 52 4D ED 93 5A 73 91 21 AC 98               ..RM..Zs.!..
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected packet on interface eth3 (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:1111::5555
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TRANSPORT
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TRANSPORT

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1344  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29061 usetime=29066 bytes=264
     SA2: mode=transport reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29063 usetime=29065 bytes=360
     SA2: mode=transport reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1345  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -ingress -replay 32 
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1346  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1347  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:1111::5555/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1348  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=17  satype=AH  len=16  seq=1349  pid=0x625240
   ERRNO: errno = 0x11 (17)
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[978] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[977] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[979] :: use src=3ffe:1111::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
Total of 3 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-14.1: Passed

>> IPSECV6-AH-14.2
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the DS field from the inner IP
header to the outer IP header.
TEST_REFERENCE
RFC 4301 s5.1.2.2 p59 IPv6 header construction for tunnel mode
TEST_METHOD
- ANVL: Send ICMPv6 Echo Request from Local Host, with the DS field
        in the inner IP-Header set to <DSCP>
-  DUT: Forward authenticated ICMPv6 Echo Request to Remote Host
- ANVL: Verify that the DS field of the outer header is set to <ds>
- CASE: <DSCP> = 101110 (High Priority, Expedited Forwarding)
- CASE: <DSCP> = 001010 (Assured forwarding 11)
- CASE: <DSCP> = 000000 (Default case.Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1350  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29068 usetime=29069 bytes=272
     SA2: mode=transport reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29068 usetime=0 bytes=0
     SA2: mode=transport reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1351  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1352  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1353  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1354  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1355  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[981] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[980] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[982] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[983] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a plain packet with DSCP
field set to 0xB8
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 184
IPv6:  |01234567
IPv6:  |101110..           = 46 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 184
IPv6:  |01234567
IPv6:  |101110..           = 46 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: C2 E4 31 11 D4 4D 5A 82 68 4E E5 CA               ..1..MZ.hN..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 184
IPv6:  |01234567
IPv6:  |101110..           = 46 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received outer IP DSCP field: 0xB8
on interface eth3 (3ffe:1111::1111) (Remote Host) 


 Case: Sending a plain packet with DSCP
field set to 0x28
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 40
IPv6:  |01234567
IPv6:  |001010..           = 10 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 40
IPv6:  |01234567
IPv6:  |001010..           = 10 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: D7 E8 45 66 C7 26 CA 27 DA 92 F7 F4               ..Ef.&.'....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 40
IPv6:  |01234567
IPv6:  |001010..           = 10 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received outer IP DSCP field: 0x28
on interface eth3 (3ffe:1111::1111) (Remote Host) 


 Case: Sending a plain packet with DSCP
field set to 0x0
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000003 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 52 26 46 AA FD EA 78 AC 83 12 AE DA               R&F...x.....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received outer IP DSCP field: 0x0
on interface eth3 (3ffe:1111::1111) (Remote Host) 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-14.2: Passed

>> IPSECV6-AH-14.3
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the ECN field from 
the inner IP header to the outer IPv6 header.
(Note: This test is for tunnel mode, authenticator side)
TEST_REFERENCE
RFC 4301 s5.1.2.2 p59 IPv6 header construction for tunnel mode
IETF-proceedings-draft-ipsec-ecn-00.txt s3.1.3 p7 
TEST_METHOD
- ANVL: Send plain ICMPv6 Echo Request from Local Host to Remote host 
        through DUT containing:
        - ECT field set to <ECTInner>
-  DUT: Forward authenticated ICMPv6 Echo Request to Remote Host
- ANVL: Verify that the ECT & CE bit-field of the outer IP-header 
- CASE: <ECTInner> = 2 
- CASE: <ECTInner> = 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1356  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29071 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29071 usetime=29071 bytes=384
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1357  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1358  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1359  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1360  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1361  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[985] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[984] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[986] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[987] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a plain packet with ECNfield set to 2
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 11 36 54 AC 54 A4 69 3C 28 09 93 D5               .6T.T.i<(...
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received outer ECT bit field: 2
on interface eth3 (3ffe:1111::1111) (Remote Host) 


 Case: Sending a plain packet with ECNfield set to 0
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 88 0C BF 0B F9 F5 22 C4 77 EA 28 9D               ......".w.(.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received outer ECT bit field: 0
on interface eth3 (3ffe:1111::1111) (Remote Host) 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-14.3: Passed

>> IPSECV6-AH-16.1
TEST_DESCRIPTION
No valid SA exists for a session.The audit Log entry for this event
SHOULD include the SPI values, date/time received, source address and
destination address, sequence number.
(Note: Here we are doing this test only for SPI mismatch scenario. Can
be done for other parameter mis-match also)
TEST_REFERENCE
RFC 4302, s4, p21, Auditing
TEST_METHOD
- ANVL: Send an authenticated ICMPv6 echo request containing a SPI value
        that doesn't match the SPI entry of the established SA from
        remote host.
-  DUT: Don't forward this ICMPv6 echo request and LOG the error.
- ANVL: Verify that DUT has properly logged an error for incorrect SPI
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1362  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29073 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29073 usetime=29073 bytes=256
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1363  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1364  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1365  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1366  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1367  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[989] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[988] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[990] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[991] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending Authenticated IPv6 packet from interface eth3
(ANVL virtual address 3ffe:1111::1111) to interface eth4
(ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x0000030A 
AH: Sequence Number          = 0x0000003B 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: AA 78 5B 89 FA C3 68 07 BA 64 05 AE               .x[...h..d..
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111)
(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
778

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
DUT has correctly logged the SPI mismatch with bad SPI 0x30A

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-16.1: Passed

>> IPSECV6-AH-18.1
TEST_DESCRIPTION
To simplify the Next_Layer_Protocol, there SHOULD be a mechanism
for configuring which IPv6 extension headers to skip. The default
configuration SHOULD allow to skip when the IPv6 extension header
is "Hop by Hop options" (Next header code value is Zero).
TEST_REFERENCE
RFC 4301, s4.4.1.1, p27 Selectors(Next Layer Protocol)
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD: DISCARD packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header 
         between the IPv6 header and payload) to Remote host
         from Local host to Remote Host
-   DUT: Do not forward the packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Hop-by-Hop option" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         DISCARD it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: BYPASS packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from
         Local host
-   DUT: Forward the plain ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Hop-by-Hop option" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         BYPASS it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: APPLY IPsec on
         outgoing packets having next higher layer protocol is ICMPv6.
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from 
         Local host
-   DUT: Forward the AH-authenticated ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Hop-by-Hop option" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         APPLY IPsec on it according to the SPD.
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1368  pid=0x5b38d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29075 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5b38d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29075 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1369  pid=0x5b38d0
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1370  pid=0x5b38d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1371  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1372  pid=0x5b38d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1373  pid=0x5b38d0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[993] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[992] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[994] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[995] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 302 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1374  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1375  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=996
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[993] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[992] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[994] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[996] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Correctly no packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Hop-By-Hop Extended Header
Sending Unauthenticated IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Correctly no AH-authenticated packet received on
interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1376  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[993] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[992] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[994] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[997] :: bypass src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: BYPS
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet - with Hop-By-Hop header
Sending Unauthenticated IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1377  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[993] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[992] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[994] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[998] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected AH-authenticated packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Hop-By-Hop Extended Header
Sending Unauthenticated IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 96 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 79 5B 98 54 F2 34 D4 5E CB D9 1F 07               y[.T.4.^....
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected AH-authenticated packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-18.1: Passed

>> IPSECV6-AH-18.3
TEST_DESCRIPTION
To simplify the Next_Layer_Protocol, there SHOULD be a mechanism
for configuring which IPv6 extension headers to skip. The default
configuration SHOULD allow to skip when the IPv6 extension header
is "Destination Options" (Next header code value is 60).
TEST_REFERENCE
RFC 4301, s4.4.1.1, p27 Selectors(Next Layer Protocol)
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD: DISCARD packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from 
         Local host
-   DUT: Do not forward the packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Destination Options" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         DISCARD it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: BYPASS packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from
         Local host
-   DUT: Forward the plain ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Destination Options" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         BYPASS it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: APPLY IPsec on
         outgoing packets having next higher layer protocol is ICMPv6.
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from 
         Local host
-   DUT: Forward the AH-authenticated ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Destination Options" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         APPLY IPsec on it according to the SPD.
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 NOT_CONFIGURED 66306630663066306630663066302222 768 770 MD5 DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-ah-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ENCRYPTED_DIFACE:3ffe:1111::5555
UNENCRYPTED_DIFACE:3ffe:2222::5555
UNENCRYPTED_DIFACE_MASK:64
ENCRYPTED_SESSION_ENDPOINT :3ffe:1111::1111
ENCRYPTED_SESSION_STARTPOINT:3ffe:2222::1111
ENCRYPTED_DIFACE_INDEX:0
ENCRYPTED_DIFACE:3ffe:1111::5555
ISAKMP_HASHING_ALGO:MD5
ISAKMP_GROUP:MODP768
AUTO_AUTH_ALGO:HMAC_MD5
MANUAL_AUTH_ALGO:HMAC_MD5_96
AUTH_METHOD:PRESHARED-KEY
AUTH_KEY:66306630663066306630663066302222
ANVL_SPI:768
DUT_SPI:770
IPSEC_MODE:TUNNEL
IPSEC_CONFIGURATION:MANUAL
ENCRYPTED_DIFACE_MASK=64

IPSEC_MODE=TUNNEL

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=1378  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=29087 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=AH  len=184  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=29087 usetime=29108 bytes=264
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1379  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1380  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1381  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm add -proto ah -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=AH  len=112  seq=1382  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto ah -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=272  seq=1383  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1000] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[999] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1001] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1002] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto ah -spi 302 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=AH  len=192  seq=1384  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=296  seq=1385  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1003
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[1000] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[999] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1001] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1003] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Correctly no packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Destination Options Header
Sending Unauthenticated IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly no packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=1386  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[1000] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[999] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1001] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1004] :: bypass src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: BYPS
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Destination Options Header
Sending Unauthenticated IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-authenticated IPv6 packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-AH/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto ah -transport 0 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow 3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=AH  len=280  seq=1387  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[1000] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[999] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1001] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: AH   spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1005] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: AH   spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending Unauthenticated ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000001 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: ED 03 38 ED A6 6C 11 F4 98 CC 6E 74               ..8..l....nt
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected AH-authenticated packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Destination Option Extended Header
Sending Unauthenticated IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Authenticated IPv6 Packet

Received authenticated IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 96 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000302 
AH: Sequence Number          = 0x00000002 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 7F 8E 5F F5 A5 09 0D 6C CE 78 19 57               .._....l.x.W
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected AH-authenticated packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-AH-18.3: Passed
Executing system command:
  "./DocScriptQ35/IPSECV6-AH/IPSECV6AHpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "0"
sysvar: ipnet.inet.AcceptSourceRoute=0 ok
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1388  pid=0x5de180
------------------------------------------
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          58
Number of tests passed:       58
Number of tests failed:       0
Number of tests inconclusive: 0
