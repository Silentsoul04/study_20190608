ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6705756 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlrip rip 1-2 3.2 3.4-6.6 7-10.1 10.3-15 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlrip.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           "./DocScriptQ35/RIP/reboot-command.exp $ANVL_DUTHOSTNAME"
Post suite Command                       "./DocScriptQ35/RIP/RIPpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
RIP Suite Setup Command                  "./DocScriptQ35/RIP/rip-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Flush Routes Command                 "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
RIP Version                              2-Broadcast
RIP DUT Supports all Versions            True
RIP Host Routes Accepted                 False
RIP Default Route Supported              True
RIP Poison Reverse Supported             True
RIP Default Route Enable Command         "./DocScriptQ35/RIP/rip-default-route-enable-command.exp $ANVL_DUTHOSTNAME"
RIP Default Route Disable Command        "./DocScriptQ35/RIP/rip-default-route-disable-command.exp $ANVL_DUTHOSTNAME"
RIP Compatibility Send Command           "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Compatibility Receive Command        "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Set Authentication Command           "./DocScriptQ35/RIP/rip-set-authentication-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Reset Authentication Command         "./DocScriptQ35/RIP/rip-reset-authentication-command.exp $ANVL_DUTHOSTNAME"
RIP Router List Command                  "./DocScriptQ35/RIP/rip-router-list-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Poison Reverse Command               "./DocScriptQ35/RIP/rip-poison-reverse-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Reset Router List Command            "./DocScriptQ35/RIP/rip-reset-router-list-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Set Host Route Command               "./DocScriptQ35/RIP/rip-set-host-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Static Route Add Command             "./DocScriptQ35/RIP/rip-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Static Route Delete Command          "./DocScriptQ35/RIP/rip-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Tolerance Factor                     1                   # (0x00000001)
RIP Tolerance Time                       10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlrip.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        
IP First Unused Net                      50.0.0.0
IP Number Unused Nets                    100                 # (0x00000064)
IP Unused Net Mask                       255.0.0.0

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255
  IP First Unused Address                  30.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255
  IP First Unused Address                  40.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

# Configuration File End.
%% VALIDATE PRM GLOBAL WARNING: 
The DUT supports RIP Poison Reverse;
therefore the following tests will not be run: 8.17 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.0 40.1.1.0 3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask 255.255.255.0 up
-> cmd ripctrl ifclose gei0
The IPRIP daemon is not running
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2 nopoison 
The IPRIP daemon is not running
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask 255.255.255.0 up
-> cmd ripctrl ifclose gei1
The IPRIP daemon is not running
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 nopoison 
The IPRIP daemon is not running
-> cmd ipd kill iprip
ipd: kill iprip failed: not started
-> cmd sysvar get iprip.drop.hostroute 
sysvar: iprip.drop.hostroute=0
-> cmd sysvar set -co iprip.drop.hostroute "1"
sysvar: iprip.drop.hostroute=1 ok
-> cmd ipd start iprip
ipd: start iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

00:1B:21:7D:57:BA < 00:15:17:C8:90:28 ARP Rsp 30.1.1.150

Device Under Test found at 30.1.1.5 as 00:15:17:C8:90:28
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
RFC 2453:  'RIP Version 2'
(G. Malkin, Bay Networks, November 1998)

ANVL Test Suite Required Setup:
This suite expects to be running against an IP router that is set up
to accept and advertise RIP routes.   There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.  All tests require at least one interface to be
configured and connected to the machine running ANVL.  Some of the
tests require two interfaces.  Some of the tests require RIP v2 to be
implemented.  Some of the tests require support for setting the
version Compatibility Switch ('RIP Version 2', RFC 2453,
Page 34, Section 5.1.)

This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> RIP-1.1
TEST_DESCRIPTION
Each router that uses RIP has a routing process that sends
datagrams on UDP port number 520.
TEST_REFERENCE
RFC 2453 s3.6 p20 Message Format
TEST_METHOD
- ANVL: Send RIP request to DUT from unused port
-  DUT: Send update message to ANVL
- ANVL: Verify that received RIP message contains:
        - Source UDP port set to 520
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Sending request from port 16338
Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16338

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3C1C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16338 (16338)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Saw UDP packet from port 520 to port 16338
Received RIP v2 Response from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x17FF (6143)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x240A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16338 (16338)
UDP: Length           = 52 
UDP: Checksum         = 0xF216 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received response with source port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-1.1: Passed

>> RIP-1.2
TEST_DESCRIPTION
Unsolicited routing update messages have both source and destination
port equal to the RIP port (UDP port number 520).
TEST_REFERENCE
RFC 2453 s3.6 p20 Message Format
TEST_METHOD
-  DUT: Broadcast routing update every 30 seconds
- ANVL: Verify that source and destination ports are 520
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x8C2C (35884)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2E6A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x6F6E (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Source and destination ports in RIP Response are both 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-1.2: Passed

>> RIP-1.3
TEST_DESCRIPTION
Update messages sent in response to a request are sent to the port from which the request came.
TEST_REFERENCE
RFC 2453 s3.6 p20 Message Format
TEST_METHOD
- ANVL: Send RIP request to DUT from a port not equal to 520
-  DUT: Send update message to ANVL
- ANVL: Verify that message was sent back to port it originated from
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0002 (2)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3C1B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x1800 (6144)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2409 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xF215 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

RIP Response was sent to port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-1.3: Passed

>> RIP-2.1
TEST_DESCRIPTION
There may be between 1 and 25 (inclusive) RIP entries.
Recall that there is a limit of 25 RTEs to a Response.
TEST_REFERENCE
NEGATIVE:
RFC 2453 s3.6 p21 Message Format
RFC 2453 s3.10.2 p30 Generating Response Messages
TEST_METHOD
- ANVL: Send datagram with 26 tuples to DUT
-  DUT: Do not accept packet
- ANVL: Send RIP request to DUT
-  DUT: Return unchanged routing table
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending RIP update with 26 routes
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 552 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x392C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 532 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 51.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 52.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 53.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 54.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 55.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 56.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 57.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 58.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 59.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 60.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 61.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 62.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 63.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 64.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 16 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 65.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 17 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 66.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 18 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 67.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 19 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 68.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 20 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 69.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 21 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 70.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 22 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 71.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 23 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 72.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 24 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 73.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 25 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 74.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 26 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 75.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2819 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x4D42 (19778)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDAC6 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 52 
UDP: Checksum         = 0xD414 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Device under test rejected RIP update with 26 routes

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-2.1: Passed

>> RIP-2.2
TEST_DESCRIPTION
The RIP Message Format is:

   0                   1                   2                   3    
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1  
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  command (1)  |  version (1)  |       must be zero (2)        |
   +---------------+---------------+-------------------------------+
   |                                                               |
   ~                         RIP Entry (20)                        ~
   |                                                               |
   +---------------+---------------+---------------+---------------+

There may be between 1 and 25 (inclusive) RIP entries.
(NOTE: Here we are testing that only valid RIP packets may be
accepted.)
TEST_REFERENCE
NEGATIVE:
RFC 2453 s4 p31 Protocol Extensions
RFC 2453 s3.6 p20-21 Message Format
TEST_METHOD
- ANVL: Send RIP updates with invalid formats to DUT
-  DUT: Reject invalid RIP updates
- CASE: Truncated RIP tuple (invalid)
- CASE: Trailing junk on RIP packet (invalid)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending invalid update with truncated tuple
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 45 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B25 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 25 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP: --- Truncated Tuple [13 bytes] ---
RIP:  00 02 00 00 4C 00 00 00 00 00 00 00 00            ....L........
RIP: --- Truncated Tuple End ---
RIP: ---- End RIP Packet ----
RIP:
ETHER: --- Padding [1 bytes] ---
ETHER:  00                                                .
ETHER: --- Padding End ---

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2817 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x4D43 (19779)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDAC5 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Device under test rejected invalid update

Sending invalid update with extra trailing junk
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 63 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B11 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 43 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 77.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: --- Truncated Tuple [11 bytes] ---
RIP:  36 2E 32 20 31 36 2E 35 00 5F 31                  6.2 16.5._1
RIP: --- Truncated Tuple End ---
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2815 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x48DE (18654)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDF2A (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Device under test rejected invalid update
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-2.2: Passed

>> RIP-2.3
TEST_DESCRIPTION
The commands implemented in version 1 and 2 are request and response
TEST_REFERENCE
NEGATIVE:
RFC 2453 s3.1 p21 Message Format
TEST_METHOD
- ANVL: Send RIP packets with invalid command values
-  DUT: Do not accept routes in invalid packets
- CASE: Command = 0x03 (traceon)
- CASE: Command = 0x04 (traceoff)
- CASE: Command = 0x00 (reserved)
- CASE: Command = 0xfa (unknown)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending RIP packet with command 0x03
Sending RIPv2 bogus cmd to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Trace On (0x03)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 78.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT did not respond

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2813 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x48DF (18655)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDF29 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Routing table has not changed

Sending RIP packet with command 0x04
Sending RIPv2 bogus cmd to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B18 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Trace Off (0x04)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 79.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT did not respond

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2811 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x7E81 (32385)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA987 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Routing table has not changed

Sending RIP packet with command 0x00
Sending RIPv2 bogus cmd to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B16 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = UNKNOWN (0x00)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 80.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT did not respond

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x280F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x7E82 (32386)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA986 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Routing table has not changed

Sending RIP packet with command 0xFA
Sending RIPv2 bogus cmd to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B14 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = UNKNOWN (0xFA)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 81.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT did not respond

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x280D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x4ACC (19148)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDD3C (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Routing table has not changed

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-2.3: Passed

>> RIP-2.4
TEST_DESCRIPTION
For RIP-1, only AF_INET (2) is generally supported.
TEST_REFERENCE
NEGATIVE
RFC 2453 s3.6 p21 Message Format
TEST_METHOD
- ANVL: Send RIP updates with invalid address family identifiers
-  DUT: Do not accept packets
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending update with invalid address family identifier 0xFFFF
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B12 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Unknown (0x0000)
RIP: Authentication = ASCII: R...............
RIP:                    HEX: 52 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02  
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT rejected update with invalid identifier

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x280B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x4ACD (19149)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDD3B (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT did not accept route with invalid address family identifier 0xFFFF

Sending update with invalid address family identifier 0x00
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B10 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 83.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
DUT rejected update with invalid identifier

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2809 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xB14D (45389)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x76BB (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT did not accept route with invalid address family identifier 0x0

Sending update with invalid address family identifier 0x01
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = UNKNOWN (0x0001)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 84.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT rejected update with invalid identifier

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2807 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xB14E (45390)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x76BA (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT did not accept route with invalid address family identifier 0x1

Sending update with invalid address family identifier 0xFA77
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0017 (23)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = UNKNOWN (0xFA77)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 85.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT rejected update with invalid identifier

Making sure the routing table has not been changed
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2805 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x6BFB (27643)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xBC0D (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT did not accept route with invalid address family identifier 0xFA77

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-2.4: Passed

>> RIP-2.5
TEST_DESCRIPTION
The metric field contains a value between 1 and 15 (inclusive)
which specifies the current metric for the destination; or
the value 16, which indicates that the destination is not reachable.
TEST_REFERENCE
NEGATIVE:
RFC 2453 p21 Message Format
TEST_METHOD
- ANVL: Send update with metric outside of the range 1 to 16
-  DUT: Do not accept packet
- CASE: Metric = 17, 0, 0xffffffff, 0x99e7, 25
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending update with invalid metric 0x11 in first tuple
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B0A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 86.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 17 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2803 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x6BFC (27644)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xBC0C (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid metric

Sending update with invalid metric 0x00 in first tuple
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B08 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 87.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 0 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2801 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0D0E (3342)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x1AFB (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid metric

Sending update with invalid metric 0xFFFFFFFF in first tuple
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B06 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 88.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 4294967295 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27FF (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0D0F (3343)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x1AFA (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid metric

Sending update with invalid metric 0x99E7 in first tuple
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B04 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 89.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 39399 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27FD (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xFFDE (65502)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x282A (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid metric

Sending update with invalid metric 0x19 in first tuple
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B02 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 90.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 25 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27FB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xFFDF (65503)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2829 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid metric

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-2.5: Passed

>> RIP-2.8
TEST_DESCRIPTION
The RIP Response Message Format is:

   0                   1                   2                   3    
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1  
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  command (1)  |  version (1)  |       must be zero (2)        |
   +---------------+---------------+-------------------------------+
   |                                                               |
   ~                         RIP Entry (20)                        ~
   |                                                               |
   +---------------+---------------+---------------+---------------+

There may be between 1 and 25 (inclusive) RIP entries.
TEST_REFERENCE
RFC 2453 s3.6 p20 Message Format
RFC 2453 s4 p31 Protocol Extensions
TEST_METHOD
-  DUT: Broadcast routing update every 30 seconds
- ANVL: Validate fields:
        Command          2 (Response)
        Version          1 or 2
        2 bytes must be zero
        Data             multiple of 20 bytes, at least one tuple but
                         no more than 25 tuples
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xC1B0 (49584)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF8E5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x6F6E (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Validating fields

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-2.8: Passed

>> RIP-3.2
TEST_DESCRIPTION
The destinations appearing in request and response messages can be
networks, hosts, or a special code used to indicate a default address.
Normally hosts only know the subnet masks for directly-connected
networks.
(NOTE: Here we are testing the DUT does not accept bad values in
address fields.)
TEST_REFERENCE
NEGATIVE:
RFC 2453 s3.7 p22-23 Addressing considerations
TEST_METHOD
- ANVL: Send route for bogus address to DUT
-  DUT: Do not accept route
- CASE: Route = 240.0.0.0
- CASE: Route = 255.255.255.255
- CASE: Route = 224.0.0.0
- CASE: Route = 0.51.0.0
- CASE: Route = 127.0.0.1
- CASE: Route = 127.51.0.0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending update for invalid address 240.0.0.0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B00 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 240.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27F9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x85DE (34270)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA22A (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid address

Sending update for invalid address 255.255.255.255
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 255.255.255.255
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27F7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x85DF (34271)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA229 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid address

Sending update for invalid address 224.0.0.0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 224.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27F5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x28EA (10474)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xFF1E (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid address

Sending update for invalid address 0.51.0.0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.51.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27F3 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x28EB (10475)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xFF1D (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid address

Sending update for invalid address 127.0.0.1
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 127.0.0.1
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27F1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x61B1 (25009)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xC657 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid address

Sending update for invalid address 127.51.0.0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 127.51.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27EF (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x61B2 (25010)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xC656 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with invalid address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-3.2: Passed

>> RIP-3.5
TEST_DESCRIPTION
These routers should create RIP entries for the address 0.0.0.0,
just as if it were a network to which they are connected.  The
decision as to how routers create entries for 0.0.0.0 is left to
the implementor. Most commonly, the system administrator will be
provided with a way to specify which routers should create entries
for 0.0.0.0
TEST_REFERENCE
RFC 2453 s3.7 p23 Addressing Considerations
TEST_METHOD
-SETUP: Configure DUT with a default route
-  DUT: Send regular update every 30 seconds
- ANVL: Verify received RIP Response contains:
          RTE contains:
             IPv4 address field set to 0.0.0.0
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Configuring DUT to advertise default routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-default-route-enable-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl rtadd 0.0.0.0 0.0.0.0 128.224.167.2
Adding static RIP route: 0.0.0.0/0.0.0.0 -> 128.224.167.2, metric 1, tag 0
   ok
-> exit
Au revoir!
Connection closed by foreign host.
Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x3231 (12849)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x8879 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0xDB83 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT currently has default route with metric 1
IPv4 address field is correctly set to 0.0.0.0
Configuring DUT to not advertise default routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-default-route-disable-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl rtdelete 0.0.0.0 0.0.0.0 128.224.167.2
Deleting static RIP route: 0.0.0.0/0.0.0.0 -> 128.224.167.2, metric 0, tag 0
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Waiting (up to 310.000 seconds) for Route expiration and Garbage-Collection timer
 to expire on the DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-3.5: Passed

>> RIP-4.3
TEST_DESCRIPTION
Route expiration timer should be 180 seconds and garbage collection
timer should be 120 seconds.
TEST_REFERENCE
RFC 2453 s3.8 p24 Timers
TEST_METHOD
- ANVL: Send update for new route
-  DUT: Send update including new route
- ANVL: Wait 180 seconds
-  DUT: Send update with new route marked as unreachable
- ANVL: Wait 120 seconds
-  DUT: Send update with new route missing
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Advertising new route to 91.0.0.0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AF4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 91.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27ED (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 10.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x856D (34157)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA287 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x50E1 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 91.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT returned route with metric 3
Waiting for 180 seconds for route to expire 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27EC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 10.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x0D0C (3340)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x1AE9 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x50D4 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 91.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT returned route with metric 16
Waiting for 120 seconds for route to be deleted

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27EB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 10.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x69A2 (27042)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xBE52 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x50D4 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 91.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27EA (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 10.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x69A3 (27043)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xBE65 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 52 
UDP: Checksum         = 0xD415 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Route has been deleted

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-4.3: Passed

>> RIP-4.4
TEST_DESCRIPTION
The garbage-collection timer is reset upon the reception of
a new route to an unreachable network.
TEST_REFERENCE
RFC 2453 s3.8 p23-24 Timers
TEST_METHOD
- ANVL: Send update for new route
- ANVL: Wait 180 + 60 seconds
-  DUT: Send update with new route marked as unreachable
- ANVL: Send an update for a new route to the network
-  DUT: Time out route as if new
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Advertising new route
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AEF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Waiting for 240 seconds for route to go into garbage-collection
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27E8 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 10.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x23D4 (9172)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0421 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x4FD4 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT correctly set metric to 16 for route 92.0.0.0
Advertising new route again
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27E6 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 10.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x2FC6 (12230)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF82E (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x4FE1 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT properly reset metric for route 92.0.0.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-4.4: Passed

>> RIP-5.1
TEST_DESCRIPTION
RIP messages of version 0 are to be discarded.
TEST_REFERENCE
RFC 2453 s5 p34 Compatability
TEST_METHOD
- ANVL: Send datagram with version set to 0
-  DUT: Do not accept update
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending RIP response with version 0
Sending RIPv0 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AEB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 0
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 93.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27E4 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x2FC7 (12231)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF82D (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x4FE1 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected version 0 response packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-5.1: Passed

>> RIP-5.2
TEST_DESCRIPTION
RIP messages of version 1 are to be discarded if any Must Be Zero
(MBZ) field is non-zero.
TEST_REFERENCE
RFC 2453 s5 p34 Compatability
TEST_METHOD
- ANVL: Send version 1 datagram with MBZ fields filled
-  DUT: Do not accept update
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending RIP response with bogus header ('must be zero' of 1)
Sending RIPv1 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0001 *Should be 0*
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 94.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27E2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0xF24E (62030)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x35A6 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x4FE1 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected update with bogus header

Sending RIP response with bogus header ('must be zero' of 17)
Sending RIPv1 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0011 *Should be 0*
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 95.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27E0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0xF24F (62031)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x35A5 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 72 
UDP: Checksum         = 0x4FE1 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected update with bogus header

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-5.2: Passed

>> RIP-5.3
TEST_DESCRIPTION
RIP messages of any version greater than 1 should not be discarded
simply because an MBZ field contains a value other than zero.
TEST_REFERENCE
RFC 2453 s5 p34 Compatability
TEST_METHOD
- ANVL: Send version 2 datagram with MBZ fields filled
-  DUT: Accept update
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Sending RIP v2 update with MBZ field filled
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0xFD8D 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27DE (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0xC60D (50701)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x61D3 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 92 
UDP: Checksum         = 0xC7A9 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted update with MBZ field 0xFD8D
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-5.3: Passed

>> RIP-6.1
TEST_DESCRIPTION
Normally, Requests are sent as broadcasts, from the RIP port, by
routers which have just come up and are seeking to fill in their
routing tables as quickly as possible.  However, there may be
situations (e.g., router monitoring) where the routing table of
only a single router is needed.  In this case, the Request should
be sent directly to that router from a UDP port other than the
RIP port.  If such a Request is received, the router responds
directly to the requestor's address and port.
TEST_REFERENCE
RFC 2453 s3.9.1 p25 Request Messages
TEST_METHOD
- ANVL: Send RIP request to DUT
-  DUT: Send RIP response
- CASE: Broadcast request, source port equal to 520
- CASE: Directed request, source port not equal to 520
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


CASE : Sending broadcast request from port 520
Sending RIPv2 Request to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AE3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 97.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0xA3EE (41966)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x97F2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 92 
UDP: Checksum         = 0x363C (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:


CASE : Sending request to DUT's address (30.1.1.5) from port not equal
        to 520 (16339)
Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16339

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BDC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16339 (16339)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 97.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Saw UDP packet from port 520 to port 16339
Received RIP v2 Response from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0xA3EF (41967)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x97F1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16339 (16339)
UDP: Length           = 92 
UDP: Checksum         = 0xF870 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-6.1: Passed

>> RIP-6.5
TEST_DESCRIPTION
If there is exactly one entry in the request, and it has an address
family identifier of zero and a metric of infinity (i.e., 16), then
this is a request to send the entire routing table.
TEST_REFERENCE
NEGATIVE:
RFC 2453 s3.9.1 p25 Request Messages
TEST_METHOD
- ANVL: Send invalid requests
-  DUT: Ignore invalid requests
- CASE: Address family identifier = 0 and metric not equal to 16 (invalid)
- CASE: Two valid tuples (invalid)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Sending invalid request for routing table (metric 15)
Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BDB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 15 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT rejected invalid request
Sending invalid request for routing table (2 tuples)
Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BC6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
DUT rejected invalid request

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-6.5: Passed

>> RIP-6.6
TEST_DESCRIPTION
Validate RIP Response Message in reply to Request Message.
TEST_REFERENCE
RFC 2453 s3.9.1 p25 Request Messages
TEST_METHOD
- ANVL: Send general RIP Request to DUT
-  DUT: Send RIP Response
- ANVL: Validate fields:
        Command          2 (Response)
        Version          1 or 2
        2 bytes must be zero
        Data             multiple of 20 bytes, at least one tuple but
                         no more than 25 tuples
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Sending request from port 16340
Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BD9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0xA27D (41597)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9963 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 92 
UDP: Checksum         = 0xF86F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Validating fields

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-6.6: Passed

>> RIP-7.1
TEST_DESCRIPTION
The Response must be ignored if it is not from the RIP port.
(UDP Port 520).
TEST_REFERENCE
RFC 2453 s3.9.2 p26 Response Messages
TEST_METHOD
- ANVL: Send response packet with route from port not equal to 520
-  DUT: Do not add route to routing table
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending response from port 16340
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ADE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 98.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16341

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27D7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16341 (16341)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16341
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0xE674 (58996)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x416C (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16341 (16341)
UDP: Length           = 92 
UDP: Checksum         = 0xC79A (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected response packet from port not equal to 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.1: Passed

>> RIP-7.2
TEST_DESCRIPTION
The datagram's IPv4 source address should be checked to see whether
the datagram is from a valid neighbor
TEST_REFERENCE
NEGATIVE:
RFC 2453 s3.9.2 p26 Response Messages
TEST_METHOD
- ANVL: Send response packet from bogus network
-  DUT: Do not accept packet
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending RIP response from non-local network 31.1.1.150
Sending RIPv2 Response to 30.1.1.255 port 520 from 31.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39DC (Correct)
IP: Source Address         = 31.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 99.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27D5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0xE675 (58997)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x416B (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 92 
UDP: Checksum         = 0xC79B (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected update from non-local network

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.2: Passed

>> RIP-7.3
TEST_DESCRIPTION
It is also worth checking to see whether the response is from one of
the router's own addresses.  Interfaces on broadcast networks may
receive copies of their own broadcasts/multicasts immediately.  If
a router processes its own output as new input, confusion is likely
so such datagrams must be ignored.
TEST_REFERENCE
NEGATIVE:
RFC 2453 s3.9.2 p26 Response Messages
TEST_METHOD
- ANVL: Send response packet from DUT's address
-  DUT: Do not add route to routing table
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending RIP response from DUT's IP address (30.1.1.5)
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.5 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B6B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 100.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27D3 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0x5678 (22136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD168 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 92 
UDP: Checksum         = 0xC791 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected update from DUT's IP address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.3: Passed

>> RIP-7.9
TEST_DESCRIPTION
Set the command to Response.  Set the bytes labeled "must be zero"
to zero.
RIP messages of version 1 are to be discarded if any Must Be Zero
(MBZ) field is non-zero
NEGATIVE:
RFC 2453 s3.10.2  p30 Generating Response Messages
TEST_REFERENCE
RFC 2453 s5 p34 Compatibility
TEST_METHOD
- ANVL: Send version 1 datagram with Must Be Zero (MBZ) subnet mask
        field filled
-  DUT: Do not accept response
- ANVL: Send version 1 datagram with MBZ next hop field filled
-  DUT: Do not accept response
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending route with subnet mask filled
Sending RIPv1 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 101.0.0.0
RIP: Unused         = 0xFFFFFF00 *Should be 0*
RIP: Unused         = 0x00000000 
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27D1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0x5679 (22137)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD167 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 92 
UDP: Checksum         = 0xC791 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with subnet mask filled

Sending route with next hop field filled
Sending RIPv1 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 101.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000008 *Should be 0*
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27CF (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0x6FF8 (28664)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB7E8 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 92 
UDP: Checksum         = 0xC791 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 92.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT rejected route with next hop filled

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.9: Passed

>> RIP-7.10
TEST_DESCRIPTION
Once the entry has been validated, update the metric by adding the
cost of the network on which the message arrived.  If the result is
greater than infinity, use infinity.  That is,
metric = MIN (metric + cost, infinity)
TEST_REFERENCE
RFC 2453  s3.4.2 p27 Response Messages
TEST_METHOD
- ANVL: Send response containing various metrics
-  DUT: Reject out of bounds metrics and max others to 16
- ANVL: Verify math in resulting routing table
- CASE: Metric = 1, 6, 13, 15, 16, 17, 271 (0x010F), 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Advertising route with metric 1
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xAC38 (44088)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0E72 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x75E2 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27CD (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0x8831 (34865)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9FAF (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 92 
UDP: Checksum         = 0xBD9F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Advertised route was added with metric 2
ANVL Expected a route with metric 2

Advertising route with metric 6
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x3E0F (15887)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7C9B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x74E2 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27CB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 132 bytes
IP: Identification         = 0x8799 (34713)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA033 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 112 
UDP: Checksum         = 0x2E67 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Advertised route was added with metric 7
ANVL Expected a route with metric 7

Advertising route with metric 13
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AD0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 13 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0DCD (3533)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xACDD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x73E2 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27C9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 152 bytes
IP: Identification         = 0x5592 (21906)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD226 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 132 
UDP: Checksum         = 0x9E27 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Advertised route was added with metric 14
ANVL Expected a route with metric 14

Advertising route with metric 15
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 105.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 15 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27C7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 152 bytes
IP: Identification         = 0x5593 (21907)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD225 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 132 
UDP: Checksum         = 0x9E27 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Advertised route with metric 15 was not accepted

Advertising route with metric 16
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 106.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 152 bytes
IP: Identification         = 0x0DD3 (3539)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xAC73 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 132 
UDP: Checksum         = 0x5F24 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27C5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 152 bytes
IP: Identification         = 0x5594 (21908)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD224 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 132 
UDP: Checksum         = 0x9E27 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Advertised route with metric 16 was not accepted

Advertising route with metric 17
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ACA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 107.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 17 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27C3 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 152 bytes
IP: Identification         = 0x3571 (13681)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF247 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 132 
UDP: Checksum         = 0x9E27 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 96.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Advertised route with metric 17 was not accepted

Advertising route with metric 271
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AC8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 108.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 271 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 132 bytes
IP: Identification         = 0x03E3 (995)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB677 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 112 
UDP: Checksum         = 0xDDF6 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27C1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 132 bytes
IP: Identification         = 0x3572 (13682)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF25A (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 112 
UDP: Checksum         = 0x2669 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Advertised route with metric 271 was not accepted
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.10: Passed

>> RIP-7.12
TEST_DESCRIPTION
If there is no such route, add this route to the routing table,
unless the metric is infinity (there is no point in adding a route
which is unusable).
TEST_REFERENCE
RFC 2453 s3.9.2 p27 Response Messages
TEST_METHOD
- ANVL: Send update for a route with metric 16
-  DUT: Send next regular update without that route
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending update for new route with infinite metric
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AC6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 109.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27BF (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 132 bytes
IP: Identification         = 0x4608 (17928)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xE1C4 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 112 
UDP: Checksum         = 0x2669 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT did not accept update for new route

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.12: Passed

>> RIP-7.13
TEST_DESCRIPTION
If the new metric is infinity, start the deletion process
TEST_REFERENCE
RFC 2453 s3.9.2 p28 Response Messages
TEST_METHOD
- ANVL: Advertise route with metric < 16
-  DUT: Accept new route
- ANVL: Send update with metric 16 for existing route
-  DUT: Send update with metric 16 for that route
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Advertising route to 110.0.0.0 with metric 3
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AC4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xDB71 (56177)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDF38 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x6DE2 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Sending RIP request to query new route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27BD (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 152 bytes
IP: Identification         = 0x4E00 (19968)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD9B8 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 132 
UDP: Checksum         = 0x9033 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Device under test added route with metric 4

Sending update for same route with metric 16
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AC2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xD89F (55455)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xE20A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x6DE2 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Sending RIP request to query updated route
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27BB (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 152 bytes
IP: Identification         = 0x6874 (26740)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xBF44 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 132 
UDP: Checksum         = 0x9027 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response contains route, metric 16
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.13: Passed

>> RIP-7.14
TEST_DESCRIPTION
Any entry that fails these tests is ignored, as it is no better than
the current route.
TEST_REFERENCE
RFC 2453 s3.9.2 p27 Response Messages
TEST_METHOD
- ANVL: Send Response with route for net A with metric 3 on DIface-0
- ANVL: Send Request for routing table on DIface-1
-  DUT: Send Response with route for net A with metric 4 on DIface-1
- ANVL: Send Response with route for net A with metric 2 on DIface-0
- ANVL: Send Request for routing table on DIface-1
-  DUT: Send Response with route for net A with metric 3 on DIface-1
- ANVL: Send Reponse with route for net A with metric 4 on DIface-1
-  DUT: Ignore new entry as it is no better than the current route
- ANVL: Verify DUT did not accept update via Request on DIface-0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending update for network route with metric 3 on DIface-0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AC0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27B9 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 172 bytes
IP: Identification         = 0x2A15 (10773)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xFD8F (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 152 
UDP: Checksum         = 0xF8F1 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted network route

Sending update for network route with metric 2 on DIface-0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3ABE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27B7 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 172 bytes
IP: Identification         = 0x2A16 (10774)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xFD8E (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 152 
UDP: Checksum         = 0xF8F2 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 2 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 14 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted new route

Sending update for same network route with metric 4 on DIface-1
Sending RIPv2 Response to 40.1.1.255 port 520 from 40.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x26BC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 40.1.1.5 (ignored)
Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BB5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 172 bytes
IP: Identification         = 0xE39D (58269)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5807 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 152 
UDP: Checksum         = 0x45F8 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT did not accept update

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-7.14: Passed

>> RIP-8.1
TEST_DESCRIPTION
This processing may be triggered by input processing, when a Request
is received (this Response is unicast to the requestor)
TEST_REFERENCE
RFC 2453 s3.10 p28 Output Processing
TEST_METHOD
- ANVL: Send request for routing information
-  DUT: Send response to ANVL unicast address
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Sending RIP request
Sending RIPv2 Request to 30.1.1.5 port 520 from 30.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BB4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 172 bytes
IP: Identification         = 0xE39E (58270)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5806 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 152 
UDP: Checksum         = 0x45F8 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 110.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received response with destination IP address 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-8.1: Passed

>> RIP-8.3
TEST_DESCRIPTION
This processing may be triggered by triggered updates
(broadcast/multicast when a route changes)
TEST_REFERENCE
RFC 2453 s3.10 p28 Output Processing
TEST_METHOD
- ANVL: Send update for new route R with metric X
-  DUT: Send update including new route
- ANVL: Send update for R with metric Y
-  DUT: Immediately send update including R with metric Y
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending update for new route
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27B2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 172 bytes
IP: Identification         = 0x8FD8 (36824)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x97CC (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 152 
UDP: Checksum         = 0xF6E5 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted new route, returned metric 4

Sending update for the route with metric 6

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x468B (18059)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x6A1F (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x587C (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT response has metric 7
DUT accepted new metric

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-8.3: Passed

>> RIP-8.5
TEST_DESCRIPTION
After a triggered update is sent, a timer should be set for a random
interval between 1 and 5 seconds.  If other changes that would trigger
updates occur before the timer expires, a single update is triggered
when the timer expires.  The timer is then reset to another random
value between 1 and 5 seconds.
TEST_REFERENCE
RFC 2453 s3.10.1 p29 Triggered Updates
TEST_METHOD
- ANVL: Send update for an existing route R
- ANVL: Send update for another existing route S
-  DUT: Send update for route R
-  DUT: Wait 1-5 seconds
-  DUT: Send update for route S
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Sending updates to elicit triggered updates from DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x4900 (18688)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x67AA (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x577F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 2 secs

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x67C0 (26560)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x48EA (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x567F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 3 secs

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x1751 (5969)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9959 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x557F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 3 secs

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xFA89 (64137)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB620 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x547F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 3 secs

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x4E16 (19990)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x6294 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x537F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 3 secs

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x4814 (18452)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x6896 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x527F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 3 secs

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AB0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xF007 (61447)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xC0A2 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x517F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 3 secs

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AAF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 5.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xFB00 (64256)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB5A9 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x507F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update with 1 route at 3 secs
averagesec 2.00 secs, count 8 
Received 8 updates, on average every 2.00 secs
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-8.5: Passed

>> RIP-8.18
TEST_DESCRIPTION
"Split horizon with poisoned reverse" includes such routes in
updates, but sets their metrics to infinity.
If split horizon with poisoned reverse is used, the router must
mention all routes that it learns from the backbone, with metrics of 16.
The router requirements RFC [11] specifies that all implementation of
RIP must use split horizon and should also use split horizon with
poisoned reverse
TEST_REFERENCE
RFC 2453 s3.4.3 p15-16 Split horizon
TEST_METHOD
SETUP: Externally configure DUT to support Poison Reverse
 ANVL: Send update for a route with metric n
  DUT: Send update for route with metric 16
  DUT: Send update for route to other network
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Configuring the DUT so that it poisons the RIP routes before propagating
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-poison-reverse-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Advertising new route to 121.0.0.0
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AAE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 45.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x3E7F (15999)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7C2B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x62E2 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT correctly sent update with metric 16 from first interface
Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 352 bytes
IP: Identification         = 0x3E87 (16007)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x70F7 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 332 
UDP: Checksum         = 0xF75A (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 102.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 103.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 104.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 16 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received update from second interface with metric 3

Configuring the DUT so that it does not poison the RIP routes before propagating
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-poison-reverse-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-8.18: Passed

>> RIP-9.1
TEST_DESCRIPTION
The RIP Header format is:

  0                   1                   2                   3   
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  command (1)  |  version (1)  |       must be zero (2)        |
 +---------------+---------------+-------------------------------+

TEST_REFERENCE
RFC 2453 s3.6 p20 Message format
TEST_METHOD
- ANVL: Send a valid version 2 update with MBZ field zeroed
-  DUT: Accept update
- ANVL: Send a valid version 2 update
-  DUT: Send an update containing the advertised route
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending RIP v2 update with MBZ field zeroed
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AAD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27A6 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 312 bytes
IP: Identification         = 0x31E4 (12772)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF534 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 292 
UDP: Checksum         = 0x7B8E (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted update with MBZ field 0x00

Sending valid update with version number 2
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AAB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27A4 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 332 bytes
IP: Identification         = 0xDF29 (57129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x47DB (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 312 
UDP: Checksum         = 0xD856 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted valid update
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-9.1: Passed

>> RIP-9.2
TEST_DESCRIPTION
The format for the 20-octet route entry (RTE) for
   RIP-2 is:

    0                   1                   2                   3 3 
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Address Family Identifier (2) |        Route Tag (2)          |
   +-------------------------------+-------------------------------+
   |                         IP Address (4)                        |
   +---------------------------------------------------------------+
   |                         Subnet Mask (4)                       |
   +---------------------------------------------------------------+
   |                         Next Hop (4)                          |
   +---------------------------------------------------------------+
   |                         Metric (4)                            |
   +---------------------------------------------------------------+

TEST_REFERENCE
RFC 2453 s4 p31 Protocol Extensions
TEST_METHOD
- ANVL: Send version 2 updates with an invalid subnet mask
-  DUT: Ignore invalid updates
- ANVL: Send valid version 2 updates
-  DUT: Accept updates
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending RIP v2 update for net route with invalid net mask 0x01010101
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 124.0.0.0
RIP: Subnet Mask    = 1.1.1.1
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27A2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 332 bytes
IP: Identification         = 0x440F (17423)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xE2F5 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 312 
UDP: Checksum         = 0xD849 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Device under test rejected invalid update

Sending RIP v2 update with route tag = 0xFFFF
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0xFFFF 
RIP: IP Address     = 125.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x27A0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 352 bytes
IP: Identification         = 0xA3DA (41946)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x8316 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 332 
UDP: Checksum         = 0x3312 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 7 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 16 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0xFFFF 
RIP: IP Address     = 125.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Device under test accepted valid update

Sending RIP v2 update with route tag = 0x0000
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 126.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received RIP v2 Response (regular update) from 30.1.1.5 (ignored)
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x279E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 372 bytes
IP: Identification         = 0x25D0 (9680)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x010D (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 352 
UDP: Checksum         = 0x8CD1 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 16 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0xFFFF 
RIP: IP Address     = 125.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 17 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 126.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Device under test accepted valid update
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-9.2: Passed

>> RIP-10.1
TEST_DESCRIPTION
If the Address Family Identifier of the first (and only the first)
entry in the message is 0xFFFF, then the remainder of the entry
contains the authentication.
TEST_REFERENCE
RFC 2453 s4.1 p31 Authentication
TEST_METHOD
- ANVL: Enable authentication on DUT
- ANVL: Send a version 2 packet with correct authentication
-  DUT: Accept packet and send an update with authentication
- ANVL: Verify that authentication in update is correct
- ANVL: Send a version 2 packet with incorrect authentication
-  DUT: Ignore update
- ANVL: Send a version 2 packet with an authentication entry as the
        second tuple
-  DUT: Ignore entry
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Setting authentication string in DUT to 'ab3RMQ'
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ab3RMQ

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-set-authentication-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast in-multi auth-simple ab3RMQ  in v2 
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1  broadcast in-multi auth-simple ab3RMQ  in v2 
   ok
-> exit
Au revoir!
Connection closed by foreign host.
Re-establishing connection with new configuration options
Sending authenticated update for new route

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0080 (128)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A8F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x9C7D (40061)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x8B22 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x1D59 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT response has authentication:
61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00   ab3RMQ..........
DUT accepted additional route, returned metric 4
Flushing RIP Routes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending update with incorrect authentication

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0081 (129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A8E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: zigzag..........
RIP:                    HEX: 7A 69 67 7A 61 67 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 129.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 412 bytes
IP: Identification         = 0x9C7F (40063)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x89CC (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 392 
UDP: Checksum         = 0x403A (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 111.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 16 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0xFFFF 
RIP: IP Address     = 125.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 17 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 126.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 18 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 19 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT did not accept packet with incorrect authentication

Sending update with authentication in second tuple

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A8D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 130.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 392 bytes
IP: Identification         = 0x13D5 (5077)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x128B (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 372 
UDP: Checksum         = 0xD77B (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0xFFFF 
RIP: IP Address     = 125.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 16 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 126.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 17 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 18 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 4 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT did not accept packet with authentication in second tuple
Disabling authentication on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-reset-authentication-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast in-multi in v2 
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast in-multi in v2 
   ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-10.1: Passed

>> RIP-10.3
TEST_DESCRIPTION
Currently, the only Authentication Type is simple password and it is
type 2.  The remaining 16 octets contain the plain text password.  If
the password is under 16 octets, it must be left-justified and padded
to the right with nulls (0x00).
TEST_REFERENCE
NEGATIVE:
RFC 2453 s4.1 p32 Authentication
TEST_METHOD
- ANVL: Enable authentication on DUT
- ANVL: Send a packet with authentication type not equal to 2
-  DUT: Ignore packet
- ANVL: Send a packet with authentication type 2, but illegal
        authentication string
-  DUT: Ignore packet
- CASE: authentication string with zeros in middle (but characters
        on the right of the string)
- CASE: incorrect authentication string
- CASE: incorrect authentication string with leading zero
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Setting authentication string in DUT to 'ab3RMQ'
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ab3RMQ

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-set-authentication-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast in-multi auth-simple ab3RMQ  in v2 
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1  broadcast in-multi auth-simple ab3RMQ  in v2 
   ok
-> exit
Au revoir!
Connection closed by foreign host.
Re-establishing connection with new configuration options

Sending update with invalid authentication type (1)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0083 (131)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A8C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Unknown (0x0001)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 131.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x6F11 (28433)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB8A2 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0xC48E (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT did not accept packet with invalid authentication type

Sending update with non zero-padded authentication string

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0084 (132)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A8B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ.......cde
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 63 64 65  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 132.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 392 bytes
IP: Identification         = 0x7ACA (31434)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xAB95 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 372 
UDP: Checksum         = 0xD76F (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 112.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 113.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 114.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 115.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 116.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 117.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 9 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 118.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 10 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 119.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 11 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 120.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 12 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 121.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 13 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 122.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 14 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 123.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 15 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0xFFFF 
RIP: IP Address     = 125.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 16 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 126.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 17 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 18 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT did not accept packet with non zero-padded authentication string

Sending update with incorrect authentication string

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0085 (133)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A8A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: d1234567890iujkh
RIP:                    HEX: 64 31 32 33 34 35 36 37 38 39 30 69 75 6A 6B 68  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 133.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0x53AB (21419)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD3CC (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 92 
UDP: Checksum         = 0x8806 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT did not accept packet with incorrect authentication string

Sending update with leading-zero, incorrect authentication string

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0086 (134)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A89 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: .kkkkkkkkkkkkkkk
RIP:                    HEX: 00 6B 6B 6B 6B 6B 6B 6B 6B 6B 6B 6B 6B 6B 6B 6B  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 134.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0x84E7 (34023)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA290 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 92 
UDP: Checksum         = 0x8806 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Authentication (0xFFFF)
RIP: Auth type      = Plain text (0x0002)
RIP: Authentication = ASCII: ab3RMQ..........
RIP:                    HEX: 61 62 33 52 4D 51 00 00 00 00 00 00 00 00 00 00  
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update
DUT did not accept packet with leading-zero, incorrect authentication string
Resetting authentication on DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-reset-authentication-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast in-multi in v2 
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast in-multi in v2 
   ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-10.3: Passed

>> RIP-14.1
TEST_DESCRIPTION
An address specified as a next hop must, per force, be directly
reachable on the logical subnet over which the advertisement is made.
TEST_REFERENCE
RFC 2453 s4.4 p33 Next hop
TEST_METHOD
- ANVL: Send a RIP update with next hop for route R set to IP address
        of ANVL connected to <DIface-0> through <DIface-0>
-  DUT: Accept update
- ANVL: Send a RIP request for DUT's routing table through <DIface-1>
-  DUT: Send RIP routing table through <DIface-1>
- ANVL: Check that next hop in the received response is set to either
        of the following values
        - IP Address on DIface-1
        - 0.0.0.0 (treated as IP Address on DIface-1)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending update for new route with valid next hop 30.1.1.150
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0087 (135)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A9C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 135.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x14EE (5358)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x26C6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x15EC (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 135.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update with next hop 30.1.1.150
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0088 (136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2795 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 112 bytes
IP: Identification         = 0xB31F (45855)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x74C1 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 92 
UDP: Checksum         = 0x7E9E (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 135.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted route with valid next hop 30.1.1.150 and correctly
set next hop to 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-14.1: Passed

>> RIP-14.2
TEST_DESCRIPTION
The purpose of the Next Hop field is to eliminate packets being
routed through extra hops in the system.  It is particularly useful...
If the received Next Hop is not directly reachable, it should be treated
as 0.0.0.0.
TEST_REFERENCE
RFC 2453 s4.4 p33 Next hop
TEST_METHOD
- ANVL: Send a RIP update with next hop for route R set to an IP address
        not directly reachable by the DUT
-  DUT: Accept update
- ANVL: Send a RIP request for DUT's routing table through <DIface-1>
-  DUT: Send RIP routing table through <DIface-1>
- ANVL: Check that route in the received response is set to R
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Sending update for new route with indirectly connected next hop 137.0.0.1
Sending RIPv2 Response to 30.1.1.255 port 520 from 30.1.1.150 port 520

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0089 (137)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3A9A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 136.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 137.0.0.1
RIP: Metric         = 2 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 21.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x83EA (33770)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB7C9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x14EC (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 136.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 30.1.1.150
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received RIP response to update with next hop 137.0.0.1
Sending RIPv2 Request to 40.1.1.5 port 520 from 40.1.1.150 port 16340

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x008A (138)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2793 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 40.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 16340 (16340)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Request (0x01)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = Unspecified (0x0000)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 0.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 16 Infinity
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Saw UDP packet from port 520 to port 16340
Received RIP v2 Response from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 132 bytes
IP: Identification         = 0x0238 (568)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2595 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 16340 (16340)
UDP: Length           = 112 
UDP: Checksum         = 0xCF69 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 135.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 136.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 3 
RIP:
RIP: ---- End RIP Packet ----
RIP:

DUT accepted route with valid next hop 137.0.0.1 and correctly
set next hop to 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-14.2: Passed

>> RIP-15.1
TEST_DESCRIPTION
In order to reduce unnecessary load on those hosts which are not
listening to RIP-2 messages, an IP multicast address will be used for
periodic broadcasts.  The IP multicast address is 224.0.0.9.
In order to maintain backwards compatibility, the use of the
multicast address will be configurable
(NOTE: Here we are testing DUT sends multicast RIP-2 update)
TEST_REFERENCE
RFC 2453 s4.5 p33 Multicasting
TEST_METHOD
- ANVL: (Optional) Configure DUT Compatibility Switch to RIP-2 mode
        (RIP-2 messages are multicast)
-  DUT: Send a RIP-2 regular update
- ANVL: Verify regular update is sent out on the multicast address
        (224.0.0.9)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Setting DUT Compatibility Send Switch to RIP-2 (RIP-2 messages are multicast)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=2
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 multicast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 multicast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x2A88 (10888)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9022 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0xB381 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received multicast update from DUT

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-15.1: Passed

>> RIP-15.2
TEST_DESCRIPTION
In order to reduce unnecessary load on those hosts which are not
listening to RIP-2 messages, an IP multicast address will be used for
periodic broadcasts.  The IP multicast address is 224.0.0.9.
In order to maintain backwards compatibility, the use of the
multicast address will be configurable
(NOTE: Here we are testing DUT accepts multicast RIP-2 update)
TEST_REFERENCE
RFC 2453 s4.5 p33 Multicasting
TEST_METHOD
- ANVL: (Optional) Configure DUT Compatibility Switch to RIP-2 mode
        (RIP-2 messages are multicast)
- ANVL: Send a RIP-2 update to the multicast address (224.0.0.9)
-  DUT: Accept update
-  DUT: Send update on other interface containing advertised route
- ANVL: Verify response contains advertised route
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Setting DUT Compatibility Switch to RIP-2 (RIP-2 messages are multicast)

Setting DUT Compatibility Send Switch to RIP-2 (RIP-2 messages are multicast)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=2
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 multicast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 multicast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending RIP v2 update to multicast address

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x008B (139)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7A8E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 138.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x8A7D (35453)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x262D (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x3F7D (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 138.0.0.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Received response containing additional route

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-15.2: Passed
Executing system command:
  "./DocScriptQ35/RIP/RIPpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -o iprip.drop.hostroute "0"
sysvar: iprip.drop.hostroute=0 ok
-> cmd ripctrl ifclose gei0
   ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> cmd ripctrl ifclose gei1
   ok
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          39
Number of tests passed:       39
Number of tests failed:       0
Number of tests inconclusive: 0
