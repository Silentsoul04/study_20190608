ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5783524 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipv6 ipv6 1-8.15 8.17-16.1 16.4-16.7 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipv6.prm 

Reboot Time                              60                  # (0x0000003C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IPV6/IPV6postsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IPv6 DUT is a Router                     True
IPv6 Unknown Option Type                 20                  # (0x00000014)
IPv6 Invalid Header                      254                 # (0x000000FE)
IPv6 DUT Echo Request Send Command       "./DocScriptQ35/IPV6/ipv6-dut-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPv6 DUT Periodic Router Advertise Is Supported False
IPv6 DUT Deprecation of RH0 Is Supported True
IPv6 DUT Configure Deprecation of RH0 Command "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPv6 Suite Setup Command                 "./DocScriptQ35/IPV6/ipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPv6 DUT PPP Interface Configure Command ""
IPv6 MTU of First Interface of DUT       1500                # (0x000005DC)
IPv6 MTU of Second Interface of DUT      1300                # (0x00000514)
IPv6 Unknown Routing Type                10                  # (0x0000000A)
IPv6 DUT Support Flow Level              True
ICMPv6 Packet Listen Time                15                  # (0x0000000F)
ICMPv6 Packet Tolerance Time             1                   # (0x00000001)
ICMPv6 Packet Tolerance Factor           1                   # (0x00000001)
IPv6 Packet Listen Time                  15                  # (0x0000000F)
ICMPv6 ANVL Listen Time                  3                   # (0x00000003)
PPP Send Configure To Start              False
PPP Delay After Connect                  0                   # (0x00000000)
PPP Delay After LCP                      0                   # (0x00000000)
PPP Delay After NCP                      0                   # (0x00000000)
PPP Allow Dynamic Addressing             False

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipv6.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:1111::9028
  IPV6 ANVL Address                        3ffe:1111::1111
  IPV6 Gateway                             3ffe:1111::9028
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:2222::9029
  IPV6 ANVL Address                        3ffe:2222::2222
  IPV6 Gateway                             3ffe:2222::9029
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)

# Configuration File End.
%% VALIDATE PRM 15 WARNING: DUT supports the functions of the Flow Label field.
So the following tests will not be run: 11.1 11.2 11.3 
%% VALIDATE PRM GLOBAL WARNING: DUT supports RFC 5095 - Deprecation of RH0.
So the following tests will not be run: 7.1 7.2 7.3 7.4 7.5 7.6 7.7 7.8 7.9 7.10 7.11 7.12 7.13 7.14 7.15 7.16 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::9028 64 1500 3ffe:2222::9029 64 1300 ROUTER

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 3ffe:1111::9028 prefixlen 64 mtu 1500 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 3ffe:2222::9029 prefixlen 64 mtu 1300 up 
-> cmd sysvar set -co ipnet.inet6.AcceptRtAdv "1" 
sysvar: ipnet.inet6.AcceptRtAdv=1 ok
-> cmd sysvar set -co ipnet.inet6.radvd.interfaces "gei0,gei1"
sysvar: ipnet.inet6.radvd.interfaces=gei0,gei1 ok
-> cmd radvdconfig gei0 add t0 3ffe:1111::/64 valid 600 preferred 200 L A
-> cmd radvdconfig gei0 enable t0
-> cmd radvdconfig gei1 add t1 3ffe:2222::/64 valid 600 preferred 200 L A
-> cmd radvdconfig gei1 enable t1
-> cmd ipd start ipnet_radvd
ipd: start ipnet_radvd ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028
33:33:FF:00:90:28 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:9028 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 3ffe:1111::1111 < 3ffe:1111::9028 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:1111::9028 as 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029
33:33:FF:00:90:29 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:9029 < 3ffe:2222::2222 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 3ffe:2222::2222 < 3ffe:2222::9029 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:2222::9029 as 00:15:17:C8:90:29

This test suite tests statements from:
RFC 2460: 'Internet Protocol, Version6 (IPv6) Specification'
(S. Deering (Cisco), R. Hinden(Nokia), December 1998)
RFC 2464: 'Transmission of IPv6 Packets over Ethernet Networks'
(M. Crawford, Femilab, December 1998)

ANVL Test Suite Required Setup:
This suite expects to be running against an IPv6 host or a router which
has an IPv6 stack. There are a number of parameters controlling this
suite that need to be setup for a completely automated run.
Many of the tests can be run against a single interface, but more 
thorough testing requires that the machine ANVL is running on be 
connected to 2 interfaces that are connected to the router under test.

The ANVL config file must contain at least one IP interface
configured. 




This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IPV6-1.1
TEST_DESCRIPTION
An IPv6 host must respond to all ICMPv6 Echo Requests sent to it,
by sending an ICMPv6 Echo Reply back to the sender of ICMPv6 Echo
Request.
TEST_REFERENCE
ANVL Setup Specific
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and
        Data of the received ICMPv6 Echo Reply are the same as
        those of the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-1.1: Passed

>> IPV6-1.2
TEST_DESCRIPTION
An IPv6 router must forward all the ICMPv6 Echo Requests 
and replies to and from the networks it is connected to.
TEST_REFERENCE
ANVL Setup Specific
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the ICMPv6 Echo Request to <AIface-1>
- ANVL: Verify that the forwarded ICMPv6 Echo Request remains
        unmodified 
- ANVL: Send an ICMPv6 Echo Reply to <DIface-1>, containing:
        - source address set to address of host-2
        - destination address set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Forward the ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that the forwarded ICMPv6 Echo Reply remains
        unmodified 
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request remains unmodified
Sending ICMPv6 Echo Reply Packet
Sending IPv6 packet from 3ffe:2222::2222 
to 3ffe:1111::1111 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7636 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:2222::2222 
to 3ffe:1111::1111 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7636 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Reply remains unmodified

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-1.2: Passed

>> IPV6-2.1
TEST_DESCRIPTION
Length of the IPv6 payload, i.e. the rest of the packet 
following this IPv6 header, in octets, can be odd
TEST_REFERENCE
RFC 2460 s3 p4 IPv6 Header Format
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - The Payload Length field of the IPv6 Header set to
          an odd value
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that the forwarded ICMPv6 Echo Request remains
        unmodified
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending an IPv6 Packet with ODD payload length 11
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x613 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  4F 44 44                                          ODD
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x613 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  4F 44 44                                          ODD
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request remains unmodified

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-2.1: Passed

>> IPV6-2.2
TEST_DESCRIPTION
Length of the IPv6 payload, i.e. the rest of the packet 
following this IPv6 header, in octets, can be odd
TEST_REFERENCE
RFC 2460 s3 p4 IPv6 Header Format
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of Dut
        - The Payload Length field of the IPv6 Header set to
          an odd value
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply packet to <AIfcae-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending an IPv6 Packet with ODD payload length 11
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA91D (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  4F 44 44                                          ODD
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA81D (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  4F 44 44                                          ODD
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-2.2: Passed

>> IPV6-3.1
TEST_DESCRIPTION
The Hop-by-Hop Options header, when present, must immediately
follow the IPv6 header
TEST_REFERENCE
NEGATIVE
RFC 2460 s4 p6 IPv6 Extension Headers
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header immediately after IPv6 
          header, followed by Hop-by-Hop Option Header
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send ICMPv6 Echo Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
after Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.1: Passed

>> IPV6-3.2
TEST_DESCRIPTION
The Hop-by-Hop Options header, when present, must immediately follow
the IPv6 header
TEST_REFERENCE
RFC 2460 s4 p6 IPv6 Extension Headers
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header immediately after IPv6 header
        - a Destination Option Header immediately after Hop-by-Hop
          Option Header
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0> 
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
after Hop-by-Hop Option header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = Destination Header (60)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.2: Passed

>> IPV6-3.3
TEST_DESCRIPTION
If, as a result of processing a header, a node is required to proceed
to the next header but the Next Header value in the current header is
unrecognized by the node, it should discard the packet
(This tests for a router ignoring the unrecognized Next Header value)
TEST_REFERENCE
RFC 2460 s4 p6 IPv6 Extension Headers
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - The Next Header field of IPv6 header set to
          <InvalidNxtHdr>
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Ignore the unrecognized Next Header value and forward packet
        to <AIface-1>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with invalid next header
value in the Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = *UNKNOWN* (254)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPV6: --- Trailing Data [28 bytes] ---
IPV6:  80 00 77 36 00 00 00 00 49 50 56 36 5F 50 52 4F   ..w6....IPV6_PRO
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = *UNKNOWN* (254)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPV6: --- Trailing Data [28 bytes] ---
IPV6:  80 00 77 36 00 00 00 00 49 50 56 36 5F 50 52 4F   ..w6....IPV6_PRO
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

DUT correctly forwarded and did not discard the
ICMPv6 Echo Request packet

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.3: Passed

>> IPV6-3.4
TEST_DESCRIPTION
If the Next Header value in the current header is unrecognized by
by the node, it should send an ICMPv6 parameter problem to the
source of the packet, with an ICMPv6 code value of 1 (Unrecognized
Next Header type encountered) and the ICMPv6 Pointer field containing
the offset of the unrecognized value within the original packet
TEST_REFERENCE
RFC 2460 s4 p6 IPv6 Extension Headers
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - The Next Header field of IPv6 header set to
          <InvalidNxtHdr>
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 1
        - ICMPv6 Pointer field containing the offset of the
          unrecognized value within the original packet
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with invalid next header
value in the IPv6 header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = *UNKNOWN* (254)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPV6: --- Trailing Data [28 bytes] ---
IPV6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 1 (Unrecognized next header type encountered)
ICMPv6: Checksum           = 0x5954 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 6
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 28 (bytes)
ICMPv6: IPv6: Next Header          = *UNKNOWN* (254)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [28 bytes] ---
ICMPv6: IPv6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = *UNKNOWN* (254)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPV6: --- Trailing Data [28 bytes] ---
IPV6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

DUT correctly sent an ICMPv6 Parameter Problem with Code
value 1 and correct offset value

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.4: Passed

>> IPV6-3.5
TEST_DESCRIPTION
If a node encounters a Next Header value of zero in any header
otherthan an IPv6 header (e,g Fragment Header),
it should discard the packet
TEST_REFERENCE
RFC 2460 s4 p6 IPv6 Extension Headers
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - Next Header field set to 0
          - Offset set to 0
          - M flag set to 0
          - Fragment Identification field set to id
        - a Hop-by-Hop header following the Routing Header
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 1
        - ICMPv6 Pointer field containing the offset of the
          unrecognized value within the original packet
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with next header value
zero in Fragment Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 211
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 1 (Unrecognized next header type encountered)
ICMPv6: Checksum           = 0xEF3B (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 40
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 44 (bytes)
ICMPv6: IPv6: Next Header          = Fragment Header (44)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [44 bytes] ---
ICMPv6: IPv6:  00 00 00 00 00 00 00 D3 3A 00 01 04 00 00 00 00   ........:.......
ICMPv6: IPv6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 211
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent an ICMPv6 Parameter Problem with Code
value 1 and correct offset value

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.5: Passed

>> IPV6-3.6
TEST_DESCRIPTION
If a node encounters a Next Header value of zero in any header
other than an IPv6 header (e,g Destination Option Header), it
should discard the packet
TEST_REFERENCE
RFC 2460 s4 p7 IPv6 Extension Headers
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with Next Header
          field set to 0 followed by a Hop-by-Hop header
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send ICMPv6 Echo Reply to <AIface-0>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with next header value
zero in Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.6: Passed

>> IPV6-3.7
TEST_DESCRIPTION
If a node encounters a Next Header value of zero in any header other
than the IPv6 header, it should send an ICMP parameter problem
message to the source of the packet, with an ICMP code value of 1
(unrecognized Next Header type encountered) and the ICMP Pointer
field containing the offset of the unrecognized value within the
original packet
TEST_REFERENCE
RFC 2460 s4 p6 IPv6 Extension Headers
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with Next Header field
          set to 0 followed by a Hop-by-hop header
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains
        - ICMPv6 code value 1
        - ICMPv6 Pointer field with the offset of the
          unrecognized value within the original packet
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with next header value
zero in Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 92 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 1 (Unrecognized next header type encountered)
ICMPv6: Checksum           = 0xDF0A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 40
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 44 (bytes)
ICMPv6: IPv6: Next Header          = Destination Header (60)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [44 bytes] ---
ICMPv6: IPv6:  00 00 01 04 00 00 00 00 3A 00 01 04 00 00 00 00   ........:.......
ICMPv6: IPv6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code 1
and correct offset value

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.7: Passed

>> IPV6-3.8
TEST_DESCRIPTION
Each extension header is an integer multiple of 8 octets long, in
order to retain 8-octet alignment for subsequent headers
TEST_REFERENCE
RFC 2460 s4 p6 IPv6Extension Headers
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - one Hop-by-Hop Option Header with one Option of type
          <UnrecognizedOptionType> with higher order 2-bits set
          to 00. Opt Data Len of Option is set to 22 and Option
          Data contains 22 octets
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Accept and forward the ICMPv6 Echo Request to <AIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 22
IPv6: --- Option Data [22 bytes] ---
IPv6:  41 42 43 44 45 46 47 48 49 4A 48 4C 4D 4E 4F 50   ABCDEFGHIJHLMNOP
IPv6:  51 20 44 41 54 41                                 Q DATA
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 22
IPv6: --- Option Data [22 bytes] ---
IPv6:  41 42 43 44 45 46 47 48 49 4A 48 4C 4D 4E 4F 50   ABCDEFGHIJHLMNOP
IPv6:  51 20 44 41 54 41                                 Q DATA
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT sent expected Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.8: Passed

>> IPV6-3.9
TEST_DESCRIPTION
If, as a result of processing a header, a node is required to proceed
to the next header but the Next Header value in the current header is
unrecognized by the node, it should discard the packet
TEST_REFERENCE
RFC 2460 s4 p7 IPv6 Extension Headers
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - The Next Header field of IPv6 header set to
          <InvalidNxtHdr>
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not Send ICMPv6 Echo Reply packet to <AIfcae-0>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with invalid next header
value in the Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = *UNKNOWN* (254)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPV6: --- Trailing Data [28 bytes] ---
IPV6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.9: Passed

>> IPV6-3.10
TEST_DESCRIPTION
Each extension header is an integer multiple of 8 octets long, in
order to retain 8-octet alignment for subsequent headers
TEST_REFERENCE
RFC 2460 s4 p6 IPv6Extension Headers
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - one Hop-by-Hop Option Header with one Option of type
          <UnrecognizedOptionType> with higher order 2-bits set
          to 00. Opt Data Len of Option is set to 22 and Option
          Data contains 22 octets
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply packet to <AIfcae-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 22
IPv6: --- Option Data [22 bytes] ---
IPv6:  41 42 43 44 45 46 47 48 49 4A 48 4C 4D 4E 4F 50   ABCDEFGHIJHLMNOP
IPv6:  51 20 44 41 54 41                                 Q DATA
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-3.10: Passed

>> IPV6-4.1
TEST_DESCRIPTION
Each extension header should occur at most once except Destination
Option Header
TEST_REFERENCE
RFC 2460 s4.1 p7 Extension Header Order
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - one Hop-by-Hop Option Header
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that the forwarded ICMPv6 Echo Request remains
        unmodified
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with one Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request correctly remains unmodified

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-4.1: Passed

>> IPV6-4.2
TEST_DESCRIPTION
Each extension header should occur at most once except Destination
Option Header
AND
IPv6 nodes must accept and attempt to process extension headers in
any order and occurring any number of times in the same packet
TEST_REFERENCE
RFC 2460 s4.1 p7 Extension Header Order
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - two Routing Headers
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Verify that the ICMPv6 Echo Request packet has been forwarded
        to <AIfcae-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with two Hop-by-Hop Option Headers
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = Routing Header (43)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 0
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 0
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = Routing Header (43)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 0
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 0
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly forwarded the ICMPv6 Echo Request

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-4.2: Passed

>> IPV6-4.3
TEST_DESCRIPTION
Each extension header should occur at most once except Destination
Option Header
TEST_REFERENCE
RFC 2460 s4.1 p8 Extension Header Order
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - one Hop-by-Hop Option Header
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0> 
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with one Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-4.3: Passed

>> IPV6-4.4
TEST_DESCRIPTION
Each extension header should occur at most once except Destination
Option Header
IPv6 nodes must accept and attempt to process extension headers in
any order and occurring any number of times in the same packet
TEST_REFERENCE
NEGATIVE
RFC 2460 s4.1 p7 Extension Header Order
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - two Hop-by-Hop Option Headers
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet and do not send the ICMPv6 Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with two Hop-by-Hop Option Headers
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request Packet with
two Hop-by-Hop Option headers 

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-4.4: Passed

>> IPV6-5.1
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type,
with higher order 2-bits 00 of a Hop-by-Hop Option Header, it
skips over this option and continues processing the header
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          hving higher order 2-bits set to 00
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that the forwarded ICMPv6 Echo Request remains
        unmodified
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request remains unmodified.
DUT correctly ignored the unknown option with higher order
two bits set to 00

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.1: Passed

>> IPV6-5.2
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type,
with higher order 2-bits 00 of a Destination Option header, it
skips over this option and continues processing the header
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 00
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and
        Data of the received ICMPv6 Echo Reply are same as
        those of the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data.
DUT correctly ignored the unknown option with higher order
2-bits set to 00

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.2: Passed

>> IPV6-5.3
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header,
the sequence of options must be processed strictly in the order
they appear in the Header. If the processing IPv6 node does not
recognize the Option Type, with higher order 2-bits 00, it skips
over this option and continues processing the header
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with 4 options each of type
          <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 00, 00, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that the forwarded ICMPv6 Echo request remains
        unmodified
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request remains unmodified.
DUT correctly ignored the 4 unknown options with higher
order 2-bits set to 00

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.3: Passed

>> IPV6-5.4
TEST_DESCRIPTION
When multiple options are present in a Destination Option Header,
the sequence of options must be processed strictly in the order
they appear in the Header. If the processing IPv6 node does not
recognize the Option Type, with higher order 2-bits 00, it skips
over this option and continues processing the header 
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Destination Option Header with 4 options each of type
          <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 00, 00, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data.
DUT correctly ignored the 4 unknown options with higher
 order 2-bits set to 00

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.4: Passed

>> IPV6-5.5
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type
with higher order 2-bits 01 of a Hop-by-Hop Option Header, it
discards the packet 
TEST_REFERENCE
RFC 2460 s4.2 p8 Options 
RFC 2460 s4.3 p11 Hop-by-Hop Options Header 
TEST_METHOD
- ANVL: Perform Router Solicitation 
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 01 
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1> 
-  DUT: Discard the Echo Request packet and do not forward it to
        <AIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on  nets 3ffe:2222:: 
and 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:2222::9029
 to 3ffe:2222::2222
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request with the
unknown option with higher order 2-bits set to 01, and
did not forward the packet

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.5: Passed

>> IPV6-5.6
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header,
the sequence of options must be processed strictly in the order
they appear in the Header and if the processing IPv6 node does not
recognize the Option Type with higher order 2-bits 01, it discards
the packet 
TEST_REFERENCE
RFC 2460 s4.2 p8 Options 
RFC 2460 s4.3 p11 Hop-by-Hop Options Header 
TEST_METHOD
- ANVL: Perform Router Solicitation 
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with 4 options each of type
          <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 01, 10, 11 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1> 
-  DUT: Discard the Echo Request packet and do not forward it
        to <AIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on  nets 3ffe:2222:: 
and 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request with 4
unknown options with higher order 2-bits set to 00, 01,
10, 11 respectively, and did not forward the packet

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.6: Passed

>> IPV6-5.7
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type,
with higher order 2-bits 01 of a Destination Option header, it
discards the packet 
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 01
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet and do not send the ICMPv6 Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request Packet with
unknown option with higher order 2-bits set to 01 and did
not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.7: Passed

>> IPV6-5.8
TEST_DESCRIPTION
When multiple options are present in a Destination Option Header,
the sequence of options must be processed strictly in the order
they appear in the Header. If the processing IPv6 node does not
recognize the Option Type with higher order 2-bits 01, it discards
the packet
TEST_REFERENCE
RFC 2460 s4.2 p8 Options 
RFC 2460 s4.6 p22 Destination Options Header 
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with 4 options each of
        - type <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 01, 10, 11 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0> 
-  DUT: Discard the packet and do not send an ICMPv6 Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request Packet with
4 unknown options with higher order 2-bits set to 00, 01,
10, 11 respectively, and did not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.8: Passed

>> IPV6-5.9
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type
with higher order 2-bits 10 of a Hop-by-Hop Option Header, it
discards the packet
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Discard the Echo Request packet and do not forward it
        to <AIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on  nets 3ffe:2222:: 
and 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:2222::9029
 to 3ffe:2222::2222
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMv6 Echo Request Packet with
unknown option with higher order 2-bits set to 10, and
did not forward the packet

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.9: Passed

>> IPV6-5.10
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
sequence of options must be processed strictly in the order they
appear in the Header. If the processing IPv6 node does not recognize
the Option Type with higher order 2-bits 10, it discards the packet
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with 4 options each of
          type <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 10, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Discard the Echo Request packet, and do not forward it
        to <AIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on  nets 3ffe:2222:: 
and 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMv6 Echo Request Packet
with 4 unknown options with higher order 2-bits set to
00, 10, 01, 00 respectively, and did not forward the packet

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.10: Passed

>> IPV6-5.11
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Destination Option header, it discards
the packet
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard packet, and do not send ICMPv6 Echo Reply to
        <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request Packet with
unknown option with higher order 2-bits set to 01 and did not
send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.11: Passed

>> IPV6-5.12
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Hop-by-Hop Option Header, it sends an
ICMP Parameter Problem, Code 2, message to the packet's
Source Address, pointing to the unrecognized Option Type
TEST_REFERENCE
RFC 2460 s4.2 p8 Option
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 Code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xC994 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 36 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:2222::2222
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [36 bytes] ---
ICMPv6: IPv6:  3A 00 94 04 49 50 76 36 80 00 77 36 00 00 00 00   :...IPv6..w6....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code
value 2 and Pointer pointing to Unrecognized Option type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.12: Passed

>> IPV6-5.13
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
options must be processed strictly in the order they appear in the
Header. If the processing IPv6 node does not recognize the option Type
with higher order 2-bits 10, it discards the packet and sends an ICMP
Parameter Problem, Code 2, message to the packet's Source Address
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header containing 4 options each of
          type <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 10, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard packet and send ICMPv6 Parameter Problem message
        to <AIface-0>
- ANVL: Verify that received ICMPv6 Parameter Problem message has
        Code value 2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xBB9 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 50
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 60 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:2222::2222
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [60 bytes] ---
ICMPv6: IPv6:  3A 03 14 04 49 50 76 36 01 00 94 04 49 50 76 36   :...IPv6....IPv6
ICMPv6: IPv6:  01 00 54 04 49 50 76 36 01 00 14 04 49 50 76 36   ..T.IPv6....IPv6
ICMPv6: IPv6:  80 00 77 36 00 00 00 00 49 50 56 36 5F 50 52 4F   ..w6....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code value 2

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.13: Passed

>> IPV6-5.14
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Destination Option Header, it sends an
ICMP Parameter Problem, Code 2, message to the packet's Source
Address, pointing to the unrecognized Option Type
TEST_REFERENCE
RFC 2460 s4.2 p8 Option
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10 
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0x8D94 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 36 (bytes)
ICMPv6: IPv6: Next Header          = Destination Header (60)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [36 bytes] ---
ICMPv6: IPv6:  3A 00 94 04 49 50 76 36 80 00 1A 41 00 00 00 00   :...IPv6...A....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code 2,
pointing to the Unrecognized Option Type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.14: Passed

>> IPV6-5.15
TEST_DESCRIPTION
When multiple options are present in a Destination Option Header,the
options must be processed strictly in the order they appear in the
Header. If the processing IPv6 node does not recognize the Option
Type with higher order 2-bits 10, it sends an ICMP Parameter Problem,
Code 2, message to the packet's Source Address
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with 4 options each of type
          <UnrecognizedOptionType> having higher order 2-bits set
          to 00, 10, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that received ICMPv6 Parameter Problem message has
        Code value 2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xCFB8 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 50
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 60 (bytes)
ICMPv6: IPv6: Next Header          = Destination Header (60)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [60 bytes] ---
ICMPv6: IPv6:  3A 03 14 04 49 50 76 36 01 00 94 04 49 50 76 36   :...IPv6....IPv6
ICMPv6: IPv6:  01 00 54 04 49 50 76 36 01 00 14 04 49 50 76 36   ..T.IPv6....IPv6
ICMPv6: IPv6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code value 2

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.15: Passed

>> IPV6-5.16
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Hop-by-Hop Option Header, and with
multicast destination address, it discards the packet
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet and do not send Router Advertisement to
        <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending Router Solicitation Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::2 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:00:00:00:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::2
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 133 (Router Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9F3C (Correct)
ICMPv6: 
ICMPv6: ---- Router Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the Router Solicitation Packet with
unknown option with higher order 2-bits set to 10, and
did not send any Router Advertisement

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.16: Passed

>> IPV6-5.17
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Destination Option header, and with
multicast destination address, it discards the packet
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send a Neighbor Solicitation to <DIface-0>, with
        - source address set to address of host-1
        - target address set to address of DUT
        - destination address set to solicited-node multicast address
          corresponding to the target address
        - a Destination Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet and do not send Neighbor Advertisement
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::1:ff00:9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
DUT correctly discarded the Neighbor Solicitation Packet
with unknown option with higher order 2-bits set to 10,
and did not send any Neighbor Advertisement

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.17: Passed

>> IPV6-5.18
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Hop-by-Hop Option Header, and with 
multicast destination address, it sends an ICMP Parameter Problem,
Code 2, message to the packet's Source Address, pointing to the
unrecognized Option Type
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending Router Solicitation Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::2 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:00:00:00:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::2
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 133 (Router Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9F3C (Correct)
ICMPv6: 
ICMPv6: ---- Router Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xC9A0 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 24 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = ff02::2
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [24 bytes] ---
ICMPv6: IPv6:  3A 00 94 04 49 50 76 36 85 00 9F 3C 00 00 00 00   :...IPv6...<....
ICMPv6: IPv6:  01 01 00 1B 21 7D 57 BA                           ....!}W.
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::2
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 133 (Router Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9F3C (Correct)
ICMPv6: 
ICMPv6: ---- Router Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received an ICMPv6 Parameter Problem with Code 2 from DUT.
The ICMPv6 Pointer points to the Unrecognized Opiton type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.18: Passed

>> IPV6-5.19
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
with higher order 2-bits 10 of a Destination Option header, and with
multicast destination address, it sends an ICMP Parameter Problem,
Code 2, message to the packet's Source Address, pointing to the
unrecognized Option Type
TEST_REFERENCE
RFC 2460 s4.2 p8 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send a Neighbor Solicitation to <DIface-0>, with
        - source address set to address of host-1
        - target address set to address of DUT
        - destination address set to solicited-node multicast address
          corresponding to the target address
        - a Destination Option Header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 10
 - ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::1:ff00:9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0x8D90 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 40 (bytes)
ICMPv6: IPv6: Next Header          = Destination Header (60)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = ff02::1:ff00:9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [40 bytes] ---
ICMPv6: IPv6:  3A 00 94 04 49 50 76 36 87 00 2C CC 00 00 00 00   :...IPv6..,.....
ICMPv6: IPv6:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 90 28   ?..............(
ICMPv6: IPv6:  01 01 00 1B 21 7D 57 BA                           ....!}W.
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received an ICMPv6 Parameter Problem with Code 2 from DUT.
The ICMPv6 Pointer points to the Unrecognized Opiton type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.19: Passed

>> IPV6-5.20
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
the higher order 2-bits 11 of a Hop-by-Hop Option Header, it discards
the packet
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Discard the Echo Request packet and do not forward it to
        <AIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on  nets 3ffe:2222:: 
and 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:2222::9029
 to 3ffe:2222::2222
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT did not forward any ICMPv6 Echo Request.
DUT correctly discarded the packet with unknown option
with higher order 2-bits set to 11

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.20: Passed

>> IPV6-5.21
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
sequence of options must be processed strictly in the order they
appear in the Header. If the processing IPv6 node does not recognize
the Option Type with higher order 2-bits 11, it discards the packet 
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with 4 options each of type
          <UnrecognizedOptionType>, having higher order 2-bits set
          to 00, 11, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Discard the Echo Request packet, and do not forward it to
        <AIface-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on  nets 3ffe:2222:: 
and 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
DUT did not forward any ICMPv6 Echo Request
DUT correctly discarded the packet with 4 unknown options,
with higher order 2-bits set to 00, 11, 01, 00 respectively

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.21: Passed

>> IPV6-5.22
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 11 of a Destination Option header, it discards
the packet
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet and do not send ICMPv6 Echo Reply to
        <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Did not receive an ICMPv6 Echo Reply from DUT.
DUT correctly discarded the packet with unknown option,
with higher order 2-bits set to 11

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.22: Passed

>> IPV6-5.23
TEST_DESCRIPTION
When multiple options are present in a Destination Option Header, the
sequence of options must be processed strictly in the order they appear
appear in the Header. If the processing IPv6 node does not recognize
the Option Type with higher order 2-bits 11, it discards the packet
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with 4 options each of type
          <UnrecognizedOptionType>, having higher order 2-bits set
          to 00, 11, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and do not send ICMPv6 Echo Reply to
        <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Did not receive an ICMPv6 Echo Reply from DUT.
DUT correctly discarded the packet with 4 unknown options,
with higher order 2-bits set to 00, 11, 01, 00 respectively

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.23: Passed

>> IPV6-5.24
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
the higher order 2-bits 11 of a Hop-by-Hop Option Header and only
if the packet's Destination Address was not a multicast address, it
sends an ICMP Parameter Problem, Code 2, message to the packet's
Source Address, pointing to the unrecognized Option Type 
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation 
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0x8994 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 36 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:2222::2222
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [36 bytes] ---
ICMPv6: IPv6:  3A 00 D4 04 49 50 76 36 80 00 77 36 00 00 00 00   :...IPv6..w6....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 2,
pointing to the Unrecognized Option Type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.24: Passed

>> IPV6-5.25
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
options must be processed strictly in the order they appear. If the
processing IPv6 node does not recognize the Option Type with higher
order 2-bits 11, with unicast Hop-by-Hop Address, it sends an ICMP
Parameter Problem, Code 2, message to the packet's Source Address
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with 4 options each of type
          <UnrecognizedOptionType>, having higher order 2-bits set
          to 00, 11, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-1>
- ANVL: Verify that received ICMPv6 packet contains Code value 2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on  nets 3ffe:2222:: 
and 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xCBB8 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 50
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 60 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:2222::2222
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [60 bytes] ---
ICMPv6: IPv6:  3A 03 14 04 49 50 76 36 01 00 D4 04 49 50 76 36   :...IPv6....IPv6
ICMPv6: IPv6:  01 00 54 04 49 50 76 36 01 00 14 04 49 50 76 36   ..T.IPv6....IPv6
ICMPv6: IPv6:  80 00 77 36 00 00 00 00 49 50 56 36 5F 50 52 4F   ..w6....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code value 2

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.25: Passed

>> IPV6-5.26
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
with higher order 2-bits 11 of a Destination Option header and only
if the packet's Destination Address was not a multicast address, it
sends an ICMP Parameter Problem, Code 2, message to the packet's
Source Address, pointing to the unrecognized Option Type
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0x4D94 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 36 (bytes)
ICMPv6: IPv6: Next Header          = Destination Header (60)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [36 bytes] ---
ICMPv6: IPv6:  3A 00 D4 04 49 50 76 36 80 00 1A 41 00 00 00 00   :...IPv6...A....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 2,
pointing to the Unrecognized Option Type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.26: Passed

>> IPV6-5.27
TEST_DESCRIPTION
When multiple options are present in a Destination Option Header,
the options must be processed strictly in the order they appear. If
the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 11, with unicast packet's Destination Address,
it sends an ICMP Parameter Problem, Code 2, message to the packet's
Source Address
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with 4 options each of type
          <UnrecognizedOptionType>, having higher order 2-bits set
          to 00, 11, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that received ICMPv6 packet contains Code value 2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0x8FB8 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 50
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 60 (bytes)
ICMPv6: IPv6: Next Header          = Destination Header (60)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [60 bytes] ---
ICMPv6: IPv6:  3A 03 14 04 49 50 76 36 01 00 D4 04 49 50 76 36   :...IPv6....IPv6
ICMPv6: IPv6:  01 00 54 04 49 50 76 36 01 00 14 04 49 50 76 36   ..T.IPv6....IPv6
ICMPv6: IPv6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code value 2

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.27: Passed

>> IPV6-5.28
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
the higher order 2-bits 11 of a Hop-by-Hop Option Header and if the
packet's Destination Address was a multicast address, it does not
send ICMP Parameter Problem, Code 2, message to the packet's Source
Address
TEST_REFERENCE
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send any ICMP Parameter problem to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending Router Solicitation Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::2 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:00:00:00:02
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::2
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 133 (Router Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9F3C (Correct)
ICMPv6: 
ICMPv6: ---- Router Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly ignored the received Router Solicitation,
and did not send any ICMPv6 Parameter Problem

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.28: Passed

>> IPV6-5.29
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 11 of a Destination Option header and if the
packet's Destination Address was a multicast address, it does not
send ICMP Parameter Problem, Code 2, message to the packet's Source
Address
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.6 p22 Destination Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT and destination
          address set to solicited-node multicast address
          corresponding to the target address
        - Destination Option header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send any ICMPv6 Parameter Problem to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::1:ff00:9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly ignored the received Neighbor Solicitation,
and did not send any ICMPv6 Parameter Problem

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.29: Passed

>> IPV6-5.30
TEST_DESCRIPTION
Pad1 option can be used to pad out a Hop-by-Hop Option header to a
multiple of 8 octets in length
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 00, 3 bytes of data
          and Pad1 option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the ICPMv6 Echo Request to <AIface-1>
- ANVL: Verify that the forwarded ICMPv6 Echo Request remains
        unmodified
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 3
IPv6: --- Option Data [3 bytes] ---
IPv6:  49 50 36                                          IP6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 3
IPv6: --- Option Data [3 bytes] ---
IPv6:  49 50 36                                          IP6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request remains unmodified.
DUT correctly ignored the unknown option with higher order
two bits set to 00 and with Pad1 option

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.30: Passed

>> IPV6-5.31
TEST_DESCRIPTION
Pad1 option can be used to pad out a Destination Option header to a
multiple of 8 octets in length
[Note: Test description of test-5.31 is not directly copied from
the RFC. In RFC 2460, two sentences are merged to make this test 
case
TEST_REFERENCE
RFC 2460 s4.2 p9 Options, 4.6 Destination option header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header. The required alignment of
          the Destination Option Header is done by inserting only
          the Pad1 option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of received ICMPv6 Echo Reply are same as those of the ICMPv6
        Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 3
IPv6: --- Option Data [3 bytes] ---
IPv6:  49 50 36                                          IP6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.31: Passed

>> IPV6-5.32
TEST_DESCRIPTION
PadN option can be used to pad out a Hop-by-Hop Option header to a
multiple of 8 octets in length
[Note: Test description of test-5.32 is not directly copied from
the RFC. In RFC 2460, two sentences from different sections 
are merged to make this test 
TEST_REFERENCE
RFC 2460 s4.2 p9 Options, 4.3 Hop-by-Hop Options 
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option header. The required alignment of
          the Hop-by-Hop Option header is done by inserting only
          the PadN options
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the ICPMv6 Echo Request to <AIface-1>
- ANVL: Verify that the forwarded ICMPv6 Echo Request remains
        unmodified
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request correctly remains unmodified

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-5.32: Passed

>> IPV6-6.1
TEST_DESCRIPTION
PadN option can be used to pad out a Destination Option header to a
multiple of 8 octets in length
[Note: Test description of test-6.1 is not directly copied from
the RFC. In RFC 2460, two sentences from different sections 
are merged to make this test
TEST_REFERENCE
RFC 2460 s4.2 p9 Options, Appendix B, p30
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option header. The required 8-octet alignment
          of the Destination Option header is done by inserting only
          the PadN options
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that dentification Number, Sequence Number and Data
        of received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-6.1: Passed

>> IPV6-6.2
TEST_DESCRIPTION
PadN option can be used to pad out a Hop-by-Hop Option header with
two PadN Options to a multiple of 8 octets in length 
[Note: Test description of test-6.2 is not directly copied from
the RFC. In RFC 2460, two sentences from different sections 
are merged to make this test
TEST_REFERENCE
RFC 2460 s4.2 p9 Options 
TEST_METHOD
- ANVL: Perform Router Solicitation 
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with two Options each of
          type <UnrecognizedOptionType>, having higher order 2-bits
          set to 00
        - Opt Data Len of first Option set to 12
          and Option Data containing 12 octets of data
        - Opt data Len of the second Option set to 7
          and Option Data containing 7 octets of data
        Proper alignment is done between the two Options and
        at the end of the second Option by PadN Option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the ICMPv6 Echo Request to <AIface-1>
- ANVL: Verify that the forwarded ICPMv6 Echo Request remains
        unmodified
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 40
IPv6: Data Len             = 12
IPv6: --- Option Data [12 bytes] ---
IPv6:  41 42 43 44 45 46 47 20 44 41 54 41               ABCDEFG DATA
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 1
IPv6: --- PadN Data [1 bytes] ---
IPv6:  00                                                .
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 40
IPv6: Data Len             = 12
IPv6: --- Option Data [12 bytes] ---
IPv6:  41 42 43 44 45 46 47 20 44 41 54 41               ABCDEFG DATA
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 1
IPv6: --- PadN Data [1 bytes] ---
IPv6:  00                                                .
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly forwarded the ICMPv6 Echo Request

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-6.2: Passed

>> IPV6-6.3
TEST_DESCRIPTION
PadN option can be used to pad out a Destination Option header with
two Options to a multiple of 8 octets in length 
[Note: Test description of test-6.3 is not directly copied from
the RFC. In RFC 2460, two sentences from different sections 
are merged to make this test
TEST_REFERENCE
RFC 2460 s4.2 p10 Options 
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Destination Option Header with two Options each of
          type <UnrecognizedOptionType>, having higher order 2-bits
          set to 00
        - Opt Data Len of first Option set to 12
          and Option Data containing 12 octets of data
        - Opt data Len of the second Option set to 7
          and Option Data containing 7 octets of data
        Proper alignment is done between the two Options an 
        at the end of the second Option by PadN Option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 40
IPv6: Data Len             = 12
IPv6: --- Option Data [12 bytes] ---
IPv6:  41 42 43 44 45 46 47 20 44 41 54 41               ABCDEFG DATA
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 1
IPv6: --- PadN Data [1 bytes] ---
IPv6:  00                                                .
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent an ICMPv6 Echo Reply packet
The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data.
DUT correctly ignored the unknown option with higher order
2-bits set to 0

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-6.3: Passed

>> IPV6-6.6
TEST_DESCRIPTION
Both Pad1 and PadN option can be used to pad out a Hop-by-Hop
Option header to a multiple of 8 octets in length
[Note: Test description of test-6.6 is not directly copied from
the RFC. In RFC 2460, two sentences from different sections 
are merged to make this test
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 00.
        Opt data Len of the Option is set to 7 and Option Data
        contains 7 octets of data. Proper alignment is done before
        the Option by Pad1 Option and at the end of the Option by
        PadN Option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the ICPMv6 Echo Request to <AIface-1>
- ANVL: Verify that the forwarded ICPMv6 Echo Request remains
        unmodified
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 1 (in unit of 8 octets)
IPv6: 
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 1 (in unit of 8 octets)
IPv6: 
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Forwarded ICMPv6 Echo Request correctly remains unmodified

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-6.6: Passed

>> IPV6-6.7
TEST_DESCRIPTION
Both Pad1 and PadN option can be used to pad out a Destination
Option header to a multiple of 8 octets in length
[Note: test description of test-6.7 is not directly copied from
the rfc. in rfc 2460, two sentences from different sections 
are merged to make this test
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - a Destination Option Header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 00.
        Opt data Len of the Option is set to 7 and Option Data
        contains 7 octets of data. Proper alignment is done before
        the Option by Pad1 Option and at the end of the Option by
        PadN Option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send the ICPMv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of ICPMv6
        Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 1 (in unit of 8 octets)
IPv6: 
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-6.7: Passed

>> IPV6-6.8
TEST_DESCRIPTION
PadN option can be used to pad out a Hop-by-Hop Option header with
two Options to a multiple of 8 octets in length 
[Note: test description of test-6.8 is not directly copied from
the rfc. in rfc 2460, two sentences from different sections 
are merged to make this test
TEST_REFERENCE
RFC 2460 s4.2 p11 Options 
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with two Options each of
          type <UnrecognizedOptionType>, having higher order 2-bits
          set to 00
        - Opt Data Len of first Option set to 12
          and Option Data containing 12 octets of data
        - Opt data Len of the second Option set to 7
          and Option Data containing 7 octets of data
        Proper alignment is done between the two Options and
        at the end of the second Option by PadN Option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and
        Data of the received ICMPv6 Echo Reply are the same as
        those of the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 40
IPv6: Data Len             = 12
IPv6: --- Option Data [12 bytes] ---
IPv6:  41 42 43 44 45 46 47 20 44 41 54 41               ABCDEFG DATA
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 1
IPv6: --- PadN Data [1 bytes] ---
IPv6:  00                                                .
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-6.8: Passed

>> IPV6-6.9
TEST_DESCRIPTION
Both Pad1 and PadN option can be used to pad out a Hop-by-Hop
Option header to a multiple of 8 octets in length
[Note: test description of test-6.9 is not directly copied from
the rfc. in rfc 2460, two sentences from different sections 
are merged to make this test
TEST_REFERENCE
RFC 2460 s4.2 p10 Options
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 00.
        Opt data Len of the Option is set to 7 and Option Data
        contains 7 octets of data. Proper alignment is done before
        the Option by Pad1 Option and at the end of the Option by
        PadN Option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and
        Data of the received ICMPv6 Echo Reply are the same as
        those of the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 1 (in unit of 8 octets)
IPv6: 
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 30
IPv6: Data Len             = 7
IPv6: --- Option Data [7 bytes] ---
IPv6:  41 42 43 44 45 46 47                              ABCDEFG
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 2
IPv6: --- PadN Data [2 bytes] ---
IPv6:  00 00                                             ..
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-6.9: Passed

>> IPV6-8.1
TEST_DESCRIPTION
While reassembling fragmented packets, if duplicate fragments are
received within 60 seconds of the arrival of the first arrived
fragment, reassembly of the packet should not be affected
[Note: Test description of test-8.1 is not directly copied from
the RFC. In RFC 2460, there is no such comment on the duplicate
fragment. In error conditions mentioned in the RFC there is also
no such comments about the duplicate fragment. So we have assumed
that duplicate fragment should not affect the reassembly]
TEST_REFERENCE
RFC 2460 s4.5 p20 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification field set to id
          - Next Header field set to ICMPv6
          - Offset set to 0
        - first half of the constructed ICMPv6 packet
- ANVL: Send the previous packet once again
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Fragment Identification field set to id
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of ICMPv6 Echo Reply are same as those of ICMPv6 Echo
        Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 200
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet again

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 200
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with second half of constructed ICMPv6 packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 200
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.1: Passed

>> IPV6-8.2
TEST_DESCRIPTION
The fragment offset of the first(leftmost) fragment is  0 
An M flag value of 0 if the fragment is the last one
TEST_REFERENCE
RFC 2460 s4.5 p16 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Fragment Offset field set to 0
        - the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request with Fragment Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 102
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.2: Passed

>> IPV6-8.3
TEST_DESCRIPTION
A receiving node should not start reassembly of a complete packet,
till the fragments with same Fragment Identification values have
been received
[Note: test description of test-8.3 is not directly copied from
the rfc. 2460
TEST_REFERENCE
RFC 2460 s4.5 p16 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 packet, say Packet-A. Send an IPv6 Echo
        Request containing:
        - source address set to address of host-1,
        - destination address set to address of DUT to <DIface-0>
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification value set to id
        - first half of the constructed Packet-A
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Construct another ICMPv6 packet, say Packet-B. Send an IPv6
        packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification value set to id1
        - first half of the constructed Packet-B
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification value set to id
        - second half of the constructed Packet-A
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply for Packet-A to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification value set to id1
        - second half of the constructed Packet-B
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply for Packet-B to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet with first half of the constructed ICMPv6 packet(A)
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 117
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with first half of the constructed ICMPv6 packet(B)
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 145
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with second half of the constructed ICMPv6 packet(A)
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 117
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6
Echo Reply have same Identification Number, Sequence
 Number and data
Sending IPv6 Packet with second half of the constructed ICMPv6 packet(B)
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 145
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6
Echo Reply have same Identification Number, Sequence
Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.3: Passed

>> IPV6-8.4
TEST_DESCRIPTION
The Fragment header is used by an IPv6 source to send a packet
larger than would fit in the path MTU to its destination
TEST_REFERENCE
RFC 2460 s4.5 p16 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request with more than <mtu> bytes
        of data. Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Offset set to 0
          - Identification set to id
          - Next Header set to ICMPV6
        - first half of the constructed ICMPv6 packet
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Identification set to id
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send two Fragmented IPv6 packets to <AIface-0>
- ANVL: Reassemble the fragmented packets received from DUT.
        Verify that Identification Number, Sequence Number and Data
        of ICMPv6 Echo Reply are same as those of ICMPv6 Echo
        Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 768 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 68
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x95C 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [752 bytes] ---
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with second half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 756 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 95 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 68
IPv6: 
IPV6: --- Trailing Data [748 bytes] ---
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41               AAAAAAAAAAAA
IPV6: --- Trailing Data End ---

Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1456 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 160679033
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x85C 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [1440 bytes] ---
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 68 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 181 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 160679033
IPv6: 
IPV6: --- Trailing Data [60 bytes] ---
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41               AAAAAAAAAAAA
IPV6: --- Trailing Data End ---

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.4: Passed

>> IPV6-8.5
TEST_DESCRIPTION
The Reserved and the Res field of Fragment Header is initialized to
zero for transmission
TEST_REFERENCE
RFC 2460 s4.5 p16 Fragment Header
TEST_METHOD
- ANVL: Cause DUT to send a large ping
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send two Fragmented IPv6 packets to <AIface-0>
- ANVL: Verify that the Reserved and the Res field of Fragment Header
        of the received packets are set to zero
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.


Causing DUT to send ICMPv6 Echo Request of size 1500
to	3ffe:1111::1111
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 1500

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping6 -c 1 -s 1548 3ffe:1111::1111 
Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1456 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 177456249
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3206 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 62785
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [1440 bytes] ---
ICMPv6:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMPv6:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMPv6:  40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F   @ABCDEFGHIJKLMNO
ICMPv6:  50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F   PQRSTUVWXYZ[\]^_
ICMPv6:  60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F   `abcdefghijklmno
ICMPv6:  70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20   pqrstuvwxyz{|}~ 
ICMPv6:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ICMPv6:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ICMPv6:  41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50   ABCDEFGHIJKLMNOP
ICMPv6:  51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60   QRSTUVWXYZ[\]^_`
ICMPv6:  61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70   abcdefghijklmnop
ICMPv6:  71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21   qrstuvwxyz{|}~ !
ICMPv6:  22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31   "#$%&'()*+,-./01
ICMPv6:  32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41   23456789:;<=>?@A
ICMPv6:  42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51   BCDEFGHIJKLMNOPQ
ICMPv6:  52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61   RSTUVWXYZ[\]^_`a
ICMPv6:  62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71   bcdefghijklmnopq
ICMPv6:  72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22   rstuvwxyz{|}~ !"
ICMPv6:  23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32   #$%&'()*+,-./012
ICMPv6:  33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42   3456789:;<=>?@AB
ICMPv6:  43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52   CDEFGHIJKLMNOPQR
ICMPv6:  53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62   STUVWXYZ[\]^_`ab
ICMPv6:  63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72   cdefghijklmnopqr
ICMPv6:  73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23   stuvwxyz{|}~ !"#
ICMPv6:  24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33   $%&'()*+,-./0123
ICMPv6:  34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43   456789:;<=>?@ABC
ICMPv6:  44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53   DEFGHIJKLMNOPQRS
ICMPv6:  54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63   TUVWXYZ[\]^_`abc
ICMPv6:  64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73   defghijklmnopqrs
ICMPv6:  74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24   tuvwxyz{|}~ !"#$
ICMPv6:  25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34   %&'()*+,-./01234
ICMPv6:  35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44   56789:;<=>?@ABCD
ICMPv6:  45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54   EFGHIJKLMNOPQRST
ICMPv6:  55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64   UVWXYZ[\]^_`abcd
ICMPv6:  65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74   efghijklmnopqrst
ICMPv6:  75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25   uvwxyz{|}~ !"#$%
ICMPv6:  26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35   &'()*+,-./012345
ICMPv6:  36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45   6789:;<=>?@ABCDE
ICMPv6:  46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55   FGHIJKLMNOPQRSTU
ICMPv6:  56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65   VWXYZ[\]^_`abcde
ICMPv6:  66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75   fghijklmnopqrstu
ICMPv6:  76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26   vwxyz{|}~ !"#$%&
ICMPv6:  27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36   '()*+,-./0123456
ICMPv6:  37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46   789:;<=>?@ABCDEF
ICMPv6:  47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56   GHIJKLMNOPQRSTUV
ICMPv6:  57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66   WXYZ[\]^_`abcdef
ICMPv6:  67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76   ghijklmnopqrstuv
ICMPv6:  77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27   wxyz{|}~ !"#$%&'
ICMPv6:  28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37   ()*+,-./01234567
ICMPv6:  38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47   89:;<=>?@ABCDEFG
ICMPv6:  48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57   HIJKLMNOPQRSTUVW
ICMPv6:  58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67   XYZ[\]^_`abcdefg
ICMPv6:  68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77   hijklmnopqrstuvw
ICMPv6:  78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28   xyz{|}~ !"#$%&'(
ICMPv6:  29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38   )*+,-./012345678
ICMPv6:  39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48   9:;<=>?@ABCDEFGH
ICMPv6:  49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58   IJKLMNOPQRSTUVWX
ICMPv6:  59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68   YZ[\]^_`abcdefgh
ICMPv6:  69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78   ijklmnopqrstuvwx
ICMPv6:  79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29   yz{|}~ !"#$%&'()
ICMPv6:  2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39   *+,-./0123456789
ICMPv6:  3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49   :;<=>?@ABCDEFGHI
ICMPv6:  4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59   JKLMNOPQRSTUVWXY
ICMPv6:  5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69   Z[\]^_`abcdefghi
ICMPv6:  6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79   jklmnopqrstuvwxy
ICMPv6:  7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A   z{|}~ !"#$%&'()*
ICMPv6:  2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A   +,-./0123456789:
ICMPv6:  3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A   ;<=>?@ABCDEFGHIJ
ICMPv6:  4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A   KLMNOPQRSTUVWXYZ
ICMPv6:  5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A   [\]^_`abcdefghij
ICMPv6:  6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A   klmnopqrstuvwxyz
ICMPv6:  7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B   {|}~ !"#$%&'()*+
ICMPv6:  2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B   ,-./0123456789:;
ICMPv6:  3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B   <=>?@ABCDEFGHIJK
ICMPv6:  4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B   LMNOPQRSTUVWXYZ[
ICMPv6:  5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B   \]^_`abcdefghijk
ICMPv6:  6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B   lmnopqrstuvwxyz{
ICMPv6:  7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C   |}~ !"#$%&'()*+,
ICMPv6:  2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C   -./0123456789:;<
ICMPv6:  3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C   =>?@ABCDEFGHIJKL
ICMPv6:  4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C   MNOPQRSTUVWXYZ[\
ICMPv6:  5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C   ]^_`abcdefghijkl
ICMPv6:  6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C   mnopqrstuvwxyz{|
ICMPv6:  7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D   }~ !"#$%&'()*+,-
ICMPv6:  2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D   ./0123456789:;<=
ICMPv6:  3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D   >?@ABCDEFGHIJKLM
ICMPv6:  4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D   NOPQRSTUVWXYZ[\]
ICMPv6:  5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D   ^_`abcdefghijklm
ICMPv6:  6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D   nopqrstuvwxyz{|}
ICMPv6:  7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E   ~ !"#$%&'()*+,-.
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 181 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 177456249
IPv6: 
IPV6: --- Trailing Data [100 bytes] ---
IPV6:  2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E   /0123456789:;<=>
IPV6:  3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E   ?@ABCDEFGHIJKLMN
IPV6:  4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E   OPQRSTUVWXYZ[\]^
IPV6:  5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E   _`abcdefghijklmn
IPV6:  6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E   opqrstuvwxyz{|}~
IPV6:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
IPV6:  30 31 32 33                                       0123
IPV6: --- Trailing Data End ---

Reserved Field and Res Field of first fragmented packet
are correctly initialized to zero
Reserved Field and Res Field of second fragmented packet
are correctly initialized to zero

Pinging 3ffe:1111::1111 (3ffe:1111::1111) with 1548 bytes of data:

--- 3ffe:1111::1111 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1016 ms
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.5: Passed

>> IPV6-8.6
TEST_DESCRIPTION
M flag value of Fragment Header is set to 0 if the fragment is the
last (rightmost) one, else M flag value is set to 1
TEST_REFERENCE
RFC 2460 s4.5 p18 Fragment Header
TEST_METHOD
- ANVL: Cause DUT to send a large ping
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send two Fragmented IPv6 packets to <AIface-0>
- ANVL: Verify that the Fragment Header with Fragment Offset field
        set to zero has M bit set to 1, and the other one has M bit
        set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.


Causing DUT to send ICMPv6 Echo Request of size 1500
to	3ffe:1111::1111
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 1500

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping6 -c 1 -s 1548 3ffe:1111::1111 
Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1456 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 194233465
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6BB5 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 48018
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [1440 bytes] ---
ICMPv6:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMPv6:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMPv6:  40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F   @ABCDEFGHIJKLMNO
ICMPv6:  50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F   PQRSTUVWXYZ[\]^_
ICMPv6:  60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F   `abcdefghijklmno
ICMPv6:  70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20   pqrstuvwxyz{|}~ 
ICMPv6:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ICMPv6:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ICMPv6:  41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50   ABCDEFGHIJKLMNOP
ICMPv6:  51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60   QRSTUVWXYZ[\]^_`
ICMPv6:  61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70   abcdefghijklmnop
ICMPv6:  71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21   qrstuvwxyz{|}~ !
ICMPv6:  22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31   "#$%&'()*+,-./01
ICMPv6:  32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41   23456789:;<=>?@A
ICMPv6:  42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51   BCDEFGHIJKLMNOPQ
ICMPv6:  52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61   RSTUVWXYZ[\]^_`a
ICMPv6:  62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71   bcdefghijklmnopq
ICMPv6:  72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22   rstuvwxyz{|}~ !"
ICMPv6:  23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32   #$%&'()*+,-./012
ICMPv6:  33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42   3456789:;<=>?@AB
ICMPv6:  43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52   CDEFGHIJKLMNOPQR
ICMPv6:  53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62   STUVWXYZ[\]^_`ab
ICMPv6:  63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72   cdefghijklmnopqr
ICMPv6:  73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23   stuvwxyz{|}~ !"#
ICMPv6:  24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33   $%&'()*+,-./0123
ICMPv6:  34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43   456789:;<=>?@ABC
ICMPv6:  44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53   DEFGHIJKLMNOPQRS
ICMPv6:  54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63   TUVWXYZ[\]^_`abc
ICMPv6:  64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73   defghijklmnopqrs
ICMPv6:  74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24   tuvwxyz{|}~ !"#$
ICMPv6:  25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34   %&'()*+,-./01234
ICMPv6:  35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44   56789:;<=>?@ABCD
ICMPv6:  45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54   EFGHIJKLMNOPQRST
ICMPv6:  55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64   UVWXYZ[\]^_`abcd
ICMPv6:  65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74   efghijklmnopqrst
ICMPv6:  75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25   uvwxyz{|}~ !"#$%
ICMPv6:  26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35   &'()*+,-./012345
ICMPv6:  36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45   6789:;<=>?@ABCDE
ICMPv6:  46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55   FGHIJKLMNOPQRSTU
ICMPv6:  56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65   VWXYZ[\]^_`abcde
ICMPv6:  66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75   fghijklmnopqrstu
ICMPv6:  76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26   vwxyz{|}~ !"#$%&
ICMPv6:  27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36   '()*+,-./0123456
ICMPv6:  37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46   789:;<=>?@ABCDEF
ICMPv6:  47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56   GHIJKLMNOPQRSTUV
ICMPv6:  57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66   WXYZ[\]^_`abcdef
ICMPv6:  67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76   ghijklmnopqrstuv
ICMPv6:  77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27   wxyz{|}~ !"#$%&'
ICMPv6:  28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37   ()*+,-./01234567
ICMPv6:  38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47   89:;<=>?@ABCDEFG
ICMPv6:  48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57   HIJKLMNOPQRSTUVW
ICMPv6:  58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67   XYZ[\]^_`abcdefg
ICMPv6:  68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77   hijklmnopqrstuvw
ICMPv6:  78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28   xyz{|}~ !"#$%&'(
ICMPv6:  29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38   )*+,-./012345678
ICMPv6:  39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48   9:;<=>?@ABCDEFGH
ICMPv6:  49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58   IJKLMNOPQRSTUVWX
ICMPv6:  59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68   YZ[\]^_`abcdefgh
ICMPv6:  69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78   ijklmnopqrstuvwx
ICMPv6:  79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29   yz{|}~ !"#$%&'()
ICMPv6:  2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39   *+,-./0123456789
ICMPv6:  3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49   :;<=>?@ABCDEFGHI
ICMPv6:  4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59   JKLMNOPQRSTUVWXY
ICMPv6:  5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69   Z[\]^_`abcdefghi
ICMPv6:  6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79   jklmnopqrstuvwxy
ICMPv6:  7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A   z{|}~ !"#$%&'()*
ICMPv6:  2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A   +,-./0123456789:
ICMPv6:  3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A   ;<=>?@ABCDEFGHIJ
ICMPv6:  4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A   KLMNOPQRSTUVWXYZ
ICMPv6:  5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A   [\]^_`abcdefghij
ICMPv6:  6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A   klmnopqrstuvwxyz
ICMPv6:  7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B   {|}~ !"#$%&'()*+
ICMPv6:  2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B   ,-./0123456789:;
ICMPv6:  3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B   <=>?@ABCDEFGHIJK
ICMPv6:  4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B   LMNOPQRSTUVWXYZ[
ICMPv6:  5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B   \]^_`abcdefghijk
ICMPv6:  6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B   lmnopqrstuvwxyz{
ICMPv6:  7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C   |}~ !"#$%&'()*+,
ICMPv6:  2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C   -./0123456789:;<
ICMPv6:  3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C   =>?@ABCDEFGHIJKL
ICMPv6:  4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C   MNOPQRSTUVWXYZ[\
ICMPv6:  5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C   ]^_`abcdefghijkl
ICMPv6:  6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C   mnopqrstuvwxyz{|
ICMPv6:  7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D   }~ !"#$%&'()*+,-
ICMPv6:  2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D   ./0123456789:;<=
ICMPv6:  3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D   >?@ABCDEFGHIJKLM
ICMPv6:  4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D   NOPQRSTUVWXYZ[\]
ICMPv6:  5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D   ^_`abcdefghijklm
ICMPv6:  6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D   nopqrstuvwxyz{|}
ICMPv6:  7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E   ~ !"#$%&'()*+,-.
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 181 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 194233465
IPv6: 
IPV6: --- Trailing Data [100 bytes] ---
IPV6:  2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E   /0123456789:;<=>
IPV6:  3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E   ?@ABCDEFGHIJKLMN
IPV6:  4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E   OPQRSTUVWXYZ[\]^
IPV6:  5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E   _`abcdefghijklmn
IPV6:  6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E   opqrstuvwxyz{|}~
IPV6:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
IPV6:  30 31 32 33                                       0123
IPV6: --- Trailing Data End ---

First Fragment header has correct Offset and MFlag
Second Fragment header has correct Offset and MFlag

Pinging 3ffe:1111::1111 (3ffe:1111::1111) with 1548 bytes of data:

--- 3ffe:1111::1111 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1017 ms
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.6: Passed

>> IPV6-8.7
TEST_DESCRIPTION
The original packet is reassembled only from fragment packets that
have the same Source Address, Destination Address, and Fragment
Identification
[Note Here only same Source Address checked]
TEST_REFERENCE
RFC 2460 s4.5 p19 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to 
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification field set to id
        - first half of the constructed ICMPv6 packet
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address different from the address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Fragment Identification field set to id
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
         - M flag set to 0
         - Fragment Identification field set to id
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the 
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 9
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with different source address and with
second half of the constructed ICMPv6 packet
Sending IPv6 packet from ff02::1 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = ff02::1
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 9
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send an ICMPv6 Echo Reply
Sending IPv6 Packet with same source address and with
second half of the constructed ICMPv6 packet
Sending IPv6 Packet with same source address as the source
address of the first IPv6 Packet and with second half of
constructed packetSending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 9
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.7: Passed

>> IPV6-8.8
TEST_DESCRIPTION
The original packet is reassembled only from fragment packets that
have the same Source Address, Destination Address, and Fragment
Identification
[Note Here only same Destination Address checked]
TEST_REFERENCE
RFC 2460 s4.5 p19 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to 
        <DIface-0> containing:
        - source address set to addres of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification field set to id
        - first half of the constructed ICMPv6 packet
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address different from the address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Fragment Identification field set to id
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
         - M flag set to 0
         - Fragment Identification field set to id
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 146
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet from 3ffe:1111::1111 to ff02::1 
which is different from first packet's destination address
with second half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 146
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Sending IPv6 Packet with same destination address and
with second half of constructed packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 146
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.8: Passed

>> IPV6-8.9
TEST_DESCRIPTION
The original packet is reassembled only from fragment packets that
have the same Source Address, Destination Address, and Fragment
Identification
[Note Here only same Fragment Identification checked]
TEST_REFERENCE
RFC 2460 s4.5 p19 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to 
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification field set to id1
        - first half of the constructed ICMPv6 packet
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Fragment Identification field set to id2
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Fragment Identification field set to id1
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 90
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with different Identification Number and
with second half of the constructed ICMPv6 packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 129
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send ICMPv6 Echo Reply
Sending IPv6 Packet with same Identification Number as that
of the first IPv6 packet and with second half of constructed
ICMPv6 packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 90
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.9: Passed

>> IPV6-8.10
TEST_DESCRIPTION
An original packet is reassembled only from fragment packets that
have the same Source Address, Destination Address, and Fragment
Identification, irrespective of the order in which the fragments
arrives
TEST_REFERENCE
RFC 2460 s4.5 p19 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Fragment Identification field set to id
          - Offset field set to the value which is half of the
            constructed ICMPv6 packet
        - second half of the constructed ICMPv6 packet
- ANVL: Send an IPv6 packet to <DIface-0> containing:
          - source address set to address of host-1
          - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Fragment Identification field set to id
          - Offset field set to 0
        - first half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with second half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 160
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028 
with first half of the constructed ICMPv6 packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 160
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.10: Passed

>> IPV6-8.11
TEST_DESCRIPTION
While reassembling fragmented packets, if insufficient fragments
are received within 60 seconds of the arrival of the first arrived
fragment (i.e. the one with the Fragment Offset of zero), reassembly
of the packet must be abandoned and all the fragments that have been
received for the packet must be discarded
TEST_REFERENCE
RFC 2460 s4.5 p20 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header with M flag set to 1
        - first half of the constructed ICMPv6 packet
- ANVL: Wait for 60 seconds
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header with M flag set to 0
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the fragments and do not send an ICMPv6 Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 13
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for 61 seconds
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with second half of the constructed
 ICMPv6 packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 13
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the fragments and did not send Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.11: Passed

>> IPV6-8.12
TEST_DESCRIPTION
While reassembling fragmented packets, if insufficient fragments are
received within 60 seconds of the arrival of the first arrived 
fragment, reassembly of the packet must be abandoned and if the first
fragment (i.e., the one with a Fragment Offset of zero) has been 
received, an ICMP Time Exceeded--Fragment Reassembly Time Exceeded
message should be sent to the source of that fragment
TEST_REFERENCE
RFC 2460 s4.5 p20 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Offset field of the Fragment Header set to 0
        - first half of the constructed ICMPv6 packet
- ANVL: Wait for 60 seconds
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 message to <AIface-0>
- ANVL: Verify that ICMPv6 message is a Time Exceeded--Fragment
        Reassembly Time Exceeded message (Type 3, Code 1)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 175
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for 60 seconds
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Time Exceeded from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 3 (Time Exceeded)
ICMPv6: Code               = 1 (Fragment Reassembly Time Exceeded)
ICMPv6: Checksum           = 0xC29C (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Time Exceeded ----
ICMPv6: 
ICMPv6: Unused             = 0
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 24 (bytes)
ICMPv6: IPv6: Next Header          = Fragment Header (44)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [24 bytes] ---
ICMPv6: IPv6:  3A 00 00 01 00 00 00 AF 80 00 1A 41 00 00 00 00   :..........A....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Time Exceeded Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 175
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT sent ICMPv6 Time Exceeded with proper code value

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.12: Passed

>> IPV6-8.13
TEST_DESCRIPTION
While reassembling fragmented packets, if insufficient fragments are
received within 60 seconds of the arrival of the first arrived 
fragment, reassembly of the packet must be abandoned and if the first
fragment (i.e., the one with a Fragment Offset of zero) have been 
received, an ICMP Time Exceeded--Fragment Reassembly Time Exceeded
message should be sent to the source of that fragment
TEST_REFERENCE
NEGATIVE
RFC 2460 s4.5 p20 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to 
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Offset value which is half of constructed ICMPv6 packet
        - second half of the constructed ICMPv6 packet
- ANVL: Wait for 60 seconds
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send ICMPv6 Time Exceeded--Fragment Reassembly Time
        Exceeded message to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with second half of constructed ICMPv6 packet and with
M Flag set to 0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 110
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Waiting for 60 seconds
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send Time Exceeded Message

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.13: Passed

>> IPV6-8.14
TEST_DESCRIPTION
If the length of a fragment, as derived from the fragment packet's
Payload Length field, is not a multiple of 8 octets and the M flag of
that fragment is 1, then that fragment must be discarded
TEST_REFERENCE
RFC 2460 s4.5 p20 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header with M flag set to 1
        - first half of the constructed ICMPv6 packet
        - Payload Length field of IPv6 Header set to a value not
          multiple of 8 octets
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header with M flag set to 0
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the fragments, and do not send any ICMPv6 Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet
and with IPv6 payloadLength not multiple of 8 octets

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 25 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 98
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [9 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54                        IPV6_PROT
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with second half of the constructed
ICMPv6 packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 19 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 98
IPv6: 
IPV6: --- Trailing Data [11 bytes] ---
IPV6:  4F 43 4F 4C 5F 54 45 53 54 45 52                  OCOL_TESTER
IPV6: --- Trailing Data End ---

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.14: Passed

>> IPV6-8.15
TEST_DESCRIPTION
If the length of a fragment, as derived from the fragment packet's
Payload Length field, is not a multiple of 8 octets and the M flag of
that fragment is 1, then an ICMP Parameter Problem, Code 0, message
should be sent to the source of the fragment, pointing to the
Payload Length field of the fragment packet
TEST_REFERENCE
RFC 2460 s4.5 p20 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header with M flag set to 1
        - first half of the constructed ICMPv6 packet
        - Payload Length field of the IPv6 Header set to a value
          not multiple of 8 octets
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 0
        - ICMPv6 Pointer field pointing to the Payload Length field
          of the sent fragment packet
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet with first half of the constructed ICMPv6
packet, and with IPv6 payloadLength not multiple of 8 octets
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 25 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 234
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [9 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54                        IPV6_PROT
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 73 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 0 (Errorneous header field encountered)
ICMPv6: Checksum           = 0x6D5C (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 4
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 25 (bytes)
ICMPv6: IPv6: Next Header          = Fragment Header (44)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [25 bytes] ---
ICMPv6: IPv6:  3A 00 00 01 00 00 00 EA 80 00 1A 41 00 00 00 00   :..........A....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54                        IPV6_PROT
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 25 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 234
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [9 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54                        IPV6_PROT
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 0,
pointing to the Payload Length field of the sent
fragment packet

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.15: Passed

>> IPV6-8.17
TEST_DESCRIPTION
If Next Header values in the Fragment headers of different
fragments of the same original packet differ, only the value
from the Offset zero fragment packet is used for reassembly
TEST_REFERENCE
RFC 2460 s4.5 p21 Fragment Header
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request. Send an IPv6 packet to 
        <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 1
          - Identification field set to id
          - Offset field set to 0
          - Next Header field set to ICMPv6
        - first half of the constructed ICMPv6 packet
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header containing:
          - M flag set to 0
          - Identification field set to id
          - Next Header field set to a value different from ICMPv6
          - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 15
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [8 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F                           IPV6_PRO
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet with second half of the constructed ICMPv6 packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = No Next Header (59)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 2 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 15
IPv6: 
IPV6: --- Trailing Data [12 bytes] ---
IPV6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
IPV6: --- Trailing Data End ---

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-8.17: Passed

>> IPV6-9.1
TEST_DESCRIPTION
If the value of the Next Header field of an IPv6 header is 59 and if
the Payload Length field of the IPv6 header indicates the presence
of octets past the end of IPv6 Header those octets must be ignored,
and passed on unchanged if the packet is forwarded
TEST_REFERENCE
RFC 2460 s4.7 p22 No Next Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - The Next Header field of the IPv6 Header set to 59 and
          Payload Length field set to a non-zero value
        - The Data field containing a Hop-by-Hop Option Header with
          <UnrecognizedOptionType> of higher order 2-bits set to 01
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that the forwarded packet remains unmodified
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Next Header field
value of IPv6 header set to 59
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = No Next Header (59)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPV6: --- Trailing Data [36 bytes] ---
IPV6:  3A 00 54 04 49 50 76 36 80 00 77 36 00 00 00 00   :.T.IPv6..w6....
IPV6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
IPV6:  53 54 45 52                                       STER
IPV6: --- Trailing Data End ---

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = No Next Header (59)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPV6: --- Trailing Data [36 bytes] ---
IPV6:  3A 00 54 04 49 50 76 36 80 00 77 36 00 00 00 00   :.T.IPv6..w6....
IPV6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
IPV6:  53 54 45 52                                       STER
IPV6: --- Trailing Data End ---

DUT correctly forwarded the packet.
The forwarded packet remains unmodified.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-9.1: Passed

>> IPV6-9.2
TEST_DESCRIPTION
If the value of the Next Header field of any extension header is 59
and if the Payload Length field of the IPv6 header indicates the
presence of octets past the end of the header those octets must be
ignored, and passed on unchanged if the packet is forwarded
TEST_REFERENCE
RFC 2460 s4.7 p22 No Next Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - Hop-by-Hop Option Header with Next Header Field set to 59
        - Destination Option Header, following Hop-by-Hop Option
          Header, with <UnrecognizedOptionType> of higher order
          2-bits set to 01
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that forwarded packet contains a Hop-by-Hop Option
        Header with next header field value set to 59, followed by
        a destination Option Header. Check that the ICMPv6 Echo
        Request remains unmodified
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = No Next Header (59)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPV6: --- Trailing Data [36 bytes] ---
IPV6:  3B 00 54 04 49 50 76 36 80 00 77 36 00 00 00 00   ;.T.IPv6..w6....
IPV6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
IPV6:  53 54 45 52                                       STER
IPV6: --- Trailing Data End ---

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = No Next Header (59)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPV6: --- Trailing Data [36 bytes] ---
IPV6:  3B 00 54 04 49 50 76 36 80 00 77 36 00 00 00 00   ;.T.IPv6..w6....
IPV6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
IPV6:  53 54 45 52                                       STER
IPV6: --- Trailing Data End ---

Forwarded packet contains Hop-by-Hop Option Header with next
header field value set to 59, followed by a Destination Option
Header. ICMPv6 Echo Request correctly remains unmodified

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-9.2: Passed

>> IPV6-9.3
TEST_DESCRIPTION
If the value of the Next Header field of an IPv6 header is 59 and if
the Payload Length field of the IPv6 header indicates the presence
of octets past the end of IPv6 Header those octets must be ignored,
and passed on unchanged if the packet is forwarded
TEST_REFERENCE
RFC 2460 s4.7 p24 No Next Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - The Next Header field of the IPv6 Header set to 59 and
          Payload Length field set to a non-zero value
        - The Data field containing a Hop-by-Hop Option Header with
          <UnrecognizedOptionType> of higher order 2-bits set to 01
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
- DUT: Ignore Echo request and do not Send Echo Reply message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Next Header field
value of IPv6 header set to 59
Sending ICMPv6 Echo Request Packet with Next header value as 59 in IPv6 Headerfollowed by Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = No Next Header (59)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPV6: --- Trailing Data [36 bytes] ---
IPV6:  3A 00 54 04 49 50 76 36 80 00 1A 41 00 00 00 00   :.T.IPv6...A....
IPV6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
IPV6:  53 54 45 52                                       STER
IPV6: --- Trailing Data End ---

DUT correctly ignored the Echo Request and did not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-9.3: Passed

>> IPV6-9.4
TEST_DESCRIPTION
If the value of the Next Header field of any extension header is 59
and if the Payload Length field of the IPv6 header indicates the
presence of octets past the end of the header those octets must be
ignored, and passed on unchanged if the packet is forwarded
TEST_REFERENCE
RFC 2460 s4.7 p24 No Next Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Hop-by-Hop Option Header with Next Header Field set to 59
        - Destination Option Header, following Hop-by-Hop Option
          Header, with <UnrecognizedOptionType> of higher order
          2-bits set to 01
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Ignore the Echo Request and do not send Echo reply message <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header with Next Header Field set to 59 and followed by 
Destination Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = No Next Header (59)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
IPV6: --- Trailing Data [36 bytes] ---
IPV6:  3B 00 54 04 49 50 76 36 80 00 1A 41 00 00 00 00   ;.T.IPv6...A....
IPV6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
IPV6:  53 54 45 52                                       STER
IPV6: --- Trailing Data End ---

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly ignored the Echo Request and did not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-9.4: Passed

>> IPV6-10.1
TEST_DESCRIPTION
A node must be able to accept a fragmented packet that, after
reassembly, is as large as 1500 octets.
TEST_REFERENCE
RFC 2460 s5 p23 Packet Size Issues
TEST_METHOD
- ANVL: Construct an ICMPv6 Echo Request with more than <mtu> bytes
        of data. Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header with M flag set to 1
        - first half of the constructed ICMPv6 packet
- ANVL: Send an IPv6 packet to <DIface-0> containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Fragment Header with M flag set to 0
        - second half of the constructed ICMPv6 packet
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send Two Fragmented IPv6 packets to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of received ICMPv6 Echo Reply are same as those of ICMPv6
        Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with first half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 768 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x95C 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [752 bytes] ---
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending IPv6 Packet from 3ffe:1111::1111 to 3ffe:1111::9028
with second half of the constructed ICMPv6 packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 756 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 95 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 1
IPv6: 
IPV6: --- Trailing Data [748 bytes] ---
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41               AAAAAAAAAAAA
IPV6: --- Trailing Data End ---

Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1456 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 211010681
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x85C 
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [1440 bytes] ---
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 68 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 181 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 211010681
IPv6: 
IPV6: --- Trailing Data [60 bytes] ---
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
IPV6:  41 41 41 41 41 41 41 41 41 41 41 41               AAAAAAAAAAAA
IPV6: --- Trailing Data End ---

Reassembly is completed
The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-10.1: Passed

>> IPV6-12.1
TEST_DESCRIPTION
Nodes should ignore any bits of the Traffic Class field for which
they do not support a specific use
TEST_REFERENCE
RFC 2460 s7 p26 Traffic Classes
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Traffic Class field of IPv6 header set to non-zero value
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent.
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending an ICMPv6 Echo Request to DUT
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 1
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......01           = 1 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-12.1: Passed

>> IPV6-12.2
TEST_DESCRIPTION
Nodes should ignore any bits of the Traffic Class field for which
they do not support a specific use
TEST_REFERENCE
RFC 2460 s7 p24 Traffic Classes
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - Traffic Class field of IPv6 header set to non-zero value
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that all bits in the Traffic Class field in forwarded
        packet remains unaltered
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending an ICMPv6 Echo Request with non-zero Traffic Class
field value
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 1
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......01           = 1 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 1
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......01           = 1 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

All bits in the Traffic Class field in forwarded packet
correctly remain unaltered

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-12.2: Passed

>> IPV6-13.1
TEST_DESCRIPTION
Any transport or other upper-layer protocol that includes the
addresses from the IPv6 header in its checksum computation must
use the Pseudo-Header in their checksum calculation
TEST_REFERENCE
RFC 2460 s8.1 p26 Upper-Layer Checksums
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0> containing:
        - source address set to address of host-1
        -destination address set to address of DUT
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that the Pseudo-Header is included in the ICMPv6
        checksum calculation
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending an ICMPv6 Echo Request to DUT
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 1
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......01           = 1 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Pseudo-Header is correctly included in the ICMPv6 checksum
calculation

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-13.1: Passed

>> IPV6-13.2
TEST_DESCRIPTION
The IPv6 version of ICMP [ICMPv6] includes the Pseudo-Header in
its checksum computation
TEST_REFERENCE
RFC 2460 s8.1 p26 Upper-Layer Checksums
TEST_METHOD
- ANVL: Cause DUT to send a ICMPv6 Echo Request to <AIface-0>
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Request to <AIface-0>
- ANVL: Verify that Pseudo-Header is included in the ICMPv6
        checksum calculation
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.


Causing DUT to send ICMPv6 Echo Request of size 100
to	3ffe:1111::1111
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 100

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Waiting for an Echo Request from DUT
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping6 -c 1 -s 148 3ffe:1111::1111 
Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 148 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB74B (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 64798
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [140 bytes] ---
ICMPv6:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMPv6:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMPv6:  40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F   @ABCDEFGHIJKLMNO
ICMPv6:  50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F   PQRSTUVWXYZ[\]^_
ICMPv6:  60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F   `abcdefghijklmno
ICMPv6:  70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20   pqrstuvwxyz{|}~ 
ICMPv6:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ICMPv6:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ICMPv6:  41 42 43 44 45 46 47 48 49 4A 4B 4C               ABCDEFGHIJKL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Pseudo-Header is correctly included in the ICMPv6 checksum
calculation

Pinging 3ffe:1111::1111 (3ffe:1111::1111) with 148 bytes of data:

--- 3ffe:1111::1111 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1016 ms
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-13.2: Passed

>> IPV6-14.1
TEST_DESCRIPTION
IPv6 packets are transmitted in standard Ethernet frames where the
Ethernet type code MUST contain the value 86DD hexadecimal.
TEST_REFERENCE
NEGATIVE
RFC 2464 s3 p2 Frame Format
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request with Ethernet type code NOT
        EQUAL to 86DD (hex) to <DIface-0>
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send any ICMPv6 Echo Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request from 3ffe:1111::1111 to 3ffe:1111::9028
with Ethernet type code not equal to 0x86DD

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0xFFFF (unknown etherType)
ETHER:
ETHER: --- Trailing Data [64 bytes] ---
ETHER:  60 00 00 00 00 18 3A FF 3F FE 11 11 00 00 00 00   `.....:.?.......
ETHER:  00 00 00 00 00 00 11 11 3F FE 11 11 00 00 00 00   ........?.......
ETHER:  00 00 00 00 00 00 90 28 80 00 08 F8 00 00 00 00   .......(........
ETHER:  49 78 41 4E 56 4C 20 54 45 53 54 20 44 41 54 41   IxANVL TEST DATA
ETHER: --- Trailing Data End ---

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028
                       to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send any ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-14.1: Passed

>> IPV6-14.2
TEST_DESCRIPTION
IPv6 packets are transmitted in standard Ethernet frames where the
Ethernet type code MUST contain the value 86DD hexadecimal.
TEST_REFERENCE
RFC 2464 s3 p2 Frame Format
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request with Ethernet type code EQUAL
        to 86DD (hex) 
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply
- ANVL: Verify that Identification Number, Sequence Number and Data
        field of the received ICMPv6 Echo Reply are same as those
        of the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request from 3ffe:1111::1111 to 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 1
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......01           = 1 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for an Echo Reply from DUT
Received IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT sent expected Echo Reply
The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-14.2: Passed

>> IPV6-14.3
TEST_DESCRIPTION
An IPv6 packet with a multicast destination address DST, consisting
of the sixteen octets DST[1] through DST[16], is transmitted to the
Ethernet multicast address whose first two octets are the value 3333
hexadecimal and whose last four octets are the last four octets
of DST
TEST_REFERENCE
RFC 2464 s7 p5 Address Mapping -- Multicast
TEST_METHOD
- ANVL: Send a Neighbor Solicitation to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to solicited-node multicast address
        - IPv6 destination address DST consisting of sixteen octets
          DST[1] through DST[16], and transmitted to the Ethernet
          multicast address whose first two octets are the value
          3333 hexadecimal and whose last four octets are the last
          four octets of DST
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send Neighbor Advertisement Message to <AIface-0> 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation from 3ffe:1111::1111 to ff02::1:ff00:9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Neighbor Advertisement from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT sent expected Neighbor Advertisement

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-14.3: Passed

>> IPV6-14.4
TEST_DESCRIPTION
An IPv6 packet with a multicast destination address DST, consisting
of the sixteen octets DST[1] through DST[16], is transmitted to the
Ethernet multicast address whose first two octets are the value 3333
hexadecimal and whose last four octets are the last four octets
of DST
TEST_REFERENCE
NEGATIVE
RFC 2464 s7 p5 Address Mapping -- Multicast
TEST_METHOD
- ANVL: Send a Neighbor Solicitation to <DIface-0> containing:
        - destination address set to solicited-node multicast address
        - IPv6 destination address DST consisting of sixteen octets
          DST[1] through DST[16], and transmitted to the Ethernet
          multicast address whose first two octets are the value
          3333 hexadecimal and whose last four octets are NOT last
          four octets of DST
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Do not send Neighbor Advertisement to <AIface-0>
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation from 3ffe:1111::1111 to ff02::1:ff00:9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:00:00:0F:00
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly did not send Neighbor Advertisement

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-14.4: Passed

>> IPV6-15.1
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type,
with higher order 2-bits 00 of a Hop-by-Hop Option Header, it
skips over this option and continues processing the header
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 00
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0> 
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with unknown Hop-by-Hop Option Header with higher order 2-bits set to 00
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.1: Passed

>> IPV6-15.2
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header,
the sequence of options must be processed strictly in the order
they appear in the Header. If the processing IPv6 node does not
recognize the Option Type, with higher order 2-bits 00, it skips
over this option and continues processing the header
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with 4 options each of type
          <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 00, 00, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0> 
- ANVL: Verify that Identification Number, Sequence Number and Data
        of the received ICMPv6 Echo Reply are same as those of the
        ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with 4 unknown Hop-by-Hop Options Header with higher order 2-bits set to 00
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.2: Passed

>> IPV6-15.3
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type
with higher order 2-bits 01 of a Hop-by-Hop Option Header, it
discards the packet 
TEST_REFERENCE
RFC 2460 s4.2 p9 Options 
RFC 2460 s4.3 p11 Hop-by-Hop Options Header 
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 01 
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0> 
-  DUT: Discard the packet and do not send the ICMPv6 Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with unknown option-type in 
Hop-by-Hop Option Header with higher order 2-bits set to 01
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request with the
unknown option with higher order 2-bits set to 01, and did
not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.3: Passed

>> IPV6-15.4
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header,
the sequence of options must be processed strictly in the order
they appear in the Header and if the processing IPv6 node does not
recognize the Option Type with higher order 2-bits 01, it discards
the packet 
TEST_REFERENCE
RFC 2460 s4.2 p9 Options 
RFC 2460 s4.3 p11 Hop-by-Hop Options Header 
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with 4 options each of type
          <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 01, 10, 11 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0> 
-  DUT: Discard the packet and do not send the ICMPv6 Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with 4 unknown option-type in
Hop-by-Hop Option Header with higher order 2-bits set to 00, 01, 10, 11
respectively
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMPv6 Echo Request with 4
unknown options with higher order 2-bits set to 00, 01,
10, 11 respectively, and did not send ICMPv6 Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.4: Passed

>> IPV6-15.5
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type
with higher order 2-bits 10 of a Hop-by-Hop Option Header, it
discards the packet
Note: Discarding the packet is verified by not receiving the Echo
Reply packet
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
- DUT : Discard the Echo Request packet and do not send echo Reply 
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-By-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
DUT correctly discarded the ICMv6 Echo Request Packet with
unknown option with higher order 2-bits set to 10, and
did not do Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.5: Passed

>> IPV6-15.6
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
sequence of options must be processed strictly in the order they
appear in the Header. If the processing IPv6 node does not recognize
the Option Type with higher order 2-bits 10, it discards the packet
Note: Discarding the packet is verified by not receiving the Echo
Reply packet
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with 4 options each of
          type <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 10, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the Echo Request packet and do not send Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-By-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMv6 Echo Request Packet
with 4 unknown options with higher order 2-bits set to
00, 10, 01, 00 respectively, and did not send Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.6: Passed

>> IPV6-15.7
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Hop-by-Hop Option Header, it sends an
ICMP Parameter Problem, Code 2, message to the packet's
Source Address, pointing to the unrecognized Option Type
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
- DUT: Discard packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 Code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xC994 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 36 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [36 bytes] ---
ICMPv6: IPv6:  3A 00 94 04 49 50 76 36 80 00 1A 41 00 00 00 00   :...IPv6...A....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code
value 2 and Pointer pointing to Unrecognized Option type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.7: Passed

>> IPV6-15.8
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
options must be processed strictly in the order they appear in the
Header. If the processing IPv6 Host does not recognize the option Type
with higher order 2-bits 10, it discards the packet and sends an ICMP
Parameter Problem, Code 2, message to the packet's Source Address
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with 4 options each of
          type <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 10, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard packet and send ICMPv6 Parameter Problem message
        to <AIface-0>
- ANVL: Verify that received ICMPv6 Parameter Problem message has
        Code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-By-Hop option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xBB9 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 50
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 60 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [60 bytes] ---
ICMPv6: IPv6:  3A 03 14 04 49 50 76 36 01 00 94 04 49 50 76 36   :...IPv6....IPv6
ICMPv6: IPv6:  01 00 54 04 49 50 76 36 01 00 14 04 49 50 76 36   ..T.IPv6....IPv6
ICMPv6: IPv6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code
value 2 and Pointer pointing to Unrecognized Option type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.8: Passed

>> IPV6-15.9
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Hop-by-Hop Option Header, and with
multicast destination address, it discards the packet
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send a Neighbor Solicitation to <DIface-0>, with
        - source address set to address of host-1
        - target address set to address of DUT
        - destination address set to solicited-node multicast address
          corresponding to the target address
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet and do not send Neighbor Advertisement
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::1:ff00:9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the Neighbor Solicitation Packet with
unknown option with higher order 2-bits set to 10, and
did not send any Neighbor Advertisement

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.9: Passed

>> IPV6-15.10
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
higher order 2-bits 10 of a Hop-by-Hop Option Header, and with 
multicast destination address, it sends an ICMP Parameter Problem,
Code 2, message to the packet's Source Address, pointing to the
unrecognized Option Type
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send a Neighbor Solicitation to <DIface-0>, with
        - source address set to address of host-1
        - target address set to address of DUT
        - destination address set to solicited-node multicast address
          corresponding to the target address
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 10
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::1:ff00:9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xC990 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 40 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = ff02::1:ff00:9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [40 bytes] ---
ICMPv6: IPv6:  3A 00 94 04 49 50 76 36 87 00 2C CC 00 00 00 00   :...IPv6..,.....
ICMPv6: IPv6:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 90 28   ?..............(
ICMPv6: IPv6:  01 01 00 1B 21 7D 57 BA                           ....!}W.
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 148
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received an ICMPv6 Parameter Problem with Code 2 from DUT.
The ICMPv6 Pointer points to the Unrecognized Opiton type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.10: Passed

>> IPV6-15.11
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
the higher order 2-bits 11 of a Hop-by-Hop Option Header, it discards
the packet
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
 - ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
- DUT : Discard the Echo Request packet and do not send Echo Reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-By-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMv6 Echo Request Packet with
unknown option with higher order 2-bits set to 11, and
did not send Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.11: Passed

>> IPV6-15.12
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
sequence of options must be processed strictly in the order they
appear in the Header. If the processing IPv6 node does not recognize
the Option Type with higher order 2-bits 11, it discards the packet 
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with 4 options each of
          type <UnrecognizedOptionType> having higher order 2-bits
          set to 00, 11, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the Echo Request packet, and did not send echo reply
        to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-BY-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Parameter Problem packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly discarded the ICMv6 Echo Request Packet with 4 unknown
options with higher order 2-bits set to 00, 11, 01, 00 respectively
did not send Echo Reply

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.12: Passed

>> IPV6-15.13
TEST_DESCRIPTION
If the processing IPv6 node does not recognize the Option Type with
the higher order 2-bits 11 of a Hop-by-Hop Option Header and only
if the packet's Destination Address was not a multicast address, it
sends an ICMP Parameter Problem, Code 2, message to the packet's
Source Address, pointing to the unrecognized Option Type 
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0x8994 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 36 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [36 bytes] ---
ICMPv6: IPv6:  3A 00 D4 04 49 50 76 36 80 00 1A 41 00 00 00 00   :...IPv6...A....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code
value 2 and Pointer pointing to Unrecognized Option type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.13: Passed

>> IPV6-15.14
TEST_DESCRIPTION
When multiple options are present in a Hop-by-Hop Option Header, the
options must be processed strictly in the order they appear. If the
processing IPv6 node does not recognize the Option Type with higher
order 2-bits 11, with unicast Hop-by-Hop Address, it sends an ICMP
Parameter Problem, Code 2, message to the packet's Source Address
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option Header with 4 options each of type
          <UnrecognizedOptionType>, having higher order 2-bits set
          to 00, 11, 01, 00 respectively
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard the packet, and send an ICMPv6 Parameter Problem
        message to <AIface-0>
- ANVL: Verify that received ICMPv6 packet contains Code value 2
        - ICMPv6 Pointer field pointing to unrecognized Option Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-By-Hop option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 2 (Unrecognized IPv6 options encountered)
ICMPv6: Checksum           = 0xCBB8 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 50
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 60 (bytes)
ICMPv6: IPv6: Next Header          = Hop-by-Hop Header (0)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [60 bytes] ---
ICMPv6: IPv6:  3A 03 14 04 49 50 76 36 01 00 D4 04 49 50 76 36   :...IPv6....IPv6
ICMPv6: IPv6:  01 00 54 04 49 50 76 36 01 00 14 04 49 50 76 36   ..T.IPv6....IPv6
ICMPv6: IPv6:  80 00 1A 41 00 00 00 00 49 50 56 36 5F 50 52 4F   ...A....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 84
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 0
IPv6: --- PadN Data [0 bytes] ---
IPv6: --- PadN Data End ---
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem with Code
value 2 and Pointer pointing to Unrecognized Option type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.14: Passed

>> IPV6-15.15
TEST_DESCRIPTION
If the processing IPv6 host does not recognize the Option Type with
the higher order 2-bits 11 of a Hop-by-Hop Option Header and if the
packet's Destination Address was a multicast address, it does not
send ICMP Parameter Problem, Code 2, message to the packet's Source
Address
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
RFC 2460 s4.3 p11 Hop-by-Hop Options Header
TEST_METHOD
- ANVL: Send an ICMPv6 Neighbor Solicitation to <DIface-0>, containing:
        - source address set to address of host-1
        - Destination address is multicast address of DUT
        - a Hop-by-Hop Option Header with <UnrecognizedOptionType>,
          having higher order 2-bits set to 11
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Discard Packet and Do not send any ICMP Parameter problem to <AIface-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending Neighbor Solicitation Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to ff02::1:ff00:9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 40 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 212
IPv6: Data Len             = 4
IPv6: --- Option Data [4 bytes] ---
IPv6:  49 50 76 36                                       IPv6
IPv6: --- Option Data End ---
IPv6:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028 
to 3ffe:1111::1111
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly ignored the received Neighbr Solicitation,
and did not send any ICMPv6 Parameter Problem

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.15: Passed

>> IPV6-15.16
TEST_DESCRIPTION
Pad1 option can be used to pad out a Hop-by-Hop Option header to a
multiple of 8 octets in length
TEST_REFERENCE
RFC 2460 s4.2 p9 Options
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option header. The required alignment of
          the Hop-by-Hop Option header is done by inserting only
          the Pad1 option
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and
        Data of the received ICMPv6 Echo Reply are the same as
        those of the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header with unknown option with higher order 2-bits set to 00
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- Option ---- 
IPv6: 
IPv6: Type                 = 20
IPv6: Data Len             = 3
IPv6: --- Option Data [3 bytes] ---
IPv6:  49 50 36                                          IP6
IPv6: --- Option Data End ---
IPv6:
IPv6: ---- Pad1 Option ----
IPv6: 
IPv6: data                 = 0
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.16: Passed

>> IPV6-15.17
TEST_DESCRIPTION
PadN option can be used to pad out a Hop-by-Hop Option header to a
multiple of 8 octets in length
TEST_REFERENCE
RFC 2460 s4.2 p11 Options
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Hop-by-Hop Option header. The required alignment of
          the Hop-by-Hop Option header is done by inserting only
          the PadN options
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and
        Data of the received ICMPv6 Echo Reply are the same as
        those of the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Hop-by-Hop Option Header
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 36 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo Reply
have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-15.17: Passed

>> IPV6-16.1
TEST_DESCRIPTION
If Segments Left is zero, the node must ignore the Routing header
and proceed to process the next header in the packet, whose type
is identified by the Next Header field in the Routing header.
TEST_REFERENCE
RFC 5095 s3 p3 Deprecation of RH0
TEST_METHOD
-  DUT: Enable Deprecation of RH0 Support
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header of type zero.
          Address field of the Routing Option Header is set to the
          address of host-2, with Segments Left field set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        of ICMPv6 Echo Reply are same as those of ICMPv6 Echo
        Request sent
-  DUT: Disable Deprecation of RH0 Support
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Enable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "0"
sysvar: ipnet.inet6.RtHdr0=0 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=0
-> exit
Au revoir!
Connection closed by foreign host.

_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Routing Option Header
of type zero
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 0
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Disable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "1"
sysvar: ipnet.inet6.RtHdr0=1 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=1
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-16.1: Passed

>> IPV6-16.4
TEST_DESCRIPTION
An IPv6 node that receives a packet with a destination address
assigned to it and that contains an RH0 extension header MUST NOT
execute the algorithm specified in the latter part of Section 4.4
of [RFC2460] for RH0.
Note: Tests that RFC2460 algorithm is not executed - If the IPv6
node receives an IPv6 packet with Routing Header Type zero,
non-zero Segments Left field and odd Hdr Ext Len field, then the
node sends an ICMP Parameter Problem, Code 0, message to the Source
Address, pointing to the Hdr Ext Len field
TEST_REFERENCE
RFC 2460 s4.4 p14 Routing Header
TEST_METHOD
-  DUT: Enable Deprecation of RH0 Support
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header of type zero.
          Address field of the Routing Option Header is set to the
          address of host-2, Segments Left field set to 1 and an
          odd Hdr Ext Len value
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 0
        - ICMPv6 Pointer field pointing to Unrecognized Routing Type
-  DUT: Disable Deprecation of RH0 Support
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Enable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "0"
sysvar: ipnet.inet6.RtHdr0=0 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=0
-> exit
Au revoir!
Connection closed by foreign host.

_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Routing Option Header
of type zero
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 1
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
IPV6: --- Trailing Data [8 bytes] ---
IPV6:  00 00 00 00 00 00 00 00                           ........
IPV6: --- Trailing Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 0 (Errorneous header field encountered)
ICMPv6: Checksum           = 0x10B6 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 60 (bytes)
ICMPv6: IPv6: Next Header          = Routing Header (43)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [60 bytes] ---
ICMPv6: IPv6:  3A 03 00 01 00 00 00 00 3F FE 22 22 00 00 00 00   :.......?.""....
ICMPv6: IPv6:  00 00 00 00 00 00 22 22 00 00 00 00 00 00 00 00   ......""........
ICMPv6: IPv6:  80 00 77 36 00 00 00 00 49 50 56 36 5F 50 52 4F   ..w6....IPV6_PRO
ICMPv6: IPv6:  54 4F 43 4F 4C 5F 54 45 53 54 45 52               TOCOL_TESTER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 3 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 1
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
IPV6: --- Trailing Data [8 bytes] ---
IPV6:  00 00 00 00 00 00 00 00                           ........
IPV6: --- Trailing Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 0,
pointing to Unrecognized Routing Type

Disable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "1"
sysvar: ipnet.inet6.RtHdr0=1 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=1
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-16.4: Passed

>> IPV6-16.5
TEST_DESCRIPTION
An IPv6 node that receives a packet with a destination address
assigned to it and that contains an RH0 extension header MUST NOT
execute the algorithm specified in the latter part of Section 4.4
of [RFC2460] for RH0.
Note: Tests that RFC2460 algorithm is not executed - If the IPv6
node receives an IPv6 packet with Routing Header Type zero,
Segments Left field value greater than the number of addresses in
the Routing header and even Hdr Ext Len, then the node sends an ICMP
Parameter Problem, Code 0, message to the Source Address, pointing
to the Segments Left field
TEST_REFERENCE
RFC 2460 s4.4 p14 Routing Header
TEST_METHOD
-  DUT: Enable Deprecation of RH0 Support
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header of type zero.
          Address field of the Routing Option Header is set to the
          address of host-2, Hdr Ext Len field is set to an even
          value and Segments Left field value set to 4
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 0
        - ICMPv6 Pointer field pointing to Unrecognized Routing
        - Type
-  DUT: Disable Deprecation of RH0 Support
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Enable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "0"
sysvar: ipnet.inet6.RtHdr0=0 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=0
-> exit
Au revoir!
Connection closed by foreign host.

_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Routing Option Header
of type zero
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::
Problem in Routing Header :
Segment left field(4) is greater than half of Header Ext len(2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 4
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Checksum can't be calculated)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111
Problem in Routing Header :
Segment left field(4) is greater than half of Header Ext len(2)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 0 (Errorneous header field encountered)
ICMPv6: Checksum           = 0x10C4 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 52 (bytes)
ICMPv6: IPv6: Next Header          = Routing Header (43)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [52 bytes] ---
ICMPv6: IPv6:  3A 02 00 04 00 00 00 00 3F FE 22 22 00 00 00 00   :.......?.""....
ICMPv6: IPv6:  00 00 00 00 00 00 22 22 80 00 77 36 00 00 00 00   ......""..w6....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 4
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Checksum can't be calculated)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 0,
pointing to Unrecognized Routing Type

Disable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "1"
sysvar: ipnet.inet6.RtHdr0=1 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=1
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-16.5: Passed

>> IPV6-16.6
TEST_DESCRIPTION
An IPv6 node that receives a packet with a destination address
assigned to it and that contains an RH0 extension header MUST NOT
execute the algorithm specified in the latter part of Section 4.4
of [RFC2460] for RH0.
Note: Tests that RFC2460 algorithm is not executed - If the IPv6
Hop Limit is less than or equal to 1, send an ICMP Time Exceeded
-- Hop Limit Exceeded in Transit message to the Source Address
TEST_REFERENCE
RFC 5095 s3 p3 Deprecation of RH0
TEST_METHOD
- ANVL: Perform Router Solicitation
-  DUT: Enable Deprecation of RH0 Support
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header of type zero.
          Address field of the Routing Option Header is set to the
          address of host-2, and the IPv6 header Hop Limit field is
          set to <HopLimit>
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 0
        - ICMPv6 Pointer field pointing to unrecognized Routing
          Type
-  DUT: Disable Deprecation of RH0 Support
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Enable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "0"
sysvar: ipnet.inet6.RtHdr0=0 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=0
-> exit
Au revoir!
Connection closed by foreign host.

_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.


 <CASE>: Hop Limit is 1
Sending ICMPv6 Echo Request Packet with Routing Option
Header of type zero
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 1
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 1
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 0 (Errorneous header field encountered)
ICMPv6: Checksum           = 0x11C5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 52 (bytes)
ICMPv6: IPv6: Next Header          = Routing Header (43)
ICMPv6: IPv6: Hop Limit            = 1
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [52 bytes] ---
ICMPv6: IPv6:  3A 02 00 01 00 00 00 00 3F FE 22 22 00 00 00 00   :.......?.""....
ICMPv6: IPv6:  00 00 00 00 00 00 22 22 80 00 77 36 00 00 00 00   ......""..w6....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 1
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 1
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 0,
pointing to the Unrecognized Option Type

 <CASE>: Hop Limit is 0
Sending ICMPv6 Echo Request Packet with Routing Option
Header of type zero
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 0
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 1
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Source Quench from 3ffe:1111::9028 
to 3ffe:1111::1111 
Received Neighbor Solicitation from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xD4CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = 3ffe:2222::9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC181 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::2222
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Ignoring ICMPv6 Neighbor Solicitation packet from 3ffe:1111::9028
 to 3ffe:1111::1111
Ignoring ICMPv6 *Unknown Type 135* from 3ffe:1111::9028 
to 3ffe:1111::1111 
Received Neighbor Solicitation from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2A26 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x16D9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 0,
pointing to the Unrecognized Option Type

Disable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "1"
sysvar: ipnet.inet6.RtHdr0=1 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=1
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-16.6: Passed

>> IPV6-16.7
TEST_DESCRIPTION
An IPv6 node that receives a packet with a destination address
assigned to it and that contains an RH0 extension header MUST NOT
execute the algorithm specified in the latter part of Section 4.4
of [RFC2460] for RH0.
Note: Tests that RFC2460 algorithm is not executed - If the IPv6
If the IPv6 Hop Limit is greater than 1 send an ICMP Time Exceeded
 -- Hop Limit Exceeded in Transit message to the Source Address
TEST_REFERENCE
RFC 5095 s3 p3 Deprecation of RH0
TEST_METHOD
- ANVL: Perform Router Solicitation
-  DUT: Enable Deprecation of RH0 Support
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header of type zero.
          Address field of the Routing Option Header is set to the
          address of host-2, and the IPv6 header Hop Limit field is
          set to 4 (greater than 1)
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 0
        - ICMPv6 Pointer field pointing to unrecognized Routing
          Type
-  DUT: Disable Deprecation of RH0 Support
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Enable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "0"
sysvar: ipnet.inet6.RtHdr0=0 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=0
-> exit
Au revoir!
Connection closed by foreign host.

_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Routing Option
Header of type zero
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 4
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 1
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 0 (Errorneous header field encountered)
ICMPv6: Checksum           = 0x11C2 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 52 (bytes)
ICMPv6: IPv6: Next Header          = Routing Header (43)
ICMPv6: IPv6: Hop Limit            = 4
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [52 bytes] ---
ICMPv6: IPv6:  3A 02 00 01 00 00 00 00 3F FE 22 22 00 00 00 00   :.......?.""....
ICMPv6: IPv6:  00 00 00 00 00 00 22 22 80 00 77 36 00 00 00 00   ......""..w6....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 4
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6:      (Deprecated per RFC5095)
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 0
IPv6: Segments Left        = 1
IPv6: 
IPv6: ---- Type Zero ----
IPv6: 
IPv6: Reserved             = 0
IPv6: Address[1]           = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 0,
pointing to the Unrecognized Option Type

Disable Deprecation of RH0 in DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet6.RtHdr0 "1"
sysvar: ipnet.inet6.RtHdr0=1 ok
-> cmd sysvar get ipnet.inet6.RtHdr0 
sysvar: ipnet.inet6.RtHdr0=1
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-16.7: Passed
Executing system command:
  "./DocScriptQ35/IPV6/IPV6postsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipnet_radvd
ipd: kill ipnet_radvd ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar unset ipnet.inet6.AcceptRtAdv 
sysvar: 'ipnet.inet6.AcceptRtAdv' unset ok
-> cmd sysvar unset ipnet.inet6.radvd.interfaces 
sysvar: 'ipnet.inet6.radvd.interfaces' unset ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          108
Number of tests passed:       108
Number of tests failed:       0
Number of tests inconclusive: 0
