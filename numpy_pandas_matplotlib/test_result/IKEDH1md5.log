ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5773728 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlike_dh1_md5 ike 2.19, 4.9, 7.7, 14.5, 16.9, 18.11 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlike_dh1_md5.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IKE/IKEpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         "./DocScriptQ35/IKE/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IKE Suite Setup Command                  "./DocScriptQ35/IKE/ike-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE ISAKMP SA Initiate Command           "./DocScriptQ35/IKE/ike-isakmp-sa-initiate-group1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE IPSec SA Initiate Command            "./DocScriptQ35/IKE/ike-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Another IPSec SA Initiate Command    "./DocScriptQ35/IKE/ike-another-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Restart Command                      "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Specify DES MD5 Attribute Command    "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Specify DES SHA Attribute Command    "./DocScriptQ35/IKE/ike-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Combined SA Initiate Command         "./DocScriptQ35/IKE/ike-combined-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Two SA Initiate Command              "./DocScriptQ35/IKE/ike-two-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Aggressive Mode Initiate Command     "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-group1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE New Group Mode Initiate Command      "./DocScriptQ35/IKE/ike-new-group-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Aggressive Mode Configure Command    "./DocScriptQ35/IKE/ike-aggressive-mode-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE SA Down Command                      "./DocScriptQ35/IKE/ike-sa-down-command.exp $ANVL_DUTHOSTNAME"
IKE Certificate Data                     "abcdefghijklmnop"
IKE Certificate Type                     2                   # (0x00000002)
IKE Signature Data                       "ABCDEFGHIJKLMNOP"
IKE Retransmit Count                     3                   # (0x00000003)
IKE Unique Cookie Test Count             3                   # (0x00000003)
IKE Test Timeout                         60                  # (0x0000003C)
IKE DUT Major Version                    1                   # (0x00000001)
IKE DUT Minor Version                    1                   # (0x00000001)
IKE Non Zero Value                       1                   # (0x00000001)
IKE Nonce Payload Invalid Length         7                   # (0x00000007)
IKE ID Payload Invalid Port              10                  # (0x0000000A)
IKE ID Payload Invalid Protocol          10                  # (0x0000000A)
IKE Invalid Exchange Type                10                  # (0x0000000A)
IKE Invalid Message ID                   10                  # (0x0000000A)
IKE Invalid DOI                          10                  # (0x0000000A)
IKE Invalid Protocol ID                  10                  # (0x0000000A)
IKE Invalid Transform ID                 10                  # (0x0000000A)
IKE Invalid Attribute Class              20                  # (0x00000014)
IKE Invalid SPI                          210                 # (0x000000D2)
IKE DUT Supports Certificate Payload Processing True
IKE DUT Supports Main Mode As Initiator  True
IKE DUT Supports Main Mode As Responder  True
IKE DUT Supports Quick Mode As Initiator True
IKE DUT Supports Quick Mode As Responder True
IKE DUT Supports Aggressive Mode As Initiator True
IKE DUT Supports Aggressive Mode As Responder True
IKE DUT Supports New Group Mode As Initiator False
IKE DUT Supports New Group Mode As Responder False
IKE DUT Supports Sending of Notification Message True
IKE DUT Supports Traffic Processing before CONNECTED Notify False
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlike_dh1_md5.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               4                 # (0x00000004)
  IPV6 DUT Address                         ::
  IPV6 ANVL Address                        ::
  IPV6 Gateway                             ::
  IPV6 Subnet Mask                         0                 # (0x00000000)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               4                 # (0x00000004)
  IPV6 DUT Address                         ::
  IPV6 ANVL Address                        ::
  IPV6 Gateway                             ::
  IPV6 Subnet Mask                         0                 # (0x00000000)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Remote Host Address             30.1.1.150
  IPSec IP Local Host Address              40.1.1.150
  IPSec IP Encapsulation                   v4Ov4
  IPSec Configuration                      Auto
  IPSec IPv6 Remote Host Address           ::
  IPSec IPv6 Local Host Address            ::
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          MD5
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                ESP_DES
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Encapsulation Mode          TUNNEL
  IKE IPSec SA Authentication Algorithm    HMAC_SHA
  IKE Alternative ISAKMP SA Encryption Algorithm 3DES_CBC
  IKE Alternative ISAKMP SA Hashing Algorithm MD5
  New Group Description                    32768             # (0x00008000)
  New Group Prime                          "FFFDFF6FF2FF3FFFC90FDAA22168C234C6C6628B86DC6CD129064E088A676C74020B6EA636139B62564A06798634646D6F6569B3CD3A431B302B0A6DF25F14676FE6366D66516245E4656576665E6EC6F66662E9A6"
  New Group Generator                      "3"
  New Group Modulus Length                 680               # (0x000002A8)
  IKE Pre-Shared Key                       abcdef

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
0:DUT_HOSTNAME:128.224.166.238
1 ENCRYPTED_DIFACE_INDEX:0
1ENCRYPTED_DIFACE:30.1.1.5
1UNENCRYPTED_DIFACE:40.1.1.5
1ENCRYPTED_SESSION_STARTPOINT:40.1.1.150
ENCRYPTED_SESSION_ENDPOINT:30.1.1.150
IPSEC_MODE:TUNNEL
AUTH_METHOD:PRESHARED-KEY
ISAKMP_HASHING_ALGO:MD5
ISAKMP_ENCRYPTION_ALGO:DES_CBC
ISAKMP_GROUP_DESCRIPTION:MODP768
ALTERNATE_ISAKMP_HASHING_ALGO:MD5
ALTERNATE_ISAKMP_ENCRYPTION_ALGO:3DES_CBC
IPSEC_AUTH_ALGO:HMAC_SHA
IPSEC_ENCRYPTION_ALGO:ESP_DES
IPSEC_GROUP_DESCRIPTION:MODP1024
IPSEC_PROTOCOL:ESP
PRESHARED_KEY:abcdef
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask 255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask 255.255.255.0 up
-> cmd ifconfig -a
lo0	Link type:Local loopback
	inet 127.0.0.1  mask 255.255.255.255
	inet6 unicast fe80::1%lo0  prefixlen 64  automatic
	inet6 unicast ::1  prefixlen 128
	UP RUNNING LOOPBACK MULTICAST NOARP ALLMULTI 
	MTU:1500  metric:1  VR:0  ifindex:1
	RX packets:1182269 mcast:3395 errors:0 dropped:0
	TX packets:1182269 mcast:3395 errors:0
	collisions:0 unsupported proto:0
	RX bytes:87888207 (87 M)  TX bytes:87888207 (87 M)

gei2	Link type:Ethernet  HWaddr 00:25:90:04:e2:de
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 128.224.166.238  mask 255.255.254.0  broadcast 128.224.167.255
	inet6 unicast fe80::225:90ff:fe04:e2de%gei2  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:2
	RX packets:861192 mcast:21911 errors:0 dropped:2533
	TX packets:62204 mcast:1126 errors:0
	collisions:0 unsupported proto:0
	RX bytes:64473247 (64 M)  TX bytes:6565230 (6565 k)

gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:49
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:132

gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:50
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> cmd sysvar set -co ipike.strict_lifetime_policy "1"
sysvar: ipike.strict_lifetime_policy=1 ok
-> cmd sysvar get ipike.strict_lifetime_policy 
sysvar: ipike.strict_lifetime_policy=1
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill iprip
ipd: kill iprip failed: not started
-> cmd ipd kill ipike
ipd: kill ipike failed: not started
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5


! Couldn't find DUT at 30.1.1.5
! Some tests may fail because of this
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite Internet Key Exchange (IKE)
RFC 2407: 'The Internet IP Security Domain of Interpretation
for ISAKMP'
(D. Piper Network Alchemy, November 1988)
RFC 2408: 'Internet Security Association and Key Management
Protocol (ISAKMP)'
(D. Maughan National Security Agency,
M. Schertler Securify, Inc.
M. Schneider National Security Agency,
J. Turner RABA Technologies, Inc., November 1998)
RFC 2409: The Internet Key Exchange (IKE)
(D. Harkins, D. Carrel, Cisco Systems, November 1998


ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the machine on which ANVL is running
be connected to 2 interfaces that are connected
to the device under test.

The ANVL config file must contain 2 IP interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IKE-2.19
TEST_DESCRIPTION
IKE MUST support DES_CBC, MD5, Authentication via pre-shared keys and
MODP over default group number one
.Main mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 IntroductionTEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using Main Mode
        with SA Attributes = {Encryption algo: DES_CBC, Hash algo: MD5,
        Auth Method: Authentication via pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA> with requested SA Attributes
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_COMB-SA.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Main Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-isakmp-sa-initiate-group1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_init_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_init_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> c
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received ISAKMP packet from 30.1.1.5 with Exchange type
Identity Protection Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 128 bytes
IP: Identification         = 0xEBAC (60332)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5024 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0xB9D7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CB A8 29 54 93 0C 9A D9                           ..)T....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly received Encryption Algorithm = 1
Correctly received Group Descryption = 1
Correctly received Hash Algorithm = 1
Correctly received Authentication Method = 1
Correctly received <HDR,SA> Packet from
DUT with requested SA attributes 

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVxit
Au revoir!
Connection closed by foreign host.
L_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-2.19: Passed

>> IKE-4.9
TEST_DESCRIPTION
IKE MUST support DES_CBC, MD5, Authentication via pre_shared
keys and MODP over default group number one.
Main mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA> Packet with 1 Proposal Payload containing the
        protocol PROTO_ISAKMP and Transform Payload containing the
        Transform KEY_IKE with SA Attributes =
        {Encryption algorithm: DES_CBC, Hash algorithm: MD5,
        Authentication Method: Authentication via pre_shared keys,
        Group: MODP over group number one}
-  DUT: Send <HDR,SA> Packet with the same Proposal Payload containing
        the same Transform Payload with the SA Attributes sent by
        the initiator
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_COMB-SA.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA> Packet with 1 Proposal Payload containing the
protocol PROTO_ISAKMP and Transform Payload containing the
Transform KEY_IKE with SA Attributes =
{Encryption algorithm: DES_CBC, Hash algorithm: MD5,
Authentication Method: Authentication via pre_shared keys,
Group: MODP over group number one} to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 100 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BEC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0xEA4D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD 36 AD 50 B7 19 BB 09                           .6.P....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Identity Protection Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 128 bytes
IP: Identification         = 0xEBAD (60333)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5023 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0xEB57 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD 36 AD 50 B7 19 BB 09                           .6.P....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7F 8F 24 0B C7 8E 2A 10                           ..$...*.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-4.9: Passed

>> IKE-7.7
TEST_DESCRIPTION
IKE will not respond to an ISAKMP packet without one of the
following 4 mandatory SA attributes: Encryption algorithm,
Hash algorithm, Authentication method, Group value.
Main mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA> Packet with Proposal Payload containing the
        protocol PROTO_ISAKMP, Transform Payload containing the
        Transform KEY_IKE with SA Attributes as <SA  Attributes>
-  DUT: Do not send <HDR,SA> packet
- CASE: <SA  Attributes> = { Encryption Algorithm:  DES_CBC,
                             Hash Algorithm:        MD5,
                             Authentication Method: Pre-shared keys }
- CASE: <SA  Attributes> = { Encryption Algorithm:  DES_CBC,
                             Hash Algorithm:        MD5,
                             Group: MODP over group number one }
- CASE: <SA  Attributes> = { Encryption Algorithm:  DES_CBC,
                             Authentication Method: Pre-shared keys
                             Group: MODP over group number one}
- CASE: <SA  Attributes> = { Hash Algorithm: MD5,
                             Authentication Method: Pre-shared keys
                             Group: MODP over group number one}
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_COMB-SA.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 1: Group Description Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0002 (2)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BEF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0x5059 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A9 8C E7 2B 43 D7 12 2D                           ...+C..-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBAE (60334)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x504E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7EC5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A9 8C E7 2B 43 D7 12 2D                           ...+C..-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7A 6C 48 25 3C 12 F4 6A                           zlH%<..j
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xAB0CCDFC
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A9 8C E7 2B 43 D7 12 2D 7A 6C 48 25 3C 12 F4 6A   ...+C..-zlH%<..j
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 2: Authentication Method Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BEE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0x3A76 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B2 B1 19 3D 86 5F AA 50                           ...=._.P
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBAF (60335)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x504D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD772 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B2 B1 19 3D 86 5F AA 50                           ...=._.P
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  A2 1E E9 A4 1B 0E CC FA                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7B867796
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  B2 B1 19 3D 86 5F AA 50 A2 1E E9 A4 1B 0E CC FA   ...=._.P........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 3: Hash Algorithm Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0xA84B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AB 5B 7D 21 5D 28 09 23                           .[}!](.#
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBB0 (60336)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x504C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x8CE7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AB 5B 7D 21 5D 28 09 23                           .[}!](.#
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  99 92 17 0E 18 44 97 67                           .....D.g
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xBD8782CD
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  AB 5B 7D 21 5D 28 09 23 99 92 17 0E 18 44 97 67   .[}!](.#.....D.g
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 4: Encryption Algorithm Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3BEC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0xB2F8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6A 04 DD 57 5F 64 DD 59                           j..W_d.Y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBB1 (60337)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x504B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3E8B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6A 04 DD 57 5F 64 DD 59                           j..W_d.Y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  37 8A F9 46 AD E7 2E 56                           7..F...V
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x8AF4BF93
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  6A 04 DD 57 5F 64 DD 59 37 8A F9 46 AD E7 2E 56   j..W_d.Y7..F...V
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-7.7: Passed

>> IKE-14.5
TEST_DESCRIPTION
TEST_DESCRIPTION
IKE MUST support DES_CBC,MD5,Authentication via pre_shared keys
and MODP over default group number one.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode with SA Attributes = {Encryption algo: DES_CBC,
        Hash algo: MD5, Auth Method: Authentication via pre_shared
        keys, Group: MODP over group number one }
-  DUT: Send <HDR,SA,KE,Ni,IDii> with requested SA Attributes 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_COMB-SA.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-aggressive-mode-initiate-group1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_aggressive_init_group1_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init_group1_md5.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_aggressive_init_group1_md5.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cReceived ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0xEBB2 (60338)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4F6A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x149F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4F 28 F4 CC F8 DD 28 11                           O(....(.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  94 1C 40 84 50 75 E0 70 C0 F1 11 47 BF B4 21 18   ..@.Pu.p...G..!.
ISAKMP:  D7 AC DB ED C5 A5 E0 38 AF 02 C1 A6 05 E9 00 0F   .......8........
ISAKMP:  FF 89 6B 9B FA D2 5B 74 F9 DF 6C C4 AE 24 01 BE   ..k...[t..l..$..
ISAKMP:  F7 8F 4C E1 BF BD C4 C2 C4 93 F4 E1 78 DF D6 25   ..L.........x..%
ISAKMP:  D1 E2 5C 69 AE 87 00 9A 3A 8A D4 D5 B7 6D 9D B7   ..\i....:....m..
ISAKMP:  41 28 2C 14 60 94 54 B3 A0 20 FA 26 B1 01 78 B3   A(,.`.T.. .&..x.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  2D D1 E0 23 C8 19 EF 40 C0 72 11 EC 85 24 37 9A   -..#...@.r...$7.
ISAKMP:  7F FA 8F 68 93 58 4B DC EC 12 7A B4 A0 DC FC A8   ...h.XK...z.....
ISAKMP:  39 2C E1 2F C2 84 6E 9D 42 63 E5 CA E4 C4 E6 4C   9,./..n.Bc.....L
ISAKMP:  83 56 74 84 2D 4E EC 3F 7F 0D AF 46 4D 32 BD E4   .Vt.-N.?...FM2..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
30.1.1.5 (on interface 30.1.1.150)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
4 mandatory SA Attrbitues as requested

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
md ipd start ipike
ipd: start ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVxit
Au revoir!
Connection closed by foreign host.
L_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-14.5: Passed

>> IKE-16.9
TEST_DESCRIPTION
IKE MUST support DES_CBC,MD5,Authentication via pre_shared keys and
MODP over default group number one
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>  with one Proposal Payload containing
        the protocol PROTO_ISAKMP and Transform Payload cantaining the
        Transform KEY_IKE with SA Attributes =         {Encryption algo: DES_CBC,
        Hash algo: MD5, Auth Method:         Authentication via pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the same
        Proposal Payload containing the same Transform Payload
        with the SA Attributes sent by the initiator
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_COMB-SA.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii>  with one Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload cantaining the
Transform KEY_IKE with SA Attributes = {Encryption algo: DES_CBC,
Hash algo: MD5, Auth Method: Authentication via pre_shared keys,
Group: MODP over group number one } to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 232 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B63 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 212 
UDP: Checksum         = 0xD9B8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8D FD D5 50 86 A9 59 00                           ...P..Y.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 204 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  16 9A 20 89 8D E3 11 4C 87 F7 34 7D 56 A8 4E A6   .. ....L..4}V.N.
ISAKMP:  E5 B1 15 F8 68 E5 2F 9C 28 49 08 B6 71 BD 44 7B   ....h./.(I..q.D{
ISAKMP:  4C DD DC CE 8E 51 24 B8 BE 69 A5 5F F8 D5 86 72   L....Q$..i._...r
ISAKMP:  D9 4F F3 5D 15 D6 A0 01 3D 65 59 C5 21 8B 91 41   .O.]....=eY.!..A
ISAKMP:  49 0F 7A 7F A9 2E C6 BC 15 C5 E4 13 07 F7 64 FC   I.z...........d.
ISAKMP:  A0 48 3B 11 A5 95 FD 87 37 60 B3 F0 43 18 C0 6E   .H;.....7`..C..n
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A1 22 CB 1A 32 3A 76 36 7E E7 8D 71 87 0B 71 34   ."..2:v6~..q..q4
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Aggressive Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xEBB3 (60339)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4F55 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 308 
UDP: Checksum         = 0x8B4E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8D FD D5 50 86 A9 59 00                           ...P..Y.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  89 7A 34 60 06 15 A5 54                           .z4`...T
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 300 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  BD 1B BE F5 94 05 B2 5F 76 4A 0F 64 F7 B3 B8 AD   ......._vJ.d....
ISAKMP:  7E A8 A9 DA B3 3A 01 0E AF 55 A2 88 95 B6 4E E4   ~....:...U....N.
ISAKMP:  55 49 20 2A 23 51 F0 DE 9A A9 D0 32 8C AF 54 91   UI *#Q.....2..T.
ISAKMP:  29 D9 4C C2 DF B4 D8 E6 C9 5A 3E C0 D3 77 D3 25   ).L......Z>..w.%
ISAKMP:  E6 E2 06 C8 38 01 5D 47 AD C5 82 69 96 06 2A 7D   ....8.]G...i..*}
ISAKMP:  F1 EF 7A 9F 27 1C E8 68 59 8D 0C F2 62 DA 22 DE   ..z.'..hY...b.".
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  54 B0 6C 29 5B A2 C5 B6 EF 40 2A F6 AB 64 7F 73   T.l)[....@*..d.s
ISAKMP:  83 F6 3D 7B 91 25 46 41 63 69 41 1E B3 FB 5C 84   ..={.%FAciA...\.
ISAKMP:  A6 2C 0F 51 CB E6 92 63 D7 A7 3C 2A 7E 7F 16 63   .,.Q...c..<*~..c
ISAKMP:  D2 51 B9 F8 0A F4 EA 83 BB ED B7 4C B3 43 0F 43   .Q.........L.C.C
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 05                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Hash Data [16 bytes] ---
ISAKMP:  8C 9D 01 FE B7 27 85 A1 5F CC 5A 72 5F D0 6B 84   .....'.._.Zr_.k.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)
Received SA Attributes are same with
Encryption Algo = 1
Hash Algo = 1
Authentication Method = 1
Group Description = 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-16.9: Passed

>> IKE-18.11
TEST_DESCRIPTION
IKE MUST not respond to an ISAKMP packet without any one of
the following four- Enc. algo, Hash algo, Auth. method, Group value
mandatory SA attributes.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
        the protocol PROTO_ISAKMP and Transform Payload containing
        the Transform KEY_IKE 
        with SA Attributes as <SA  Attributes>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <SA  Attributes> ={Encryption Algo: DES_CBC, Hash Algo: MD5,
        Auth Method: Authentication via pre_shared keys}
- CASE: <SA  Attributes> ={Encryption Algo: DES_CBC, Hash Algo:
        MD5,Group: MODP over group number one}
- CASE: <SA  Attributes> ={Encryption Algo: DES_CBC,
        Auth Method:Authentication via pre_shared keys,
        Group: MODP over group number one}
- CASE: <SA  Attributes> ={Hash Algo: MD5,
        Auth Method:Authentication via pre_shared keys, 
        Group: MODP over group number one}
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-0

Executing system command:
  "./DocScriptQ35/IKE/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_COMB-SA.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp_COMB-SA.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Group Description Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 228 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B66 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 208 
UDP: Checksum         = 0x1901 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1F 68 1C 73 D8 68 55 34                           .h.s.hU4
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 200 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  60 80 5E A4 A4 DD 6B 9D 3D 94 B9 E7 62 EF 63 49   `.^...k.=...b.cI
ISAKMP:  E0 28 58 4B 05 DB 6D F8 EA 3F 09 2A 8B 7A 25 2B   .(XK..m..?.*.z%+
ISAKMP:  50 A8 34 15 EE 8B C5 B9 B9 E0 84 ED 04 07 34 CF   P.4...........4.
ISAKMP:  68 F8 1D 2D 23 C1 C9 09 43 28 BE 74 A2 DC 3D 29   h..-#...C(.t..=)
ISAKMP:  98 98 E5 C9 EA FE E2 3F 5A 7C 06 D8 D1 DF C3 63   .......?Z|.....c
ISAKMP:  AD 22 D4 96 65 B7 33 E0 29 22 D0 9F F4 1E D7 33   ."..e.3.)".....3
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  C6 18 23 37 8C A0 6D E0 1C 8B 6F B1 48 C9 BC 93   ..#7..m...o.H...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBB4 (60340)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5048 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x5418 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1F 68 1C 73 D8 68 55 34                           .h.s.hU4
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  AB A5 FA DB 9D 13 4B BB                           ......K.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x5EAC0710
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  1F 68 1C 73 D8 68 55 34 AB A5 FA DB 9D 13 4B BB   .h.s.hU4......K.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Authentication Method Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 228 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B65 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 208 
UDP: Checksum         = 0x8D78 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  90 C2 F6 07 73 64 3B 09                           ....sd;.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 200 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  5F 74 30 D4 AA E9 41 FA 05 6F D5 79 91 54 70 35   _t0...A..o.y.Tp5
ISAKMP:  FA 2A 1C A7 74 A3 9A 00 92 12 19 A3 6B 2E 53 77   .*..t.......k.Sw
ISAKMP:  84 91 FF E3 90 57 47 D7 D5 37 5B C8 AC DB DE F3   .....WG..7[.....
ISAKMP:  B7 39 DE 37 34 BB 1A EE AB 38 51 73 B3 F2 8E C9   .9.74....8Qs....
ISAKMP:  A0 9C A9 AC E2 38 69 FD 51 22 AA 2D A3 A7 1F 18   .....8i.Q".-....
ISAKMP:  79 15 AB BF A9 C3 84 B1 A7 A0 EF 1E C0 7C 06 F0   y............|..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6D 5E 85 02 2C A2 A2 C3 83 C2 8E 85 AD 03 8C 37   m^..,..........7
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBB5 (60341)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5047 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0CE3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  90 C2 F6 07 73 64 3B 09                           ....sd;.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  89 30 F5 FD 6D F6 A8 A9                           .0..m...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xBF9948DC
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  90 C2 F6 07 73 64 3B 09 89 30 F5 FD 6D F6 A8 A9   ....sd;..0..m...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Hash Algorithm Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 228 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B64 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 208 
UDP: Checksum         = 0x8ADF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  46 F9 47 04 82 59 91 45                           F.G..Y.E
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 200 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  9E AF 1B 18 6E 7B 2C D3 A5 99 1E B8 95 A8 19 A5   ....n{,.........
ISAKMP:  81 04 52 E6 39 2B 8C E1 4A 78 05 F3 0F 44 5A E7   ..R.9+..Jx...DZ.
ISAKMP:  02 2F F9 6D 91 88 EA A7 42 A0 98 53 DA 01 0E 1D   ./.m....B..S....
ISAKMP:  AF 74 BB 12 60 A6 08 9A 2E D2 52 7A 0B B1 F8 76   .t..`.....Rz...v
ISAKMP:  36 21 24 1E 0A 96 A8 1F D9 F0 0D 46 AC 5D 4A 78   6!$........F.]Jx
ISAKMP:  4B 43 25 1C 83 AB 5F 39 F2 37 0E 22 E3 2D E6 47   KC%..._9.7.".-.G
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  42 A0 4A 98 9C 58 00 52 8E F6 87 C9 78 35 5E 9C   B.J..X.R....x5^.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBB6 (60342)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5046 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7AEE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  46 F9 47 04 82 59 91 45                           F.G..Y.E
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  45 F5 15 D7 FA 59 92 2D                           E....Y.-
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xFD391F5D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  46 F9 47 04 82 59 91 45 45 F5 15 D7 FA 59 92 2D   F.G..Y.EE....Y.-
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using specified SA Attributes
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:4 Encryption Algorithm Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 30.1.1.5
from interface 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 228 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B63 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 208 
UDP: Checksum         = 0x42A7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FC E5 ED 7C 57 65 01 50                           ...|We.P
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 200 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  3B F2 16 E7 0B 19 29 06 53 02 BF 4E 41 DF 52 6F   ;.....).S..NA.Ro
ISAKMP:  21 CC 09 6F 10 F6 6D 5C 0F 1A 9A 3E A2 5A AE EA   !..o..m\...>.Z..
ISAKMP:  1F 89 17 1A 5D F6 BF 2E 6A 37 7E 36 5E 6D 69 46   ....]...j7~6^miF
ISAKMP:  58 8F 41 83 AD AC B0 31 41 60 53 CF E1 0B F1 03   X.A....1A`S.....
ISAKMP:  E0 1F 8D 47 E9 00 6B B4 E6 25 88 16 B0 97 C7 DD   ...G..k..%......
ISAKMP:  37 15 66 B6 DB C2 35 7F 82 65 4A 9F 54 C3 49 09   7.f...5..eJ.T.I.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E8 7E EF A9 51 79 CA 11 BE DC DF 42 0E B6 DF 91   .~..Qy.....B....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: ID Type                  = 1
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [4 bytes] ---
ISAKMP:  1E 01 01 96                                       ....
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 30.1.1.5 with Exchange type
Informational Exchange on interface 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xEBB7 (60343)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5045 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x9008 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FC E5 ED 7C 57 65 01 50                           ...|We.P
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C4 E7 7E 0F 3D B7 A6 9C                           ..~.=...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x4EFAF79C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  FC E5 ED 7C 57 65 01 50 C4 E7 7E 0F 3D B7 A6 9C   ...|We.P..~.=...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 30.1.1.5 (on interface 30.1.1.150)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKE/ike-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_resp.cfg ok
-> cmd sysvar list ipike.filename
System variables:
   ipike.filename=/romfs/ANVL_ikev1_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IKE-18.11: Passed
Executing system command:
  "./DocScriptQ35/IKE/IKEpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipike
ipd: kill ipike ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar set -o ipike.strict_lifetime_policy "0"
sysvar: ipike.strict_lifetime_policy=0 ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          6
Number of tests passed:       6
Number of tests failed:       0
Number of tests inconclusive: 0
