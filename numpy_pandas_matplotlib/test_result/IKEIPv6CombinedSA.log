ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5772364 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_combined_sa ike-ipv6 2.20 9.9, 9.10, 11.1, 11.3, 11.18 14.6 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_combined_sa.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IKEIPV6/IKEIPV6postsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IKE SA Down Command                      "./DocScriptQ35/IKEIPV6/ike-sa-down-command.exp $ANVL_DUTHOSTNAME"
IKE Certificate Data                     "abcdefghijklmnop"
IKE Certificate Type                     2                   # (0x00000002)
IKE Signature Data                       "ABCDEFGHIJKLMNOP"
IKE Retransmit Count                     5                   # (0x00000005)
IKE Unique Cookie Test Count             3                   # (0x00000003)
IKE Test Timeout                         3                   # (0x00000003)
IKE DUT Major Version                    1                   # (0x00000001)
IKE DUT Minor Version                    1                   # (0x00000001)
IKE Non Zero Value                       1                   # (0x00000001)
IKE Nonce Payload Invalid Length         7                   # (0x00000007)
IKE ID Payload Invalid Port              10                  # (0x0000000A)
IKE ID Payload Invalid Protocol          10                  # (0x0000000A)
IKE Invalid Exchange Type                10                  # (0x0000000A)
IKE Invalid Message ID                   10                  # (0x0000000A)
IKE Invalid DOI                          10                  # (0x0000000A)
IKE Invalid Protocol ID                  10                  # (0x0000000A)
IKE Invalid Transform ID                 10                  # (0x0000000A)
IKE Invalid Attribute Class              20                  # (0x00000014)
IKE Invalid SPI                          210                 # (0x000000D2)
IKE DUT Supports Certificate Payload Processing True
IKE DUT Supports Main Mode As Initiator  True
IKE DUT Supports Main Mode As Responder  True
IKE DUT Supports Quick Mode As Initiator True
IKE DUT Supports Quick Mode As Responder True
IKE DUT Supports Aggressive Mode As Initiator True
IKE DUT Supports Aggressive Mode As Responder True
IKE DUT Supports New Group Mode As Initiator False
IKE DUT Supports New Group Mode As Responder False
IKE DUT Supports Sending of Notification Message True
IKE DUT Supports Traffic Processing before CONNECTED Notify False
IKEIPV6 Suite Setup Command              "./DocScriptQ35/IKEIPV6/ikeipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 ISAKMP SA Initiate Command       "./DocScriptQ35/IKEIPV6/ikeipv6-isakmp-sa-initiate-dh1-sha-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 IPSec SA Initiate Command        "./DocScriptQ35/IKEIPV6/ikeipv6-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Another IPSec SA Initiate Command "./DocScriptQ35/IKEIPV6/ikeipv6-another-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Restart Command                  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Specify DES MD5 Attribute Command "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Specify DES SHA Attribute Command "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Combined SA Initiate Command     "./DocScriptQ35/IKEIPV6/ikeipv6-combined-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Two SA Initiate Command          "./DocScriptQ35/IKEIPV6/ikeipv6-two-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Aggressive Mode Initiate Command "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-dh1-sha-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Aggressive Mode Configure Command "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 New Group Mode Initiate Command  "./DocScriptQ35/IKEIPV6/ikeipv6-new-group-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 DUT Uses Wildcard Identification False
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_combined_sa.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         2000::5
  IPV6 ANVL Address                        2000::1
  IPV6 Gateway                             2000::5
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         2111::5
  IPV6 ANVL Address                        2111::1
  IPV6 Gateway                             2111::5
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Encapsulation                   v6Ov6
  IPSec Configuration                      Auto
  IPSec IPv6 Remote Host Address           2000::1
  IPSec IPv6 Local Host Address            2111::1
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          SHA
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                ESP_DES
  IKE IPSec SA Group Description           MODP768
  IKE IPSec SA Encapsulation Mode          TUNNEL
  IKE IPSec SA Authentication Algorithm    HMAC_SHA
  IKE Alternative ISAKMP SA Encryption Algorithm 3DES_CBC
  IKE Alternative ISAKMP SA Hashing Algorithm MD5
  New Group Description                    32768             # (0x00008000)
  New Group Prime                          "FFFDFF6FF2FF3FFFC90FDAA22168C234C6C6628B86DC6CD129064E088A676C74020B6EA636139B62564A06798634646D6F6569B3CD3A431B302B0A6DF25F14676FE6366D66516245E4656576665E6EC6F66662E9A6"
  New Group Generator                      "3"
  New Group Modulus Length                 680               # (0x000002A8)
  IKE Pre-Shared Key                       abcdef

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 2000::5 prefixlen 64 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 2111::5 prefixlen 64 up
-> cmd ifconfig -a
lo0	Link type:Local loopback
	inet 127.0.0.1  mask 255.255.255.255
	inet6 unicast fe80::1%lo0  prefixlen 64  automatic
	inet6 unicast ::1  prefixlen 128
	UP RUNNING LOOPBACK MULTICAST NOARP ALLMULTI 
	MTU:1500  metric:1  VR:0  ifindex:1
	RX packets:1194561 mcast:3395 errors:0 dropped:0
	TX packets:1194561 mcast:3395 errors:0
	collisions:0 unsupported proto:0
	RX bytes:88787522 (88 M)  TX bytes:88787522 (88 M)

gei2	Link type:Ethernet  HWaddr 00:25:90:04:e2:de
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 128.224.166.238  mask 255.255.254.0  broadcast 128.224.167.255
	inet6 unicast fe80::225:90ff:fe04:e2de%gei2  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:2
	RX packets:865551 mcast:21911 errors:0 dropped:2544
	TX packets:63234 mcast:1126 errors:0
	collisions:0 unsupported proto:0
	RX bytes:64796667 (64 M)  TX bytes:6653483 (6653 k)

gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	inet6 unicast 2000::5  prefixlen 64  tentative
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:53
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:2 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:180

gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	inet6 unicast 2111::5  prefixlen 64  tentative
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:54
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:2 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:180

-> cmd sysvar set -co ipike.strict_lifetime_policy "1"
sysvar: ipike.strict_lifetime_policy=1 ok
-> cmd sysvar get ipike.strict_lifetime_policy 
sysvar: ipike.strict_lifetime_policy=1
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd reconfigure ipike
ipd: reconfigure ipike failed: not started
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 2000::1 < 2000::5 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 2000::5 as 00:15:17:C8:90:28

Neighbor Discovery for 2111::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:5 < 2111::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 2111::1 < 2111::5 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 2111::5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite Internet Key Exchange (IKE)
RFC 2407: 'The Internet IP Security Domain of Interpretation
for ISAKMP'
(D. Piper Network Alchemy, November 1988)
RFC 2408: 'Internet Security Association and Key Management
Protocol (ISAKMP)'
(D. Maughan National Security Agency,
M. Schertler Securify, Inc.
M. Schneider National Security Agency,
J. Turner RABA Technologies, Inc., November 1998)
RFC 2409: The Internet Key Exchange (IKE)
(D. Harkins, D. Carrel, Cisco Systems, November 1998


ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the machine on which ANVL is running
be connected to 2 interfaces that are connected
to the device under test.

The ANVL config file must contain 2 IP interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IKE-IPV6-2.20
TEST_DESCRIPTION
IKE MUST support DES_CBC, SHA, Authentication via pre_shared keys
and MODP over default group number one.
Main mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using Main Mode
        with SA Attributes = {Encryption algo: DES_CBC, Hash algo: SHA,
        Auth Method: Authentication via pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA> with requested SA Attributes
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike failed: not started
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes  = {DES, SHA}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Main Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-isakmp-sa-initiate-dh1-sha-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_init_des_sha.cfg" 
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_init_des_sha.cfg ok
-> cmd sysvar get ipike.filename 
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_init_des_sha.cfg
-> cmd ipd reconfigure ipike 
Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0xD8EA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  83 79 D1 1F 00 16 AD B6                           .y......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)
Received expected SA Attributes with
Encryption Algorithm 1
Group Description 1
Hash Algorithm 2
Authentication Method 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANxit
Au revoir!
Connection closed by foreign host.
VL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-2.20: Passed

>> IKE-IPV6-9.9
TEST_DESCRIPTION
For COMB-SA, IKE MUST set the NP field of the first Proposal Payload
to 2 and that of last to 0 in an outbound packet.
Quick mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.5 p28 Proposal Payload
RFC 2408 s4.2.1 p48 Security Association Establishment Examples
TEST_METHOD
- ANVL: Establish one ISAKMP SA with DUT
- ANVL: Externally cause DUT to initiate COMB-SA for
        IPSEC_AH and IPSEC_ESP
-  DUT: Send <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> with two Proposal Payloads for
        a combined protection suite with two different protocols.
- ANVL: Verify the NP field of 1st Proposal is 2 and NP field of 2nd
        Proposal is 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending <HDR,SA> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 80 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0x6FF8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  95 3E 47 37 7B C1 ED 5E                           .>G7{..^
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0x6BDC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  95 3E 47 37 7B C1 ED 5E                           .>G7{..^
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DF FF 80 26 1E 71 1B C8                           ...&.q..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
Sending <HDR,KE,Ni> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 156 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 156 
UDP: Checksum         = 0x691B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  95 3E 47 37 7B C1 ED 5E                           .>G7{..^
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DF FF 80 26 1E 71 1B C8                           ...&.q..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 148 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  16 9A 20 89 8D E3 11 4C 87 F7 34 7D 56 A8 4E A6   .. ....L..4}V.N.
ISAKMP:  E5 B1 15 F8 68 E5 2F 9C 28 49 08 B6 71 BD 44 7B   ....h./.(I..q.D{
ISAKMP:  4C DD DC CE 8E 51 24 B8 BE 69 A5 5F F8 D5 86 72   L....Q$..i._...r
ISAKMP:  D9 4F F3 5D 15 D6 A0 01 3D 65 59 C5 21 8B 91 41   .O.]....=eY.!..A
ISAKMP:  49 0F 7A 7F A9 2E C6 BC 15 C5 E4 13 07 F7 64 FC   I.z...........d.
ISAKMP:  A0 48 3B 11 A5 95 FD 87 37 60 B3 F0 43 18 C0 6E   .H;.....7`..C..n
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A1 22 CB 1A 32 3A 76 36 7E E7 8D 71 87 0B 71 34   ."..2:v6~..q..q4
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 204 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 204 
UDP: Checksum         = 0x0CDA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  95 3E 47 37 7B C1 ED 5E                           .>G7{..^
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DF FF 80 26 1E 71 1B C8                           ...&.q..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 196 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  62 30 47 F1 08 80 AF 9C 8E E3 1E 43 30 70 0A 6D   b0G........C0p.m
ISAKMP:  CB 67 BD 35 11 44 A0 52 21 76 C4 8B 66 1C EC 4C   .g.5.D.R!v..f..L
ISAKMP:  FC B0 3B 97 1F F0 1B A3 55 78 C6 A8 DC 3C 56 F9   ..;.....Ux...<V.
ISAKMP:  EB DC 27 7E 52 69 EB 28 8E 7F 03 64 EB 1B 18 8F   ..'~Ri.(...d....
ISAKMP:  2C 3A 3B 3B 37 D9 F9 6B D5 43 76 45 CC E8 8F 4E   ,:;;7..k.CvE...N
ISAKMP:  03 47 3A B3 7A 7F 7C ED B0 93 88 56 3F 44 DE 0C   .G:.z.|....V?D..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  0C C8 88 F9 FA 61 8E 33 EE 41 6F 54 7D C7 65 B5   .....a.3.AoT}.e.
ISAKMP:  F4 03 87 44 59 09 B9 47 60 F9 86 5B F9 4F 17 89   ...DY..G`..[.O..
ISAKMP:  1B 48 45 D5 E6 B5 3E 1A F1 68 DD A9 A9 A9 14 3E   .HE...>..h.....>
ISAKMP:  E8 E9 F2 29 50 1E 12 98 0D 4B 4E BA CD 45 2A 3F   ...)P....KN..E*?
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:

Received <HDR,KE,Nr> Packet from DUT
Sending <HDR*,ID,Hash_I> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0x6329 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  95 3E 47 37 7B C1 ED 5E                           .>G7{..^
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DF FF 80 26 1E 71 1B C8                           ...&.q..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  72 AF CB E6 59 A8 4A F9 B8 DB 90 8B EB 18 C6 10   r...Y.J.........
ISAKMP:  6E 63 D1 F1                                       nc..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0xA7CB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  95 3E 47 37 7B C1 ED 5E                           .>G7{..^
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DF FF 80 26 1E 71 1B C8                           ...&.q..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  32 19 47 13 2E A8 AF F3 19 01 8B D5 BE C0 ED 27   2.G............'
ISAKMP:  71 5F 8D 9B                                       q_..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:

Received <HDR*,ID,Hash_R> Packet from DUT
ISAKMP SA has been Established

Waiting (up to 5.000 seconds) for DUT to stabilize the ISAKMP SA
Received Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6F97 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C63 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = 2111::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5916 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


Externally causing DUT to initiate combined SA for
IPSEC-AH and IPSEC-ESP
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-combined-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping6 -S 2111::5 -c 1 2000::1Received ISAKMP packet from 2000::5 with Exchange type
Quick Mode Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 404 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 404 
UDP: Checksum         = 0x811D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  95 3E 47 37 7B C1 ED 5E                           .>G7{..^
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DF FF 80 26 1E 71 1B C8                           ...&.q..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x59C87C07
ISAKMP: Length                   = 396 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  BF C3 90 63 A5 34 CB FA 23 21 A6 29 30 3A F6 39   ...c.4..#!.)0:.9
ISAKMP:  88 F2 2A E8                                       ..*.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 92 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 18 AA                                       ....
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (SA Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (SA Life Duration)
ISAKMP: SA Attribute Value       = 3600 
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 18 BE                                       ....
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (SA Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (SA Life Duration)
ISAKMP: SA Attribute Value       = 3600 
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  15 37 20 D8 D1 89 E8 A1 0B C8 6B 61 30 0F 9F E6   .7 .......ka0...
ISAKMP:  D2 9B 62 C5 15 01 2F 20 39 7B 6D 8B B7 16 D1 0F   ..b.../ 9{m.....
ISAKMP:  08 C3 2E CF 1C 8C 53 67 D6 28 6E B3 47 A5 E2 07   ......Sg.(n.G...
ISAKMP:  4C 92 C1 53 C4 0F A4 EB CA D5 D3 EF 25 B4 CC AE   L..S........%...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  76 23 C0 E0 5C 2F 8E CC 4D 26 C2 51 1A 8E D9 08   v#..\/..M&.Q....
ISAKMP:  E3 6F B8 E3 12 7B 08 81 1B A6 2C 9A 0D 25 BF BA   .o...{....,..%..
ISAKMP:  64 27 62 CA F3 D5 F5 66 A9 24 20 98 B9 44 58 CC   d'b....f.$ ..DX.
ISAKMP:  FD EB FB 7F 63 18 86 23 17 E8 55 FA 25 C9 5F C0   ....c..#..U.%._.
ISAKMP:  8D F8 1B 6B 27 7D 6D 44 A0 DF 77 36 69 D8 F2 B2   ...k'}mD..w6i...
ISAKMP:  4F EA 22 7B 32 E4 A0 66 5F 66 8F B4 F0 87 1F 64   O."{2..f_f.....d
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: ID Type                  = 6
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [32 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00   !...............
ISAKMP:  FF FF FF FF FF FF FF FF 00 00 00 00 00 00 00 00   ................
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: ID Type                  = 6
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [32 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ...............
ISAKMP:  FF FF FF FF FF FF FF FF 00 00 00 00 00 00 00 00   ................
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:

Received <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Value of nextpayload field of first proposal (2)
Correctly received value of nextpayload field of second proposal(0)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Next Payload of 1st Proposal
is 2 and that of 2nd Proposal is 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.


Pinging 2000::1 (2000::1) with 64 bytes of data:

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-9.9: Passed

>> IKE-IPV6-9.10
TEST_DESCRIPTION
For COMB-SA with two protocols, IKE MUST send an outbound ISAKMP
packet with two Proposal Payloads with same Proposal Number.
Quick mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s4.2 p47 Security Association Establishment
RFC 2410 s5.5 p18 Phase 2 - Quick Mode
TEST_METHOD
- ANVL: Establish one ISAKMP SA with DUT
- ANVL: Externally cause DUT to initiate COMB-SA for
        IPSEC_AH and IPSEC_ESP
-  DUT: Send <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> with two Proposal Payloads
        with same Proposal Number
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> 
--- 2000::1 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1016 ms
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending <HDR,SA> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 80 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0x5B39 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F0 AA 04 72 5A 5F 05                           ....rZ_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0x5609 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F0 AA 04 72 5A 5F 05                           ....rZ_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D5 52 A9 36 BB C3 61 26                           .R.6..a&
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
Sending <HDR,KE,Ni> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 156 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 156 
UDP: Checksum         = 0x38F3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F0 AA 04 72 5A 5F 05                           ....rZ_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D5 52 A9 36 BB C3 61 26                           .R.6..a&
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 148 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  60 80 5E A4 A4 DD 6B 9D 3D 94 B9 E7 62 EF 63 49   `.^...k.=...b.cI
ISAKMP:  E0 28 58 4B 05 DB 6D F8 EA 3F 09 2A 8B 7A 25 2B   .(XK..m..?.*.z%+
ISAKMP:  50 A8 34 15 EE 8B C5 B9 B9 E0 84 ED 04 07 34 CF   P.4...........4.
ISAKMP:  68 F8 1D 2D 23 C1 C9 09 43 28 BE 74 A2 DC 3D 29   h..-#...C(.t..=)
ISAKMP:  98 98 E5 C9 EA FE E2 3F 5A 7C 06 D8 D1 DF C3 63   .......?Z|.....c
ISAKMP:  AD 22 D4 96 65 B7 33 E0 29 22 D0 9F F4 1E D7 33   ."..e.3.)".....3
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  C6 18 23 37 8C A0 6D E0 1C 8B 6F B1 48 C9 BC 93   ..#7..m...o.H...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 204 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 204 
UDP: Checksum         = 0x25D9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F0 AA 04 72 5A 5F 05                           ....rZ_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D5 52 A9 36 BB C3 61 26                           .R.6..a&
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 196 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  19 ED 47 C4 F0 16 16 E7 AA B3 48 68 7A CD 81 58   ..G.......Hhz..X
ISAKMP:  69 EB B3 A6 35 04 B5 D1 ED 52 41 EF 9C BF 9E DA   i...5....RA.....
ISAKMP:  8A E2 24 59 56 CC C2 D0 B3 D3 A7 B9 09 30 93 A2   ..$YV........0..
ISAKMP:  83 11 E8 55 58 EE B5 EF B1 DF 4B AB 35 42 CB 49   ...UX.....K.5B.I
ISAKMP:  DF 84 7C 9C BD 43 36 1B 70 C6 F7 DA 21 F4 AA B2   ..|..C6.p...!...
ISAKMP:  FD BE 19 18 08 EC 37 DA 1A 5B CE A6 B7 72 77 07   ......7..[...rw.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  C5 E7 8B 77 2B 46 FE CE 9B F5 F2 AA 14 DC 43 88   ...w+F........C.
ISAKMP:  DC 6C 29 95 E7 44 19 4E F4 89 95 45 FD F5 CD 93   .l)..D.N...E....
ISAKMP:  4D 41 F5 AC FC EE 3A E5 04 87 E6 C2 69 0B 91 41   MA....:.....i..A
ISAKMP:  3B 7F 51 5C F2 CF 42 04 BB D9 2E 44 38 32 91 DC   ;.Q\..B....D82..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:

Received <HDR,KE,Nr> Packet from DUT
Sending <HDR*,ID,Hash_I> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0x67A2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F0 AA 04 72 5A 5F 05                           ....rZ_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D5 52 A9 36 BB C3 61 26                           .R.6..a&
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  3D 9F 1C B7 6F 8E 52 21 25 DB 65 79 EF CB 1B 4D   =...o.R!%.ey...M
ISAKMP:  B6 BB 59 05                                       ..Y.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0xF1EF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F0 AA 04 72 5A 5F 05                           ....rZ_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D5 52 A9 36 BB C3 61 26                           .R.6..a&
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F3 DD F4 17 1F 33 06 E2 1D 3A 5E 6B 5A FC 7C 61   .....3...:^kZ.|a
ISAKMP:  78 56 31 48                                       xV1H
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:

Received <HDR*,ID,Hash_R> Packet from DUT
ISAKMP SA has been Established

Waiting (up to 5.000 seconds) for DUT to stabilize the ISAKMP SA
exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to initiate combined SA for
IPSEC-AH and IPSEC-ESP
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-combined-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping6 -SReceived ISAKMP packet from 2000::5 with Exchange type
Quick Mode Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 404 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 404 
UDP: Checksum         = 0x1012 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F0 AA 04 72 5A 5F 05                           ....rZ_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D5 52 A9 36 BB C3 61 26                           .R.6..a&
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xBBCA8F43
ISAKMP: Length                   = 396 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  FB 32 AA DB 15 86 A5 F3 56 FD 66 C0 12 6B B8 1C   .2......V.f..k..
ISAKMP:  BA C9 E6 FC                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 92 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 1D 21                                       ...!
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (SA Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (SA Life Duration)
ISAKMP: SA Attribute Value       = 3600 
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 13 01                                       ....
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (SA Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (SA Life Duration)
ISAKMP: SA Attribute Value       = 3600 
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AB D7 E4 12 DD 74 61 CE DF 21 BF 51 86 9A 84 25   .....ta..!.Q...%
ISAKMP:  A1 90 5F 79 B6 FB 31 BB 14 41 C9 E7 1A 54 7B 98   .._y..1..A...T{.
ISAKMP:  BD CD 16 34 02 F8 89 EA 25 7E 49 6F EE D7 3D 40   ...4....%~Io..=@
ISAKMP:  A0 68 FA 19 E8 48 CB 53 30 6C 1D 83 08 B5 12 94   .h...H.S0l......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  75 D2 6F 56 E8 49 54 78 37 20 CC 53 2A D3 A9 B6   u.oV.ITx7 .S*...
ISAKMP:  39 49 7B 24 D5 CF 27 60 55 2B 18 17 1E E7 77 15   9I{$..'`U+....w.
ISAKMP:  D0 3D C0 E3 D3 4A 5E 8E 5E 88 46 58 FE 43 9B 59   .=...J^.^.FX.C.Y
ISAKMP:  05 31 96 DB 3B 10 25 8E 20 32 65 11 A9 31 C2 E2   .1..;.%. 2e..1..
ISAKMP:  E4 F4 72 E4 78 47 56 FF 52 FE 9C 5B 17 AC 22 11   ..r.xGV.R..[..".
ISAKMP:  1E C2 23 7A CA F4 83 9F F5 68 59 57 35 03 BE AC   ..#z.....hYW5...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: ID Type                  = 6
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [32 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00   !...............
ISAKMP:  FF FF FF FF FF FF FF FF 00 00 00 00 00 00 00 00   ................
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: ID Type                  = 6
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [32 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ...............
ISAKMP:  FF FF FF FF FF FF FF FF 00 00 00 00 00 00 00 00   ................
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:

Received <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR*,SA,KE,Nr,IDir, HASH_R>
packet from DUT with same proposal number in
two proposals

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
 2111::5 -c 1 2000::1

Pinging 2000::1 (2000::1) with 64 bytes of data:

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-9.10: Passed

>> IKE-IPV6-11.1
TEST_DESCRIPTION
If there are additional Proposal payloads in the message,
then this field will be 2.  If the current Proposal payload
is the last within the security association proposal,
then this field will be 0
Quick mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.5 p28 Proposal Payload
RFC 2408 s4.2.1 p48 Security Association Establishment Examples
TEST_METHOD
- ANVL: Establish one ISAKMP SA with DUT
- ANVL: Send <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> Packet with 2 Proposal Payloads
        for a combined protection suite with 2 different protocols
-  DUT: Send <HDR*,HASH(2),SA,Nr,KE,IDci,IDcr> Packet with 2 Proposal Payloads
- ANVL: Verify the Next Payload field of 1st Proposal is 2 and Next
        Payload field of 2nd Proposal is 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> 
--- 2000::1 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1017 ms
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending <HDR,SA> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 80 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0x128B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0x8B16 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 ED AF 2A 83 C6 55 D9                           ...*..U.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
Sending <HDR,KE,Ni> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 156 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 156 
UDP: Checksum         = 0xAE38 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 ED AF 2A 83 C6 55 D9                           ...*..U.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 148 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  5F 74 30 D4 AA E9 41 FA 05 6F D5 79 91 54 70 35   _t0...A..o.y.Tp5
ISAKMP:  FA 2A 1C A7 74 A3 9A 00 92 12 19 A3 6B 2E 53 77   .*..t.......k.Sw
ISAKMP:  84 91 FF E3 90 57 47 D7 D5 37 5B C8 AC DB DE F3   .....WG..7[.....
ISAKMP:  B7 39 DE 37 34 BB 1A EE AB 38 51 73 B3 F2 8E C9   .9.74....8Qs....
ISAKMP:  A0 9C A9 AC E2 38 69 FD 51 22 AA 2D A3 A7 1F 18   .....8i.Q".-....
ISAKMP:  79 15 AB BF A9 C3 84 B1 A7 A0 EF 1E C0 7C 06 F0   y............|..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6D 5E 85 02 2C A2 A2 C3 83 C2 8E 85 AD 03 8C 37   m^..,..........7
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 204 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 204 
UDP: Checksum         = 0xB329 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 ED AF 2A 83 C6 55 D9                           ...*..U.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 196 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  25 05 B9 52 2B 0F ED EC 66 65 24 14 56 C9 30 F5   %..R+...fe$.V.0.
ISAKMP:  8C B1 B3 CC BB 69 0E 14 9C 88 3A A5 86 29 55 77   .....i....:..)Uw
ISAKMP:  70 9C 94 2F 47 9C DA A3 89 FE 5A 86 84 31 30 C3   p../G.....Z..10.
ISAKMP:  DD 5D 7D BB A0 9A 7D F5 25 1C 85 3D 6C 03 80 2B   .]}...}.%..=l..+
ISAKMP:  4D E7 46 E1 65 F1 08 DB E2 77 BF E3 79 12 81 C9   M.F.e....w..y...
ISAKMP:  4B 24 69 DA A8 2A 8F 4B 5A 02 C4 76 7D 97 4E 20   K$i..*.KZ..v}.N 
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D8 01 8F 69 5D 82 7B 16 6E 1A DD 07 38 C4 E7 41   ...i].{.n...8..A
ISAKMP:  9C 09 BF E2 49 39 58 58 FA 37 3B E2 62 3A E7 6F   ....I9XX.7;.b:.o
ISAKMP:  E7 DB 2D 44 AC E4 BD 16 80 6F D6 C9 67 2F D5 8D   ..-D.....o..g/..
ISAKMP:  29 F9 4C F5 80 8B 24 00 20 6C 13 0C B9 11 E3 00   ).L...$. l......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:

Received <HDR,KE,Nr> Packet from DUT
Sending <HDR*,ID,Hash_I> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0x0192 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 ED AF 2A 83 C6 55 D9                           ...*..U.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  FD 16 C3 69 E4 C6 C8 9F 91 84 D5 64 5F 48 33 01   ...i.......d_H3.
ISAKMP:  D7 CE E7 C9                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0xF4D2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 ED AF 2A 83 C6 55 D9                           ...*..U.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  20 E7 7A 35 B6 BC 0F C1 E2 14 22 C4 C5 B4 3A 85    .z5......"...:.
ISAKMP:  F4 B0 99 B9                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:

Received <HDR*,ID,Hash_R> Packet from DUT
ISAKMP SA has been Established

Waiting (up to 5.000 seconds) for DUT to stabilize the ISAKMP SA
exit
Au revoir!
Connection closed by foreign host.

Sending <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> Packet with 2 Proposal Payloads
for a combined protection suite with 2 different protocols
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 308 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 308 
UDP: Checksum         = 0x2211 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 ED AF 2A 83 C6 55 D9                           ...*..U.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x31496FBF
ISAKMP: Length                   = 300 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  BF 65 38 D6 28 73 8C F0 49 59 2D FA C0 A0 D0 02   .e8.(s..IY-.....
ISAKMP:  1A 9E 42 0B                                       ..B.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  18 15 DC 73                                       ...s
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  4F 4E 7A CD                                       ONz.
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4A FD 41 0A 9D D4 B0 8C CA 76 69 C7 47 CC E5 44   J.A......vi.G..D
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  BB 9A DB 23 A9 50 51 0B 37 5F C3 20 7F 16 2E 3F   ...#.PQ.7_. ...?
ISAKMP:  AE 47 EB 7C 3C 47 28 95 DD 14 0A 78 E6 95 C9 DB   .G.|<G(....x....
ISAKMP:  A0 9B 62 49 69 FA 66 B4 D3 C2 1D 10 6F C2 06 CB   ..bIi.f.....o...
ISAKMP:  3B 58 58 FF 60 CE DF B3 60 CA 47 B8 82 73 C0 FD   ;XX.`...`.G..s..
ISAKMP:  D8 C7 E8 7F 67 D2 22 36 BA 94 5B 32 B0 58 DA DD   ....g."6..[2.X..
ISAKMP:  0A 6A 00 BA F4 D2 D9 FE 48 A5 19 A4 64 BC 47 C5   .j......H...d.G.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 01   !...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Quick Mode Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xD189 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D2 00 AE 60 21 40 01 62                           ...`!@.b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 ED AF 2A 83 C6 55 D9                           ...*..U.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x31496FBF
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  EE 95 45 87 44 A1 74 BD 87 D4 94 BA EA CC F1 D9   ..E.D.t.........
ISAKMP:  E3 3B A7 E0                                       .;..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 15 E7                                       ....
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 18 7D                                       ...}
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  9B A3 91 8F DA 55 B3 4D 41 21 06 01 F2 30 E9 68   .....U.MA!...0.h
ISAKMP:  5A 85 FE 36 1A 27 06 3A AE 53 E0 0B F8 08 0D 88   Z..6.'.:.S......
ISAKMP:  92 F3 6E 78 56 6D 1A E8 B3 C1 6D 83 4B F3 CB 5D   ..nxVm....m.K..]
ISAKMP:  50 8E 45 45 D2 77 D1 77 80 07 A7 AC E6 E3 68 1F   P.EE.w.w......h.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  49 49 37 2B 59 DB 0E 39 35 66 7C BF F9 8B 1F F6   II7+Y..95f|.....
ISAKMP:  A5 7C 9F B5 12 CB AC 9F 2C 87 79 E6 65 B9 52 FA   .|......,.y.e.R.
ISAKMP:  5A F8 58 A4 CC 94 28 D8 95 5C 56 26 9D 33 CB 16   Z.X...(..\V&.3..
ISAKMP:  D5 18 C1 B1 BC B2 04 3F 9F 0F B5 66 FA 66 9D 71   .......?...f.f.q
ISAKMP:  A1 0A 67 CB F7 E1 7D 44 9E FC AE 48 A6 AC AA 19   ..g...}D...H....
ISAKMP:  DA 08 BA 23 7C 68 D5 3A 4E 5D 9A A5 93 66 2A 45   ...#|h.:N]...f*E
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 01   !...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:

Received the <HDR*,HASH(2),SA,Nr,KE,IDci,IDcr> Packet
from DUT 2000::5 (on interface 2000::1)
Next Payload of First Proposal is 2 and Second Proposal is 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-11.1: Passed

>> IKE-IPV6-11.3
TEST_DESCRIPTION
If the SA establishment negotiation is for a combined protection
suite consisting of multiple protocols, then there MUST be multiple
Proposal payloads each with the same Proposal number.
Note: This test checks for 2 protoccols selectedQuick mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s4.2 p47 Security Association Establishment
RFC 2409 s5.5 p18 Phase 2 - Quick Mode
TEST_METHOD
- ANVL: Establish one ISAKMP SA with DUT
- ANVL: Send <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> Packet with 2 Proposal
        Payloads with same Proposal Number
-  DUT: Send <HDR*,HASH(2),SA,Nr,KE,IDci,IDcr> Packet with two
        Proposal Payloads with same Proposal Number for both the
        Proposals
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending <HDR,SA> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 80 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0x1283 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0x2BF5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CC 92 A5 4D B1 DE 59 12                           ...M..Y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
Sending <HDR,KE,Ni> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 156 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 156 
UDP: Checksum         = 0x1228 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CC 92 A5 4D B1 DE 59 12                           ...M..Y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 148 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  3B F2 16 E7 0B 19 29 06 53 02 BF 4E 41 DF 52 6F   ;.....).S..NA.Ro
ISAKMP:  21 CC 09 6F 10 F6 6D 5C 0F 1A 9A 3E A2 5A AE EA   !..o..m\...>.Z..
ISAKMP:  1F 89 17 1A 5D F6 BF 2E 6A 37 7E 36 5E 6D 69 46   ....]...j7~6^miF
ISAKMP:  58 8F 41 83 AD AC B0 31 41 60 53 CF E1 0B F1 03   X.A....1A`S.....
ISAKMP:  E0 1F 8D 47 E9 00 6B B4 E6 25 88 16 B0 97 C7 DD   ...G..k..%......
ISAKMP:  37 15 66 B6 DB C2 35 7F 82 65 4A 9F 54 C3 49 09   7.f...5..eJ.T.I.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E8 7E EF A9 51 79 CA 11 BE DC DF 42 0E B6 DF 91   .~..Qy.....B....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 204 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 204 
UDP: Checksum         = 0x49E7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CC 92 A5 4D B1 DE 59 12                           ...M..Y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 196 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  9D 7D E6 5D D8 69 48 22 22 4F 03 9A 35 5B BB C9   .}.].iH""O..5[..
ISAKMP:  25 C7 AA 95 47 60 44 07 6B F6 95 88 97 96 F2 68   %...G`D.k......h
ISAKMP:  D5 41 71 EC 6B 29 FB 9F 38 2F 40 DF 0B 04 0F 08   .Aq.k)..8/@.....
ISAKMP:  8E 18 E0 F2 D6 71 8A 68 C7 DA 5E B6 B5 AD 21 A8   .....q.h..^...!.
ISAKMP:  1D 30 03 0A 6A A2 AC 79 83 CD 3B 93 6D 66 1E 74   .0..j..y..;.mf.t
ISAKMP:  6D D2 F5 5D A9 C3 5E 1A D4 18 2E 89 A8 3A FA 7C   m..]..^......:.|
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  87 26 94 BC 66 77 EE 36 08 58 36 E2 0F 9B 91 EC   .&..fw.6.X6.....
ISAKMP:  88 FB 46 3B 86 5A 66 4A 69 7B AD C4 2F 35 1F 72   ..F;.ZfJi{../5.r
ISAKMP:  17 6E 78 93 25 5E 34 8B 68 2F 35 E0 CB D3 05 19   .nx.%^4.h/5.....
ISAKMP:  F4 3C EC 5E DD 6E 6F A5 D6 A9 09 C9 DB EF 44 86   .<.^.no.......D.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:

Received <HDR,KE,Nr> Packet from DUT
Sending <HDR*,ID,Hash_I> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0x8871 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CC 92 A5 4D B1 DE 59 12                           ...M..Y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  D1 FB B0 F5 C2 4C D3 87 B1 D3 4B 83 B4 D8 3F 79   .....L....K...?y
ISAKMP:  94 19 D9 87                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0x352F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CC 92 A5 4D B1 DE 59 12                           ...M..Y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  59 EB 30 7C 99 50 8D 0A CB 92 85 67 4F 8A 3B 6A   Y.0|.P.....gO.;j
ISAKMP:  52 F6 92 20                                       R.. 
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:

Received <HDR*,ID,Hash_R> Packet from DUT
ISAKMP SA has been Established

Waiting (up to 5.000 seconds) for DUT to stabilize the ISAKMP SA

Sending <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> Packet with 2 Proposal
Payloads with same Proposal Number to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 308 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 308 
UDP: Checksum         = 0x237B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CC 92 A5 4D B1 DE 59 12                           ...M..Y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6513E12C
ISAKMP: Length                   = 300 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  EC 6F 77 97 77 53 ED 03 8C 7E 3D 70 33 A8 ED DE   .ow.wS...~=p3...
ISAKMP:  F8 28 69 80                                       .(i.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  2F 2D E5 19                                       /-..
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  54 FB 9F ED                                       T...
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7A A6 43 34 EB 5F 7C 66 8D 57 0C BF 81 34 B7 F7   z.C4._|f.W...4..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  B0 3F 0F 03 4F 4B B5 4A AB 87 B7 0A 0E A2 2C B3   .?..OK.J......,.
ISAKMP:  F2 14 70 DC 2F FA 78 9F BA C2 4D 29 EF AC ED C9   ..p./.x...M)....
ISAKMP:  0C 8D 4A 39 A6 59 0F 84 36 FE F7 BC B7 92 53 6D   ..J9.Y..6.....Sm
ISAKMP:  8B BF E8 04 29 B5 28 F0 14 2B DD 03 EA AC 0A 26   ....).(..+.....&
ISAKMP:  A7 B2 3E 49 DE 29 0E E2 88 07 47 04 C0 6F 59 70   ..>I.)....G..oYp
ISAKMP:  65 9B 1E 12 C5 AA F1 1E B5 76 E8 80 E2 29 D9 09   e........v...)..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 01   !...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Quick Mode Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xA00C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 C1 46 0F F5 D7 91 62                           ..F....b
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  CC 92 A5 4D B1 DE 59 12                           ...M..Y.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6513E12C
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  88 86 CC 9F 2D BB A3 75 EF 2B 30 6E 73 86 B4 E4   ....-..u.+0ns...
ISAKMP:  91 E0 15 C3                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 1B E0                                       ....
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 19 8F                                       ....
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  77 E1 7F 69 6E 6D 75 23 5E C6 CB 69 F9 5A 09 2A   w..inmu#^..i.Z.*
ISAKMP:  72 4E 83 F1 61 EB 17 7A 95 A3 68 76 36 4D 20 75   rN..a..z..hv6M u
ISAKMP:  7F 82 DA FD 2B 52 67 23 4C DF 6F 57 03 08 38 5C   ....+Rg#L.oW..8\
ISAKMP:  A4 5F AB 93 A2 56 0A BF 5D 33 B0 8E F1 81 19 24   ._...V..]3.....$
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  4E DF 9E CD EE AB 2B 35 96 4F 9A 46 47 DA 9F ED   N.....+5.O.FG...
ISAKMP:  2A D0 33 70 97 0B 87 A1 E3 76 C2 F8 DA 89 28 4E   *.3p.....v....(N
ISAKMP:  FA 61 18 2B D7 61 A1 06 A8 84 8A BF E6 9B 5E C3   .a.+.a........^.
ISAKMP:  B7 45 47 37 E2 D9 86 D2 AE F5 81 E2 A2 01 20 34   .EG7.......... 4
ISAKMP:  08 47 2E C5 78 1B 76 48 B7 51 40 46 1C 61 74 54   .G..x.vH.Q@F.atT
ISAKMP:  D7 A0 BC 46 6D D3 7A C5 77 D8 28 9A 28 6B 29 C0   ...Fm.z.w.(.(k).
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 01   !...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:

Received any <HDR*,Hash(2),SA,KE,Nr> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR*,Hash(2),SA,KE,Nr> Packet
with the same Proposal Number in both Proposals

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-11.3: Passed

>> IKE-IPV6-11.18
TEST_DESCRIPTION
IKE can be used to negotiate a combined protection suite consisting of
multiple protocols.
Quick mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s4.1 p47 ISAKMP Exchange Types
TEST_METHOD
- ANVL: Establish one ISAKMP SA with DUT
- ANVL: Send <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> with two Proposal Payloads for a
        combined protection suite with two different protocols,
        one for AH, one for ESP with same Proposal number.
-  DUT: Send <HDR*,HASH(2),SA,Nr,KE,IDci,IDcr>
- ANVL: Send <HDR*,HASH(3)>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending <HDR,SA> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 80 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0x2139 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0x0E86 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
Sending <HDR,KE,Ni> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 156 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 156 
UDP: Checksum         = 0x9FE4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 148 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  C7 1D 84 D1 47 87 29 02 AC CE F7 E4 49 8E AF 9C   ....G.).....I...
ISAKMP:  D3 40 92 5A 81 B5 29 E9 DA AD BD 76 20 1F D1 9E   .@.Z..)....v ...
ISAKMP:  6B F2 A2 3F 92 DF 31 9A 84 E2 09 28 8B D6 39 FA   k..?..1....(..9.
ISAKMP:  B2 7B 8A 30 F9 0F A5 F0 87 63 4B AD 30 D8 2E B7   .{.0.....cK.0...
ISAKMP:  3E 85 FC 7C 6A 1D 42 F5 1C F7 ED F7 53 14 0A D4   >..|j.B.....S...
ISAKMP:  41 0A 76 12 8F 68 B1 84 84 60 13 7E 53 FE 4F AC   A.v..h...`.~S.O.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A 56 25 49 D4 33 C6 00 E3 A4 08 5C 12 35 35 AA   *V%I.3.....\.55.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 204 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 204 
UDP: Checksum         = 0x82A8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 196 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  BD 78 26 D5 28 1A 5B A5 CE C2 E7 83 90 47 27 6B   .x&.(.[......G'k
ISAKMP:  1B AF 26 B2 A3 76 63 6A 8C E9 1E 7E 54 CE A5 EE   ..&..vcj...~T...
ISAKMP:  D8 B5 AE D0 EC D8 97 D1 3C 4F 3A 1E 8A 2C 3D 12   ........<O:..,=.
ISAKMP:  0E 00 5B 85 D2 CC 02 D2 9A EB 16 DE 88 0B C4 F7   ..[.............
ISAKMP:  DF 4D 15 6B 75 7F 8D C8 42 B9 AB DB D4 CC 01 C3   .M.ku...B.......
ISAKMP:  3E 0D 24 53 E4 7F 9D 1A 3F 5C C1 10 F5 17 0B BE   >.$S....?\......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D1 79 A7 48 36 77 66 12 D8 FE 0F 82 D9 C1 84 8C   .y.H6wf.........
ISAKMP:  AA 17 19 C4 38 98 44 37 71 FF 39 F7 45 98 5B EF   ....8.D7q.9.E.[.
ISAKMP:  FB B1 69 B8 24 A9 B5 E5 88 43 34 89 6C 4A B0 56   ..i.$....C4.lJ.V
ISAKMP:  F1 85 E0 42 24 71 B6 65 CE CD 5D B0 4F 35 CD 58   ...B$q.e..].O5.X
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:

Received <HDR,KE,Nr> Packet from DUT
Sending <HDR*,ID,Hash_I> Packet to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0x8CFB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  A9 48 AF 9B 02 B5 1D E2 52 3A 26 47 BD 69 49 3F   .H......R:&G.iI?
ISAKMP:  0A 45 00 17                                       .E..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 84 
UDP: Checksum         = 0xF6B0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 76 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E6 5C 02 33 44 86 32 7A 60 3D 17 4E B8 F5 0E 4F   .\.3D.2z`=.N...O
ISAKMP:  0A B5 2B D2                                       ..+.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:

Received <HDR*,ID,Hash_R> Packet from DUT
ISAKMP SA has been Established

Waiting (up to 5.000 seconds) for DUT to stabilize the ISAKMP SA

Sending <HDR*,HASH(1),SA,Ni,KE,IDci,IDcr> with two Proposal Payloads for a
combined protection suite with two different protocols,
one for AH, one for ESP with same Proposal number to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 308 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 308 
UDP: Checksum         = 0xB704 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x2E87FD07
ISAKMP: Length                   = 300 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  1A 55 97 B8 61 2C 16 52 BC F3 9E 99 E2 3F 2E 06   .U..a,.R.....?..
ISAKMP:  F9 A4 A7 75                                       ...u
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  2F DA 97 98                                       /...
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  55 69 E0 84                                       Ui..
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B1 62 E5 EC BF 18 5E 66 F0 A5 FC A1 80 1A 2C 3A   .b....^f......,:
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  78 9C 6D E7 46 B7 85 6D 90 60 06 B9 C9 19 D2 34   x.m.F..m.`.....4
ISAKMP:  96 83 B1 96 E3 CB 74 78 AF 9B 91 9C D5 CA A5 1A   ......tx........
ISAKMP:  CB 29 B9 5C 8C 20 80 0E 29 AD 00 29 65 0A 91 EF   .).\. ..)..)e...
ISAKMP:  CF 03 63 E1 DA 94 81 22 62 AA A5 2E 04 7E 94 E9   ..c...."b....~..
ISAKMP:  FB 1C D7 6F F3 72 7B B3 21 DC D6 30 0F EF 5E 03   ...o.r{.!..0..^.
ISAKMP:  0F D7 AA 03 2B E6 40 53 A8 26 D5 B3 7B 4D A4 30   ....+.@S.&..{M.0
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 01   !...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Quick Mode Exchange on interface 2000::1

Received Hash Data matches with the computed value

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xBC90 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x2E87FD07
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  DA 41 6C 99 F4 66 52 9A 5B E5 27 F3 B0 10 8A 35   .Al..fR.[.'....5
ISAKMP:  0E 00 75 05                                       ..u.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 3 (ESP)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 15 1F                                       ....
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (DES)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 2 (HMAC-SHA)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 2 (AH)
ISAKMP: SPI Size                 = 4
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [4 bytes] ---
ISAKMP:  00 00 12 27                                       ...'
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 2 (MD5)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Encapsulation Mode)
ISAKMP: SA Attribute Value       = 1 (Tunnel)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 5 (Authentication Algorithm)
ISAKMP: SA Attribute Value       = 1 (HMAC-MD5)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  75 46 72 DB 57 AE 7D 4A D4 4B F5 93 A5 1F EA FA   uFr.W.}J.K......
ISAKMP:  67 29 FB 4D C1 6A DC 2C EE AD 56 19 2F A7 47 AE   g).M.j.,..V./.G.
ISAKMP:  E3 2A 89 88 9E D8 E6 01 15 C2 16 57 70 B8 47 DF   .*.........Wp.G.
ISAKMP:  74 62 83 7D 4A 89 06 A9 35 6E 1F DF 05 D6 75 DD   tb.}J...5n....u.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  34 EB DA 83 58 EA 31 87 58 B0 9E B4 E2 FA 32 33   4...X.1.X.....23
ISAKMP:  D9 9F A2 B6 E5 5D 1C AD BE F5 1A DE 95 82 F5 E5   .....]..........
ISAKMP:  B5 A9 9C 22 EE CE 53 2E 20 EA E2 03 0C 78 97 CB   ..."..S. ....x..
ISAKMP:  78 B0 8B 79 03 B2 CF FE 3E 71 5D 49 4B 42 6A 47   x..y....>q]IKBjG
ISAKMP:  CB FE 76 AE 9C FB 82 77 2F DB 1A C8 39 B6 F5 90   ..v....w/...9...
ISAKMP:  EF 1B 69 49 5B 78 82 B9 B8 77 37 C4 05 85 96 11   ..iI[x...w7.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  21 11 00 00 00 00 00 00 00 00 00 00 00 00 00 01   !...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:

Received <HDR*,HASH(2),SA,Ni,KE,IDci,IDcr> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR*,HASH(3)> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 60 
UDP: Checksum         = 0x02F8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A8 9A E9 0D 86 9D 7C 0F                           ......|.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  44 01 EC 50 62 06 16 9E                           D..Pb...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 32 (Quick Mode Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x2E87FD07
ISAKMP: Length                   = 52 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  2A FE 03 BC 05 B0 B3 AC 84 EA C2 7C 82 EA 99 7F   *..........|....
ISAKMP:  02 56 1A 6A                                       .V.j
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

IPSec SA has been succesfully established
between 2000::5 and 2000::1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-11.18: Passed

>> IKE-IPV6-14.6
TEST_DESCRIPTION
IKE MUST support DES_CBC,SHA,Authentication via pre_shared keys
and MODP over default group number one.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode with SA Attributes = {Encryption algo: DES_CBC,
        Hash algo: SHA, Auth Method: Authentication via
        pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA,KE,Ni,IDii> with requested SA Attributes 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes  = {DES, SHA}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-dh1-sha-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_dh1_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_dh1_sha.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 300 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 300 
UDP: Checksum         = 0xC568 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  06 FB E3 19 45 88 46 D2                           ....E.F.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 292 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  CE FA 60 65 A3 87 80 30 81 54 84 9B 46 B6 B7 2A   ..`e...0.T..F..*
ISAKMP:  30 38 F9 CA B0 E9 2B E0 98 99 1C EA 87 4E 4A A2   08....+......NJ.
ISAKMP:  9D 79 D2 B7 8C 0A 1A 6D F4 F7 F5 7E 4F 8F 4A C7   .y.....m...~O.J.
ISAKMP:  B9 BD E8 2C 0F 07 85 EF 28 A8 94 70 70 AF F3 A5   ...,....(..pp...
ISAKMP:  BE D8 C1 45 32 68 7F 59 EE 60 7D 5F B1 67 7A 56   ...E2h.Y.`}_.gzV
ISAKMP:  3C F6 46 D8 EA B9 B9 A1 35 1D 84 33 98 28 0D D4   <.F.....5..3.(..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D1 58 71 FF 2F 26 91 CA 21 46 EE 18 D6 0B AC B9   .Xq./&..!F......
ISAKMP:  0A D4 65 1F C2 AC 9A 1E FF DD B5 E6 EB 48 E4 57   ..e..........H.W
ISAKMP:  87 C3 E7 96 FE AD 47 3A 11 30 2A 4E 4E F1 4B E0   ......G:.0*NN.K.
ISAKMP:  92 7D 22 57 98 7A 43 64 31 01 28 4E CC 2A 0E 5A   .}"W.zCd1.(N.*.Z
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
4 mandatory SA Attrbitues as requested

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 MD5 3DES_CBC HMAC_SHA ESP_DES MODP768 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.6: Passed
Executing system command:
  "./DocScriptQ35/IKEIPV6/IKEIPV6postsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipike
ipd: kill ipike ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar set -o ipike.strict_lifetime_policy "0"
sysvar: ipike.strict_lifetime_policy=0 ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          7
Number of tests passed:       7
Number of tests failed:       0
Number of tests inconclusive: 0
exit
Au revoir!
Connection closed by foreign host.
